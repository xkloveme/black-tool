const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./angular-html-GqBVQ6Dm.js","./html-DG1TtFnM.js","./javascript-DNgb01dh.js","./css-u4bm_LMz.js","./angular-ts-MKs4dlu_.js","./scss-BfMQ58X7.js","./apl-C6GBNg32.js","./xml-BOQ9RtXF.js","./java-BN40hmum.js","./json-DWmkr0yC.js","./astro-DTSlZd1t.js","./typescript-CVESyXxo.js","./postcss-DmF4-xLG.js","./blade-CPEzV-UE.js","./sql-D8nBeWSR.js","./bsl-Dgyn0ogV.js","./sdbl-BLhTXw86.js","./cobol-NX_YbRMJ.js","./coffee-CXcjgkhu.js","./cpp-IRqjNdQP.js","./regexp-DoiKbUTj.js","./glsl-bwZ1_LLM.js","./c-BhsLqr-4.js","./crystal-DFEzbmK1.js","./shellscript-HNM5thJl.js","./edge-Cq_6DOij.js","./html-derivative-CDVwFiY1.js","./elixir-BoNJ9vXU.js","./elm-CTr_twwF.js","./erb-DuefeV9w.js","./ruby-C8Yez0Ov.js","./lua-B2--UKVN.js","./fortran-fixed-form-C9lV_GL-.js","./fortran-free-form-B3Z_eaxm.js","./fsharp-Vw5t3P44.js","./markdown-CNXuF1yM.js","./gdresource-D_y5yz_M.js","./gdshader-BSHf-0eb.js","./gdscript-BIguuW30.js","./git-commit-C0WNX4K0.js","./diff-Dnfm4U7b.js","./git-rebase-3YLVFLpI.js","./glimmer-js-D4fdoRWd.js","./glimmer-ts-DFoQQgBS.js","./graphql-DqgCZ2sd.js","./jsx-CM4fc1WH.js","./tsx-DqpEK-75.js","./hack-BV5LM4CS.js","./haml-B1jT_oKV.js","./handlebars-HtVeTy3a.js","./yaml-CIiI48o2.js","./http-CYnz8shJ.js","./hxml-BfFmssGd.js","./haxe-BgqZeg96.js","./imba-C6vdFTm2.js","./jinja-BORjBBXU.js","./jison-Ct8rtT8R.js","./julia-Czdw582_.js","./python-CK56Z9cH.js","./r-Cqv5JV-q.js","./latex-BpoAco4y.js","./tex-Dej6pUpk.js","./liquid-0snwLfvK.js","./marko-BxSrAFJn.js","./less-Dk1rBueR.js","./mdc-DfEMzj3F.js","./nginx-Dw0nYz9L.js","./nim-NHYZZDnF.js","./perl-DLffUHFU.js","./php-D3VTUn6x.js","./pug-BbGfWiEl.js","./qml-Dhho_E4W.js","./razor-CDyaIOPG.js","./csharp-D7v6OrNy.js","./rst-BtGMdPX_.js","./cmake-DbXoA79R.js","./sas-K_Wwm3IX.js","./shaderlab-CsYUIUcf.js","./hlsl-DkpUthgY.js","./shellsession-DU_2P5ZA.js","./soy-aWhPD8Nq.js","./sparql-B5YtT9lV.js","./turtle-C0hdQUNN.js","./stata-bRt97scT.js","./svelte-DK3KTNg_.js","./templ-CP2hJ0oK.js","./go-Cv7ZOjGq.js","./ts-tags-CiO5kd_m.js","./twig-DN6YEzOP.js","./vue-xldAUJov.js","./vue-html-x3hEOujm.js","./xsl-BqG2VzO2.js"])))=>i.map(i=>d[i]);
var Hi=Object.defineProperty;var Gi=(n,e,t)=>e in n?Hi(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Fe=(n,e,t)=>Gi(n,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function makeMap(n){const e=Object.create(null);for(const t of n.split(","))e[t]=1;return t=>t in e}const EMPTY_OBJ={},EMPTY_ARR=[],NOOP=()=>{},NO=()=>!1,isOn=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&(n.charCodeAt(2)>122||n.charCodeAt(2)<97),isModelListener=n=>n.startsWith("onUpdate:"),extend=Object.assign,remove=(n,e)=>{const t=n.indexOf(e);t>-1&&n.splice(t,1)},hasOwnProperty$1=Object.prototype.hasOwnProperty,hasOwn=(n,e)=>hasOwnProperty$1.call(n,e),isArray$1=Array.isArray,isMap=n=>toTypeString(n)==="[object Map]",isSet=n=>toTypeString(n)==="[object Set]",isDate=n=>toTypeString(n)==="[object Date]",isFunction=n=>typeof n=="function",isString$1=n=>typeof n=="string",isSymbol=n=>typeof n=="symbol",isObject=n=>n!==null&&typeof n=="object",isPromise$1=n=>(isObject(n)||isFunction(n))&&isFunction(n.then)&&isFunction(n.catch),objectToString=Object.prototype.toString,toTypeString=n=>objectToString.call(n),toRawType=n=>toTypeString(n).slice(8,-1),isPlainObject$1=n=>toTypeString(n)==="[object Object]",isIntegerKey=n=>isString$1(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,isReservedProp=makeMap(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),cacheStringFunction=n=>{const e=Object.create(null);return t=>e[t]||(e[t]=n(t))},camelizeRE=/-(\w)/g,camelize=cacheStringFunction(n=>n.replace(camelizeRE,(e,t)=>t?t.toUpperCase():"")),hyphenateRE=/\B([A-Z])/g,hyphenate=cacheStringFunction(n=>n.replace(hyphenateRE,"-$1").toLowerCase()),capitalize=cacheStringFunction(n=>n.charAt(0).toUpperCase()+n.slice(1)),toHandlerKey=cacheStringFunction(n=>n?`on${capitalize(n)}`:""),hasChanged=(n,e)=>!Object.is(n,e),invokeArrayFns=(n,...e)=>{for(let t=0;t<n.length;t++)n[t](...e)},def=(n,e,t,r=!1)=>{Object.defineProperty(n,e,{configurable:!0,enumerable:!1,writable:r,value:t})},looseToNumber=n=>{const e=parseFloat(n);return isNaN(e)?n:e},toNumber=n=>{const e=isString$1(n)?Number(n):NaN;return isNaN(e)?n:e};let _globalThis;const getGlobalThis=()=>_globalThis||(_globalThis=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function normalizeStyle(n){if(isArray$1(n)){const e={};for(let t=0;t<n.length;t++){const r=n[t],i=isString$1(r)?parseStringStyle(r):normalizeStyle(r);if(i)for(const s in i)e[s]=i[s]}return e}else if(isString$1(n)||isObject(n))return n}const listDelimiterRE=/;(?![^(]*\))/g,propertyDelimiterRE=/:([^]+)/,styleCommentRE=/\/\*[^]*?\*\//g;function parseStringStyle(n){const e={};return n.replace(styleCommentRE,"").split(listDelimiterRE).forEach(t=>{if(t){const r=t.split(propertyDelimiterRE);r.length>1&&(e[r[0].trim()]=r[1].trim())}}),e}function normalizeClass(n){let e="";if(isString$1(n))e=n;else if(isArray$1(n))for(let t=0;t<n.length;t++){const r=normalizeClass(n[t]);r&&(e+=r+" ")}else if(isObject(n))for(const t in n)n[t]&&(e+=t+" ");return e.trim()}const specialBooleanAttrs="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",isSpecialBooleanAttr=makeMap(specialBooleanAttrs);function includeBooleanAttr(n){return!!n||n===""}function looseCompareArrays(n,e){if(n.length!==e.length)return!1;let t=!0;for(let r=0;t&&r<n.length;r++)t=looseEqual(n[r],e[r]);return t}function looseEqual(n,e){if(n===e)return!0;let t=isDate(n),r=isDate(e);if(t||r)return t&&r?n.getTime()===e.getTime():!1;if(t=isSymbol(n),r=isSymbol(e),t||r)return n===e;if(t=isArray$1(n),r=isArray$1(e),t||r)return t&&r?looseCompareArrays(n,e):!1;if(t=isObject(n),r=isObject(e),t||r){if(!t||!r)return!1;const i=Object.keys(n).length,s=Object.keys(e).length;if(i!==s)return!1;for(const o in n){const a=n.hasOwnProperty(o),l=e.hasOwnProperty(o);if(a&&!l||!a&&l||!looseEqual(n[o],e[o]))return!1}}return String(n)===String(e)}function looseIndexOf(n,e){return n.findIndex(t=>looseEqual(t,e))}const isRef$1=n=>!!(n&&n.__v_isRef===!0),toDisplayString=n=>isString$1(n)?n:n==null?"":isArray$1(n)||isObject(n)&&(n.toString===objectToString||!isFunction(n.toString))?isRef$1(n)?toDisplayString(n.value):JSON.stringify(n,replacer,2):String(n),replacer=(n,e)=>isRef$1(e)?replacer(n,e.value):isMap(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((t,[r,i],s)=>(t[stringifySymbol(r,s)+" =>"]=i,t),{})}:isSet(e)?{[`Set(${e.size})`]:[...e.values()].map(t=>stringifySymbol(t))}:isSymbol(e)?stringifySymbol(e):isObject(e)&&!isArray$1(e)&&!isPlainObject$1(e)?String(e):e,stringifySymbol=(n,e="")=>{var t;return isSymbol(n)?`Symbol(${(t=n.description)!=null?t:e})`:n};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let activeEffectScope;class EffectScope{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=activeEffectScope,!e&&activeEffectScope&&(this.index=(activeEffectScope.scopes||(activeEffectScope.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].pause();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].resume();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].resume()}}run(e){if(this._active){const t=activeEffectScope;try{return activeEffectScope=this,e()}finally{activeEffectScope=t}}}on(){activeEffectScope=this}off(){activeEffectScope=this.parent}stop(e){if(this._active){this._active=!1;let t,r;for(t=0,r=this.effects.length;t<r;t++)this.effects[t].stop();for(this.effects.length=0,t=0,r=this.cleanups.length;t<r;t++)this.cleanups[t]();if(this.cleanups.length=0,this.scopes){for(t=0,r=this.scopes.length;t<r;t++)this.scopes[t].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.parent=void 0}}}function effectScope(n){return new EffectScope(n)}function getCurrentScope(){return activeEffectScope}function onScopeDispose(n,e=!1){activeEffectScope&&activeEffectScope.cleanups.push(n)}let activeSub;const pausedQueueEffects=new WeakSet;class ReactiveEffect{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,activeEffectScope&&activeEffectScope.active&&activeEffectScope.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,pausedQueueEffects.has(this)&&(pausedQueueEffects.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||batch(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,cleanupEffect(this),prepareDeps(this);const e=activeSub,t=shouldTrack;activeSub=this,shouldTrack=!0;try{return this.fn()}finally{cleanupDeps(this),activeSub=e,shouldTrack=t,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)removeSub(e);this.deps=this.depsTail=void 0,cleanupEffect(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?pausedQueueEffects.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){isDirty(this)&&this.run()}get dirty(){return isDirty(this)}}let batchDepth=0,batchedSub,batchedComputed;function batch(n,e=!1){if(n.flags|=8,e){n.next=batchedComputed,batchedComputed=n;return}n.next=batchedSub,batchedSub=n}function startBatch(){batchDepth++}function endBatch(){if(--batchDepth>0)return;if(batchedComputed){let e=batchedComputed;for(batchedComputed=void 0;e;){const t=e.next;e.next=void 0,e.flags&=-9,e=t}}let n;for(;batchedSub;){let e=batchedSub;for(batchedSub=void 0;e;){const t=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(r){n||(n=r)}e=t}}if(n)throw n}function prepareDeps(n){for(let e=n.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function cleanupDeps(n){let e,t=n.depsTail,r=t;for(;r;){const i=r.prevDep;r.version===-1?(r===t&&(t=i),removeSub(r),removeDep(r)):e=r,r.dep.activeLink=r.prevActiveLink,r.prevActiveLink=void 0,r=i}n.deps=e,n.depsTail=t}function isDirty(n){for(let e=n.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(refreshComputed(e.dep.computed)||e.dep.version!==e.version))return!0;return!!n._dirty}function refreshComputed(n){if(n.flags&4&&!(n.flags&16)||(n.flags&=-17,n.globalVersion===globalVersion))return;n.globalVersion=globalVersion;const e=n.dep;if(n.flags|=2,e.version>0&&!n.isSSR&&n.deps&&!isDirty(n)){n.flags&=-3;return}const t=activeSub,r=shouldTrack;activeSub=n,shouldTrack=!0;try{prepareDeps(n);const i=n.fn(n._value);(e.version===0||hasChanged(i,n._value))&&(n._value=i,e.version++)}catch(i){throw e.version++,i}finally{activeSub=t,shouldTrack=r,cleanupDeps(n),n.flags&=-3}}function removeSub(n,e=!1){const{dep:t,prevSub:r,nextSub:i}=n;if(r&&(r.nextSub=i,n.prevSub=void 0),i&&(i.prevSub=r,n.nextSub=void 0),t.subs===n&&(t.subs=r,!r&&t.computed)){t.computed.flags&=-5;for(let s=t.computed.deps;s;s=s.nextDep)removeSub(s,!0)}!e&&!--t.sc&&t.map&&t.map.delete(t.key)}function removeDep(n){const{prevDep:e,nextDep:t}=n;e&&(e.nextDep=t,n.prevDep=void 0),t&&(t.prevDep=e,n.nextDep=void 0)}let shouldTrack=!0;const trackStack=[];function pauseTracking(){trackStack.push(shouldTrack),shouldTrack=!1}function resetTracking(){const n=trackStack.pop();shouldTrack=n===void 0?!0:n}function cleanupEffect(n){const{cleanup:e}=n;if(n.cleanup=void 0,e){const t=activeSub;activeSub=void 0;try{e()}finally{activeSub=t}}}let globalVersion=0;class Link{constructor(e,t){this.sub=e,this.dep=t,this.version=t.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Dep{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(e){if(!activeSub||!shouldTrack||activeSub===this.computed)return;let t=this.activeLink;if(t===void 0||t.sub!==activeSub)t=this.activeLink=new Link(activeSub,this),activeSub.deps?(t.prevDep=activeSub.depsTail,activeSub.depsTail.nextDep=t,activeSub.depsTail=t):activeSub.deps=activeSub.depsTail=t,addSub(t);else if(t.version===-1&&(t.version=this.version,t.nextDep)){const r=t.nextDep;r.prevDep=t.prevDep,t.prevDep&&(t.prevDep.nextDep=r),t.prevDep=activeSub.depsTail,t.nextDep=void 0,activeSub.depsTail.nextDep=t,activeSub.depsTail=t,activeSub.deps===t&&(activeSub.deps=r)}return t}trigger(e){this.version++,globalVersion++,this.notify(e)}notify(e){startBatch();try{for(let t=this.subs;t;t=t.prevSub)t.sub.notify()&&t.sub.dep.notify()}finally{endBatch()}}}function addSub(n){if(n.dep.sc++,n.sub.flags&4){const e=n.dep.computed;if(e&&!n.dep.subs){e.flags|=20;for(let r=e.deps;r;r=r.nextDep)addSub(r)}const t=n.dep.subs;t!==n&&(n.prevSub=t,t&&(t.nextSub=n)),n.dep.subs=n}}const targetMap=new WeakMap,ITERATE_KEY=Symbol(""),MAP_KEY_ITERATE_KEY=Symbol(""),ARRAY_ITERATE_KEY=Symbol("");function track(n,e,t){if(shouldTrack&&activeSub){let r=targetMap.get(n);r||targetMap.set(n,r=new Map);let i=r.get(t);i||(r.set(t,i=new Dep),i.map=r,i.key=t),i.track()}}function trigger(n,e,t,r,i,s){const o=targetMap.get(n);if(!o){globalVersion++;return}const a=l=>{l&&l.trigger()};if(startBatch(),e==="clear")o.forEach(a);else{const l=isArray$1(n),c=l&&isIntegerKey(t);if(l&&t==="length"){const u=Number(r);o.forEach((d,f)=>{(f==="length"||f===ARRAY_ITERATE_KEY||!isSymbol(f)&&f>=u)&&a(d)})}else switch((t!==void 0||o.has(void 0))&&a(o.get(t)),c&&a(o.get(ARRAY_ITERATE_KEY)),e){case"add":l?c&&a(o.get("length")):(a(o.get(ITERATE_KEY)),isMap(n)&&a(o.get(MAP_KEY_ITERATE_KEY)));break;case"delete":l||(a(o.get(ITERATE_KEY)),isMap(n)&&a(o.get(MAP_KEY_ITERATE_KEY)));break;case"set":isMap(n)&&a(o.get(ITERATE_KEY));break}}endBatch()}function getDepFromReactive(n,e){const t=targetMap.get(n);return t&&t.get(e)}function reactiveReadArray(n){const e=toRaw(n);return e===n?e:(track(e,"iterate",ARRAY_ITERATE_KEY),isShallow(n)?e:e.map(toReactive))}function shallowReadArray(n){return track(n=toRaw(n),"iterate",ARRAY_ITERATE_KEY),n}const arrayInstrumentations={__proto__:null,[Symbol.iterator](){return iterator(this,Symbol.iterator,toReactive)},concat(...n){return reactiveReadArray(this).concat(...n.map(e=>isArray$1(e)?reactiveReadArray(e):e))},entries(){return iterator(this,"entries",n=>(n[1]=toReactive(n[1]),n))},every(n,e){return apply(this,"every",n,e,void 0,arguments)},filter(n,e){return apply(this,"filter",n,e,t=>t.map(toReactive),arguments)},find(n,e){return apply(this,"find",n,e,toReactive,arguments)},findIndex(n,e){return apply(this,"findIndex",n,e,void 0,arguments)},findLast(n,e){return apply(this,"findLast",n,e,toReactive,arguments)},findLastIndex(n,e){return apply(this,"findLastIndex",n,e,void 0,arguments)},forEach(n,e){return apply(this,"forEach",n,e,void 0,arguments)},includes(...n){return searchProxy(this,"includes",n)},indexOf(...n){return searchProxy(this,"indexOf",n)},join(n){return reactiveReadArray(this).join(n)},lastIndexOf(...n){return searchProxy(this,"lastIndexOf",n)},map(n,e){return apply(this,"map",n,e,void 0,arguments)},pop(){return noTracking(this,"pop")},push(...n){return noTracking(this,"push",n)},reduce(n,...e){return reduce(this,"reduce",n,e)},reduceRight(n,...e){return reduce(this,"reduceRight",n,e)},shift(){return noTracking(this,"shift")},some(n,e){return apply(this,"some",n,e,void 0,arguments)},splice(...n){return noTracking(this,"splice",n)},toReversed(){return reactiveReadArray(this).toReversed()},toSorted(n){return reactiveReadArray(this).toSorted(n)},toSpliced(...n){return reactiveReadArray(this).toSpliced(...n)},unshift(...n){return noTracking(this,"unshift",n)},values(){return iterator(this,"values",toReactive)}};function iterator(n,e,t){const r=shallowReadArray(n),i=r[e]();return r!==n&&!isShallow(n)&&(i._next=i.next,i.next=()=>{const s=i._next();return s.value&&(s.value=t(s.value)),s}),i}const arrayProto=Array.prototype;function apply(n,e,t,r,i,s){const o=shallowReadArray(n),a=o!==n&&!isShallow(n),l=o[e];if(l!==arrayProto[e]){const d=l.apply(n,s);return a?toReactive(d):d}let c=t;o!==n&&(a?c=function(d,f){return t.call(this,toReactive(d),f,n)}:t.length>2&&(c=function(d,f){return t.call(this,d,f,n)}));const u=l.call(o,c,r);return a&&i?i(u):u}function reduce(n,e,t,r){const i=shallowReadArray(n);let s=t;return i!==n&&(isShallow(n)?t.length>3&&(s=function(o,a,l){return t.call(this,o,a,l,n)}):s=function(o,a,l){return t.call(this,o,toReactive(a),l,n)}),i[e](s,...r)}function searchProxy(n,e,t){const r=toRaw(n);track(r,"iterate",ARRAY_ITERATE_KEY);const i=r[e](...t);return(i===-1||i===!1)&&isProxy(t[0])?(t[0]=toRaw(t[0]),r[e](...t)):i}function noTracking(n,e,t=[]){pauseTracking(),startBatch();const r=toRaw(n)[e].apply(n,t);return endBatch(),resetTracking(),r}const isNonTrackableKeys=makeMap("__proto__,__v_isRef,__isVue"),builtInSymbols=new Set(Object.getOwnPropertyNames(Symbol).filter(n=>n!=="arguments"&&n!=="caller").map(n=>Symbol[n]).filter(isSymbol));function hasOwnProperty(n){isSymbol(n)||(n=String(n));const e=toRaw(this);return track(e,"has",n),e.hasOwnProperty(n)}class BaseReactiveHandler{constructor(e=!1,t=!1){this._isReadonly=e,this._isShallow=t}get(e,t,r){if(t==="__v_skip")return e.__v_skip;const i=this._isReadonly,s=this._isShallow;if(t==="__v_isReactive")return!i;if(t==="__v_isReadonly")return i;if(t==="__v_isShallow")return s;if(t==="__v_raw")return r===(i?s?shallowReadonlyMap:readonlyMap:s?shallowReactiveMap:reactiveMap).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(r)?e:void 0;const o=isArray$1(e);if(!i){let l;if(o&&(l=arrayInstrumentations[t]))return l;if(t==="hasOwnProperty")return hasOwnProperty}const a=Reflect.get(e,t,isRef(e)?e:r);return(isSymbol(t)?builtInSymbols.has(t):isNonTrackableKeys(t))||(i||track(e,"get",t),s)?a:isRef(a)?o&&isIntegerKey(t)?a:a.value:isObject(a)?i?readonly(a):reactive(a):a}}class MutableReactiveHandler extends BaseReactiveHandler{constructor(e=!1){super(!1,e)}set(e,t,r,i){let s=e[t];if(!this._isShallow){const l=isReadonly(s);if(!isShallow(r)&&!isReadonly(r)&&(s=toRaw(s),r=toRaw(r)),!isArray$1(e)&&isRef(s)&&!isRef(r))return l?!1:(s.value=r,!0)}const o=isArray$1(e)&&isIntegerKey(t)?Number(t)<e.length:hasOwn(e,t),a=Reflect.set(e,t,r,isRef(e)?e:i);return e===toRaw(i)&&(o?hasChanged(r,s)&&trigger(e,"set",t,r):trigger(e,"add",t,r)),a}deleteProperty(e,t){const r=hasOwn(e,t);e[t];const i=Reflect.deleteProperty(e,t);return i&&r&&trigger(e,"delete",t,void 0),i}has(e,t){const r=Reflect.has(e,t);return(!isSymbol(t)||!builtInSymbols.has(t))&&track(e,"has",t),r}ownKeys(e){return track(e,"iterate",isArray$1(e)?"length":ITERATE_KEY),Reflect.ownKeys(e)}}class ReadonlyReactiveHandler extends BaseReactiveHandler{constructor(e=!1){super(!0,e)}set(e,t){return!0}deleteProperty(e,t){return!0}}const mutableHandlers=new MutableReactiveHandler,readonlyHandlers=new ReadonlyReactiveHandler,shallowReactiveHandlers=new MutableReactiveHandler(!0),shallowReadonlyHandlers=new ReadonlyReactiveHandler(!0),toShallow=n=>n,getProto=n=>Reflect.getPrototypeOf(n);function createIterableMethod(n,e,t){return function(...r){const i=this.__v_raw,s=toRaw(i),o=isMap(s),a=n==="entries"||n===Symbol.iterator&&o,l=n==="keys"&&o,c=i[n](...r),u=t?toShallow:e?toReadonly:toReactive;return!e&&track(s,"iterate",l?MAP_KEY_ITERATE_KEY:ITERATE_KEY),{next(){const{value:d,done:f}=c.next();return f?{value:d,done:f}:{value:a?[u(d[0]),u(d[1])]:u(d),done:f}},[Symbol.iterator](){return this}}}}function createReadonlyMethod(n){return function(...e){return n==="delete"?!1:n==="clear"?void 0:this}}function createInstrumentations(n,e){const t={get(i){const s=this.__v_raw,o=toRaw(s),a=toRaw(i);n||(hasChanged(i,a)&&track(o,"get",i),track(o,"get",a));const{has:l}=getProto(o),c=e?toShallow:n?toReadonly:toReactive;if(l.call(o,i))return c(s.get(i));if(l.call(o,a))return c(s.get(a));s!==o&&s.get(i)},get size(){const i=this.__v_raw;return!n&&track(toRaw(i),"iterate",ITERATE_KEY),Reflect.get(i,"size",i)},has(i){const s=this.__v_raw,o=toRaw(s),a=toRaw(i);return n||(hasChanged(i,a)&&track(o,"has",i),track(o,"has",a)),i===a?s.has(i):s.has(i)||s.has(a)},forEach(i,s){const o=this,a=o.__v_raw,l=toRaw(a),c=e?toShallow:n?toReadonly:toReactive;return!n&&track(l,"iterate",ITERATE_KEY),a.forEach((u,d)=>i.call(s,c(u),c(d),o))}};return extend(t,n?{add:createReadonlyMethod("add"),set:createReadonlyMethod("set"),delete:createReadonlyMethod("delete"),clear:createReadonlyMethod("clear")}:{add(i){!e&&!isShallow(i)&&!isReadonly(i)&&(i=toRaw(i));const s=toRaw(this);return getProto(s).has.call(s,i)||(s.add(i),trigger(s,"add",i,i)),this},set(i,s){!e&&!isShallow(s)&&!isReadonly(s)&&(s=toRaw(s));const o=toRaw(this),{has:a,get:l}=getProto(o);let c=a.call(o,i);c||(i=toRaw(i),c=a.call(o,i));const u=l.call(o,i);return o.set(i,s),c?hasChanged(s,u)&&trigger(o,"set",i,s):trigger(o,"add",i,s),this},delete(i){const s=toRaw(this),{has:o,get:a}=getProto(s);let l=o.call(s,i);l||(i=toRaw(i),l=o.call(s,i)),a&&a.call(s,i);const c=s.delete(i);return l&&trigger(s,"delete",i,void 0),c},clear(){const i=toRaw(this),s=i.size!==0,o=i.clear();return s&&trigger(i,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(i=>{t[i]=createIterableMethod(i,n,e)}),t}function createInstrumentationGetter(n,e){const t=createInstrumentations(n,e);return(r,i,s)=>i==="__v_isReactive"?!n:i==="__v_isReadonly"?n:i==="__v_raw"?r:Reflect.get(hasOwn(t,i)&&i in r?t:r,i,s)}const mutableCollectionHandlers={get:createInstrumentationGetter(!1,!1)},shallowCollectionHandlers={get:createInstrumentationGetter(!1,!0)},readonlyCollectionHandlers={get:createInstrumentationGetter(!0,!1)},shallowReadonlyCollectionHandlers={get:createInstrumentationGetter(!0,!0)},reactiveMap=new WeakMap,shallowReactiveMap=new WeakMap,readonlyMap=new WeakMap,shallowReadonlyMap=new WeakMap;function targetTypeMap(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function getTargetType(n){return n.__v_skip||!Object.isExtensible(n)?0:targetTypeMap(toRawType(n))}function reactive(n){return isReadonly(n)?n:createReactiveObject(n,!1,mutableHandlers,mutableCollectionHandlers,reactiveMap)}function shallowReactive(n){return createReactiveObject(n,!1,shallowReactiveHandlers,shallowCollectionHandlers,shallowReactiveMap)}function readonly(n){return createReactiveObject(n,!0,readonlyHandlers,readonlyCollectionHandlers,readonlyMap)}function shallowReadonly(n){return createReactiveObject(n,!0,shallowReadonlyHandlers,shallowReadonlyCollectionHandlers,shallowReadonlyMap)}function createReactiveObject(n,e,t,r,i){if(!isObject(n)||n.__v_raw&&!(e&&n.__v_isReactive))return n;const s=i.get(n);if(s)return s;const o=getTargetType(n);if(o===0)return n;const a=new Proxy(n,o===2?r:t);return i.set(n,a),a}function isReactive(n){return isReadonly(n)?isReactive(n.__v_raw):!!(n&&n.__v_isReactive)}function isReadonly(n){return!!(n&&n.__v_isReadonly)}function isShallow(n){return!!(n&&n.__v_isShallow)}function isProxy(n){return n?!!n.__v_raw:!1}function toRaw(n){const e=n&&n.__v_raw;return e?toRaw(e):n}function markRaw(n){return!hasOwn(n,"__v_skip")&&Object.isExtensible(n)&&def(n,"__v_skip",!0),n}const toReactive=n=>isObject(n)?reactive(n):n,toReadonly=n=>isObject(n)?readonly(n):n;function isRef(n){return n?n.__v_isRef===!0:!1}function ref(n){return createRef(n,!1)}function shallowRef(n){return createRef(n,!0)}function createRef(n,e){return isRef(n)?n:new RefImpl(n,e)}class RefImpl{constructor(e,t){this.dep=new Dep,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=t?e:toRaw(e),this._value=t?e:toReactive(e),this.__v_isShallow=t}get value(){return this.dep.track(),this._value}set value(e){const t=this._rawValue,r=this.__v_isShallow||isShallow(e)||isReadonly(e);e=r?e:toRaw(e),hasChanged(e,t)&&(this._rawValue=e,this._value=r?e:toReactive(e),this.dep.trigger())}}function unref(n){return isRef(n)?n.value:n}const shallowUnwrapHandlers={get:(n,e,t)=>e==="__v_raw"?n:unref(Reflect.get(n,e,t)),set:(n,e,t,r)=>{const i=n[e];return isRef(i)&&!isRef(t)?(i.value=t,!0):Reflect.set(n,e,t,r)}};function proxyRefs(n){return isReactive(n)?n:new Proxy(n,shallowUnwrapHandlers)}function toRefs(n){const e=isArray$1(n)?new Array(n.length):{};for(const t in n)e[t]=propertyToRef(n,t);return e}class ObjectRefImpl{constructor(e,t,r){this._object=e,this._key=t,this._defaultValue=r,this.__v_isRef=!0,this._value=void 0}get value(){const e=this._object[this._key];return this._value=e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}get dep(){return getDepFromReactive(toRaw(this._object),this._key)}}class GetterRefImpl{constructor(e){this._getter=e,this.__v_isRef=!0,this.__v_isReadonly=!0,this._value=void 0}get value(){return this._value=this._getter()}}function toRef(n,e,t){return isRef(n)?n:isFunction(n)?new GetterRefImpl(n):isObject(n)&&arguments.length>1?propertyToRef(n,e,t):ref(n)}function propertyToRef(n,e,t){const r=n[e];return isRef(r)?r:new ObjectRefImpl(n,e,t)}class ComputedRefImpl{constructor(e,t,r){this.fn=e,this.setter=t,this._value=void 0,this.dep=new Dep(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=globalVersion-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!t,this.isSSR=r}notify(){if(this.flags|=16,!(this.flags&8)&&activeSub!==this)return batch(this,!0),!0}get value(){const e=this.dep.track();return refreshComputed(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function computed$1(n,e,t=!1){let r,i;return isFunction(n)?r=n:(r=n.get,i=n.set),new ComputedRefImpl(r,i,t)}const INITIAL_WATCHER_VALUE={},cleanupMap=new WeakMap;let activeWatcher;function onWatcherCleanup(n,e=!1,t=activeWatcher){if(t){let r=cleanupMap.get(t);r||cleanupMap.set(t,r=[]),r.push(n)}}function watch$1(n,e,t=EMPTY_OBJ){const{immediate:r,deep:i,once:s,scheduler:o,augmentJob:a,call:l}=t,c=k=>i?k:isShallow(k)||i===!1||i===0?traverse(k,1):traverse(k);let u,d,f,m,g=!1,v=!1;if(isRef(n)?(d=()=>n.value,g=isShallow(n)):isReactive(n)?(d=()=>c(n),g=!0):isArray$1(n)?(v=!0,g=n.some(k=>isReactive(k)||isShallow(k)),d=()=>n.map(k=>{if(isRef(k))return k.value;if(isReactive(k))return c(k);if(isFunction(k))return l?l(k,2):k()})):isFunction(n)?e?d=l?()=>l(n,2):n:d=()=>{if(f){pauseTracking();try{f()}finally{resetTracking()}}const k=activeWatcher;activeWatcher=u;try{return l?l(n,3,[m]):n(m)}finally{activeWatcher=k}}:d=NOOP,e&&i){const k=d,I=i===!0?1/0:i;d=()=>traverse(k(),I)}const x=getCurrentScope(),S=()=>{u.stop(),x&&x.active&&remove(x.effects,u)};if(s&&e){const k=e;e=(...I)=>{k(...I),S()}}let C=v?new Array(n.length).fill(INITIAL_WATCHER_VALUE):INITIAL_WATCHER_VALUE;const R=k=>{if(!(!(u.flags&1)||!u.dirty&&!k))if(e){const I=u.run();if(i||g||(v?I.some((F,N)=>hasChanged(F,C[N])):hasChanged(I,C))){f&&f();const F=activeWatcher;activeWatcher=u;try{const N=[I,C===INITIAL_WATCHER_VALUE?void 0:v&&C[0]===INITIAL_WATCHER_VALUE?[]:C,m];l?l(e,3,N):e(...N),C=I}finally{activeWatcher=F}}}else u.run()};return a&&a(R),u=new ReactiveEffect(d),u.scheduler=o?()=>o(R,!1):R,m=k=>onWatcherCleanup(k,!1,u),f=u.onStop=()=>{const k=cleanupMap.get(u);if(k){if(l)l(k,4);else for(const I of k)I();cleanupMap.delete(u)}},e?r?R(!0):C=u.run():o?o(R.bind(null,!0),!0):u.run(),S.pause=u.pause.bind(u),S.resume=u.resume.bind(u),S.stop=S,S}function traverse(n,e=1/0,t){if(e<=0||!isObject(n)||n.__v_skip||(t=t||new Set,t.has(n)))return n;if(t.add(n),e--,isRef(n))traverse(n.value,e,t);else if(isArray$1(n))for(let r=0;r<n.length;r++)traverse(n[r],e,t);else if(isSet(n)||isMap(n))n.forEach(r=>{traverse(r,e,t)});else if(isPlainObject$1(n)){for(const r in n)traverse(n[r],e,t);for(const r of Object.getOwnPropertySymbols(n))Object.prototype.propertyIsEnumerable.call(n,r)&&traverse(n[r],e,t)}return n}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const stack=[];let isWarning=!1;function warn$1(n,...e){if(isWarning)return;isWarning=!0,pauseTracking();const t=stack.length?stack[stack.length-1].component:null,r=t&&t.appContext.config.warnHandler,i=getComponentTrace();if(r)callWithErrorHandling(r,t,11,[n+e.map(s=>{var o,a;return(a=(o=s.toString)==null?void 0:o.call(s))!=null?a:JSON.stringify(s)}).join(""),t&&t.proxy,i.map(({vnode:s})=>`at <${formatComponentName(t,s.type)}>`).join(`
`),i]);else{const s=[`[Vue warn]: ${n}`,...e];i.length&&s.push(`
`,...formatTrace(i)),console.warn(...s)}resetTracking(),isWarning=!1}function getComponentTrace(){let n=stack[stack.length-1];if(!n)return[];const e=[];for(;n;){const t=e[0];t&&t.vnode===n?t.recurseCount++:e.push({vnode:n,recurseCount:0});const r=n.component&&n.component.parent;n=r&&r.vnode}return e}function formatTrace(n){const e=[];return n.forEach((t,r)=>{e.push(...r===0?[]:[`
`],...formatTraceEntry(t))}),e}function formatTraceEntry({vnode:n,recurseCount:e}){const t=e>0?`... (${e} recursive calls)`:"",r=n.component?n.component.parent==null:!1,i=` at <${formatComponentName(n.component,n.type,r)}`,s=">"+t;return n.props?[i,...formatProps(n.props),s]:[i+s]}function formatProps(n){const e=[],t=Object.keys(n);return t.slice(0,3).forEach(r=>{e.push(...formatProp(r,n[r]))}),t.length>3&&e.push(" ..."),e}function formatProp(n,e,t){return isString$1(e)?(e=JSON.stringify(e),t?e:[`${n}=${e}`]):typeof e=="number"||typeof e=="boolean"||e==null?t?e:[`${n}=${e}`]:isRef(e)?(e=formatProp(n,toRaw(e.value),!0),t?e:[`${n}=Ref<`,e,">"]):isFunction(e)?[`${n}=fn${e.name?`<${e.name}>`:""}`]:(e=toRaw(e),t?e:[`${n}=`,e])}function callWithErrorHandling(n,e,t,r){try{return r?n(...r):n()}catch(i){handleError(i,e,t)}}function callWithAsyncErrorHandling(n,e,t,r){if(isFunction(n)){const i=callWithErrorHandling(n,e,t,r);return i&&isPromise$1(i)&&i.catch(s=>{handleError(s,e,t)}),i}if(isArray$1(n)){const i=[];for(let s=0;s<n.length;s++)i.push(callWithAsyncErrorHandling(n[s],e,t,r));return i}}function handleError(n,e,t,r=!0){const i=e?e.vnode:null,{errorHandler:s,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||EMPTY_OBJ;if(e){let a=e.parent;const l=e.proxy,c=`https://vuejs.org/error-reference/#runtime-${t}`;for(;a;){const u=a.ec;if(u){for(let d=0;d<u.length;d++)if(u[d](n,l,c)===!1)return}a=a.parent}if(s){pauseTracking(),callWithErrorHandling(s,null,10,[n,l,c]),resetTracking();return}}logError(n,t,i,r,o)}function logError(n,e,t,r=!0,i=!1){if(i)throw n;console.error(n)}const queue=[];let flushIndex=-1;const pendingPostFlushCbs=[];let activePostFlushCbs=null,postFlushIndex=0;const resolvedPromise=Promise.resolve();let currentFlushPromise=null;function nextTick(n){const e=currentFlushPromise||resolvedPromise;return n?e.then(this?n.bind(this):n):e}function findInsertionIndex$1(n){let e=flushIndex+1,t=queue.length;for(;e<t;){const r=e+t>>>1,i=queue[r],s=getId(i);s<n||s===n&&i.flags&2?e=r+1:t=r}return e}function queueJob(n){if(!(n.flags&1)){const e=getId(n),t=queue[queue.length-1];!t||!(n.flags&2)&&e>=getId(t)?queue.push(n):queue.splice(findInsertionIndex$1(e),0,n),n.flags|=1,queueFlush()}}function queueFlush(){currentFlushPromise||(currentFlushPromise=resolvedPromise.then(flushJobs))}function queuePostFlushCb(n){isArray$1(n)?pendingPostFlushCbs.push(...n):activePostFlushCbs&&n.id===-1?activePostFlushCbs.splice(postFlushIndex+1,0,n):n.flags&1||(pendingPostFlushCbs.push(n),n.flags|=1),queueFlush()}function flushPreFlushCbs(n,e,t=flushIndex+1){for(;t<queue.length;t++){const r=queue[t];if(r&&r.flags&2){if(n&&r.id!==n.uid)continue;queue.splice(t,1),t--,r.flags&4&&(r.flags&=-2),r(),r.flags&4||(r.flags&=-2)}}}function flushPostFlushCbs(n){if(pendingPostFlushCbs.length){const e=[...new Set(pendingPostFlushCbs)].sort((t,r)=>getId(t)-getId(r));if(pendingPostFlushCbs.length=0,activePostFlushCbs){activePostFlushCbs.push(...e);return}for(activePostFlushCbs=e,postFlushIndex=0;postFlushIndex<activePostFlushCbs.length;postFlushIndex++){const t=activePostFlushCbs[postFlushIndex];t.flags&4&&(t.flags&=-2),t.flags&8||t(),t.flags&=-2}activePostFlushCbs=null,postFlushIndex=0}}const getId=n=>n.id==null?n.flags&2?-1:1/0:n.id;function flushJobs(n){try{for(flushIndex=0;flushIndex<queue.length;flushIndex++){const e=queue[flushIndex];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),callWithErrorHandling(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;flushIndex<queue.length;flushIndex++){const e=queue[flushIndex];e&&(e.flags&=-2)}flushIndex=-1,queue.length=0,flushPostFlushCbs(),currentFlushPromise=null,(queue.length||pendingPostFlushCbs.length)&&flushJobs()}}let currentRenderingInstance=null,currentScopeId=null;function setCurrentRenderingInstance(n){const e=currentRenderingInstance;return currentRenderingInstance=n,currentScopeId=n&&n.type.__scopeId||null,e}function withCtx(n,e=currentRenderingInstance,t){if(!e||n._n)return n;const r=(...i)=>{r._d&&setBlockTracking(-1);const s=setCurrentRenderingInstance(e);let o;try{o=n(...i)}finally{setCurrentRenderingInstance(s),r._d&&setBlockTracking(1)}return o};return r._n=!0,r._c=!0,r._d=!0,r}function withDirectives(n,e){if(currentRenderingInstance===null)return n;const t=getComponentPublicInstance(currentRenderingInstance),r=n.dirs||(n.dirs=[]);for(let i=0;i<e.length;i++){let[s,o,a,l=EMPTY_OBJ]=e[i];s&&(isFunction(s)&&(s={mounted:s,updated:s}),s.deep&&traverse(o),r.push({dir:s,instance:t,value:o,oldValue:void 0,arg:a,modifiers:l}))}return n}function invokeDirectiveHook(n,e,t,r){const i=n.dirs,s=e&&e.dirs;for(let o=0;o<i.length;o++){const a=i[o];s&&(a.oldValue=s[o].value);let l=a.dir[r];l&&(pauseTracking(),callWithAsyncErrorHandling(l,t,8,[n.el,a,n,e]),resetTracking())}}const TeleportEndKey=Symbol("_vte"),isTeleport=n=>n.__isTeleport,leaveCbKey=Symbol("_leaveCb"),enterCbKey=Symbol("_enterCb");function useTransitionState(){const n={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return onMounted(()=>{n.isMounted=!0}),onBeforeUnmount(()=>{n.isUnmounting=!0}),n}const TransitionHookValidator=[Function,Array],BaseTransitionPropsValidators={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:TransitionHookValidator,onEnter:TransitionHookValidator,onAfterEnter:TransitionHookValidator,onEnterCancelled:TransitionHookValidator,onBeforeLeave:TransitionHookValidator,onLeave:TransitionHookValidator,onAfterLeave:TransitionHookValidator,onLeaveCancelled:TransitionHookValidator,onBeforeAppear:TransitionHookValidator,onAppear:TransitionHookValidator,onAfterAppear:TransitionHookValidator,onAppearCancelled:TransitionHookValidator},recursiveGetSubtree=n=>{const e=n.subTree;return e.component?recursiveGetSubtree(e.component):e},BaseTransitionImpl={name:"BaseTransition",props:BaseTransitionPropsValidators,setup(n,{slots:e}){const t=getCurrentInstance(),r=useTransitionState();return()=>{const i=e.default&&getTransitionRawChildren(e.default(),!0);if(!i||!i.length)return;const s=findNonCommentChild(i),o=toRaw(n),{mode:a}=o;if(r.isLeaving)return emptyPlaceholder(s);const l=getInnerChild$1(s);if(!l)return emptyPlaceholder(s);let c=resolveTransitionHooks(l,o,r,t,d=>c=d);l.type!==Comment&&setTransitionHooks(l,c);let u=t.subTree&&getInnerChild$1(t.subTree);if(u&&u.type!==Comment&&!isSameVNodeType(l,u)&&recursiveGetSubtree(t).type!==Comment){let d=resolveTransitionHooks(u,o,r,t);if(setTransitionHooks(u,d),a==="out-in"&&l.type!==Comment)return r.isLeaving=!0,d.afterLeave=()=>{r.isLeaving=!1,t.job.flags&8||t.update(),delete d.afterLeave,u=void 0},emptyPlaceholder(s);a==="in-out"&&l.type!==Comment?d.delayLeave=(f,m,g)=>{const v=getLeavingNodesForType(r,u);v[String(u.key)]=u,f[leaveCbKey]=()=>{m(),f[leaveCbKey]=void 0,delete c.delayedLeave,u=void 0},c.delayedLeave=()=>{g(),delete c.delayedLeave,u=void 0}}:u=void 0}else u&&(u=void 0);return s}}};function findNonCommentChild(n){let e=n[0];if(n.length>1){for(const t of n)if(t.type!==Comment){e=t;break}}return e}const BaseTransition=BaseTransitionImpl;function getLeavingNodesForType(n,e){const{leavingVNodes:t}=n;let r=t.get(e.type);return r||(r=Object.create(null),t.set(e.type,r)),r}function resolveTransitionHooks(n,e,t,r,i){const{appear:s,mode:o,persisted:a=!1,onBeforeEnter:l,onEnter:c,onAfterEnter:u,onEnterCancelled:d,onBeforeLeave:f,onLeave:m,onAfterLeave:g,onLeaveCancelled:v,onBeforeAppear:x,onAppear:S,onAfterAppear:C,onAppearCancelled:R}=e,k=String(n.key),I=getLeavingNodesForType(t,n),F=(M,B)=>{M&&callWithAsyncErrorHandling(M,r,9,B)},N=(M,B)=>{const H=B[1];F(M,B),isArray$1(M)?M.every(K=>K.length<=1)&&H():M.length<=1&&H()},U={mode:o,persisted:a,beforeEnter(M){let B=l;if(!t.isMounted)if(s)B=x||l;else return;M[leaveCbKey]&&M[leaveCbKey](!0);const H=I[k];H&&isSameVNodeType(n,H)&&H.el[leaveCbKey]&&H.el[leaveCbKey](),F(B,[M])},enter(M){let B=c,H=u,K=d;if(!t.isMounted)if(s)B=S||c,H=C||u,K=R||d;else return;let Y=!1;const oe=M[enterCbKey]=ue=>{Y||(Y=!0,ue?F(K,[M]):F(H,[M]),U.delayedLeave&&U.delayedLeave(),M[enterCbKey]=void 0)};B?N(B,[M,oe]):oe()},leave(M,B){const H=String(n.key);if(M[enterCbKey]&&M[enterCbKey](!0),t.isUnmounting)return B();F(f,[M]);let K=!1;const Y=M[leaveCbKey]=oe=>{K||(K=!0,B(),oe?F(v,[M]):F(g,[M]),M[leaveCbKey]=void 0,I[H]===n&&delete I[H])};I[H]=n,m?N(m,[M,Y]):Y()},clone(M){const B=resolveTransitionHooks(M,e,t,r,i);return i&&i(B),B}};return U}function emptyPlaceholder(n){if(isKeepAlive(n))return n=cloneVNode(n),n.children=null,n}function getInnerChild$1(n){if(!isKeepAlive(n))return isTeleport(n.type)&&n.children?findNonCommentChild(n.children):n;const{shapeFlag:e,children:t}=n;if(t){if(e&16)return t[0];if(e&32&&isFunction(t.default))return t.default()}}function setTransitionHooks(n,e){n.shapeFlag&6&&n.component?(n.transition=e,setTransitionHooks(n.component.subTree,e)):n.shapeFlag&128?(n.ssContent.transition=e.clone(n.ssContent),n.ssFallback.transition=e.clone(n.ssFallback)):n.transition=e}function getTransitionRawChildren(n,e=!1,t){let r=[],i=0;for(let s=0;s<n.length;s++){let o=n[s];const a=t==null?o.key:String(t)+String(o.key!=null?o.key:s);o.type===Fragment$1?(o.patchFlag&128&&i++,r=r.concat(getTransitionRawChildren(o.children,e,a))):(e||o.type!==Comment)&&r.push(a!=null?cloneVNode(o,{key:a}):o)}if(i>1)for(let s=0;s<r.length;s++)r[s].patchFlag=-2;return r}/*! #__NO_SIDE_EFFECTS__ */function defineComponent(n,e){return isFunction(n)?extend({name:n.name},e,{setup:n}):n}function markAsyncBoundary(n){n.ids=[n.ids[0]+n.ids[2]+++"-",0,0]}function setRef(n,e,t,r,i=!1){if(isArray$1(n)){n.forEach((g,v)=>setRef(g,e&&(isArray$1(e)?e[v]:e),t,r,i));return}if(isAsyncWrapper(r)&&!i){r.shapeFlag&512&&r.type.__asyncResolved&&r.component.subTree.component&&setRef(n,e,t,r.component.subTree);return}const s=r.shapeFlag&4?getComponentPublicInstance(r.component):r.el,o=i?null:s,{i:a,r:l}=n,c=e&&e.r,u=a.refs===EMPTY_OBJ?a.refs={}:a.refs,d=a.setupState,f=toRaw(d),m=d===EMPTY_OBJ?()=>!1:g=>hasOwn(f,g);if(c!=null&&c!==l&&(isString$1(c)?(u[c]=null,m(c)&&(d[c]=null)):isRef(c)&&(c.value=null)),isFunction(l))callWithErrorHandling(l,a,12,[o,u]);else{const g=isString$1(l),v=isRef(l);if(g||v){const x=()=>{if(n.f){const S=g?m(l)?d[l]:u[l]:l.value;i?isArray$1(S)&&remove(S,s):isArray$1(S)?S.includes(s)||S.push(s):g?(u[l]=[s],m(l)&&(d[l]=u[l])):(l.value=[s],n.k&&(u[n.k]=l.value))}else g?(u[l]=o,m(l)&&(d[l]=o)):v&&(l.value=o,n.k&&(u[n.k]=o))};o?(x.id=-1,queuePostRenderEffect(x,t)):x()}}}getGlobalThis().requestIdleCallback;getGlobalThis().cancelIdleCallback;const isAsyncWrapper=n=>!!n.type.__asyncLoader,isKeepAlive=n=>n.type.__isKeepAlive;function onActivated(n,e){registerKeepAliveHook(n,"a",e)}function onDeactivated(n,e){registerKeepAliveHook(n,"da",e)}function registerKeepAliveHook(n,e,t=currentInstance){const r=n.__wdc||(n.__wdc=()=>{let i=t;for(;i;){if(i.isDeactivated)return;i=i.parent}return n()});if(injectHook(e,r,t),t){let i=t.parent;for(;i&&i.parent;)isKeepAlive(i.parent.vnode)&&injectToKeepAliveRoot(r,e,t,i),i=i.parent}}function injectToKeepAliveRoot(n,e,t,r){const i=injectHook(e,n,r,!0);onUnmounted(()=>{remove(r[e],i)},t)}function injectHook(n,e,t=currentInstance,r=!1){if(t){const i=t[n]||(t[n]=[]),s=e.__weh||(e.__weh=(...o)=>{pauseTracking();const a=setCurrentInstance(t),l=callWithAsyncErrorHandling(e,t,n,o);return a(),resetTracking(),l});return r?i.unshift(s):i.push(s),s}}const createHook=n=>(e,t=currentInstance)=>{(!isInSSRComponentSetup||n==="sp")&&injectHook(n,(...r)=>e(...r),t)},onBeforeMount=createHook("bm"),onMounted=createHook("m"),onBeforeUpdate=createHook("bu"),onUpdated=createHook("u"),onBeforeUnmount=createHook("bum"),onUnmounted=createHook("um"),onServerPrefetch=createHook("sp"),onRenderTriggered=createHook("rtg"),onRenderTracked=createHook("rtc");function onErrorCaptured(n,e=currentInstance){injectHook("ec",n,e)}const COMPONENTS="components";function resolveComponent(n,e){return resolveAsset(COMPONENTS,n,!0,e)||n}const NULL_DYNAMIC_COMPONENT=Symbol.for("v-ndc");function resolveAsset(n,e,t=!0,r=!1){const i=currentRenderingInstance||currentInstance;if(i){const s=i.type;{const a=getComponentName(s,!1);if(a&&(a===e||a===camelize(e)||a===capitalize(camelize(e))))return s}const o=resolve(i[n]||s[n],e)||resolve(i.appContext[n],e);return!o&&r?s:o}}function resolve(n,e){return n&&(n[e]||n[camelize(e)]||n[capitalize(camelize(e))])}function renderList(n,e,t,r){let i;const s=t,o=isArray$1(n);if(o||isString$1(n)){const a=o&&isReactive(n);let l=!1;a&&(l=!isShallow(n),n=shallowReadArray(n)),i=new Array(n.length);for(let c=0,u=n.length;c<u;c++)i[c]=e(l?toReactive(n[c]):n[c],c,void 0,s)}else if(typeof n=="number"){i=new Array(n);for(let a=0;a<n;a++)i[a]=e(a+1,a,void 0,s)}else if(isObject(n))if(n[Symbol.iterator])i=Array.from(n,(a,l)=>e(a,l,void 0,s));else{const a=Object.keys(n);i=new Array(a.length);for(let l=0,c=a.length;l<c;l++){const u=a[l];i[l]=e(n[u],u,l,s)}}else i=[];return i}const getPublicInstance=n=>n?isStatefulComponent(n)?getComponentPublicInstance(n):getPublicInstance(n.parent):null,publicPropertiesMap=extend(Object.create(null),{$:n=>n,$el:n=>n.vnode.el,$data:n=>n.data,$props:n=>n.props,$attrs:n=>n.attrs,$slots:n=>n.slots,$refs:n=>n.refs,$parent:n=>getPublicInstance(n.parent),$root:n=>getPublicInstance(n.root),$host:n=>n.ce,$emit:n=>n.emit,$options:n=>resolveMergedOptions(n),$forceUpdate:n=>n.f||(n.f=()=>{queueJob(n.update)}),$nextTick:n=>n.n||(n.n=nextTick.bind(n.proxy)),$watch:n=>instanceWatch.bind(n)}),hasSetupBinding=(n,e)=>n!==EMPTY_OBJ&&!n.__isScriptSetup&&hasOwn(n,e),PublicInstanceProxyHandlers={get({_:n},e){if(e==="__v_skip")return!0;const{ctx:t,setupState:r,data:i,props:s,accessCache:o,type:a,appContext:l}=n;let c;if(e[0]!=="$"){const m=o[e];if(m!==void 0)switch(m){case 1:return r[e];case 2:return i[e];case 4:return t[e];case 3:return s[e]}else{if(hasSetupBinding(r,e))return o[e]=1,r[e];if(i!==EMPTY_OBJ&&hasOwn(i,e))return o[e]=2,i[e];if((c=n.propsOptions[0])&&hasOwn(c,e))return o[e]=3,s[e];if(t!==EMPTY_OBJ&&hasOwn(t,e))return o[e]=4,t[e];shouldCacheAccess&&(o[e]=0)}}const u=publicPropertiesMap[e];let d,f;if(u)return e==="$attrs"&&track(n.attrs,"get",""),u(n);if((d=a.__cssModules)&&(d=d[e]))return d;if(t!==EMPTY_OBJ&&hasOwn(t,e))return o[e]=4,t[e];if(f=l.config.globalProperties,hasOwn(f,e))return f[e]},set({_:n},e,t){const{data:r,setupState:i,ctx:s}=n;return hasSetupBinding(i,e)?(i[e]=t,!0):r!==EMPTY_OBJ&&hasOwn(r,e)?(r[e]=t,!0):hasOwn(n.props,e)||e[0]==="$"&&e.slice(1)in n?!1:(s[e]=t,!0)},has({_:{data:n,setupState:e,accessCache:t,ctx:r,appContext:i,propsOptions:s}},o){let a;return!!t[o]||n!==EMPTY_OBJ&&hasOwn(n,o)||hasSetupBinding(e,o)||(a=s[0])&&hasOwn(a,o)||hasOwn(r,o)||hasOwn(publicPropertiesMap,o)||hasOwn(i.config.globalProperties,o)},defineProperty(n,e,t){return t.get!=null?n._.accessCache[e]=0:hasOwn(t,"value")&&this.set(n,e,t.value,null),Reflect.defineProperty(n,e,t)}};function normalizePropsOrEmits(n){return isArray$1(n)?n.reduce((e,t)=>(e[t]=null,e),{}):n}let shouldCacheAccess=!0;function applyOptions(n){const e=resolveMergedOptions(n),t=n.proxy,r=n.ctx;shouldCacheAccess=!1,e.beforeCreate&&callHook$1(e.beforeCreate,n,"bc");const{data:i,computed:s,methods:o,watch:a,provide:l,inject:c,created:u,beforeMount:d,mounted:f,beforeUpdate:m,updated:g,activated:v,deactivated:x,beforeDestroy:S,beforeUnmount:C,destroyed:R,unmounted:k,render:I,renderTracked:F,renderTriggered:N,errorCaptured:U,serverPrefetch:M,expose:B,inheritAttrs:H,components:K,directives:Y,filters:oe}=e;if(c&&resolveInjections(c,r,null),o)for(const Ae in o){const ye=o[Ae];isFunction(ye)&&(r[Ae]=ye.bind(t))}if(i){const Ae=i.call(t,t);isObject(Ae)&&(n.data=reactive(Ae))}if(shouldCacheAccess=!0,s)for(const Ae in s){const ye=s[Ae],$=isFunction(ye)?ye.bind(t,t):isFunction(ye.get)?ye.get.bind(t,t):NOOP,W=!isFunction(ye)&&isFunction(ye.set)?ye.set.bind(t):NOOP,J=computed({get:$,set:W});Object.defineProperty(r,Ae,{enumerable:!0,configurable:!0,get:()=>J.value,set:ne=>J.value=ne})}if(a)for(const Ae in a)createWatcher(a[Ae],r,t,Ae);if(l){const Ae=isFunction(l)?l.call(t):l;Reflect.ownKeys(Ae).forEach(ye=>{provide(ye,Ae[ye])})}u&&callHook$1(u,n,"c");function Z(Ae,ye){isArray$1(ye)?ye.forEach($=>Ae($.bind(t))):ye&&Ae(ye.bind(t))}if(Z(onBeforeMount,d),Z(onMounted,f),Z(onBeforeUpdate,m),Z(onUpdated,g),Z(onActivated,v),Z(onDeactivated,x),Z(onErrorCaptured,U),Z(onRenderTracked,F),Z(onRenderTriggered,N),Z(onBeforeUnmount,C),Z(onUnmounted,k),Z(onServerPrefetch,M),isArray$1(B))if(B.length){const Ae=n.exposed||(n.exposed={});B.forEach(ye=>{Object.defineProperty(Ae,ye,{get:()=>t[ye],set:$=>t[ye]=$})})}else n.exposed||(n.exposed={});I&&n.render===NOOP&&(n.render=I),H!=null&&(n.inheritAttrs=H),K&&(n.components=K),Y&&(n.directives=Y),M&&markAsyncBoundary(n)}function resolveInjections(n,e,t=NOOP){isArray$1(n)&&(n=normalizeInject(n));for(const r in n){const i=n[r];let s;isObject(i)?"default"in i?s=inject(i.from||r,i.default,!0):s=inject(i.from||r):s=inject(i),isRef(s)?Object.defineProperty(e,r,{enumerable:!0,configurable:!0,get:()=>s.value,set:o=>s.value=o}):e[r]=s}}function callHook$1(n,e,t){callWithAsyncErrorHandling(isArray$1(n)?n.map(r=>r.bind(e.proxy)):n.bind(e.proxy),e,t)}function createWatcher(n,e,t,r){let i=r.includes(".")?createPathGetter(t,r):()=>t[r];if(isString$1(n)){const s=e[n];isFunction(s)&&watch(i,s)}else if(isFunction(n))watch(i,n.bind(t));else if(isObject(n))if(isArray$1(n))n.forEach(s=>createWatcher(s,e,t,r));else{const s=isFunction(n.handler)?n.handler.bind(t):e[n.handler];isFunction(s)&&watch(i,s,n)}}function resolveMergedOptions(n){const e=n.type,{mixins:t,extends:r}=e,{mixins:i,optionsCache:s,config:{optionMergeStrategies:o}}=n.appContext,a=s.get(e);let l;return a?l=a:!i.length&&!t&&!r?l=e:(l={},i.length&&i.forEach(c=>mergeOptions$1(l,c,o,!0)),mergeOptions$1(l,e,o)),isObject(e)&&s.set(e,l),l}function mergeOptions$1(n,e,t,r=!1){const{mixins:i,extends:s}=e;s&&mergeOptions$1(n,s,t,!0),i&&i.forEach(o=>mergeOptions$1(n,o,t,!0));for(const o in e)if(!(r&&o==="expose")){const a=internalOptionMergeStrats[o]||t&&t[o];n[o]=a?a(n[o],e[o]):e[o]}return n}const internalOptionMergeStrats={data:mergeDataFn,props:mergeEmitsOrPropsOptions,emits:mergeEmitsOrPropsOptions,methods:mergeObjectOptions,computed:mergeObjectOptions,beforeCreate:mergeAsArray,created:mergeAsArray,beforeMount:mergeAsArray,mounted:mergeAsArray,beforeUpdate:mergeAsArray,updated:mergeAsArray,beforeDestroy:mergeAsArray,beforeUnmount:mergeAsArray,destroyed:mergeAsArray,unmounted:mergeAsArray,activated:mergeAsArray,deactivated:mergeAsArray,errorCaptured:mergeAsArray,serverPrefetch:mergeAsArray,components:mergeObjectOptions,directives:mergeObjectOptions,watch:mergeWatchOptions,provide:mergeDataFn,inject:mergeInject};function mergeDataFn(n,e){return e?n?function(){return extend(isFunction(n)?n.call(this,this):n,isFunction(e)?e.call(this,this):e)}:e:n}function mergeInject(n,e){return mergeObjectOptions(normalizeInject(n),normalizeInject(e))}function normalizeInject(n){if(isArray$1(n)){const e={};for(let t=0;t<n.length;t++)e[n[t]]=n[t];return e}return n}function mergeAsArray(n,e){return n?[...new Set([].concat(n,e))]:e}function mergeObjectOptions(n,e){return n?extend(Object.create(null),n,e):e}function mergeEmitsOrPropsOptions(n,e){return n?isArray$1(n)&&isArray$1(e)?[...new Set([...n,...e])]:extend(Object.create(null),normalizePropsOrEmits(n),normalizePropsOrEmits(e??{})):e}function mergeWatchOptions(n,e){if(!n)return e;if(!e)return n;const t=extend(Object.create(null),n);for(const r in e)t[r]=mergeAsArray(n[r],e[r]);return t}function createAppContext(){return{app:null,config:{isNativeTag:NO,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let uid$1=0;function createAppAPI(n,e){return function(r,i=null){isFunction(r)||(r=extend({},r)),i!=null&&!isObject(i)&&(i=null);const s=createAppContext(),o=new WeakSet,a=[];let l=!1;const c=s.app={_uid:uid$1++,_component:r,_props:i,_container:null,_context:s,_instance:null,version,get config(){return s.config},set config(u){},use(u,...d){return o.has(u)||(u&&isFunction(u.install)?(o.add(u),u.install(c,...d)):isFunction(u)&&(o.add(u),u(c,...d))),c},mixin(u){return s.mixins.includes(u)||s.mixins.push(u),c},component(u,d){return d?(s.components[u]=d,c):s.components[u]},directive(u,d){return d?(s.directives[u]=d,c):s.directives[u]},mount(u,d,f){if(!l){const m=c._ceVNode||createVNode(r,i);return m.appContext=s,f===!0?f="svg":f===!1&&(f=void 0),d&&e?e(m,u):n(m,u,f),l=!0,c._container=u,u.__vue_app__=c,getComponentPublicInstance(m.component)}},onUnmount(u){a.push(u)},unmount(){l&&(callWithAsyncErrorHandling(a,c._instance,16),n(null,c._container),delete c._container.__vue_app__)},provide(u,d){return s.provides[u]=d,c},runWithContext(u){const d=currentApp;currentApp=c;try{return u()}finally{currentApp=d}}};return c}}let currentApp=null;function provide(n,e){if(currentInstance){let t=currentInstance.provides;const r=currentInstance.parent&&currentInstance.parent.provides;r===t&&(t=currentInstance.provides=Object.create(r)),t[n]=e}}function inject(n,e,t=!1){const r=currentInstance||currentRenderingInstance;if(r||currentApp){const i=currentApp?currentApp._context.provides:r?r.parent==null?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:void 0;if(i&&n in i)return i[n];if(arguments.length>1)return t&&isFunction(e)?e.call(r&&r.proxy):e}}function hasInjectionContext(){return!!(currentInstance||currentRenderingInstance||currentApp)}const internalObjectProto={},createInternalObject=()=>Object.create(internalObjectProto),isInternalObject=n=>Object.getPrototypeOf(n)===internalObjectProto;function initProps(n,e,t,r=!1){const i={},s=createInternalObject();n.propsDefaults=Object.create(null),setFullProps(n,e,i,s);for(const o in n.propsOptions[0])o in i||(i[o]=void 0);t?n.props=r?i:shallowReactive(i):n.type.props?n.props=i:n.props=s,n.attrs=s}function updateProps(n,e,t,r){const{props:i,attrs:s,vnode:{patchFlag:o}}=n,a=toRaw(i),[l]=n.propsOptions;let c=!1;if((r||o>0)&&!(o&16)){if(o&8){const u=n.vnode.dynamicProps;for(let d=0;d<u.length;d++){let f=u[d];if(isEmitListener(n.emitsOptions,f))continue;const m=e[f];if(l)if(hasOwn(s,f))m!==s[f]&&(s[f]=m,c=!0);else{const g=camelize(f);i[g]=resolvePropValue(l,a,g,m,n,!1)}else m!==s[f]&&(s[f]=m,c=!0)}}}else{setFullProps(n,e,i,s)&&(c=!0);let u;for(const d in a)(!e||!hasOwn(e,d)&&((u=hyphenate(d))===d||!hasOwn(e,u)))&&(l?t&&(t[d]!==void 0||t[u]!==void 0)&&(i[d]=resolvePropValue(l,a,d,void 0,n,!0)):delete i[d]);if(s!==a)for(const d in s)(!e||!hasOwn(e,d))&&(delete s[d],c=!0)}c&&trigger(n.attrs,"set","")}function setFullProps(n,e,t,r){const[i,s]=n.propsOptions;let o=!1,a;if(e)for(let l in e){if(isReservedProp(l))continue;const c=e[l];let u;i&&hasOwn(i,u=camelize(l))?!s||!s.includes(u)?t[u]=c:(a||(a={}))[u]=c:isEmitListener(n.emitsOptions,l)||(!(l in r)||c!==r[l])&&(r[l]=c,o=!0)}if(s){const l=toRaw(t),c=a||EMPTY_OBJ;for(let u=0;u<s.length;u++){const d=s[u];t[d]=resolvePropValue(i,l,d,c[d],n,!hasOwn(c,d))}}return o}function resolvePropValue(n,e,t,r,i,s){const o=n[t];if(o!=null){const a=hasOwn(o,"default");if(a&&r===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&isFunction(l)){const{propsDefaults:c}=i;if(t in c)r=c[t];else{const u=setCurrentInstance(i);r=c[t]=l.call(null,e),u()}}else r=l;i.ce&&i.ce._setProp(t,r)}o[0]&&(s&&!a?r=!1:o[1]&&(r===""||r===hyphenate(t))&&(r=!0))}return r}const mixinPropsCache=new WeakMap;function normalizePropsOptions(n,e,t=!1){const r=t?mixinPropsCache:e.propsCache,i=r.get(n);if(i)return i;const s=n.props,o={},a=[];let l=!1;if(!isFunction(n)){const u=d=>{l=!0;const[f,m]=normalizePropsOptions(d,e,!0);extend(o,f),m&&a.push(...m)};!t&&e.mixins.length&&e.mixins.forEach(u),n.extends&&u(n.extends),n.mixins&&n.mixins.forEach(u)}if(!s&&!l)return isObject(n)&&r.set(n,EMPTY_ARR),EMPTY_ARR;if(isArray$1(s))for(let u=0;u<s.length;u++){const d=camelize(s[u]);validatePropName(d)&&(o[d]=EMPTY_OBJ)}else if(s)for(const u in s){const d=camelize(u);if(validatePropName(d)){const f=s[u],m=o[d]=isArray$1(f)||isFunction(f)?{type:f}:extend({},f),g=m.type;let v=!1,x=!0;if(isArray$1(g))for(let S=0;S<g.length;++S){const C=g[S],R=isFunction(C)&&C.name;if(R==="Boolean"){v=!0;break}else R==="String"&&(x=!1)}else v=isFunction(g)&&g.name==="Boolean";m[0]=v,m[1]=x,(v||hasOwn(m,"default"))&&a.push(d)}}const c=[o,a];return isObject(n)&&r.set(n,c),c}function validatePropName(n){return n[0]!=="$"&&!isReservedProp(n)}const isInternalKey=n=>n[0]==="_"||n==="$stable",normalizeSlotValue=n=>isArray$1(n)?n.map(normalizeVNode):[normalizeVNode(n)],normalizeSlot$1=(n,e,t)=>{if(e._n)return e;const r=withCtx((...i)=>normalizeSlotValue(e(...i)),t);return r._c=!1,r},normalizeObjectSlots=(n,e,t)=>{const r=n._ctx;for(const i in n){if(isInternalKey(i))continue;const s=n[i];if(isFunction(s))e[i]=normalizeSlot$1(i,s,r);else if(s!=null){const o=normalizeSlotValue(s);e[i]=()=>o}}},normalizeVNodeSlots=(n,e)=>{const t=normalizeSlotValue(e);n.slots.default=()=>t},assignSlots=(n,e,t)=>{for(const r in e)(t||r!=="_")&&(n[r]=e[r])},initSlots=(n,e,t)=>{const r=n.slots=createInternalObject();if(n.vnode.shapeFlag&32){const i=e._;i?(assignSlots(r,e,t),t&&def(r,"_",i,!0)):normalizeObjectSlots(e,r)}else e&&normalizeVNodeSlots(n,e)},updateSlots=(n,e,t)=>{const{vnode:r,slots:i}=n;let s=!0,o=EMPTY_OBJ;if(r.shapeFlag&32){const a=e._;a?t&&a===1?s=!1:assignSlots(i,e,t):(s=!e.$stable,normalizeObjectSlots(e,i)),o=e}else e&&(normalizeVNodeSlots(n,e),o={default:1});if(s)for(const a in i)!isInternalKey(a)&&o[a]==null&&delete i[a]},queuePostRenderEffect=queueEffectWithSuspense;function createRenderer(n){return baseCreateRenderer(n)}function baseCreateRenderer(n,e){const t=getGlobalThis();t.__VUE__=!0;const{insert:r,remove:i,patchProp:s,createElement:o,createText:a,createComment:l,setText:c,setElementText:u,parentNode:d,nextSibling:f,setScopeId:m=NOOP,insertStaticContent:g}=n,v=(D,O,G,X=null,Q=null,ee=null,he=void 0,de=null,se=!!O.dynamicChildren)=>{if(D===O)return;D&&!isSameVNodeType(D,O)&&(X=j(D),ne(D,Q,ee,!0),D=null),O.patchFlag===-2&&(se=!1,O.dynamicChildren=null);const{type:te,ref:_e,shapeFlag:me}=O;switch(te){case Text:x(D,O,G,X);break;case Comment:S(D,O,G,X);break;case Static:D==null&&C(O,G,X,he);break;case Fragment$1:K(D,O,G,X,Q,ee,he,de,se);break;default:me&1?I(D,O,G,X,Q,ee,he,de,se):me&6?Y(D,O,G,X,Q,ee,he,de,se):(me&64||me&128)&&te.process(D,O,G,X,Q,ee,he,de,se,Ee)}_e!=null&&Q&&setRef(_e,D&&D.ref,ee,O||D,!O)},x=(D,O,G,X)=>{if(D==null)r(O.el=a(O.children),G,X);else{const Q=O.el=D.el;O.children!==D.children&&c(Q,O.children)}},S=(D,O,G,X)=>{D==null?r(O.el=l(O.children||""),G,X):O.el=D.el},C=(D,O,G,X)=>{[D.el,D.anchor]=g(D.children,O,G,X,D.el,D.anchor)},R=({el:D,anchor:O},G,X)=>{let Q;for(;D&&D!==O;)Q=f(D),r(D,G,X),D=Q;r(O,G,X)},k=({el:D,anchor:O})=>{let G;for(;D&&D!==O;)G=f(D),i(D),D=G;i(O)},I=(D,O,G,X,Q,ee,he,de,se)=>{O.type==="svg"?he="svg":O.type==="math"&&(he="mathml"),D==null?F(O,G,X,Q,ee,he,de,se):M(D,O,Q,ee,he,de,se)},F=(D,O,G,X,Q,ee,he,de)=>{let se,te;const{props:_e,shapeFlag:me,transition:xe,dirs:Se}=D;if(se=D.el=o(D.type,ee,_e&&_e.is,_e),me&8?u(se,D.children):me&16&&U(D.children,se,null,X,Q,resolveChildrenNamespace(D,ee),he,de),Se&&invokeDirectiveHook(D,null,X,"created"),N(se,D,D.scopeId,he,X),_e){for(const Oe in _e)Oe!=="value"&&!isReservedProp(Oe)&&s(se,Oe,null,_e[Oe],ee,X);"value"in _e&&s(se,"value",null,_e.value,ee),(te=_e.onVnodeBeforeMount)&&invokeVNodeHook(te,X,D)}Se&&invokeDirectiveHook(D,null,X,"beforeMount");const ke=needTransition(Q,xe);ke&&xe.beforeEnter(se),r(se,O,G),((te=_e&&_e.onVnodeMounted)||ke||Se)&&queuePostRenderEffect(()=>{te&&invokeVNodeHook(te,X,D),ke&&xe.enter(se),Se&&invokeDirectiveHook(D,null,X,"mounted")},Q)},N=(D,O,G,X,Q)=>{if(G&&m(D,G),X)for(let ee=0;ee<X.length;ee++)m(D,X[ee]);if(Q){let ee=Q.subTree;if(O===ee||isSuspense(ee.type)&&(ee.ssContent===O||ee.ssFallback===O)){const he=Q.vnode;N(D,he,he.scopeId,he.slotScopeIds,Q.parent)}}},U=(D,O,G,X,Q,ee,he,de,se=0)=>{for(let te=se;te<D.length;te++){const _e=D[te]=de?cloneIfMounted(D[te]):normalizeVNode(D[te]);v(null,_e,O,G,X,Q,ee,he,de)}},M=(D,O,G,X,Q,ee,he)=>{const de=O.el=D.el;let{patchFlag:se,dynamicChildren:te,dirs:_e}=O;se|=D.patchFlag&16;const me=D.props||EMPTY_OBJ,xe=O.props||EMPTY_OBJ;let Se;if(G&&toggleRecurse(G,!1),(Se=xe.onVnodeBeforeUpdate)&&invokeVNodeHook(Se,G,O,D),_e&&invokeDirectiveHook(O,D,G,"beforeUpdate"),G&&toggleRecurse(G,!0),(me.innerHTML&&xe.innerHTML==null||me.textContent&&xe.textContent==null)&&u(de,""),te?B(D.dynamicChildren,te,de,G,X,resolveChildrenNamespace(O,Q),ee):he||ye(D,O,de,null,G,X,resolveChildrenNamespace(O,Q),ee,!1),se>0){if(se&16)H(de,me,xe,G,Q);else if(se&2&&me.class!==xe.class&&s(de,"class",null,xe.class,Q),se&4&&s(de,"style",me.style,xe.style,Q),se&8){const ke=O.dynamicProps;for(let Oe=0;Oe<ke.length;Oe++){const Ie=ke[Oe],Ge=me[Ie],Ue=xe[Ie];(Ue!==Ge||Ie==="value")&&s(de,Ie,Ge,Ue,Q,G)}}se&1&&D.children!==O.children&&u(de,O.children)}else!he&&te==null&&H(de,me,xe,G,Q);((Se=xe.onVnodeUpdated)||_e)&&queuePostRenderEffect(()=>{Se&&invokeVNodeHook(Se,G,O,D),_e&&invokeDirectiveHook(O,D,G,"updated")},X)},B=(D,O,G,X,Q,ee,he)=>{for(let de=0;de<O.length;de++){const se=D[de],te=O[de],_e=se.el&&(se.type===Fragment$1||!isSameVNodeType(se,te)||se.shapeFlag&70)?d(se.el):G;v(se,te,_e,null,X,Q,ee,he,!0)}},H=(D,O,G,X,Q)=>{if(O!==G){if(O!==EMPTY_OBJ)for(const ee in O)!isReservedProp(ee)&&!(ee in G)&&s(D,ee,O[ee],null,Q,X);for(const ee in G){if(isReservedProp(ee))continue;const he=G[ee],de=O[ee];he!==de&&ee!=="value"&&s(D,ee,de,he,Q,X)}"value"in G&&s(D,"value",O.value,G.value,Q)}},K=(D,O,G,X,Q,ee,he,de,se)=>{const te=O.el=D?D.el:a(""),_e=O.anchor=D?D.anchor:a("");let{patchFlag:me,dynamicChildren:xe,slotScopeIds:Se}=O;Se&&(de=de?de.concat(Se):Se),D==null?(r(te,G,X),r(_e,G,X),U(O.children||[],G,_e,Q,ee,he,de,se)):me>0&&me&64&&xe&&D.dynamicChildren?(B(D.dynamicChildren,xe,G,Q,ee,he,de),(O.key!=null||Q&&O===Q.subTree)&&traverseStaticChildren(D,O,!0)):ye(D,O,G,_e,Q,ee,he,de,se)},Y=(D,O,G,X,Q,ee,he,de,se)=>{O.slotScopeIds=de,D==null?O.shapeFlag&512?Q.ctx.activate(O,G,X,he,se):oe(O,G,X,Q,ee,he,se):ue(D,O,se)},oe=(D,O,G,X,Q,ee,he)=>{const de=D.component=createComponentInstance(D,X,Q);if(isKeepAlive(D)&&(de.ctx.renderer=Ee),setupComponent(de,!1,he),de.asyncDep){if(Q&&Q.registerDep(de,Z,he),!D.el){const se=de.subTree=createVNode(Comment);S(null,se,O,G)}}else Z(de,D,O,G,Q,ee,he)},ue=(D,O,G)=>{const X=O.component=D.component;if(shouldUpdateComponent(D,O,G))if(X.asyncDep&&!X.asyncResolved){Ae(X,O,G);return}else X.next=O,X.update();else O.el=D.el,X.vnode=O},Z=(D,O,G,X,Q,ee,he)=>{const de=()=>{if(D.isMounted){let{next:me,bu:xe,u:Se,parent:ke,vnode:Oe}=D;{const Me=locateNonHydratedAsyncRoot(D);if(Me){me&&(me.el=Oe.el,Ae(D,me,he)),Me.asyncDep.then(()=>{D.isUnmounted||de()});return}}let Ie=me,Ge;toggleRecurse(D,!1),me?(me.el=Oe.el,Ae(D,me,he)):me=Oe,xe&&invokeArrayFns(xe),(Ge=me.props&&me.props.onVnodeBeforeUpdate)&&invokeVNodeHook(Ge,ke,me,Oe),toggleRecurse(D,!0);const Ue=renderComponentRoot(D),q=D.subTree;D.subTree=Ue,v(q,Ue,d(q.el),j(q),D,Q,ee),me.el=Ue.el,Ie===null&&updateHOCHostEl(D,Ue.el),Se&&queuePostRenderEffect(Se,Q),(Ge=me.props&&me.props.onVnodeUpdated)&&queuePostRenderEffect(()=>invokeVNodeHook(Ge,ke,me,Oe),Q)}else{let me;const{el:xe,props:Se}=O,{bm:ke,m:Oe,parent:Ie,root:Ge,type:Ue}=D,q=isAsyncWrapper(O);if(toggleRecurse(D,!1),ke&&invokeArrayFns(ke),!q&&(me=Se&&Se.onVnodeBeforeMount)&&invokeVNodeHook(me,Ie,O),toggleRecurse(D,!0),xe&&De){const Me=()=>{D.subTree=renderComponentRoot(D),De(xe,D.subTree,D,Q,null)};q&&Ue.__asyncHydrate?Ue.__asyncHydrate(xe,D,Me):Me()}else{Ge.ce&&Ge.ce._injectChildStyle(Ue);const Me=D.subTree=renderComponentRoot(D);v(null,Me,G,X,D,Q,ee),O.el=Me.el}if(Oe&&queuePostRenderEffect(Oe,Q),!q&&(me=Se&&Se.onVnodeMounted)){const Me=O;queuePostRenderEffect(()=>invokeVNodeHook(me,Ie,Me),Q)}(O.shapeFlag&256||Ie&&isAsyncWrapper(Ie.vnode)&&Ie.vnode.shapeFlag&256)&&D.a&&queuePostRenderEffect(D.a,Q),D.isMounted=!0,O=G=X=null}};D.scope.on();const se=D.effect=new ReactiveEffect(de);D.scope.off();const te=D.update=se.run.bind(se),_e=D.job=se.runIfDirty.bind(se);_e.i=D,_e.id=D.uid,se.scheduler=()=>queueJob(_e),toggleRecurse(D,!0),te()},Ae=(D,O,G)=>{O.component=D;const X=D.vnode.props;D.vnode=O,D.next=null,updateProps(D,O.props,X,G),updateSlots(D,O.children,G),pauseTracking(),flushPreFlushCbs(D),resetTracking()},ye=(D,O,G,X,Q,ee,he,de,se=!1)=>{const te=D&&D.children,_e=D?D.shapeFlag:0,me=O.children,{patchFlag:xe,shapeFlag:Se}=O;if(xe>0){if(xe&128){W(te,me,G,X,Q,ee,he,de,se);return}else if(xe&256){$(te,me,G,X,Q,ee,he,de,se);return}}Se&8?(_e&16&&Ce(te,Q,ee),me!==te&&u(G,me)):_e&16?Se&16?W(te,me,G,X,Q,ee,he,de,se):Ce(te,Q,ee,!0):(_e&8&&u(G,""),Se&16&&U(me,G,X,Q,ee,he,de,se))},$=(D,O,G,X,Q,ee,he,de,se)=>{D=D||EMPTY_ARR,O=O||EMPTY_ARR;const te=D.length,_e=O.length,me=Math.min(te,_e);let xe;for(xe=0;xe<me;xe++){const Se=O[xe]=se?cloneIfMounted(O[xe]):normalizeVNode(O[xe]);v(D[xe],Se,G,null,Q,ee,he,de,se)}te>_e?Ce(D,Q,ee,!0,!1,me):U(O,G,X,Q,ee,he,de,se,me)},W=(D,O,G,X,Q,ee,he,de,se)=>{let te=0;const _e=O.length;let me=D.length-1,xe=_e-1;for(;te<=me&&te<=xe;){const Se=D[te],ke=O[te]=se?cloneIfMounted(O[te]):normalizeVNode(O[te]);if(isSameVNodeType(Se,ke))v(Se,ke,G,null,Q,ee,he,de,se);else break;te++}for(;te<=me&&te<=xe;){const Se=D[me],ke=O[xe]=se?cloneIfMounted(O[xe]):normalizeVNode(O[xe]);if(isSameVNodeType(Se,ke))v(Se,ke,G,null,Q,ee,he,de,se);else break;me--,xe--}if(te>me){if(te<=xe){const Se=xe+1,ke=Se<_e?O[Se].el:X;for(;te<=xe;)v(null,O[te]=se?cloneIfMounted(O[te]):normalizeVNode(O[te]),G,ke,Q,ee,he,de,se),te++}}else if(te>xe)for(;te<=me;)ne(D[te],Q,ee,!0),te++;else{const Se=te,ke=te,Oe=new Map;for(te=ke;te<=xe;te++){const we=O[te]=se?cloneIfMounted(O[te]):normalizeVNode(O[te]);we.key!=null&&Oe.set(we.key,te)}let Ie,Ge=0;const Ue=xe-ke+1;let q=!1,Me=0;const Xe=new Array(Ue);for(te=0;te<Ue;te++)Xe[te]=0;for(te=Se;te<=me;te++){const we=D[te];if(Ge>=Ue){ne(we,Q,ee,!0);continue}let je;if(we.key!=null)je=Oe.get(we.key);else for(Ie=ke;Ie<=xe;Ie++)if(Xe[Ie-ke]===0&&isSameVNodeType(we,O[Ie])){je=Ie;break}je===void 0?ne(we,Q,ee,!0):(Xe[je-ke]=te+1,je>=Me?Me=je:q=!0,v(we,O[je],G,null,Q,ee,he,de,se),Ge++)}const ut=q?getSequence(Xe):EMPTY_ARR;for(Ie=ut.length-1,te=Ue-1;te>=0;te--){const we=ke+te,je=O[we],rt=we+1<_e?O[we+1].el:X;Xe[te]===0?v(null,je,G,rt,Q,ee,he,de,se):q&&(Ie<0||te!==ut[Ie]?J(je,G,rt,2):Ie--)}}},J=(D,O,G,X,Q=null)=>{const{el:ee,type:he,transition:de,children:se,shapeFlag:te}=D;if(te&6){J(D.component.subTree,O,G,X);return}if(te&128){D.suspense.move(O,G,X);return}if(te&64){he.move(D,O,G,Ee);return}if(he===Fragment$1){r(ee,O,G);for(let me=0;me<se.length;me++)J(se[me],O,G,X);r(D.anchor,O,G);return}if(he===Static){R(D,O,G);return}if(X!==2&&te&1&&de)if(X===0)de.beforeEnter(ee),r(ee,O,G),queuePostRenderEffect(()=>de.enter(ee),Q);else{const{leave:me,delayLeave:xe,afterLeave:Se}=de,ke=()=>r(ee,O,G),Oe=()=>{me(ee,()=>{ke(),Se&&Se()})};xe?xe(ee,ke,Oe):Oe()}else r(ee,O,G)},ne=(D,O,G,X=!1,Q=!1)=>{const{type:ee,props:he,ref:de,children:se,dynamicChildren:te,shapeFlag:_e,patchFlag:me,dirs:xe,cacheIndex:Se}=D;if(me===-2&&(Q=!1),de!=null&&setRef(de,null,G,D,!0),Se!=null&&(O.renderCache[Se]=void 0),_e&256){O.ctx.deactivate(D);return}const ke=_e&1&&xe,Oe=!isAsyncWrapper(D);let Ie;if(Oe&&(Ie=he&&he.onVnodeBeforeUnmount)&&invokeVNodeHook(Ie,O,D),_e&6)Le(D.component,G,X);else{if(_e&128){D.suspense.unmount(G,X);return}ke&&invokeDirectiveHook(D,null,O,"beforeUnmount"),_e&64?D.type.remove(D,O,G,Ee,X):te&&!te.hasOnce&&(ee!==Fragment$1||me>0&&me&64)?Ce(te,O,G,!1,!0):(ee===Fragment$1&&me&384||!Q&&_e&16)&&Ce(se,O,G),X&&ve(D)}(Oe&&(Ie=he&&he.onVnodeUnmounted)||ke)&&queuePostRenderEffect(()=>{Ie&&invokeVNodeHook(Ie,O,D),ke&&invokeDirectiveHook(D,null,O,"unmounted")},G)},ve=D=>{const{type:O,el:G,anchor:X,transition:Q}=D;if(O===Fragment$1){Re(G,X);return}if(O===Static){k(D);return}const ee=()=>{i(G),Q&&!Q.persisted&&Q.afterLeave&&Q.afterLeave()};if(D.shapeFlag&1&&Q&&!Q.persisted){const{leave:he,delayLeave:de}=Q,se=()=>he(G,ee);de?de(D.el,ee,se):se()}else ee()},Re=(D,O)=>{let G;for(;D!==O;)G=f(D),i(D),D=G;i(O)},Le=(D,O,G)=>{const{bum:X,scope:Q,job:ee,subTree:he,um:de,m:se,a:te}=D;invalidateMount(se),invalidateMount(te),X&&invokeArrayFns(X),Q.stop(),ee&&(ee.flags|=8,ne(he,D,O,G)),de&&queuePostRenderEffect(de,O),queuePostRenderEffect(()=>{D.isUnmounted=!0},O),O&&O.pendingBranch&&!O.isUnmounted&&D.asyncDep&&!D.asyncResolved&&D.suspenseId===O.pendingId&&(O.deps--,O.deps===0&&O.resolve())},Ce=(D,O,G,X=!1,Q=!1,ee=0)=>{for(let he=ee;he<D.length;he++)ne(D[he],O,G,X,Q)},j=D=>{if(D.shapeFlag&6)return j(D.component.subTree);if(D.shapeFlag&128)return D.suspense.next();const O=f(D.anchor||D.el),G=O&&O[TeleportEndKey];return G?f(G):O};let ae=!1;const ie=(D,O,G)=>{D==null?O._vnode&&ne(O._vnode,null,null,!0):v(O._vnode||null,D,O,null,null,null,G),O._vnode=D,ae||(ae=!0,flushPreFlushCbs(),flushPostFlushCbs(),ae=!1)},Ee={p:v,um:ne,m:J,r:ve,mt:oe,mc:U,pc:ye,pbc:B,n:j,o:n};let Pe,De;return{render:ie,hydrate:Pe,createApp:createAppAPI(ie,Pe)}}function resolveChildrenNamespace({type:n,props:e},t){return t==="svg"&&n==="foreignObject"||t==="mathml"&&n==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:t}function toggleRecurse({effect:n,job:e},t){t?(n.flags|=32,e.flags|=4):(n.flags&=-33,e.flags&=-5)}function needTransition(n,e){return(!n||n&&!n.pendingBranch)&&e&&!e.persisted}function traverseStaticChildren(n,e,t=!1){const r=n.children,i=e.children;if(isArray$1(r)&&isArray$1(i))for(let s=0;s<r.length;s++){const o=r[s];let a=i[s];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=i[s]=cloneIfMounted(i[s]),a.el=o.el),!t&&a.patchFlag!==-2&&traverseStaticChildren(o,a)),a.type===Text&&(a.el=o.el)}}function getSequence(n){const e=n.slice(),t=[0];let r,i,s,o,a;const l=n.length;for(r=0;r<l;r++){const c=n[r];if(c!==0){if(i=t[t.length-1],n[i]<c){e[r]=i,t.push(r);continue}for(s=0,o=t.length-1;s<o;)a=s+o>>1,n[t[a]]<c?s=a+1:o=a;c<n[t[s]]&&(s>0&&(e[r]=t[s-1]),t[s]=r)}}for(s=t.length,o=t[s-1];s-- >0;)t[s]=o,o=e[o];return t}function locateNonHydratedAsyncRoot(n){const e=n.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:locateNonHydratedAsyncRoot(e)}function invalidateMount(n){if(n)for(let e=0;e<n.length;e++)n[e].flags|=8}const ssrContextKey=Symbol.for("v-scx"),useSSRContext=()=>inject(ssrContextKey);function watch(n,e,t){return doWatch(n,e,t)}function doWatch(n,e,t=EMPTY_OBJ){const{immediate:r,deep:i,flush:s,once:o}=t,a=extend({},t),l=e&&r||!e&&s!=="post";let c;if(isInSSRComponentSetup){if(s==="sync"){const m=useSSRContext();c=m.__watcherHandles||(m.__watcherHandles=[])}else if(!l){const m=()=>{};return m.stop=NOOP,m.resume=NOOP,m.pause=NOOP,m}}const u=currentInstance;a.call=(m,g,v)=>callWithAsyncErrorHandling(m,u,g,v);let d=!1;s==="post"?a.scheduler=m=>{queuePostRenderEffect(m,u&&u.suspense)}:s!=="sync"&&(d=!0,a.scheduler=(m,g)=>{g?m():queueJob(m)}),a.augmentJob=m=>{e&&(m.flags|=4),d&&(m.flags|=2,u&&(m.id=u.uid,m.i=u))};const f=watch$1(n,e,a);return isInSSRComponentSetup&&(c?c.push(f):l&&f()),f}function instanceWatch(n,e,t){const r=this.proxy,i=isString$1(n)?n.includes(".")?createPathGetter(r,n):()=>r[n]:n.bind(r,r);let s;isFunction(e)?s=e:(s=e.handler,t=e);const o=setCurrentInstance(this),a=doWatch(i,s.bind(r),t);return o(),a}function createPathGetter(n,e){const t=e.split(".");return()=>{let r=n;for(let i=0;i<t.length&&r;i++)r=r[t[i]];return r}}const getModelModifiers=(n,e)=>e==="modelValue"||e==="model-value"?n.modelModifiers:n[`${e}Modifiers`]||n[`${camelize(e)}Modifiers`]||n[`${hyphenate(e)}Modifiers`];function emit(n,e,...t){if(n.isUnmounted)return;const r=n.vnode.props||EMPTY_OBJ;let i=t;const s=e.startsWith("update:"),o=s&&getModelModifiers(r,e.slice(7));o&&(o.trim&&(i=t.map(u=>isString$1(u)?u.trim():u)),o.number&&(i=t.map(looseToNumber)));let a,l=r[a=toHandlerKey(e)]||r[a=toHandlerKey(camelize(e))];!l&&s&&(l=r[a=toHandlerKey(hyphenate(e))]),l&&callWithAsyncErrorHandling(l,n,6,i);const c=r[a+"Once"];if(c){if(!n.emitted)n.emitted={};else if(n.emitted[a])return;n.emitted[a]=!0,callWithAsyncErrorHandling(c,n,6,i)}}function normalizeEmitsOptions(n,e,t=!1){const r=e.emitsCache,i=r.get(n);if(i!==void 0)return i;const s=n.emits;let o={},a=!1;if(!isFunction(n)){const l=c=>{const u=normalizeEmitsOptions(c,e,!0);u&&(a=!0,extend(o,u))};!t&&e.mixins.length&&e.mixins.forEach(l),n.extends&&l(n.extends),n.mixins&&n.mixins.forEach(l)}return!s&&!a?(isObject(n)&&r.set(n,null),null):(isArray$1(s)?s.forEach(l=>o[l]=null):extend(o,s),isObject(n)&&r.set(n,o),o)}function isEmitListener(n,e){return!n||!isOn(e)?!1:(e=e.slice(2).replace(/Once$/,""),hasOwn(n,e[0].toLowerCase()+e.slice(1))||hasOwn(n,hyphenate(e))||hasOwn(n,e))}function markAttrsAccessed(){}function renderComponentRoot(n){const{type:e,vnode:t,proxy:r,withProxy:i,propsOptions:[s],slots:o,attrs:a,emit:l,render:c,renderCache:u,props:d,data:f,setupState:m,ctx:g,inheritAttrs:v}=n,x=setCurrentRenderingInstance(n);let S,C;try{if(t.shapeFlag&4){const k=i||r,I=k;S=normalizeVNode(c.call(I,k,u,d,m,f,g)),C=a}else{const k=e;S=normalizeVNode(k.length>1?k(d,{attrs:a,slots:o,emit:l}):k(d,null)),C=e.props?a:getFunctionalFallthrough(a)}}catch(k){blockStack.length=0,handleError(k,n,1),S=createVNode(Comment)}let R=S;if(C&&v!==!1){const k=Object.keys(C),{shapeFlag:I}=R;k.length&&I&7&&(s&&k.some(isModelListener)&&(C=filterModelListeners(C,s)),R=cloneVNode(R,C,!1,!0))}return t.dirs&&(R=cloneVNode(R,null,!1,!0),R.dirs=R.dirs?R.dirs.concat(t.dirs):t.dirs),t.transition&&setTransitionHooks(R,t.transition),S=R,setCurrentRenderingInstance(x),S}const getFunctionalFallthrough=n=>{let e;for(const t in n)(t==="class"||t==="style"||isOn(t))&&((e||(e={}))[t]=n[t]);return e},filterModelListeners=(n,e)=>{const t={};for(const r in n)(!isModelListener(r)||!(r.slice(9)in e))&&(t[r]=n[r]);return t};function shouldUpdateComponent(n,e,t){const{props:r,children:i,component:s}=n,{props:o,children:a,patchFlag:l}=e,c=s.emitsOptions;if(e.dirs||e.transition)return!0;if(t&&l>=0){if(l&1024)return!0;if(l&16)return r?hasPropsChanged(r,o,c):!!o;if(l&8){const u=e.dynamicProps;for(let d=0;d<u.length;d++){const f=u[d];if(o[f]!==r[f]&&!isEmitListener(c,f))return!0}}}else return(i||a)&&(!a||!a.$stable)?!0:r===o?!1:r?o?hasPropsChanged(r,o,c):!0:!!o;return!1}function hasPropsChanged(n,e,t){const r=Object.keys(e);if(r.length!==Object.keys(n).length)return!0;for(let i=0;i<r.length;i++){const s=r[i];if(e[s]!==n[s]&&!isEmitListener(t,s))return!0}return!1}function updateHOCHostEl({vnode:n,parent:e},t){for(;e;){const r=e.subTree;if(r.suspense&&r.suspense.activeBranch===n&&(r.el=n.el),r===n)(n=e.vnode).el=t,e=e.parent;else break}}const isSuspense=n=>n.__isSuspense;function queueEffectWithSuspense(n,e){e&&e.pendingBranch?isArray$1(n)?e.effects.push(...n):e.effects.push(n):queuePostFlushCb(n)}const Fragment$1=Symbol.for("v-fgt"),Text=Symbol.for("v-txt"),Comment=Symbol.for("v-cmt"),Static=Symbol.for("v-stc"),blockStack=[];let currentBlock=null;function openBlock(n=!1){blockStack.push(currentBlock=n?null:[])}function closeBlock(){blockStack.pop(),currentBlock=blockStack[blockStack.length-1]||null}let isBlockTreeEnabled=1;function setBlockTracking(n,e=!1){isBlockTreeEnabled+=n,n<0&&currentBlock&&e&&(currentBlock.hasOnce=!0)}function setupBlock(n){return n.dynamicChildren=isBlockTreeEnabled>0?currentBlock||EMPTY_ARR:null,closeBlock(),isBlockTreeEnabled>0&&currentBlock&&currentBlock.push(n),n}function createElementBlock(n,e,t,r,i,s){return setupBlock(createBaseVNode(n,e,t,r,i,s,!0))}function createBlock(n,e,t,r,i){return setupBlock(createVNode(n,e,t,r,i,!0))}function isVNode(n){return n?n.__v_isVNode===!0:!1}function isSameVNodeType(n,e){return n.type===e.type&&n.key===e.key}const normalizeKey=({key:n})=>n??null,normalizeRef=({ref:n,ref_key:e,ref_for:t})=>(typeof n=="number"&&(n=""+n),n!=null?isString$1(n)||isRef(n)||isFunction(n)?{i:currentRenderingInstance,r:n,k:e,f:!!t}:n:null);function createBaseVNode(n,e=null,t=null,r=0,i=null,s=n===Fragment$1?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:n,props:e,key:e&&normalizeKey(e),ref:e&&normalizeRef(e),scopeId:currentScopeId,slotScopeIds:null,children:t,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:r,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:currentRenderingInstance};return a?(normalizeChildren(l,t),s&128&&n.normalize(l)):t&&(l.shapeFlag|=isString$1(t)?8:16),isBlockTreeEnabled>0&&!o&&currentBlock&&(l.patchFlag>0||s&6)&&l.patchFlag!==32&&currentBlock.push(l),l}const createVNode=_createVNode;function _createVNode(n,e=null,t=null,r=0,i=null,s=!1){if((!n||n===NULL_DYNAMIC_COMPONENT)&&(n=Comment),isVNode(n)){const a=cloneVNode(n,e,!0);return t&&normalizeChildren(a,t),isBlockTreeEnabled>0&&!s&&currentBlock&&(a.shapeFlag&6?currentBlock[currentBlock.indexOf(n)]=a:currentBlock.push(a)),a.patchFlag=-2,a}if(isClassComponent(n)&&(n=n.__vccOpts),e){e=guardReactiveProps(e);let{class:a,style:l}=e;a&&!isString$1(a)&&(e.class=normalizeClass(a)),isObject(l)&&(isProxy(l)&&!isArray$1(l)&&(l=extend({},l)),e.style=normalizeStyle(l))}const o=isString$1(n)?1:isSuspense(n)?128:isTeleport(n)?64:isObject(n)?4:isFunction(n)?2:0;return createBaseVNode(n,e,t,r,i,o,s,!0)}function guardReactiveProps(n){return n?isProxy(n)||isInternalObject(n)?extend({},n):n:null}function cloneVNode(n,e,t=!1,r=!1){const{props:i,ref:s,patchFlag:o,children:a,transition:l}=n,c=e?mergeProps(i||{},e):i,u={__v_isVNode:!0,__v_skip:!0,type:n.type,props:c,key:c&&normalizeKey(c),ref:e&&e.ref?t&&s?isArray$1(s)?s.concat(normalizeRef(e)):[s,normalizeRef(e)]:normalizeRef(e):s,scopeId:n.scopeId,slotScopeIds:n.slotScopeIds,children:a,target:n.target,targetStart:n.targetStart,targetAnchor:n.targetAnchor,staticCount:n.staticCount,shapeFlag:n.shapeFlag,patchFlag:e&&n.type!==Fragment$1?o===-1?16:o|16:o,dynamicProps:n.dynamicProps,dynamicChildren:n.dynamicChildren,appContext:n.appContext,dirs:n.dirs,transition:l,component:n.component,suspense:n.suspense,ssContent:n.ssContent&&cloneVNode(n.ssContent),ssFallback:n.ssFallback&&cloneVNode(n.ssFallback),el:n.el,anchor:n.anchor,ctx:n.ctx,ce:n.ce};return l&&r&&setTransitionHooks(u,l.clone(u)),u}function createTextVNode(n=" ",e=0){return createVNode(Text,null,n,e)}function createStaticVNode(n,e){const t=createVNode(Static,null,n);return t.staticCount=e,t}function createCommentVNode(n="",e=!1){return e?(openBlock(),createBlock(Comment,null,n)):createVNode(Comment,null,n)}function normalizeVNode(n){return n==null||typeof n=="boolean"?createVNode(Comment):isArray$1(n)?createVNode(Fragment$1,null,n.slice()):isVNode(n)?cloneIfMounted(n):createVNode(Text,null,String(n))}function cloneIfMounted(n){return n.el===null&&n.patchFlag!==-1||n.memo?n:cloneVNode(n)}function normalizeChildren(n,e){let t=0;const{shapeFlag:r}=n;if(e==null)e=null;else if(isArray$1(e))t=16;else if(typeof e=="object")if(r&65){const i=e.default;i&&(i._c&&(i._d=!1),normalizeChildren(n,i()),i._c&&(i._d=!0));return}else{t=32;const i=e._;!i&&!isInternalObject(e)?e._ctx=currentRenderingInstance:i===3&&currentRenderingInstance&&(currentRenderingInstance.slots._===1?e._=1:(e._=2,n.patchFlag|=1024))}else isFunction(e)?(e={default:e,_ctx:currentRenderingInstance},t=32):(e=String(e),r&64?(t=16,e=[createTextVNode(e)]):t=8);n.children=e,n.shapeFlag|=t}function mergeProps(...n){const e={};for(let t=0;t<n.length;t++){const r=n[t];for(const i in r)if(i==="class")e.class!==r.class&&(e.class=normalizeClass([e.class,r.class]));else if(i==="style")e.style=normalizeStyle([e.style,r.style]);else if(isOn(i)){const s=e[i],o=r[i];o&&s!==o&&!(isArray$1(s)&&s.includes(o))&&(e[i]=s?[].concat(s,o):o)}else i!==""&&(e[i]=r[i])}return e}function invokeVNodeHook(n,e,t,r=null){callWithAsyncErrorHandling(n,e,7,[t,r])}const emptyAppContext=createAppContext();let uid=0;function createComponentInstance(n,e,t){const r=n.type,i=(e?e.appContext:n.appContext)||emptyAppContext,s={uid:uid++,vnode:n,type:r,parent:e,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new EffectScope(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(i.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:normalizePropsOptions(r,i),emitsOptions:normalizeEmitsOptions(r,i),emit:null,emitted:null,propsDefaults:EMPTY_OBJ,inheritAttrs:r.inheritAttrs,ctx:EMPTY_OBJ,data:EMPTY_OBJ,props:EMPTY_OBJ,attrs:EMPTY_OBJ,slots:EMPTY_OBJ,refs:EMPTY_OBJ,setupState:EMPTY_OBJ,setupContext:null,suspense:t,suspenseId:t?t.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=e?e.root:s,s.emit=emit.bind(null,s),n.ce&&n.ce(s),s}let currentInstance=null;const getCurrentInstance=()=>currentInstance||currentRenderingInstance;let internalSetCurrentInstance,setInSSRSetupState;{const n=getGlobalThis(),e=(t,r)=>{let i;return(i=n[t])||(i=n[t]=[]),i.push(r),s=>{i.length>1?i.forEach(o=>o(s)):i[0](s)}};internalSetCurrentInstance=e("__VUE_INSTANCE_SETTERS__",t=>currentInstance=t),setInSSRSetupState=e("__VUE_SSR_SETTERS__",t=>isInSSRComponentSetup=t)}const setCurrentInstance=n=>{const e=currentInstance;return internalSetCurrentInstance(n),n.scope.on(),()=>{n.scope.off(),internalSetCurrentInstance(e)}},unsetCurrentInstance=()=>{currentInstance&&currentInstance.scope.off(),internalSetCurrentInstance(null)};function isStatefulComponent(n){return n.vnode.shapeFlag&4}let isInSSRComponentSetup=!1;function setupComponent(n,e=!1,t=!1){e&&setInSSRSetupState(e);const{props:r,children:i}=n.vnode,s=isStatefulComponent(n);initProps(n,r,s,e),initSlots(n,i,t);const o=s?setupStatefulComponent(n,e):void 0;return e&&setInSSRSetupState(!1),o}function setupStatefulComponent(n,e){const t=n.type;n.accessCache=Object.create(null),n.proxy=new Proxy(n.ctx,PublicInstanceProxyHandlers);const{setup:r}=t;if(r){pauseTracking();const i=n.setupContext=r.length>1?createSetupContext(n):null,s=setCurrentInstance(n),o=callWithErrorHandling(r,n,0,[n.props,i]),a=isPromise$1(o);if(resetTracking(),s(),(a||n.sp)&&!isAsyncWrapper(n)&&markAsyncBoundary(n),a){if(o.then(unsetCurrentInstance,unsetCurrentInstance),e)return o.then(l=>{handleSetupResult(n,l,e)}).catch(l=>{handleError(l,n,0)});n.asyncDep=o}else handleSetupResult(n,o,e)}else finishComponentSetup(n,e)}function handleSetupResult(n,e,t){isFunction(e)?n.type.__ssrInlineRender?n.ssrRender=e:n.render=e:isObject(e)&&(n.setupState=proxyRefs(e)),finishComponentSetup(n,t)}let compile;function finishComponentSetup(n,e,t){const r=n.type;if(!n.render){if(!e&&compile&&!r.render){const i=r.template||resolveMergedOptions(n).template;if(i){const{isCustomElement:s,compilerOptions:o}=n.appContext.config,{delimiters:a,compilerOptions:l}=r,c=extend(extend({isCustomElement:s,delimiters:a},o),l);r.render=compile(i,c)}}n.render=r.render||NOOP}{const i=setCurrentInstance(n);pauseTracking();try{applyOptions(n)}finally{resetTracking(),i()}}}const attrsProxyHandlers={get(n,e){return track(n,"get",""),n[e]}};function createSetupContext(n){const e=t=>{n.exposed=t||{}};return{attrs:new Proxy(n.attrs,attrsProxyHandlers),slots:n.slots,emit:n.emit,expose:e}}function getComponentPublicInstance(n){return n.exposed?n.exposeProxy||(n.exposeProxy=new Proxy(proxyRefs(markRaw(n.exposed)),{get(e,t){if(t in e)return e[t];if(t in publicPropertiesMap)return publicPropertiesMap[t](n)},has(e,t){return t in e||t in publicPropertiesMap}})):n.proxy}const classifyRE=/(?:^|[-_])(\w)/g,classify=n=>n.replace(classifyRE,e=>e.toUpperCase()).replace(/[-_]/g,"");function getComponentName(n,e=!0){return isFunction(n)?n.displayName||n.name:n.name||e&&n.__name}function formatComponentName(n,e,t=!1){let r=getComponentName(e);if(!r&&e.__file){const i=e.__file.match(/([^/\\]+)\.\w+$/);i&&(r=i[1])}if(!r&&n&&n.parent){const i=s=>{for(const o in s)if(s[o]===e)return o};r=i(n.components||n.parent.type.components)||i(n.appContext.components)}return r?classify(r):t?"App":"Anonymous"}function isClassComponent(n){return isFunction(n)&&"__vccOpts"in n}const computed=(n,e)=>computed$1(n,e,isInSSRComponentSetup);function h(n,e,t){const r=arguments.length;return r===2?isObject(e)&&!isArray$1(e)?isVNode(e)?createVNode(n,null,[e]):createVNode(n,e):createVNode(n,null,e):(r>3?t=Array.prototype.slice.call(arguments,2):r===3&&isVNode(t)&&(t=[t]),createVNode(n,e,t))}const version="3.5.13";/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let policy;const tt=typeof window<"u"&&window.trustedTypes;if(tt)try{policy=tt.createPolicy("vue",{createHTML:n=>n})}catch{}const unsafeToTrustedHTML=policy?n=>policy.createHTML(n):n=>n,svgNS="http://www.w3.org/2000/svg",mathmlNS="http://www.w3.org/1998/Math/MathML",doc=typeof document<"u"?document:null,templateContainer=doc&&doc.createElement("template"),nodeOps={insert:(n,e,t)=>{e.insertBefore(n,t||null)},remove:n=>{const e=n.parentNode;e&&e.removeChild(n)},createElement:(n,e,t,r)=>{const i=e==="svg"?doc.createElementNS(svgNS,n):e==="mathml"?doc.createElementNS(mathmlNS,n):t?doc.createElement(n,{is:t}):doc.createElement(n);return n==="select"&&r&&r.multiple!=null&&i.setAttribute("multiple",r.multiple),i},createText:n=>doc.createTextNode(n),createComment:n=>doc.createComment(n),setText:(n,e)=>{n.nodeValue=e},setElementText:(n,e)=>{n.textContent=e},parentNode:n=>n.parentNode,nextSibling:n=>n.nextSibling,querySelector:n=>doc.querySelector(n),setScopeId(n,e){n.setAttribute(e,"")},insertStaticContent(n,e,t,r,i,s){const o=t?t.previousSibling:e.lastChild;if(i&&(i===s||i.nextSibling))for(;e.insertBefore(i.cloneNode(!0),t),!(i===s||!(i=i.nextSibling)););else{templateContainer.innerHTML=unsafeToTrustedHTML(r==="svg"?`<svg>${n}</svg>`:r==="mathml"?`<math>${n}</math>`:n);const a=templateContainer.content;if(r==="svg"||r==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,t)}return[o?o.nextSibling:e.firstChild,t?t.previousSibling:e.lastChild]}},TRANSITION="transition",ANIMATION="animation",vtcKey=Symbol("_vtc"),DOMTransitionPropsValidators={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},TransitionPropsValidators=extend({},BaseTransitionPropsValidators,DOMTransitionPropsValidators),decorate$1=n=>(n.displayName="Transition",n.props=TransitionPropsValidators,n),Transition=decorate$1((n,{slots:e})=>h(BaseTransition,resolveTransitionProps(n),e)),callHook=(n,e=[])=>{isArray$1(n)?n.forEach(t=>t(...e)):n&&n(...e)},hasExplicitCallback=n=>n?isArray$1(n)?n.some(e=>e.length>1):n.length>1:!1;function resolveTransitionProps(n){const e={};for(const K in n)K in DOMTransitionPropsValidators||(e[K]=n[K]);if(n.css===!1)return e;const{name:t="v",type:r,duration:i,enterFromClass:s=`${t}-enter-from`,enterActiveClass:o=`${t}-enter-active`,enterToClass:a=`${t}-enter-to`,appearFromClass:l=s,appearActiveClass:c=o,appearToClass:u=a,leaveFromClass:d=`${t}-leave-from`,leaveActiveClass:f=`${t}-leave-active`,leaveToClass:m=`${t}-leave-to`}=n,g=normalizeDuration(i),v=g&&g[0],x=g&&g[1],{onBeforeEnter:S,onEnter:C,onEnterCancelled:R,onLeave:k,onLeaveCancelled:I,onBeforeAppear:F=S,onAppear:N=C,onAppearCancelled:U=R}=e,M=(K,Y,oe,ue)=>{K._enterCancelled=ue,removeTransitionClass(K,Y?u:a),removeTransitionClass(K,Y?c:o),oe&&oe()},B=(K,Y)=>{K._isLeaving=!1,removeTransitionClass(K,d),removeTransitionClass(K,m),removeTransitionClass(K,f),Y&&Y()},H=K=>(Y,oe)=>{const ue=K?N:C,Z=()=>M(Y,K,oe);callHook(ue,[Y,Z]),nextFrame(()=>{removeTransitionClass(Y,K?l:s),addTransitionClass(Y,K?u:a),hasExplicitCallback(ue)||whenTransitionEnds(Y,r,v,Z)})};return extend(e,{onBeforeEnter(K){callHook(S,[K]),addTransitionClass(K,s),addTransitionClass(K,o)},onBeforeAppear(K){callHook(F,[K]),addTransitionClass(K,l),addTransitionClass(K,c)},onEnter:H(!1),onAppear:H(!0),onLeave(K,Y){K._isLeaving=!0;const oe=()=>B(K,Y);addTransitionClass(K,d),K._enterCancelled?(addTransitionClass(K,f),forceReflow()):(forceReflow(),addTransitionClass(K,f)),nextFrame(()=>{K._isLeaving&&(removeTransitionClass(K,d),addTransitionClass(K,m),hasExplicitCallback(k)||whenTransitionEnds(K,r,x,oe))}),callHook(k,[K,oe])},onEnterCancelled(K){M(K,!1,void 0,!0),callHook(R,[K])},onAppearCancelled(K){M(K,!0,void 0,!0),callHook(U,[K])},onLeaveCancelled(K){B(K),callHook(I,[K])}})}function normalizeDuration(n){if(n==null)return null;if(isObject(n))return[NumberOf(n.enter),NumberOf(n.leave)];{const e=NumberOf(n);return[e,e]}}function NumberOf(n){return toNumber(n)}function addTransitionClass(n,e){e.split(/\s+/).forEach(t=>t&&n.classList.add(t)),(n[vtcKey]||(n[vtcKey]=new Set)).add(e)}function removeTransitionClass(n,e){e.split(/\s+/).forEach(r=>r&&n.classList.remove(r));const t=n[vtcKey];t&&(t.delete(e),t.size||(n[vtcKey]=void 0))}function nextFrame(n){requestAnimationFrame(()=>{requestAnimationFrame(n)})}let endId=0;function whenTransitionEnds(n,e,t,r){const i=n._endId=++endId,s=()=>{i===n._endId&&r()};if(t!=null)return setTimeout(s,t);const{type:o,timeout:a,propCount:l}=getTransitionInfo(n,e);if(!o)return r();const c=o+"end";let u=0;const d=()=>{n.removeEventListener(c,f),s()},f=m=>{m.target===n&&++u>=l&&d()};setTimeout(()=>{u<l&&d()},a+1),n.addEventListener(c,f)}function getTransitionInfo(n,e){const t=window.getComputedStyle(n),r=g=>(t[g]||"").split(", "),i=r(`${TRANSITION}Delay`),s=r(`${TRANSITION}Duration`),o=getTimeout(i,s),a=r(`${ANIMATION}Delay`),l=r(`${ANIMATION}Duration`),c=getTimeout(a,l);let u=null,d=0,f=0;e===TRANSITION?o>0&&(u=TRANSITION,d=o,f=s.length):e===ANIMATION?c>0&&(u=ANIMATION,d=c,f=l.length):(d=Math.max(o,c),u=d>0?o>c?TRANSITION:ANIMATION:null,f=u?u===TRANSITION?s.length:l.length:0);const m=u===TRANSITION&&/\b(transform|all)(,|$)/.test(r(`${TRANSITION}Property`).toString());return{type:u,timeout:d,propCount:f,hasTransform:m}}function getTimeout(n,e){for(;n.length<e.length;)n=n.concat(n);return Math.max(...e.map((t,r)=>toMs(t)+toMs(n[r])))}function toMs(n){return n==="auto"?0:Number(n.slice(0,-1).replace(",","."))*1e3}function forceReflow(){return document.body.offsetHeight}function patchClass(n,e,t){const r=n[vtcKey];r&&(e=(e?[e,...r]:[...r]).join(" ")),e==null?n.removeAttribute("class"):t?n.setAttribute("class",e):n.className=e}const vShowOriginalDisplay=Symbol("_vod"),vShowHidden=Symbol("_vsh"),vShow={beforeMount(n,{value:e},{transition:t}){n[vShowOriginalDisplay]=n.style.display==="none"?"":n.style.display,t&&e?t.beforeEnter(n):setDisplay(n,e)},mounted(n,{value:e},{transition:t}){t&&e&&t.enter(n)},updated(n,{value:e,oldValue:t},{transition:r}){!e!=!t&&(r?e?(r.beforeEnter(n),setDisplay(n,!0),r.enter(n)):r.leave(n,()=>{setDisplay(n,!1)}):setDisplay(n,e))},beforeUnmount(n,{value:e}){setDisplay(n,e)}};function setDisplay(n,e){n.style.display=e?n[vShowOriginalDisplay]:"none",n[vShowHidden]=!e}const CSS_VAR_TEXT=Symbol(""),displayRE=/(^|;)\s*display\s*:/;function patchStyle(n,e,t){const r=n.style,i=isString$1(t);let s=!1;if(t&&!i){if(e)if(isString$1(e))for(const o of e.split(";")){const a=o.slice(0,o.indexOf(":")).trim();t[a]==null&&setStyle(r,a,"")}else for(const o in e)t[o]==null&&setStyle(r,o,"");for(const o in t)o==="display"&&(s=!0),setStyle(r,o,t[o])}else if(i){if(e!==t){const o=r[CSS_VAR_TEXT];o&&(t+=";"+o),r.cssText=t,s=displayRE.test(t)}}else e&&n.removeAttribute("style");vShowOriginalDisplay in n&&(n[vShowOriginalDisplay]=s?r.display:"",n[vShowHidden]&&(r.display="none"))}const importantRE=/\s*!important$/;function setStyle(n,e,t){if(isArray$1(t))t.forEach(r=>setStyle(n,e,r));else if(t==null&&(t=""),e.startsWith("--"))n.setProperty(e,t);else{const r=autoPrefix(n,e);importantRE.test(t)?n.setProperty(hyphenate(r),t.replace(importantRE,""),"important"):n[r]=t}}const prefixes=["Webkit","Moz","ms"],prefixCache={};function autoPrefix(n,e){const t=prefixCache[e];if(t)return t;let r=camelize(e);if(r!=="filter"&&r in n)return prefixCache[e]=r;r=capitalize(r);for(let i=0;i<prefixes.length;i++){const s=prefixes[i]+r;if(s in n)return prefixCache[e]=s}return e}const xlinkNS="http://www.w3.org/1999/xlink";function patchAttr(n,e,t,r,i,s=isSpecialBooleanAttr(e)){r&&e.startsWith("xlink:")?t==null?n.removeAttributeNS(xlinkNS,e.slice(6,e.length)):n.setAttributeNS(xlinkNS,e,t):t==null||s&&!includeBooleanAttr(t)?n.removeAttribute(e):n.setAttribute(e,s?"":isSymbol(t)?String(t):t)}function patchDOMProp(n,e,t,r,i){if(e==="innerHTML"||e==="textContent"){t!=null&&(n[e]=e==="innerHTML"?unsafeToTrustedHTML(t):t);return}const s=n.tagName;if(e==="value"&&s!=="PROGRESS"&&!s.includes("-")){const a=s==="OPTION"?n.getAttribute("value")||"":n.value,l=t==null?n.type==="checkbox"?"on":"":String(t);(a!==l||!("_value"in n))&&(n.value=l),t==null&&n.removeAttribute(e),n._value=t;return}let o=!1;if(t===""||t==null){const a=typeof n[e];a==="boolean"?t=includeBooleanAttr(t):t==null&&a==="string"?(t="",o=!0):a==="number"&&(t=0,o=!0)}try{n[e]=t}catch{}o&&n.removeAttribute(i||e)}function addEventListener(n,e,t,r){n.addEventListener(e,t,r)}function removeEventListener(n,e,t,r){n.removeEventListener(e,t,r)}const veiKey=Symbol("_vei");function patchEvent(n,e,t,r,i=null){const s=n[veiKey]||(n[veiKey]={}),o=s[e];if(r&&o)o.value=r;else{const[a,l]=parseName(e);if(r){const c=s[e]=createInvoker(r,i);addEventListener(n,a,c,l)}else o&&(removeEventListener(n,a,o,l),s[e]=void 0)}}const optionsModifierRE=/(?:Once|Passive|Capture)$/;function parseName(n){let e;if(optionsModifierRE.test(n)){e={};let r;for(;r=n.match(optionsModifierRE);)n=n.slice(0,n.length-r[0].length),e[r[0].toLowerCase()]=!0}return[n[2]===":"?n.slice(3):hyphenate(n.slice(2)),e]}let cachedNow=0;const p$1=Promise.resolve(),getNow=()=>cachedNow||(p$1.then(()=>cachedNow=0),cachedNow=Date.now());function createInvoker(n,e){const t=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=t.attached)return;callWithAsyncErrorHandling(patchStopImmediatePropagation(r,t.value),e,5,[r])};return t.value=n,t.attached=getNow(),t}function patchStopImmediatePropagation(n,e){if(isArray$1(e)){const t=n.stopImmediatePropagation;return n.stopImmediatePropagation=()=>{t.call(n),n._stopped=!0},e.map(r=>i=>!i._stopped&&r&&r(i))}else return e}const isNativeOn=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&n.charCodeAt(2)>96&&n.charCodeAt(2)<123,patchProp=(n,e,t,r,i,s)=>{const o=i==="svg";e==="class"?patchClass(n,r,o):e==="style"?patchStyle(n,t,r):isOn(e)?isModelListener(e)||patchEvent(n,e,t,r,s):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):shouldSetAsProp(n,e,r,o))?(patchDOMProp(n,e,r),!n.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&patchAttr(n,e,r,o,s,e!=="value")):n._isVueCE&&(/[A-Z]/.test(e)||!isString$1(r))?patchDOMProp(n,camelize(e),r,s,e):(e==="true-value"?n._trueValue=r:e==="false-value"&&(n._falseValue=r),patchAttr(n,e,r,o))};function shouldSetAsProp(n,e,t,r){if(r)return!!(e==="innerHTML"||e==="textContent"||e in n&&isNativeOn(e)&&isFunction(t));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&n.tagName==="INPUT"||e==="type"&&n.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const i=n.tagName;if(i==="IMG"||i==="VIDEO"||i==="CANVAS"||i==="SOURCE")return!1}return isNativeOn(e)&&isString$1(t)?!1:e in n}const getModelAssigner=n=>{const e=n.props["onUpdate:modelValue"]||!1;return isArray$1(e)?t=>invokeArrayFns(e,t):e};function onCompositionStart(n){n.target.composing=!0}function onCompositionEnd(n){const e=n.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const assignKey=Symbol("_assign"),vModelText={created(n,{modifiers:{lazy:e,trim:t,number:r}},i){n[assignKey]=getModelAssigner(i);const s=r||i.props&&i.props.type==="number";addEventListener(n,e?"change":"input",o=>{if(o.target.composing)return;let a=n.value;t&&(a=a.trim()),s&&(a=looseToNumber(a)),n[assignKey](a)}),t&&addEventListener(n,"change",()=>{n.value=n.value.trim()}),e||(addEventListener(n,"compositionstart",onCompositionStart),addEventListener(n,"compositionend",onCompositionEnd),addEventListener(n,"change",onCompositionEnd))},mounted(n,{value:e}){n.value=e??""},beforeUpdate(n,{value:e,oldValue:t,modifiers:{lazy:r,trim:i,number:s}},o){if(n[assignKey]=getModelAssigner(o),n.composing)return;const a=(s||n.type==="number")&&!/^0\d/.test(n.value)?looseToNumber(n.value):n.value,l=e??"";a!==l&&(document.activeElement===n&&n.type!=="range"&&(r&&e===t||i&&n.value.trim()===l)||(n.value=l))}},vModelCheckbox={deep:!0,created(n,e,t){n[assignKey]=getModelAssigner(t),addEventListener(n,"change",()=>{const r=n._modelValue,i=getValue(n),s=n.checked,o=n[assignKey];if(isArray$1(r)){const a=looseIndexOf(r,i),l=a!==-1;if(s&&!l)o(r.concat(i));else if(!s&&l){const c=[...r];c.splice(a,1),o(c)}}else if(isSet(r)){const a=new Set(r);s?a.add(i):a.delete(i),o(a)}else o(getCheckboxValue(n,s))})},mounted:setChecked,beforeUpdate(n,e,t){n[assignKey]=getModelAssigner(t),setChecked(n,e,t)}};function setChecked(n,{value:e,oldValue:t},r){n._modelValue=e;let i;if(isArray$1(e))i=looseIndexOf(e,r.props.value)>-1;else if(isSet(e))i=e.has(r.props.value);else{if(e===t)return;i=looseEqual(e,getCheckboxValue(n,!0))}n.checked!==i&&(n.checked=i)}const vModelSelect={deep:!0,created(n,{value:e,modifiers:{number:t}},r){const i=isSet(e);addEventListener(n,"change",()=>{const s=Array.prototype.filter.call(n.options,o=>o.selected).map(o=>t?looseToNumber(getValue(o)):getValue(o));n[assignKey](n.multiple?i?new Set(s):s:s[0]),n._assigning=!0,nextTick(()=>{n._assigning=!1})}),n[assignKey]=getModelAssigner(r)},mounted(n,{value:e}){setSelected(n,e)},beforeUpdate(n,e,t){n[assignKey]=getModelAssigner(t)},updated(n,{value:e}){n._assigning||setSelected(n,e)}};function setSelected(n,e){const t=n.multiple,r=isArray$1(e);if(!(t&&!r&&!isSet(e))){for(let i=0,s=n.options.length;i<s;i++){const o=n.options[i],a=getValue(o);if(t)if(r){const l=typeof a;l==="string"||l==="number"?o.selected=e.some(c=>String(c)===String(a)):o.selected=looseIndexOf(e,a)>-1}else o.selected=e.has(a);else if(looseEqual(getValue(o),e)){n.selectedIndex!==i&&(n.selectedIndex=i);return}}!t&&n.selectedIndex!==-1&&(n.selectedIndex=-1)}}function getValue(n){return"_value"in n?n._value:n.value}function getCheckboxValue(n,e){const t=e?"_trueValue":"_falseValue";return t in n?n[t]:e}const keyNames={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},withKeys=(n,e)=>{const t=n._withKeys||(n._withKeys={}),r=e.join(".");return t[r]||(t[r]=i=>{if(!("key"in i))return;const s=hyphenate(i.key);if(e.some(o=>o===s||keyNames[o]===s))return n(i)})},rendererOptions=extend({patchProp},nodeOps);let renderer;function ensureRenderer(){return renderer||(renderer=createRenderer(rendererOptions))}const createApp=(...n)=>{const e=ensureRenderer().createApp(...n),{mount:t}=e;return e.mount=r=>{const i=normalizeContainer(r);if(!i)return;const s=e._component;!isFunction(s)&&!s.render&&!s.template&&(s.template=i.innerHTML),i.nodeType===1&&(i.textContent="");const o=t(i,!1,resolveRootNamespace(i));return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),o},e};function resolveRootNamespace(n){if(n instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&n instanceof MathMLElement)return"mathml"}function normalizeContainer(n){return isString$1(n)?document.querySelector(n):n}const _imports_0$1=""+new URL("logo-BIU9-ffb.png",import.meta.url).href;/*!
  * vue-router v4.5.0
  * (c) 2024 Eduardo San Martin Morote
  * @license MIT
  */const isBrowser=typeof document<"u";function isRouteComponent(n){return typeof n=="object"||"displayName"in n||"props"in n||"__vccOpts"in n}function isESModule(n){return n.__esModule||n[Symbol.toStringTag]==="Module"||n.default&&isRouteComponent(n.default)}const assign$1=Object.assign;function applyToParams(n,e){const t={};for(const r in e){const i=e[r];t[r]=isArray(i)?i.map(n):n(i)}return t}const noop$2=()=>{},isArray=Array.isArray,HASH_RE=/#/g,AMPERSAND_RE=/&/g,SLASH_RE=/\//g,EQUAL_RE=/=/g,IM_RE=/\?/g,PLUS_RE=/\+/g,ENC_BRACKET_OPEN_RE=/%5B/g,ENC_BRACKET_CLOSE_RE=/%5D/g,ENC_CARET_RE=/%5E/g,ENC_BACKTICK_RE=/%60/g,ENC_CURLY_OPEN_RE=/%7B/g,ENC_PIPE_RE=/%7C/g,ENC_CURLY_CLOSE_RE=/%7D/g,ENC_SPACE_RE=/%20/g;function commonEncode(n){return encodeURI(""+n).replace(ENC_PIPE_RE,"|").replace(ENC_BRACKET_OPEN_RE,"[").replace(ENC_BRACKET_CLOSE_RE,"]")}function encodeHash(n){return commonEncode(n).replace(ENC_CURLY_OPEN_RE,"{").replace(ENC_CURLY_CLOSE_RE,"}").replace(ENC_CARET_RE,"^")}function encodeQueryValue(n){return commonEncode(n).replace(PLUS_RE,"%2B").replace(ENC_SPACE_RE,"+").replace(HASH_RE,"%23").replace(AMPERSAND_RE,"%26").replace(ENC_BACKTICK_RE,"`").replace(ENC_CURLY_OPEN_RE,"{").replace(ENC_CURLY_CLOSE_RE,"}").replace(ENC_CARET_RE,"^")}function encodeQueryKey(n){return encodeQueryValue(n).replace(EQUAL_RE,"%3D")}function encodePath(n){return commonEncode(n).replace(HASH_RE,"%23").replace(IM_RE,"%3F")}function encodeParam(n){return n==null?"":encodePath(n).replace(SLASH_RE,"%2F")}function decode(n){try{return decodeURIComponent(""+n)}catch{}return""+n}const TRAILING_SLASH_RE=/\/$/,removeTrailingSlash=n=>n.replace(TRAILING_SLASH_RE,"");function parseURL(n,e,t="/"){let r,i={},s="",o="";const a=e.indexOf("#");let l=e.indexOf("?");return a<l&&a>=0&&(l=-1),l>-1&&(r=e.slice(0,l),s=e.slice(l+1,a>-1?a:e.length),i=n(s)),a>-1&&(r=r||e.slice(0,a),o=e.slice(a,e.length)),r=resolveRelativePath(r??e,t),{fullPath:r+(s&&"?")+s+o,path:r,query:i,hash:decode(o)}}function stringifyURL(n,e){const t=e.query?n(e.query):"";return e.path+(t&&"?")+t+(e.hash||"")}function stripBase(n,e){return!e||!n.toLowerCase().startsWith(e.toLowerCase())?n:n.slice(e.length)||"/"}function isSameRouteLocation(n,e,t){const r=e.matched.length-1,i=t.matched.length-1;return r>-1&&r===i&&isSameRouteRecord(e.matched[r],t.matched[i])&&isSameRouteLocationParams(e.params,t.params)&&n(e.query)===n(t.query)&&e.hash===t.hash}function isSameRouteRecord(n,e){return(n.aliasOf||n)===(e.aliasOf||e)}function isSameRouteLocationParams(n,e){if(Object.keys(n).length!==Object.keys(e).length)return!1;for(const t in n)if(!isSameRouteLocationParamsValue(n[t],e[t]))return!1;return!0}function isSameRouteLocationParamsValue(n,e){return isArray(n)?isEquivalentArray(n,e):isArray(e)?isEquivalentArray(e,n):n===e}function isEquivalentArray(n,e){return isArray(e)?n.length===e.length&&n.every((t,r)=>t===e[r]):n.length===1&&n[0]===e}function resolveRelativePath(n,e){if(n.startsWith("/"))return n;if(!n)return e;const t=e.split("/"),r=n.split("/"),i=r[r.length-1];(i===".."||i===".")&&r.push("");let s=t.length-1,o,a;for(o=0;o<r.length;o++)if(a=r[o],a!==".")if(a==="..")s>1&&s--;else break;return t.slice(0,s).join("/")+"/"+r.slice(o).join("/")}const START_LOCATION_NORMALIZED={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var NavigationType;(function(n){n.pop="pop",n.push="push"})(NavigationType||(NavigationType={}));var NavigationDirection;(function(n){n.back="back",n.forward="forward",n.unknown=""})(NavigationDirection||(NavigationDirection={}));function normalizeBase(n){if(!n)if(isBrowser){const e=document.querySelector("base");n=e&&e.getAttribute("href")||"/",n=n.replace(/^\w+:\/\/[^\/]+/,"")}else n="/";return n[0]!=="/"&&n[0]!=="#"&&(n="/"+n),removeTrailingSlash(n)}const BEFORE_HASH_RE=/^[^#]+#/;function createHref(n,e){return n.replace(BEFORE_HASH_RE,"#")+e}function getElementPosition(n,e){const t=document.documentElement.getBoundingClientRect(),r=n.getBoundingClientRect();return{behavior:e.behavior,left:r.left-t.left-(e.left||0),top:r.top-t.top-(e.top||0)}}const computeScrollPosition=()=>({left:window.scrollX,top:window.scrollY});function scrollToPosition(n){let e;if("el"in n){const t=n.el,r=typeof t=="string"&&t.startsWith("#"),i=typeof t=="string"?r?document.getElementById(t.slice(1)):document.querySelector(t):t;if(!i)return;e=getElementPosition(i,n)}else e=n;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.scrollX,e.top!=null?e.top:window.scrollY)}function getScrollKey(n,e){return(history.state?history.state.position-e:-1)+n}const scrollPositions=new Map;function saveScrollPosition(n,e){scrollPositions.set(n,e)}function getSavedScrollPosition(n){const e=scrollPositions.get(n);return scrollPositions.delete(n),e}let createBaseLocation=()=>location.protocol+"//"+location.host;function createCurrentLocation(n,e){const{pathname:t,search:r,hash:i}=e,s=n.indexOf("#");if(s>-1){let a=i.includes(n.slice(s))?n.slice(s).length:1,l=i.slice(a);return l[0]!=="/"&&(l="/"+l),stripBase(l,"")}return stripBase(t,n)+r+i}function useHistoryListeners(n,e,t,r){let i=[],s=[],o=null;const a=({state:f})=>{const m=createCurrentLocation(n,location),g=t.value,v=e.value;let x=0;if(f){if(t.value=m,e.value=f,o&&o===g){o=null;return}x=v?f.position-v.position:0}else r(m);i.forEach(S=>{S(t.value,g,{delta:x,type:NavigationType.pop,direction:x?x>0?NavigationDirection.forward:NavigationDirection.back:NavigationDirection.unknown})})};function l(){o=t.value}function c(f){i.push(f);const m=()=>{const g=i.indexOf(f);g>-1&&i.splice(g,1)};return s.push(m),m}function u(){const{history:f}=window;f.state&&f.replaceState(assign$1({},f.state,{scroll:computeScrollPosition()}),"")}function d(){for(const f of s)f();s=[],window.removeEventListener("popstate",a),window.removeEventListener("beforeunload",u)}return window.addEventListener("popstate",a),window.addEventListener("beforeunload",u,{passive:!0}),{pauseListeners:l,listen:c,destroy:d}}function buildState(n,e,t,r=!1,i=!1){return{back:n,current:e,forward:t,replaced:r,position:window.history.length,scroll:i?computeScrollPosition():null}}function useHistoryStateNavigation(n){const{history:e,location:t}=window,r={value:createCurrentLocation(n,t)},i={value:e.state};i.value||s(r.value,{back:null,current:r.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function s(l,c,u){const d=n.indexOf("#"),f=d>-1?(t.host&&document.querySelector("base")?n:n.slice(d))+l:createBaseLocation()+n+l;try{e[u?"replaceState":"pushState"](c,"",f),i.value=c}catch(m){console.error(m),t[u?"replace":"assign"](f)}}function o(l,c){const u=assign$1({},e.state,buildState(i.value.back,l,i.value.forward,!0),c,{position:i.value.position});s(l,u,!0),r.value=l}function a(l,c){const u=assign$1({},i.value,e.state,{forward:l,scroll:computeScrollPosition()});s(u.current,u,!0);const d=assign$1({},buildState(r.value,l,null),{position:u.position+1},c);s(l,d,!1),r.value=l}return{location:r,state:i,push:a,replace:o}}function createWebHistory(n){n=normalizeBase(n);const e=useHistoryStateNavigation(n),t=useHistoryListeners(n,e.state,e.location,e.replace);function r(s,o=!0){o||t.pauseListeners(),history.go(s)}const i=assign$1({location:"",base:n,go:r,createHref:createHref.bind(null,n)},e,t);return Object.defineProperty(i,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(i,"state",{enumerable:!0,get:()=>e.state.value}),i}function createWebHashHistory(n){return n=location.host?n||location.pathname+location.search:"",n.includes("#")||(n+="#"),createWebHistory(n)}function isRouteLocation(n){return typeof n=="string"||n&&typeof n=="object"}function isRouteName(n){return typeof n=="string"||typeof n=="symbol"}const NavigationFailureSymbol=Symbol("");var NavigationFailureType;(function(n){n[n.aborted=4]="aborted",n[n.cancelled=8]="cancelled",n[n.duplicated=16]="duplicated"})(NavigationFailureType||(NavigationFailureType={}));function createRouterError(n,e){return assign$1(new Error,{type:n,[NavigationFailureSymbol]:!0},e)}function isNavigationFailure(n,e){return n instanceof Error&&NavigationFailureSymbol in n&&(e==null||!!(n.type&e))}const BASE_PARAM_PATTERN="[^/]+?",BASE_PATH_PARSER_OPTIONS={sensitive:!1,strict:!1,start:!0,end:!0},REGEX_CHARS_RE=/[.+*?^${}()[\]/\\]/g;function tokensToParser(n,e){const t=assign$1({},BASE_PATH_PARSER_OPTIONS,e),r=[];let i=t.start?"^":"";const s=[];for(const c of n){const u=c.length?[]:[90];t.strict&&!c.length&&(i+="/");for(let d=0;d<c.length;d++){const f=c[d];let m=40+(t.sensitive?.25:0);if(f.type===0)d||(i+="/"),i+=f.value.replace(REGEX_CHARS_RE,"\\$&"),m+=40;else if(f.type===1){const{value:g,repeatable:v,optional:x,regexp:S}=f;s.push({name:g,repeatable:v,optional:x});const C=S||BASE_PARAM_PATTERN;if(C!==BASE_PARAM_PATTERN){m+=10;try{new RegExp(`(${C})`)}catch(k){throw new Error(`Invalid custom RegExp for param "${g}" (${C}): `+k.message)}}let R=v?`((?:${C})(?:/(?:${C}))*)`:`(${C})`;d||(R=x&&c.length<2?`(?:/${R})`:"/"+R),x&&(R+="?"),i+=R,m+=20,x&&(m+=-8),v&&(m+=-20),C===".*"&&(m+=-50)}u.push(m)}r.push(u)}if(t.strict&&t.end){const c=r.length-1;r[c][r[c].length-1]+=.7000000000000001}t.strict||(i+="/?"),t.end?i+="$":t.strict&&!i.endsWith("/")&&(i+="(?:/|$)");const o=new RegExp(i,t.sensitive?"":"i");function a(c){const u=c.match(o),d={};if(!u)return null;for(let f=1;f<u.length;f++){const m=u[f]||"",g=s[f-1];d[g.name]=m&&g.repeatable?m.split("/"):m}return d}function l(c){let u="",d=!1;for(const f of n){(!d||!u.endsWith("/"))&&(u+="/"),d=!1;for(const m of f)if(m.type===0)u+=m.value;else if(m.type===1){const{value:g,repeatable:v,optional:x}=m,S=g in c?c[g]:"";if(isArray(S)&&!v)throw new Error(`Provided param "${g}" is an array but it is not repeatable (* or + modifiers)`);const C=isArray(S)?S.join("/"):S;if(!C)if(x)f.length<2&&(u.endsWith("/")?u=u.slice(0,-1):d=!0);else throw new Error(`Missing required param "${g}"`);u+=C}}return u||"/"}return{re:o,score:r,keys:s,parse:a,stringify:l}}function compareScoreArray(n,e){let t=0;for(;t<n.length&&t<e.length;){const r=e[t]-n[t];if(r)return r;t++}return n.length<e.length?n.length===1&&n[0]===80?-1:1:n.length>e.length?e.length===1&&e[0]===80?1:-1:0}function comparePathParserScore(n,e){let t=0;const r=n.score,i=e.score;for(;t<r.length&&t<i.length;){const s=compareScoreArray(r[t],i[t]);if(s)return s;t++}if(Math.abs(i.length-r.length)===1){if(isLastScoreNegative(r))return 1;if(isLastScoreNegative(i))return-1}return i.length-r.length}function isLastScoreNegative(n){const e=n[n.length-1];return n.length>0&&e[e.length-1]<0}const ROOT_TOKEN={type:0,value:""},VALID_PARAM_RE=/[a-zA-Z0-9_]/;function tokenizePath(n){if(!n)return[[]];if(n==="/")return[[ROOT_TOKEN]];if(!n.startsWith("/"))throw new Error(`Invalid path "${n}"`);function e(m){throw new Error(`ERR (${t})/"${c}": ${m}`)}let t=0,r=t;const i=[];let s;function o(){s&&i.push(s),s=[]}let a=0,l,c="",u="";function d(){c&&(t===0?s.push({type:0,value:c}):t===1||t===2||t===3?(s.length>1&&(l==="*"||l==="+")&&e(`A repeatable param (${c}) must be alone in its segment. eg: '/:ids+.`),s.push({type:1,value:c,regexp:u,repeatable:l==="*"||l==="+",optional:l==="*"||l==="?"})):e("Invalid state to consume buffer"),c="")}function f(){c+=l}for(;a<n.length;){if(l=n[a++],l==="\\"&&t!==2){r=t,t=4;continue}switch(t){case 0:l==="/"?(c&&d(),o()):l===":"?(d(),t=1):f();break;case 4:f(),t=r;break;case 1:l==="("?t=2:VALID_PARAM_RE.test(l)?f():(d(),t=0,l!=="*"&&l!=="?"&&l!=="+"&&a--);break;case 2:l===")"?u[u.length-1]=="\\"?u=u.slice(0,-1)+l:t=3:u+=l;break;case 3:d(),t=0,l!=="*"&&l!=="?"&&l!=="+"&&a--,u="";break;default:e("Unknown state");break}}return t===2&&e(`Unfinished custom RegExp for param "${c}"`),d(),o(),i}function createRouteRecordMatcher(n,e,t){const r=tokensToParser(tokenizePath(n.path),t),i=assign$1(r,{record:n,parent:e,children:[],alias:[]});return e&&!i.record.aliasOf==!e.record.aliasOf&&e.children.push(i),i}function createRouterMatcher(n,e){const t=[],r=new Map;e=mergeOptions({strict:!1,end:!0,sensitive:!1},e);function i(d){return r.get(d)}function s(d,f,m){const g=!m,v=normalizeRouteRecord(d);v.aliasOf=m&&m.record;const x=mergeOptions(e,d),S=[v];if("alias"in d){const k=typeof d.alias=="string"?[d.alias]:d.alias;for(const I of k)S.push(normalizeRouteRecord(assign$1({},v,{components:m?m.record.components:v.components,path:I,aliasOf:m?m.record:v})))}let C,R;for(const k of S){const{path:I}=k;if(f&&I[0]!=="/"){const F=f.record.path,N=F[F.length-1]==="/"?"":"/";k.path=f.record.path+(I&&N+I)}if(C=createRouteRecordMatcher(k,f,x),m?m.alias.push(C):(R=R||C,R!==C&&R.alias.push(C),g&&d.name&&!isAliasRecord(C)&&o(d.name)),isMatchable(C)&&l(C),v.children){const F=v.children;for(let N=0;N<F.length;N++)s(F[N],C,m&&m.children[N])}m=m||C}return R?()=>{o(R)}:noop$2}function o(d){if(isRouteName(d)){const f=r.get(d);f&&(r.delete(d),t.splice(t.indexOf(f),1),f.children.forEach(o),f.alias.forEach(o))}else{const f=t.indexOf(d);f>-1&&(t.splice(f,1),d.record.name&&r.delete(d.record.name),d.children.forEach(o),d.alias.forEach(o))}}function a(){return t}function l(d){const f=findInsertionIndex(d,t);t.splice(f,0,d),d.record.name&&!isAliasRecord(d)&&r.set(d.record.name,d)}function c(d,f){let m,g={},v,x;if("name"in d&&d.name){if(m=r.get(d.name),!m)throw createRouterError(1,{location:d});x=m.record.name,g=assign$1(paramsFromLocation(f.params,m.keys.filter(R=>!R.optional).concat(m.parent?m.parent.keys.filter(R=>R.optional):[]).map(R=>R.name)),d.params&&paramsFromLocation(d.params,m.keys.map(R=>R.name))),v=m.stringify(g)}else if(d.path!=null)v=d.path,m=t.find(R=>R.re.test(v)),m&&(g=m.parse(v),x=m.record.name);else{if(m=f.name?r.get(f.name):t.find(R=>R.re.test(f.path)),!m)throw createRouterError(1,{location:d,currentLocation:f});x=m.record.name,g=assign$1({},f.params,d.params),v=m.stringify(g)}const S=[];let C=m;for(;C;)S.unshift(C.record),C=C.parent;return{name:x,path:v,params:g,matched:S,meta:mergeMetaFields(S)}}n.forEach(d=>s(d));function u(){t.length=0,r.clear()}return{addRoute:s,resolve:c,removeRoute:o,clearRoutes:u,getRoutes:a,getRecordMatcher:i}}function paramsFromLocation(n,e){const t={};for(const r of e)r in n&&(t[r]=n[r]);return t}function normalizeRouteRecord(n){const e={path:n.path,redirect:n.redirect,name:n.name,meta:n.meta||{},aliasOf:n.aliasOf,beforeEnter:n.beforeEnter,props:normalizeRecordProps(n),children:n.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in n?n.components||null:n.component&&{default:n.component}};return Object.defineProperty(e,"mods",{value:{}}),e}function normalizeRecordProps(n){const e={},t=n.props||!1;if("component"in n)e.default=t;else for(const r in n.components)e[r]=typeof t=="object"?t[r]:t;return e}function isAliasRecord(n){for(;n;){if(n.record.aliasOf)return!0;n=n.parent}return!1}function mergeMetaFields(n){return n.reduce((e,t)=>assign$1(e,t.meta),{})}function mergeOptions(n,e){const t={};for(const r in n)t[r]=r in e?e[r]:n[r];return t}function findInsertionIndex(n,e){let t=0,r=e.length;for(;t!==r;){const s=t+r>>1;comparePathParserScore(n,e[s])<0?r=s:t=s+1}const i=getInsertionAncestor(n);return i&&(r=e.lastIndexOf(i,r-1)),r}function getInsertionAncestor(n){let e=n;for(;e=e.parent;)if(isMatchable(e)&&comparePathParserScore(n,e)===0)return e}function isMatchable({record:n}){return!!(n.name||n.components&&Object.keys(n.components).length||n.redirect)}function parseQuery(n){const e={};if(n===""||n==="?")return e;const r=(n[0]==="?"?n.slice(1):n).split("&");for(let i=0;i<r.length;++i){const s=r[i].replace(PLUS_RE," "),o=s.indexOf("="),a=decode(o<0?s:s.slice(0,o)),l=o<0?null:decode(s.slice(o+1));if(a in e){let c=e[a];isArray(c)||(c=e[a]=[c]),c.push(l)}else e[a]=l}return e}function stringifyQuery(n){let e="";for(let t in n){const r=n[t];if(t=encodeQueryKey(t),r==null){r!==void 0&&(e+=(e.length?"&":"")+t);continue}(isArray(r)?r.map(s=>s&&encodeQueryValue(s)):[r&&encodeQueryValue(r)]).forEach(s=>{s!==void 0&&(e+=(e.length?"&":"")+t,s!=null&&(e+="="+s))})}return e}function normalizeQuery(n){const e={};for(const t in n){const r=n[t];r!==void 0&&(e[t]=isArray(r)?r.map(i=>i==null?null:""+i):r==null?r:""+r)}return e}const matchedRouteKey=Symbol(""),viewDepthKey=Symbol(""),routerKey=Symbol(""),routeLocationKey=Symbol(""),routerViewLocationKey=Symbol("");function useCallbacks(){let n=[];function e(r){return n.push(r),()=>{const i=n.indexOf(r);i>-1&&n.splice(i,1)}}function t(){n=[]}return{add:e,list:()=>n.slice(),reset:t}}function guardToPromiseFn(n,e,t,r,i,s=o=>o()){const o=r&&(r.enterCallbacks[i]=r.enterCallbacks[i]||[]);return()=>new Promise((a,l)=>{const c=f=>{f===!1?l(createRouterError(4,{from:t,to:e})):f instanceof Error?l(f):isRouteLocation(f)?l(createRouterError(2,{from:e,to:f})):(o&&r.enterCallbacks[i]===o&&typeof f=="function"&&o.push(f),a())},u=s(()=>n.call(r&&r.instances[i],e,t,c));let d=Promise.resolve(u);n.length<3&&(d=d.then(c)),d.catch(f=>l(f))})}function extractComponentsGuards(n,e,t,r,i=s=>s()){const s=[];for(const o of n)for(const a in o.components){let l=o.components[a];if(!(e!=="beforeRouteEnter"&&!o.instances[a]))if(isRouteComponent(l)){const u=(l.__vccOpts||l)[e];u&&s.push(guardToPromiseFn(u,t,r,o,a,i))}else{let c=l();s.push(()=>c.then(u=>{if(!u)throw new Error(`Couldn't resolve component "${a}" at "${o.path}"`);const d=isESModule(u)?u.default:u;o.mods[a]=u,o.components[a]=d;const m=(d.__vccOpts||d)[e];return m&&guardToPromiseFn(m,t,r,o,a,i)()}))}}return s}function useLink(n){const e=inject(routerKey),t=inject(routeLocationKey),r=computed(()=>{const l=unref(n.to);return e.resolve(l)}),i=computed(()=>{const{matched:l}=r.value,{length:c}=l,u=l[c-1],d=t.matched;if(!u||!d.length)return-1;const f=d.findIndex(isSameRouteRecord.bind(null,u));if(f>-1)return f;const m=getOriginalPath(l[c-2]);return c>1&&getOriginalPath(u)===m&&d[d.length-1].path!==m?d.findIndex(isSameRouteRecord.bind(null,l[c-2])):f}),s=computed(()=>i.value>-1&&includesParams(t.params,r.value.params)),o=computed(()=>i.value>-1&&i.value===t.matched.length-1&&isSameRouteLocationParams(t.params,r.value.params));function a(l={}){if(guardEvent(l)){const c=e[unref(n.replace)?"replace":"push"](unref(n.to)).catch(noop$2);return n.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>c),c}return Promise.resolve()}return{route:r,href:computed(()=>r.value.href),isActive:s,isExactActive:o,navigate:a}}function preferSingleVNode(n){return n.length===1?n[0]:n}const RouterLinkImpl=defineComponent({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink,setup(n,{slots:e}){const t=reactive(useLink(n)),{options:r}=inject(routerKey),i=computed(()=>({[getLinkClass(n.activeClass,r.linkActiveClass,"router-link-active")]:t.isActive,[getLinkClass(n.exactActiveClass,r.linkExactActiveClass,"router-link-exact-active")]:t.isExactActive}));return()=>{const s=e.default&&preferSingleVNode(e.default(t));return n.custom?s:h("a",{"aria-current":t.isExactActive?n.ariaCurrentValue:null,href:t.href,onClick:t.navigate,class:i.value},s)}}}),RouterLink=RouterLinkImpl;function guardEvent(n){if(!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)&&!n.defaultPrevented&&!(n.button!==void 0&&n.button!==0)){if(n.currentTarget&&n.currentTarget.getAttribute){const e=n.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return n.preventDefault&&n.preventDefault(),!0}}function includesParams(n,e){for(const t in e){const r=e[t],i=n[t];if(typeof r=="string"){if(r!==i)return!1}else if(!isArray(i)||i.length!==r.length||r.some((s,o)=>s!==i[o]))return!1}return!0}function getOriginalPath(n){return n?n.aliasOf?n.aliasOf.path:n.path:""}const getLinkClass=(n,e,t)=>n??e??t,RouterViewImpl=defineComponent({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(n,{attrs:e,slots:t}){const r=inject(routerViewLocationKey),i=computed(()=>n.route||r.value),s=inject(viewDepthKey,0),o=computed(()=>{let c=unref(s);const{matched:u}=i.value;let d;for(;(d=u[c])&&!d.components;)c++;return c}),a=computed(()=>i.value.matched[o.value]);provide(viewDepthKey,computed(()=>o.value+1)),provide(matchedRouteKey,a),provide(routerViewLocationKey,i);const l=ref();return watch(()=>[l.value,a.value,n.name],([c,u,d],[f,m,g])=>{u&&(u.instances[d]=c,m&&m!==u&&c&&c===f&&(u.leaveGuards.size||(u.leaveGuards=m.leaveGuards),u.updateGuards.size||(u.updateGuards=m.updateGuards))),c&&u&&(!m||!isSameRouteRecord(u,m)||!f)&&(u.enterCallbacks[d]||[]).forEach(v=>v(c))},{flush:"post"}),()=>{const c=i.value,u=n.name,d=a.value,f=d&&d.components[u];if(!f)return normalizeSlot(t.default,{Component:f,route:c});const m=d.props[u],g=m?m===!0?c.params:typeof m=="function"?m(c):m:null,x=h(f,assign$1({},g,e,{onVnodeUnmounted:S=>{S.component.isUnmounted&&(d.instances[u]=null)},ref:l}));return normalizeSlot(t.default,{Component:x,route:c})||x}}});function normalizeSlot(n,e){if(!n)return null;const t=n(e);return t.length===1?t[0]:t}const RouterView=RouterViewImpl;function createRouter(n){const e=createRouterMatcher(n.routes,n),t=n.parseQuery||parseQuery,r=n.stringifyQuery||stringifyQuery,i=n.history,s=useCallbacks(),o=useCallbacks(),a=useCallbacks(),l=shallowRef(START_LOCATION_NORMALIZED);let c=START_LOCATION_NORMALIZED;isBrowser&&n.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const u=applyToParams.bind(null,j=>""+j),d=applyToParams.bind(null,encodeParam),f=applyToParams.bind(null,decode);function m(j,ae){let ie,Ee;return isRouteName(j)?(ie=e.getRecordMatcher(j),Ee=ae):Ee=j,e.addRoute(Ee,ie)}function g(j){const ae=e.getRecordMatcher(j);ae&&e.removeRoute(ae)}function v(){return e.getRoutes().map(j=>j.record)}function x(j){return!!e.getRecordMatcher(j)}function S(j,ae){if(ae=assign$1({},ae||l.value),typeof j=="string"){const O=parseURL(t,j,ae.path),G=e.resolve({path:O.path},ae),X=i.createHref(O.fullPath);return assign$1(O,G,{params:f(G.params),hash:decode(O.hash),redirectedFrom:void 0,href:X})}let ie;if(j.path!=null)ie=assign$1({},j,{path:parseURL(t,j.path,ae.path).path});else{const O=assign$1({},j.params);for(const G in O)O[G]==null&&delete O[G];ie=assign$1({},j,{params:d(O)}),ae.params=d(ae.params)}const Ee=e.resolve(ie,ae),Pe=j.hash||"";Ee.params=u(f(Ee.params));const De=stringifyURL(r,assign$1({},j,{hash:encodeHash(Pe),path:Ee.path})),D=i.createHref(De);return assign$1({fullPath:De,hash:Pe,query:r===stringifyQuery?normalizeQuery(j.query):j.query||{}},Ee,{redirectedFrom:void 0,href:D})}function C(j){return typeof j=="string"?parseURL(t,j,l.value.path):assign$1({},j)}function R(j,ae){if(c!==j)return createRouterError(8,{from:ae,to:j})}function k(j){return N(j)}function I(j){return k(assign$1(C(j),{replace:!0}))}function F(j){const ae=j.matched[j.matched.length-1];if(ae&&ae.redirect){const{redirect:ie}=ae;let Ee=typeof ie=="function"?ie(j):ie;return typeof Ee=="string"&&(Ee=Ee.includes("?")||Ee.includes("#")?Ee=C(Ee):{path:Ee},Ee.params={}),assign$1({query:j.query,hash:j.hash,params:Ee.path!=null?{}:j.params},Ee)}}function N(j,ae){const ie=c=S(j),Ee=l.value,Pe=j.state,De=j.force,D=j.replace===!0,O=F(ie);if(O)return N(assign$1(C(O),{state:typeof O=="object"?assign$1({},Pe,O.state):Pe,force:De,replace:D}),ae||ie);const G=ie;G.redirectedFrom=ae;let X;return!De&&isSameRouteLocation(r,Ee,ie)&&(X=createRouterError(16,{to:G,from:Ee}),J(Ee,Ee,!0,!1)),(X?Promise.resolve(X):B(G,Ee)).catch(Q=>isNavigationFailure(Q)?isNavigationFailure(Q,2)?Q:W(Q):ye(Q,G,Ee)).then(Q=>{if(Q){if(isNavigationFailure(Q,2))return N(assign$1({replace:D},C(Q.to),{state:typeof Q.to=="object"?assign$1({},Pe,Q.to.state):Pe,force:De}),ae||G)}else Q=K(G,Ee,!0,D,Pe);return H(G,Ee,Q),Q})}function U(j,ae){const ie=R(j,ae);return ie?Promise.reject(ie):Promise.resolve()}function M(j){const ae=Re.values().next().value;return ae&&typeof ae.runWithContext=="function"?ae.runWithContext(j):j()}function B(j,ae){let ie;const[Ee,Pe,De]=extractChangingRecords(j,ae);ie=extractComponentsGuards(Ee.reverse(),"beforeRouteLeave",j,ae);for(const O of Ee)O.leaveGuards.forEach(G=>{ie.push(guardToPromiseFn(G,j,ae))});const D=U.bind(null,j,ae);return ie.push(D),Ce(ie).then(()=>{ie=[];for(const O of s.list())ie.push(guardToPromiseFn(O,j,ae));return ie.push(D),Ce(ie)}).then(()=>{ie=extractComponentsGuards(Pe,"beforeRouteUpdate",j,ae);for(const O of Pe)O.updateGuards.forEach(G=>{ie.push(guardToPromiseFn(G,j,ae))});return ie.push(D),Ce(ie)}).then(()=>{ie=[];for(const O of De)if(O.beforeEnter)if(isArray(O.beforeEnter))for(const G of O.beforeEnter)ie.push(guardToPromiseFn(G,j,ae));else ie.push(guardToPromiseFn(O.beforeEnter,j,ae));return ie.push(D),Ce(ie)}).then(()=>(j.matched.forEach(O=>O.enterCallbacks={}),ie=extractComponentsGuards(De,"beforeRouteEnter",j,ae,M),ie.push(D),Ce(ie))).then(()=>{ie=[];for(const O of o.list())ie.push(guardToPromiseFn(O,j,ae));return ie.push(D),Ce(ie)}).catch(O=>isNavigationFailure(O,8)?O:Promise.reject(O))}function H(j,ae,ie){a.list().forEach(Ee=>M(()=>Ee(j,ae,ie)))}function K(j,ae,ie,Ee,Pe){const De=R(j,ae);if(De)return De;const D=ae===START_LOCATION_NORMALIZED,O=isBrowser?history.state:{};ie&&(Ee||D?i.replace(j.fullPath,assign$1({scroll:D&&O&&O.scroll},Pe)):i.push(j.fullPath,Pe)),l.value=j,J(j,ae,ie,D),W()}let Y;function oe(){Y||(Y=i.listen((j,ae,ie)=>{if(!Le.listening)return;const Ee=S(j),Pe=F(Ee);if(Pe){N(assign$1(Pe,{replace:!0,force:!0}),Ee).catch(noop$2);return}c=Ee;const De=l.value;isBrowser&&saveScrollPosition(getScrollKey(De.fullPath,ie.delta),computeScrollPosition()),B(Ee,De).catch(D=>isNavigationFailure(D,12)?D:isNavigationFailure(D,2)?(N(assign$1(C(D.to),{force:!0}),Ee).then(O=>{isNavigationFailure(O,20)&&!ie.delta&&ie.type===NavigationType.pop&&i.go(-1,!1)}).catch(noop$2),Promise.reject()):(ie.delta&&i.go(-ie.delta,!1),ye(D,Ee,De))).then(D=>{D=D||K(Ee,De,!1),D&&(ie.delta&&!isNavigationFailure(D,8)?i.go(-ie.delta,!1):ie.type===NavigationType.pop&&isNavigationFailure(D,20)&&i.go(-1,!1)),H(Ee,De,D)}).catch(noop$2)}))}let ue=useCallbacks(),Z=useCallbacks(),Ae;function ye(j,ae,ie){W(j);const Ee=Z.list();return Ee.length?Ee.forEach(Pe=>Pe(j,ae,ie)):console.error(j),Promise.reject(j)}function $(){return Ae&&l.value!==START_LOCATION_NORMALIZED?Promise.resolve():new Promise((j,ae)=>{ue.add([j,ae])})}function W(j){return Ae||(Ae=!j,oe(),ue.list().forEach(([ae,ie])=>j?ie(j):ae()),ue.reset()),j}function J(j,ae,ie,Ee){const{scrollBehavior:Pe}=n;if(!isBrowser||!Pe)return Promise.resolve();const De=!ie&&getSavedScrollPosition(getScrollKey(j.fullPath,0))||(Ee||!ie)&&history.state&&history.state.scroll||null;return nextTick().then(()=>Pe(j,ae,De)).then(D=>D&&scrollToPosition(D)).catch(D=>ye(D,j,ae))}const ne=j=>i.go(j);let ve;const Re=new Set,Le={currentRoute:l,listening:!0,addRoute:m,removeRoute:g,clearRoutes:e.clearRoutes,hasRoute:x,getRoutes:v,resolve:S,options:n,push:k,replace:I,go:ne,back:()=>ne(-1),forward:()=>ne(1),beforeEach:s.add,beforeResolve:o.add,afterEach:a.add,onError:Z.add,isReady:$,install(j){const ae=this;j.component("RouterLink",RouterLink),j.component("RouterView",RouterView),j.config.globalProperties.$router=ae,Object.defineProperty(j.config.globalProperties,"$route",{enumerable:!0,get:()=>unref(l)}),isBrowser&&!ve&&l.value===START_LOCATION_NORMALIZED&&(ve=!0,k(i.location).catch(Pe=>{}));const ie={};for(const Pe in START_LOCATION_NORMALIZED)Object.defineProperty(ie,Pe,{get:()=>l.value[Pe],enumerable:!0});j.provide(routerKey,ae),j.provide(routeLocationKey,shallowReactive(ie)),j.provide(routerViewLocationKey,l);const Ee=j.unmount;Re.add(j),j.unmount=function(){Re.delete(j),Re.size<1&&(c=START_LOCATION_NORMALIZED,Y&&Y(),Y=null,l.value=START_LOCATION_NORMALIZED,ve=!1,Ae=!1),Ee()}}};function Ce(j){return j.reduce((ae,ie)=>ae.then(()=>M(ie)),Promise.resolve())}return Le}function extractChangingRecords(n,e){const t=[],r=[],i=[],s=Math.max(e.matched.length,n.matched.length);for(let o=0;o<s;o++){const a=e.matched[o];a&&(n.matched.find(c=>isSameRouteRecord(c,a))?r.push(a):t.push(a));const l=n.matched[o];l&&(e.matched.find(c=>isSameRouteRecord(c,l))||i.push(l))}return[t,r,i]}function useRoute(n){return inject(routeLocationKey)}const _export_sfc=(n,e)=>{const t=n.__vccOpts||n;for(const[r,i]of e)t[r]=i;return t},_hoisted_1$9={class:"dropdown dropdown-end"},_hoisted_2$7={tabindex:"0",role:"button",class:"btn btn-ghost btn-circle"},_hoisted_3$7={key:0,class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20"},_hoisted_4$7={key:1,class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20"},_hoisted_5$7={key:2,class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20"},_hoisted_6$7={key:3,class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20"},_hoisted_7$6={key:4,class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20"},_hoisted_8$6={key:5,class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20"},_hoisted_9$6={tabindex:"0",class:"dropdown-content z-[1] menu p-2 shadow-lg bg-base-200 rounded-box w-52"},_hoisted_10$4=["onClick"],_sfc_main$9={__name:"ThemeChanger",setup(n){const e=[{id:"light",name:"明亮模式",color:"#ffffff"},{id:"dark",name:"暗黑模式",color:"#1a1b1e"},{id:"corporate",name:"商务模式",color:"#f8fafc"},{id:"bumblebee",name:"蜜蜂模式",color:"#fef9c3"},{id:"cupcake",name:"清新模式",color:"#faf7f5"},{id:"emerald",name:"翠绿模式",color:"#059669"}],t=ref("light"),r=o=>{t.value=o,document.documentElement.setAttribute("data-theme",o),localStorage.setItem("theme",o)},i=()=>window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",s=()=>{window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",o=>{const a=o.matches?"dark":"light";(t.value==="light"||t.value==="dark")&&r(a)})};return onMounted(()=>{const a=localStorage.getItem("theme")||i();r(a),s()}),(o,a)=>(openBlock(),createElementBlock("div",_hoisted_1$9,[createBaseVNode("div",_hoisted_2$7,[t.value==="dark"?(openBlock(),createElementBlock("svg",_hoisted_3$7,a[0]||(a[0]=[createBaseVNode("path",{d:"M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"},null,-1)]))):t.value==="light"?(openBlock(),createElementBlock("svg",_hoisted_4$7,a[1]||(a[1]=[createBaseVNode("path",{"fill-rule":"evenodd",d:"M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z","clip-rule":"evenodd"},null,-1)]))):t.value==="corporate"?(openBlock(),createElementBlock("svg",_hoisted_5$7,a[2]||(a[2]=[createBaseVNode("path",{"fill-rule":"evenodd",d:"M4 4a2 2 0 012-2h8a2 2 0 012 2v12a1 1 0 110 2h-3a1 1 0 01-1-1v-2a1 1 0 00-1-1H9a1 1 0 00-1 1v2a1 1 0 01-1 1H4a1 1 0 110-2V4zm3 1h2v2H7V5zm2 4H7v2h2V9zm2-4h2v2h-2V5zm2 4h-2v2h2V9z","clip-rule":"evenodd"},null,-1)]))):t.value==="bumblebee"?(openBlock(),createElementBlock("svg",_hoisted_6$7,a[3]||(a[3]=[createBaseVNode("path",{d:"M10 3.5a6.5 6.5 0 100 13 6.5 6.5 0 000-13zM3.5 10a6.5 6.5 0 1113 0 6.5 6.5 0 01-13 0zm5.5 0a1 1 0 100 2h2a1 1 0 100-2H9zm-.75-3.5a1 1 0 100 2h3.5a1 1 0 100-2h-3.5z"},null,-1)]))):t.value==="cupcake"?(openBlock(),createElementBlock("svg",_hoisted_7$6,a[4]||(a[4]=[createBaseVNode("path",{d:"M10 12a2 2 0 100-4 2 2 0 000 4z"},null,-1),createBaseVNode("path",{"fill-rule":"evenodd",d:"M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z","clip-rule":"evenodd"},null,-1)]))):t.value==="emerald"?(openBlock(),createElementBlock("svg",_hoisted_8$6,a[5]||(a[5]=[createBaseVNode("path",{"fill-rule":"evenodd",d:"M6.672 1.911a1 1 0 10-1.932.518l.259.966a1 1 0 001.932-.518l-.26-.966zM2.429 4.74a1 1 0 10-.517 1.932l.966.259a1 1 0 00.517-1.932l-.966-.26zm8.814-.569a1 1 0 00-1.415-1.414l-.707.707a1 1 0 101.415 1.415l.707-.708zm-7.071 7.072l.707-.707A1 1 0 003.465 9.12l-.708.707a1 1 0 001.415 1.415zm3.2-5.171a1 1 0 00-1.3 1.3l4 10a1 1 0 001.823.075l1.38-2.759 3.018 3.02a1 1 0 001.414-1.415l-3.019-3.02 2.76-1.379a1 1 0 00-.076-1.822l-10-4z","clip-rule":"evenodd"},null,-1)]))):createCommentVNode("",!0)]),createBaseVNode("ul",_hoisted_9$6,[a[6]||(a[6]=createBaseVNode("li",{class:"menu-title pt-2 pb-2 text-base-content/60 text-sm font-medium"},"选择主题",-1)),a[7]||(a[7]=createBaseVNode("div",{class:"divider my-0"},null,-1)),(openBlock(),createElementBlock(Fragment$1,null,renderList(e,l=>createBaseVNode("li",{key:l.id},[createBaseVNode("button",{class:normalizeClass(["flex items-center gap-2 w-full px-4 py-2 hover:bg-base-300 rounded-lg transition-colors",{"bg-primary text-primary-content":t.value===l.id}]),onClick:c=>r(l.id)},[createBaseVNode("span",{class:"theme-color",style:normalizeStyle({backgroundColor:l.color})},null,4),createTextVNode(" "+toDisplayString(l.name),1)],10,_hoisted_10$4)])),64))])]))}},ThemeChanger=_export_sfc(_sfc_main$9,[["__scopeId","data-v-7f11a0d3"]]),_hoisted_1$8={class:"header-container"},_hoisted_2$6={class:"nav-wrapper"},_hoisted_3$6={class:"flex items-center"},_hoisted_4$6={xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},_hoisted_5$6={key:0,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h16"},_hoisted_6$6={key:1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"},_sfc_main$8={__name:"Header",setup(n){const e=useRoute(),t=ref(!1);let r=[{name:"二维码",url:"/qrcode"},{name:"表格",url:"/table"},{name:"jsfuck",url:"/jsfuck"},{name:"devtools",url:"/devtools"},{name:"ipv6",url:"/ipv6"},{name:"player",url:"/player"}];return(i,s)=>{const o=resolveComponent("router-link");return openBlock(),createElementBlock("header",_hoisted_1$8,[createBaseVNode("nav",_hoisted_2$6,[s[2]||(s[2]=createBaseVNode("div",{class:"logo"},[createBaseVNode("img",{src:_imports_0$1,alt:"Logo"}),createBaseVNode("span",{class:"site-title"},"小康黑科技")],-1)),createBaseVNode("div",_hoisted_3$6,[createBaseVNode("div",{class:normalizeClass(["nav-links",{"nav-links-mobile":t.value}])},[(openBlock(!0),createElementBlock(Fragment$1,null,renderList(unref(r),a=>(openBlock(),createBlock(o,{key:a.url,to:a.url,class:normalizeClass({active:unref(e).path===a.url}),onClick:s[0]||(s[0]=l=>t.value=!1)},{default:withCtx(()=>[createTextVNode(toDisplayString(a.name),1)]),_:2},1032,["to","class"]))),128))],2),createVNode(ThemeChanger,{class:"ml-4"}),createBaseVNode("button",{class:"menu-btn md:hidden",onClick:s[1]||(s[1]=a=>t.value=!t.value)},[(openBlock(),createElementBlock("svg",_hoisted_4$6,[t.value?(openBlock(),createElementBlock("path",_hoisted_6$6)):(openBlock(),createElementBlock("path",_hoisted_5$6))]))])])])])}}},Header=_export_sfc(_sfc_main$8,[["__scopeId","data-v-d77f2c00"]]),_sfc_main$7={},_hoisted_1$7={class:"footer"};function _sfc_render(n,e){return openBlock(),createElementBlock("footer",_hoisted_1$7,e[0]||(e[0]=[createTextVNode(" Copyright © 冀小康 2024 by "),createBaseVNode("a",{href:"https://github.com/xkloveme/black-tool",target:"_blank"},"xkloveme",-1),createBaseVNode("iframe",{style:{"margin-left":"2px","margin-bottom":"-5px"},frameborder:"0",scrolling:"0",width:"91px",height:"20px",src:"https://ghbtns.com/github-btn.html?user=xkloveme&repo=black-tool&type=star&count=true"},null,-1)]))}const Footer=_export_sfc(_sfc_main$7,[["render",_sfc_render]]),_hoisted_1$6={class:"flex-grow p-4"},_sfc_main$6={__name:"App",setup(n){const e=ref("");return onMounted(()=>{e.value=localStorage.getItem("theme")||"light",new MutationObserver(r=>{r.forEach(i=>{i.attributeName==="data-theme"&&(e.value=document.documentElement.getAttribute("data-theme"))})}).observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]})}),(t,r)=>{const i=resolveComponent("router-view");return openBlock(),createElementBlock("div",{id:"app",class:normalizeClass(["min-h-screen flex flex-col",`theme-${e.value}`])},[createVNode(Header),createBaseVNode("main",_hoisted_1$6,[createVNode(i)]),createVNode(Footer)],2)}}};var isVue2=!1;/*!
  * pinia v2.1.0
  * (c) 2023 Eduardo San Martin Morote
  * @license MIT
  */let activePinia;const setActivePinia=n=>activePinia=n,piniaSymbol=Symbol();function isPlainObject(n){return n&&typeof n=="object"&&Object.prototype.toString.call(n)==="[object Object]"&&typeof n.toJSON!="function"}var MutationType;(function(n){n.direct="direct",n.patchObject="patch object",n.patchFunction="patch function"})(MutationType||(MutationType={}));function createPinia(){const n=effectScope(!0),e=n.run(()=>ref({}));let t=[],r=[];const i=markRaw({install(s){setActivePinia(i),i._a=s,s.provide(piniaSymbol,i),s.config.globalProperties.$pinia=i,r.forEach(o=>t.push(o)),r=[]},use(s){return!this._a&&!isVue2?r.push(s):t.push(s),this},_p:t,_a:null,_e:n,_s:new Map,state:e});return i}const noop$1=()=>{};function addSubscription(n,e,t,r=noop$1){n.push(e);const i=()=>{const s=n.indexOf(e);s>-1&&(n.splice(s,1),r())};return!t&&getCurrentScope()&&onScopeDispose(i),i}function triggerSubscriptions(n,...e){n.slice().forEach(t=>{t(...e)})}const fallbackRunWithContext=n=>n();function mergeReactiveObjects(n,e){n instanceof Map&&e instanceof Map&&e.forEach((t,r)=>n.set(r,t)),n instanceof Set&&e instanceof Set&&e.forEach(n.add,n);for(const t in e){if(!e.hasOwnProperty(t))continue;const r=e[t],i=n[t];isPlainObject(i)&&isPlainObject(r)&&n.hasOwnProperty(t)&&!isRef(r)&&!isReactive(r)?n[t]=mergeReactiveObjects(i,r):n[t]=r}return n}const skipHydrateSymbol=Symbol();function shouldHydrate(n){return!isPlainObject(n)||!n.hasOwnProperty(skipHydrateSymbol)}const{assign}=Object;function isComputed(n){return!!(isRef(n)&&n.effect)}function createOptionsStore(n,e,t,r){const{state:i,actions:s,getters:o}=e,a=t.state.value[n];let l;function c(){a||(t.state.value[n]=i?i():{});const u=toRefs(t.state.value[n]);return assign(u,s,Object.keys(o||{}).reduce((d,f)=>(d[f]=markRaw(computed(()=>{setActivePinia(t);const m=t._s.get(n);return o[f].call(m,m)})),d),{}))}return l=createSetupStore(n,c,e,t,r,!0),l}function createSetupStore(n,e,t={},r,i,s){let o;const a=assign({actions:{}},t),l={deep:!0};let c,u,d=[],f=[],m;const g=r.state.value[n];!s&&!g&&(r.state.value[n]={}),ref({});let v;function x(U){let M;c=u=!1,typeof U=="function"?(U(r.state.value[n]),M={type:MutationType.patchFunction,storeId:n,events:m}):(mergeReactiveObjects(r.state.value[n],U),M={type:MutationType.patchObject,payload:U,storeId:n,events:m});const B=v=Symbol();nextTick().then(()=>{v===B&&(c=!0)}),u=!0,triggerSubscriptions(d,M,r.state.value[n])}const S=s?function(){const{state:M}=t,B=M?M():{};this.$patch(H=>{assign(H,B)})}:noop$1;function C(){o.stop(),d=[],f=[],r._s.delete(n)}function R(U,M){return function(){setActivePinia(r);const B=Array.from(arguments),H=[],K=[];function Y(Z){H.push(Z)}function oe(Z){K.push(Z)}triggerSubscriptions(f,{args:B,name:U,store:I,after:Y,onError:oe});let ue;try{ue=M.apply(this&&this.$id===n?this:I,B)}catch(Z){throw triggerSubscriptions(K,Z),Z}return ue instanceof Promise?ue.then(Z=>(triggerSubscriptions(H,Z),Z)).catch(Z=>(triggerSubscriptions(K,Z),Promise.reject(Z))):(triggerSubscriptions(H,ue),ue)}}const k={_p:r,$id:n,$onAction:addSubscription.bind(null,f),$patch:x,$reset:S,$subscribe(U,M={}){const B=addSubscription(d,U,M.detached,()=>H()),H=o.run(()=>watch(()=>r.state.value[n],K=>{(M.flush==="sync"?u:c)&&U({storeId:n,type:MutationType.direct,events:m},K)},assign({},l,M)));return B},$dispose:C},I=reactive(k);r._s.set(n,I);const F=r._a&&r._a.runWithContext||fallbackRunWithContext,N=r._e.run(()=>(o=effectScope(),F(()=>o.run(e))));for(const U in N){const M=N[U];if(isRef(M)&&!isComputed(M)||isReactive(M))s||(g&&shouldHydrate(M)&&(isRef(M)?M.value=g[U]:mergeReactiveObjects(M,g[U])),r.state.value[n][U]=M);else if(typeof M=="function"){const B=R(U,M);N[U]=B,a.actions[U]=M}}return assign(I,N),assign(toRaw(I),N),Object.defineProperty(I,"$state",{get:()=>r.state.value[n],set:U=>{x(M=>{assign(M,U)})}}),r._p.forEach(U=>{assign(I,o.run(()=>U({store:I,app:r._a,pinia:r,options:a})))}),g&&s&&t.hydrate&&t.hydrate(I.$state,g),c=!0,u=!0,I}function defineStore(n,e,t){let r,i;const s=typeof e=="function";r=n,i=s?t:e;function o(a,l){const c=hasInjectionContext();return a=a||(c?inject(piniaSymbol,null):null),a&&setActivePinia(a),a=activePinia,a._s.has(r)||(s?createSetupStore(r,e,i,a):createOptionsStore(r,i,a)),a._s.get(r)}return o.$id=r,o}function storeToRefs(n){{n=toRaw(n);const e={};for(const t in n){const r=n[t];(isRef(r)||isReactive(r))&&(e[t]=toRef(n,t))}return e}}const updateStorage=(n,e)=>{const t=n.storage||sessionStorage,r=n.key||e.$id;if(n.paths){const i=n.paths.reduce((s,o)=>(s[o]=e.$state[o],s),{});t.setItem(r,JSON.stringify(i))}else t.setItem(r,JSON.stringify(e.$state))};var index=({options:n,store:e})=>{var t,r,i,s;if((t=n.persist)!=null&&t.enabled){const o=[{key:e.$id,storage:sessionStorage}],a=(i=(r=n.persist)==null?void 0:r.strategies)!=null&&i.length?(s=n.persist)==null?void 0:s.strategies:o;a.forEach(l=>{const c=l.storage||sessionStorage,u=l.key||e.$id,d=c.getItem(u);d&&(e.$patch(JSON.parse(d)),updateStorage(l,e))}),e.$subscribe(()=>{a.forEach(l=>{updateStorage(l,e)})})}};/*!
 * qrcode.vue v3.6.0
 * A Vue.js component to generate QRCode. Both support Vue 2 and Vue 3
 * © 2017-PRESENT @scopewu(https://github.com/scopewu)
 * MIT License.
 */var __assign=function(){return __assign=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},__assign.apply(this,arguments)};typeof SuppressedError=="function"&&SuppressedError;var qrcodegen;(function(n){var e=function(){function o(a,l,c,u){if(this.version=a,this.errorCorrectionLevel=l,this.modules=[],this.isFunction=[],a<o.MIN_VERSION||a>o.MAX_VERSION)throw new RangeError("Version value out of range");if(u<-1||u>7)throw new RangeError("Mask value out of range");this.size=a*4+17;for(var d=[],f=0;f<this.size;f++)d.push(!1);for(var f=0;f<this.size;f++)this.modules.push(d.slice()),this.isFunction.push(d.slice());this.drawFunctionPatterns();var m=this.addEccAndInterleave(c);if(this.drawCodewords(m),u==-1)for(var g=1e9,f=0;f<8;f++){this.applyMask(f),this.drawFormatBits(f);var v=this.getPenaltyScore();v<g&&(u=f,g=v),this.applyMask(f)}i(0<=u&&u<=7),this.mask=u,this.applyMask(u),this.drawFormatBits(u),this.isFunction=[]}return o.encodeText=function(a,l){var c=n.QrSegment.makeSegments(a);return o.encodeSegments(c,l)},o.encodeBinary=function(a,l){var c=n.QrSegment.makeBytes(a);return o.encodeSegments([c],l)},o.encodeSegments=function(a,l,c,u,d,f){if(c===void 0&&(c=1),u===void 0&&(u=40),d===void 0&&(d=-1),f===void 0&&(f=!0),!(o.MIN_VERSION<=c&&c<=u&&u<=o.MAX_VERSION)||d<-1||d>7)throw new RangeError("Invalid value");var m,g;for(m=c;;m++){var v=o.getNumDataCodewords(m,l)*8,x=s.getTotalBits(a,m);if(x<=v){g=x;break}if(m>=u)throw new RangeError("Data too long")}for(var S=0,C=[o.Ecc.MEDIUM,o.Ecc.QUARTILE,o.Ecc.HIGH];S<C.length;S++){var R=C[S];f&&g<=o.getNumDataCodewords(m,R)*8&&(l=R)}for(var k=[],I=0,F=a;I<F.length;I++){var N=F[I];t(N.mode.modeBits,4,k),t(N.numChars,N.mode.numCharCountBits(m),k);for(var U=0,M=N.getData();U<M.length;U++){var B=M[U];k.push(B)}}i(k.length==g);var H=o.getNumDataCodewords(m,l)*8;i(k.length<=H),t(0,Math.min(4,H-k.length),k),t(0,(8-k.length%8)%8,k),i(k.length%8==0);for(var K=236;k.length<H;K^=253)t(K,8,k);for(var Y=[];Y.length*8<k.length;)Y.push(0);return k.forEach(function(oe,ue){return Y[ue>>>3]|=oe<<7-(ue&7)}),new o(m,l,Y,d)},o.prototype.getModule=function(a,l){return 0<=a&&a<this.size&&0<=l&&l<this.size&&this.modules[l][a]},o.prototype.getModules=function(){return this.modules},o.prototype.drawFunctionPatterns=function(){for(var a=0;a<this.size;a++)this.setFunctionModule(6,a,a%2==0),this.setFunctionModule(a,6,a%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);for(var l=this.getAlignmentPatternPositions(),c=l.length,a=0;a<c;a++)for(var u=0;u<c;u++)a==0&&u==0||a==0&&u==c-1||a==c-1&&u==0||this.drawAlignmentPattern(l[a],l[u]);this.drawFormatBits(0),this.drawVersion()},o.prototype.drawFormatBits=function(a){for(var l=this.errorCorrectionLevel.formatBits<<3|a,c=l,u=0;u<10;u++)c=c<<1^(c>>>9)*1335;var d=(l<<10|c)^21522;i(d>>>15==0);for(var u=0;u<=5;u++)this.setFunctionModule(8,u,r(d,u));this.setFunctionModule(8,7,r(d,6)),this.setFunctionModule(8,8,r(d,7)),this.setFunctionModule(7,8,r(d,8));for(var u=9;u<15;u++)this.setFunctionModule(14-u,8,r(d,u));for(var u=0;u<8;u++)this.setFunctionModule(this.size-1-u,8,r(d,u));for(var u=8;u<15;u++)this.setFunctionModule(8,this.size-15+u,r(d,u));this.setFunctionModule(8,this.size-8,!0)},o.prototype.drawVersion=function(){if(!(this.version<7)){for(var a=this.version,l=0;l<12;l++)a=a<<1^(a>>>11)*7973;var c=this.version<<12|a;i(c>>>18==0);for(var l=0;l<18;l++){var u=r(c,l),d=this.size-11+l%3,f=Math.floor(l/3);this.setFunctionModule(d,f,u),this.setFunctionModule(f,d,u)}}},o.prototype.drawFinderPattern=function(a,l){for(var c=-4;c<=4;c++)for(var u=-4;u<=4;u++){var d=Math.max(Math.abs(u),Math.abs(c)),f=a+u,m=l+c;0<=f&&f<this.size&&0<=m&&m<this.size&&this.setFunctionModule(f,m,d!=2&&d!=4)}},o.prototype.drawAlignmentPattern=function(a,l){for(var c=-2;c<=2;c++)for(var u=-2;u<=2;u++)this.setFunctionModule(a+u,l+c,Math.max(Math.abs(u),Math.abs(c))!=1)},o.prototype.setFunctionModule=function(a,l,c){this.modules[l][a]=c,this.isFunction[l][a]=!0},o.prototype.addEccAndInterleave=function(a){var l=this.version,c=this.errorCorrectionLevel;if(a.length!=o.getNumDataCodewords(l,c))throw new RangeError("Invalid argument");for(var u=o.NUM_ERROR_CORRECTION_BLOCKS[c.ordinal][l],d=o.ECC_CODEWORDS_PER_BLOCK[c.ordinal][l],f=Math.floor(o.getNumRawDataModules(l)/8),m=u-f%u,g=Math.floor(f/u),v=[],x=o.reedSolomonComputeDivisor(d),S=0,C=0;S<u;S++){var R=a.slice(C,C+g-d+(S<m?0:1));C+=R.length;var k=o.reedSolomonComputeRemainder(R,x);S<m&&R.push(0),v.push(R.concat(k))}for(var I=[],F=function(N){v.forEach(function(U,M){(N!=g-d||M>=m)&&I.push(U[N])})},S=0;S<v[0].length;S++)F(S);return i(I.length==f),I},o.prototype.drawCodewords=function(a){if(a.length!=Math.floor(o.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");for(var l=0,c=this.size-1;c>=1;c-=2){c==6&&(c=5);for(var u=0;u<this.size;u++)for(var d=0;d<2;d++){var f=c-d,m=(c+1&2)==0,g=m?this.size-1-u:u;!this.isFunction[g][f]&&l<a.length*8&&(this.modules[g][f]=r(a[l>>>3],7-(l&7)),l++)}}i(l==a.length*8)},o.prototype.applyMask=function(a){if(a<0||a>7)throw new RangeError("Mask value out of range");for(var l=0;l<this.size;l++)for(var c=0;c<this.size;c++){var u=void 0;switch(a){case 0:u=(c+l)%2==0;break;case 1:u=l%2==0;break;case 2:u=c%3==0;break;case 3:u=(c+l)%3==0;break;case 4:u=(Math.floor(c/3)+Math.floor(l/2))%2==0;break;case 5:u=c*l%2+c*l%3==0;break;case 6:u=(c*l%2+c*l%3)%2==0;break;case 7:u=((c+l)%2+c*l%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[l][c]&&u&&(this.modules[l][c]=!this.modules[l][c])}},o.prototype.getPenaltyScore=function(){for(var a=0,l=0;l<this.size;l++){for(var c=!1,u=0,d=[0,0,0,0,0,0,0],f=0;f<this.size;f++)this.modules[l][f]==c?(u++,u==5?a+=o.PENALTY_N1:u>5&&a++):(this.finderPenaltyAddHistory(u,d),c||(a+=this.finderPenaltyCountPatterns(d)*o.PENALTY_N3),c=this.modules[l][f],u=1);a+=this.finderPenaltyTerminateAndCount(c,u,d)*o.PENALTY_N3}for(var f=0;f<this.size;f++){for(var c=!1,m=0,d=[0,0,0,0,0,0,0],l=0;l<this.size;l++)this.modules[l][f]==c?(m++,m==5?a+=o.PENALTY_N1:m>5&&a++):(this.finderPenaltyAddHistory(m,d),c||(a+=this.finderPenaltyCountPatterns(d)*o.PENALTY_N3),c=this.modules[l][f],m=1);a+=this.finderPenaltyTerminateAndCount(c,m,d)*o.PENALTY_N3}for(var l=0;l<this.size-1;l++)for(var f=0;f<this.size-1;f++){var g=this.modules[l][f];g==this.modules[l][f+1]&&g==this.modules[l+1][f]&&g==this.modules[l+1][f+1]&&(a+=o.PENALTY_N2)}for(var v=0,x=0,S=this.modules;x<S.length;x++){var C=S[x];v=C.reduce(function(I,F){return I+(F?1:0)},v)}var R=this.size*this.size,k=Math.ceil(Math.abs(v*20-R*10)/R)-1;return i(0<=k&&k<=9),a+=k*o.PENALTY_N4,i(0<=a&&a<=2568888),a},o.prototype.getAlignmentPatternPositions=function(){if(this.version==1)return[];for(var a=Math.floor(this.version/7)+2,l=Math.floor((this.version*8+a*3+5)/(a*4-4))*2,c=[6],u=this.size-7;c.length<a;u-=l)c.splice(1,0,u);return c},o.getNumRawDataModules=function(a){if(a<o.MIN_VERSION||a>o.MAX_VERSION)throw new RangeError("Version number out of range");var l=(16*a+128)*a+64;if(a>=2){var c=Math.floor(a/7)+2;l-=(25*c-10)*c-55,a>=7&&(l-=36)}return i(208<=l&&l<=29648),l},o.getNumDataCodewords=function(a,l){return Math.floor(o.getNumRawDataModules(a)/8)-o.ECC_CODEWORDS_PER_BLOCK[l.ordinal][a]*o.NUM_ERROR_CORRECTION_BLOCKS[l.ordinal][a]},o.reedSolomonComputeDivisor=function(a){if(a<1||a>255)throw new RangeError("Degree out of range");for(var l=[],c=0;c<a-1;c++)l.push(0);l.push(1);for(var u=1,c=0;c<a;c++){for(var d=0;d<l.length;d++)l[d]=o.reedSolomonMultiply(l[d],u),d+1<l.length&&(l[d]^=l[d+1]);u=o.reedSolomonMultiply(u,2)}return l},o.reedSolomonComputeRemainder=function(a,l){for(var c=l.map(function(g){return 0}),u=function(g){var v=g^c.shift();c.push(0),l.forEach(function(x,S){return c[S]^=o.reedSolomonMultiply(x,v)})},d=0,f=a;d<f.length;d++){var m=f[d];u(m)}return c},o.reedSolomonMultiply=function(a,l){if(a>>>8||l>>>8)throw new RangeError("Byte out of range");for(var c=0,u=7;u>=0;u--)c=c<<1^(c>>>7)*285,c^=(l>>>u&1)*a;return i(c>>>8==0),c},o.prototype.finderPenaltyCountPatterns=function(a){var l=a[1];i(l<=this.size*3);var c=l>0&&a[2]==l&&a[3]==l*3&&a[4]==l&&a[5]==l;return(c&&a[0]>=l*4&&a[6]>=l?1:0)+(c&&a[6]>=l*4&&a[0]>=l?1:0)},o.prototype.finderPenaltyTerminateAndCount=function(a,l,c){return a&&(this.finderPenaltyAddHistory(l,c),l=0),l+=this.size,this.finderPenaltyAddHistory(l,c),this.finderPenaltyCountPatterns(c)},o.prototype.finderPenaltyAddHistory=function(a,l){l[0]==0&&(a+=this.size),l.pop(),l.unshift(a)},o.MIN_VERSION=1,o.MAX_VERSION=40,o.PENALTY_N1=3,o.PENALTY_N2=3,o.PENALTY_N3=40,o.PENALTY_N4=10,o.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],o.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],o}();n.QrCode=e;function t(o,a,l){if(a<0||a>31||o>>>a)throw new RangeError("Value out of range");for(var c=a-1;c>=0;c--)l.push(o>>>c&1)}function r(o,a){return(o>>>a&1)!=0}function i(o){if(!o)throw new Error("Assertion error")}var s=function(){function o(a,l,c){if(this.mode=a,this.numChars=l,this.bitData=c,l<0)throw new RangeError("Invalid argument");this.bitData=c.slice()}return o.makeBytes=function(a){for(var l=[],c=0,u=a;c<u.length;c++){var d=u[c];t(d,8,l)}return new o(o.Mode.BYTE,a.length,l)},o.makeNumeric=function(a){if(!o.isNumeric(a))throw new RangeError("String contains non-numeric characters");for(var l=[],c=0;c<a.length;){var u=Math.min(a.length-c,3);t(parseInt(a.substring(c,c+u),10),u*3+1,l),c+=u}return new o(o.Mode.NUMERIC,a.length,l)},o.makeAlphanumeric=function(a){if(!o.isAlphanumeric(a))throw new RangeError("String contains unencodable characters in alphanumeric mode");var l=[],c;for(c=0;c+2<=a.length;c+=2){var u=o.ALPHANUMERIC_CHARSET.indexOf(a.charAt(c))*45;u+=o.ALPHANUMERIC_CHARSET.indexOf(a.charAt(c+1)),t(u,11,l)}return c<a.length&&t(o.ALPHANUMERIC_CHARSET.indexOf(a.charAt(c)),6,l),new o(o.Mode.ALPHANUMERIC,a.length,l)},o.makeSegments=function(a){return a==""?[]:o.isNumeric(a)?[o.makeNumeric(a)]:o.isAlphanumeric(a)?[o.makeAlphanumeric(a)]:[o.makeBytes(o.toUtf8ByteArray(a))]},o.makeEci=function(a){var l=[];if(a<0)throw new RangeError("ECI assignment value out of range");if(a<128)t(a,8,l);else if(a<16384)t(2,2,l),t(a,14,l);else if(a<1e6)t(6,3,l),t(a,21,l);else throw new RangeError("ECI assignment value out of range");return new o(o.Mode.ECI,0,l)},o.isNumeric=function(a){return o.NUMERIC_REGEX.test(a)},o.isAlphanumeric=function(a){return o.ALPHANUMERIC_REGEX.test(a)},o.prototype.getData=function(){return this.bitData.slice()},o.getTotalBits=function(a,l){for(var c=0,u=0,d=a;u<d.length;u++){var f=d[u],m=f.mode.numCharCountBits(l);if(f.numChars>=1<<m)return 1/0;c+=4+m+f.bitData.length}return c},o.toUtf8ByteArray=function(a){a=encodeURI(a);for(var l=[],c=0;c<a.length;c++)a.charAt(c)!="%"?l.push(a.charCodeAt(c)):(l.push(parseInt(a.substring(c+1,c+3),16)),c+=2);return l},o.NUMERIC_REGEX=/^[0-9]*$/,o.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,o.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",o}();n.QrSegment=s})(qrcodegen||(qrcodegen={}));(function(n){(function(e){var t=function(){function r(i,s){this.ordinal=i,this.formatBits=s}return r.LOW=new r(0,1),r.MEDIUM=new r(1,0),r.QUARTILE=new r(2,3),r.HIGH=new r(3,2),r}();e.Ecc=t})(n.QrCode||(n.QrCode={}))})(qrcodegen||(qrcodegen={}));(function(n){(function(e){var t=function(){function r(i,s){this.modeBits=i,this.numBitsCharCount=s}return r.prototype.numCharCountBits=function(i){return this.numBitsCharCount[Math.floor((i+7)/17)]},r.NUMERIC=new r(1,[10,12,14]),r.ALPHANUMERIC=new r(2,[9,11,13]),r.BYTE=new r(4,[8,16,16]),r.KANJI=new r(8,[8,10,12]),r.ECI=new r(7,[0,0,0]),r}();e.Mode=t})(n.QrSegment||(n.QrSegment={}))})(qrcodegen||(qrcodegen={}));var QR=qrcodegen,defaultErrorCorrectLevel="L",ErrorCorrectLevelMap={L:QR.QrCode.Ecc.LOW,M:QR.QrCode.Ecc.MEDIUM,Q:QR.QrCode.Ecc.QUARTILE,H:QR.QrCode.Ecc.HIGH},SUPPORTS_PATH2D=function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0}();function validErrorCorrectLevel(n){return n in ErrorCorrectLevelMap}function generatePath(n,e){e===void 0&&(e=0);var t=[];return n.forEach(function(r,i){var s=null;r.forEach(function(o,a){if(!o&&s!==null){t.push("M".concat(s+e," ").concat(i+e,"h").concat(a-s,"v1H").concat(s+e,"z")),s=null;return}if(a===r.length-1){if(!o)return;s===null?t.push("M".concat(a+e,",").concat(i+e," h1v1H").concat(a+e,"z")):t.push("M".concat(s+e,",").concat(i+e," h").concat(a+1-s,"v1H").concat(s+e,"z"));return}o&&s===null&&(s=a)})}),t.join("")}function getImageSettings(n,e,t,r){var i=r.width,s=r.height,o=r.x,a=r.y,l=n.length+t*2,c=Math.floor(e*.1),u=l/e,d=(i||c)*u,f=(s||c)*u,m=o==null?n.length/2-d/2:o*u,g=a==null?n.length/2-f/2:a*u,v=null;if(r.excavate){var x=Math.floor(m),S=Math.floor(g),C=Math.ceil(d+m-x),R=Math.ceil(f+g-S);v={x,y:S,w:C,h:R}}return{x:m,y:g,h:f,w:d,excavation:v}}function excavateModules(n,e){return n.slice().map(function(t,r){return r<e.y||r>=e.y+e.h?t:t.map(function(i,s){return s<e.x||s>=e.x+e.w?i:!1})})}var QRCodeProps={value:{type:String,required:!0,default:""},size:{type:Number,default:100},level:{type:String,default:defaultErrorCorrectLevel,validator:function(n){return validErrorCorrectLevel(n)}},background:{type:String,default:"#fff"},foreground:{type:String,default:"#000"},margin:{type:Number,required:!1,default:0},imageSettings:{type:Object,required:!1,default:function(){return{}}},gradient:{type:Boolean,required:!1,default:!1},gradientType:{type:String,required:!1,default:"linear",validator:function(n){return["linear","radial"].indexOf(n)>-1}},gradientStartColor:{type:String,required:!1,default:"#000"},gradientEndColor:{type:String,required:!1,default:"#fff"}},QRCodeVueProps=__assign(__assign({},QRCodeProps),{renderAs:{type:String,required:!1,default:"canvas",validator:function(n){return["canvas","svg"].indexOf(n)>-1}}}),QrcodeSvg=defineComponent({name:"QRCodeSvg",props:QRCodeProps,setup:function(n){var e=ref(0),t=ref(""),r,i=function(){var o=n.value,a=n.level,l=n.margin,c=l>>>0,u=validErrorCorrectLevel(a)?a:defaultErrorCorrectLevel,d=QR.QrCode.encodeText(o,ErrorCorrectLevelMap[u]).getModules();if(e.value=d.length+c*2,n.imageSettings.src){var f=getImageSettings(d,n.size,c,n.imageSettings);r={x:f.x+c,y:f.y+c,width:f.w,height:f.h},f.excavation&&(d=excavateModules(d,f.excavation))}t.value=generatePath(d,c)},s=function(){if(!n.gradient)return null;var o=n.gradientType==="linear"?{x1:"0%",y1:"0%",x2:"100%",y2:"100%"}:{cx:"50%",cy:"50%",r:"50%",fx:"50%",fy:"50%"};return h(n.gradientType==="linear"?"linearGradient":"radialGradient",__assign({id:"qr-gradient"},o),[h("stop",{offset:"0%",style:{stopColor:n.gradientStartColor}}),h("stop",{offset:"100%",style:{stopColor:n.gradientEndColor}})])};return i(),onUpdated(i),function(){return h("svg",{width:n.size,height:n.size,"shape-rendering":"crispEdges",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(e.value," ").concat(e.value)},[h("defs",{},[s()]),h("rect",{width:"100%",height:"100%",fill:n.background}),h("path",{fill:n.gradient?"url(#qr-gradient)":n.foreground,d:t.value}),n.imageSettings.src&&h("image",__assign({href:n.imageSettings.src},r))])}}}),QrcodeCanvas=defineComponent({name:"QRCodeCanvas",props:QRCodeProps,setup:function(n,e){var t=ref(null),r=ref(null),i=function(){var o=n.value,a=n.level,l=n.size,c=n.margin,u=n.background,d=n.foreground,f=n.gradient,m=n.gradientType,g=n.gradientStartColor,v=n.gradientEndColor,x=c>>>0,S=validErrorCorrectLevel(a)?a:defaultErrorCorrectLevel,C=t.value;if(C){var R=C.getContext("2d");if(R){var k=QR.QrCode.encodeText(o,ErrorCorrectLevelMap[S]).getModules(),I=k.length+x*2,F=r.value,N={x:0,y:0,width:0,height:0},U=n.imageSettings.src&&F!=null&&F.naturalWidth!==0&&F.naturalHeight!==0;if(U){var M=getImageSettings(k,n.size,x,n.imageSettings);N={x:M.x+x,y:M.y+x,width:M.w,height:M.h},M.excavation&&(k=excavateModules(k,M.excavation))}var B=window.devicePixelRatio||1,H=l/I*B;if(C.height=C.width=l*B,R.scale(H,H),R.fillStyle=u,R.fillRect(0,0,I,I),f){var K=void 0;m==="linear"?K=R.createLinearGradient(0,0,I,I):K=R.createRadialGradient(I/2,I/2,0,I/2,I/2,I/2),K.addColorStop(0,g),K.addColorStop(1,v),R.fillStyle=K}else R.fillStyle=d;SUPPORTS_PATH2D?R.fill(new Path2D(generatePath(k,x))):k.forEach(function(Y,oe){Y.forEach(function(ue,Z){ue&&R.fillRect(Z+x,oe+x,1,1)})}),U&&R.drawImage(F,N.x,N.y,N.width,N.height)}}};onMounted(i),onUpdated(i);var s=e.attrs.style;return function(){return h(Fragment$1,[h("canvas",__assign(__assign({},e.attrs),{ref:t,style:__assign(__assign({},s),{width:"".concat(n.size,"px"),height:"".concat(n.size,"px")})})),n.imageSettings.src&&h("img",{ref:r,src:n.imageSettings.src,style:{display:"none"},onLoad:i})])}}}),QrcodeVue=defineComponent({name:"Qrcode",render:function(){var n=this.$props,e=n.renderAs,t=n.value,r=n.size,i=n.margin,s=n.level,o=n.background,a=n.foreground,l=n.imageSettings,c=n.gradient,u=n.gradientType,d=n.gradientStartColor,f=n.gradientEndColor;return h(e==="svg"?QrcodeSvg:QrcodeCanvas,{value:t,size:r,margin:i,level:s,background:o,foreground:a,imageSettings:l,gradient:c,gradientType:u,gradientStartColor:d,gradientEndColor:f})},props:QRCodeVueProps});const userStore=defineStore("user",{state:()=>({SM4Key:"",urlList:[]}),getters:{getkey(){return this.SM4Key}},actions:{addKey(n){this.SM4Key=n},addUrl(n){this.urlList.push(n)}},persist:{enabled:!0,strategies:[{storage:localStorage}]}}),config=[{name:"护廉天目",key:"2001921668",url:"h5:https://hltm.jw.linan.gov.cn/zzd/#/,pc:https://hltm.jw.linan.gov.cn/zzd/nginx/client-web/index.html#/"},{name:"出国境一点通(临安)",key:"2002207948",url:"h5:https://hltm.jw.linan.gov.cn/zzd/laft-h5/#/,pc:https://hltm.jw.linan.gov.cn/linanjiwei/aa/index.html"},{name:"一网监督(嘉善)",key:"2002271810",url:"h5:https://ywjd.jiashan.gov.cn:8443/zlb/#/"},{name:"国境一网通(拱墅)",key:"2002387421",url:"h5:https://gscgj.gongshu.gov.cn/zzd/#/"},{name:"拱墅街道权力(拱墅)",key:"2002387354",url:"h5:https://jdql.gongshu.gov.cn/zzd/#/"},{name:"青锋号角",key:"2001950901",url:"h5:https://xihuyouth.hzxh.gov.cn/zlb/#/"},{name:"绍兴二期",key:"2002389987",url:"h5:https://health.sxws.gov.cn/zxtyjzd/sx-parent/#/"},{name:"婴育一件事(宁海托育)",key:"2001895658",url:"h5:https://nhty.healthnh.cn/goodeducation/#/"}],_hoisted_1$5={class:"main p-4 bg-base-100"},_hoisted_2$5={role:"alert",class:"alert shadow-lg bg-base-200 p-4 rounded-lg flex flex-col md:flex-row items-center"},_hoisted_3$5=["value"],_hoisted_4$5={class:"flex w-full flex-wrap mt-4 gap-4"},_hoisted_5$5={class:"grid flex-grow card bg-base-200 rounded-lg shadow-md p-4 place-items-center"},_hoisted_6$5=["href"],_hoisted_7$5={class:"grid flex-grow card bg-base-200 rounded-lg shadow-md p-4 place-items-center"},_hoisted_8$5={id:"my_modal_3",class:"modal"},_hoisted_9$5={class:"modal-box w-11/12 max-w-5xl bg-base-200"},_hoisted_10$3={class:"w-full"},_hoisted_11$2={class:"w-full"},_hoisted_12$2={id:"my_modal_4",class:"modal"},_hoisted_13$2={class:"modal-box max-w-5xl bg-base-300"},_hoisted_14$2={class:"table w-full table-zebra"},_hoisted_15$2={class:"flex w-30 mt-4"},_hoisted_16$2=["onClick"],_hoisted_17$2={method:"dialog"},_hoisted_18$2=["onClick"],_hoisted_19$2={class:"w-5/6 overflow-hidden"},_hoisted_20$2=["href"],_hoisted_21$2={class:"badge badge-ghost badge-lg p-2"},_sfc_main$5={__name:"Qrcode",setup(n){const{urlList:e}=storeToRefs(userStore());console.log("===🐛=== ~ file: Qrcode.vue:112 ~ store:",e);let t=ref("2002271810"),r=ref(""),i=computed(()=>`https://mapi.zjzwfw.gov.cn/web/mgop/gov-open/zj/${t.value}/lastTest/jump.html?url=${encodeURIComponent(r.value)}`),s=ref({title:"",url:""}),o=ref("");ref();function a(){r.value?(s.value.url=r.value,o.value=r.value,fetch(r.value).then(m=>m.text()).then(m=>{let g=m.match(/<title>(.*?)<\/title>/);s.value.title=g[1],my_modal_3.showModal()}).catch(()=>{s.value.title="",my_modal_3.showModal()})):alert("请输入链接")}function l(){s.value.title&&s.value.url&&e.value.unshift(JSON.parse(JSON.stringify(s.value)))}function c(m){e.value.splice(m,1)}function u(m){r.value=m.url,console.log(s.value)}const d=ref(null);return(()=>{nextTick(()=>{d.value.focus()})})(),(m,g)=>(openBlock(),createElementBlock("div",_hoisted_1$5,[createBaseVNode("div",_hoisted_2$5,[g[7]||(g[7]=createStaticVNode('<svg xmlns="http://www.w3.org/2000/svg" class="stroke-current shrink-0 h-8 w-8 text-primary" fill="none" viewBox="0 0 24 24" data-v-90a9eadb><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" data-v-90a9eadb></path></svg><div class="w-full text-center" data-v-90a9eadb><h1 class="font-bold text-primary text-xl" data-v-90a9eadb>浙里办二维码调试单点登录工具</h1><div class="text-base-content text-sm" data-v-90a9eadb> 1.调试应用（包含本地应用）链接填入后,<span class="text-primary font-medium" data-v-90a9eadb>直接使用浙里办APP扫码使用</span><br data-v-90a9eadb> 2.应用绕过了浙里办不安全域名，可以调试任何链接<br data-v-90a9eadb> 3.兼容单点登录，自动带入ticketId </div></div>',2)),withDirectives(createBaseVNode("select",{"onUpdate:modelValue":g[0]||(g[0]=v=>isRef(t)?t.value=v:t=v),class:"select select-bordered w-full mt-2 bg-base-100"},[g[6]||(g[6]=createBaseVNode("option",{disabled:"",selected:""},"选择应用",-1)),(openBlock(!0),createElementBlock(Fragment$1,null,renderList(unref(config),(v,x)=>(openBlock(),createElementBlock("option",{value:v.key},toDisplayString(v.name),9,_hoisted_3$5))),256))],512),[[vModelSelect,unref(t)]])]),createBaseVNode("div",_hoisted_4$5,[createBaseVNode("div",_hoisted_5$5,[withDirectives(createBaseVNode("textarea",{"onUpdate:modelValue":g[1]||(g[1]=v=>isRef(r)?r.value=v:r=v),class:"textarea w-full h-full bg-base-100 textarea-bordered",cols:"33",rows:"5",placeholder:"请输入链接",ref_key:"refInput",ref:d},"        ",512),[[vModelText,unref(r)]]),g[8]||(g[8]=createBaseVNode("button",{class:"btn btn-primary mt-4"},"当前URL链接:",-1)),createVNode(QrcodeVue,{value:unref(r),size:360,level:"H",class:"my-4 bg-white p-2 rounded"},null,8,["value"]),createBaseVNode("a",{href:unref(r),target:"_blank",class:"mt-4 text-primary"},toDisplayString(decodeURIComponent(unref(r))),9,_hoisted_6$5)]),g[10]||(g[10]=createBaseVNode("div",{class:"divider divider-horizontal text-primary"}," -> ",-1)),createBaseVNode("div",_hoisted_7$5,[createVNode(QrcodeVue,{value:unref(i),size:360,level:"H",class:"bg-white p-2 rounded"},null,8,["value"]),createBaseVNode("div",{class:"flex gap-4 mt-4"},[createBaseVNode("button",{onClick:a,class:"btn btn-primary"},"保存链接"),g[9]||(g[9]=createBaseVNode("button",{onclick:"my_modal_4.showModal()",class:"btn btn-secondary"},"查看列表",-1))])])]),createBaseVNode("dialog",_hoisted_8$5,[createBaseVNode("div",_hoisted_9$5,[g[14]||(g[14]=createBaseVNode("h3",{class:"font-bold text-lg"},"保存链接到配置",-1)),createBaseVNode("div",_hoisted_10$3,[g[11]||(g[11]=createBaseVNode("label",{class:"label"},[createBaseVNode("span",{class:"label-text"},"链接标题")],-1)),withDirectives(createBaseVNode("input",{type:"text",onChange:g[2]||(g[2]=(...v)=>m.handlChangeData&&m.handlChangeData(...v)),"onUpdate:modelValue":g[3]||(g[3]=v=>unref(s).title=v),placeholder:"标题",class:"input input-bordered w-full bg-base-100"},null,544),[[vModelText,unref(s).title]])]),createBaseVNode("div",_hoisted_11$2,[g[12]||(g[12]=createBaseVNode("label",{class:"label"},[createBaseVNode("span",{class:"label-text"},"链接地址")],-1)),withDirectives(createBaseVNode("input",{type:"text",onChange:g[4]||(g[4]=(...v)=>m.handlChangeData&&m.handlChangeData(...v)),"onUpdate:modelValue":g[5]||(g[5]=v=>unref(s).url=v),placeholder:"链接地址",class:"input input-bordered w-full bg-base-100"},null,544),[[vModelText,unref(s).url]])]),createBaseVNode("div",{class:"modal-action"},[createBaseVNode("form",{method:"dialog"},[createBaseVNode("button",{onClick:l,class:"btn btn-accent mr-4"},"保存"),g[13]||(g[13]=createBaseVNode("button",{class:"btn"},"关闭",-1))])])])]),createBaseVNode("dialog",_hoisted_12$2,[createBaseVNode("div",_hoisted_13$2,[createBaseVNode("div",null,[createBaseVNode("table",_hoisted_14$2,[g[16]||(g[16]=createBaseVNode("thead",null,[createBaseVNode("tr",{class:"text-primary"},[createBaseVNode("th",{align:"center"},"操作"),createBaseVNode("th",{align:"left"},"标题和链接")])],-1)),createBaseVNode("tbody",null,[(openBlock(!0),createElementBlock(Fragment$1,null,renderList(unref(e),(v,x)=>(openBlock(),createElementBlock("tr",{key:v.url,class:"border-b border-base-content/20"},[createBaseVNode("th",_hoisted_15$2,[createBaseVNode("button",{onClick:S=>c(x),class:"btn btn-outline btn-xs btn-secondary"},"删除",8,_hoisted_16$2),createBaseVNode("form",_hoisted_17$2,[createBaseVNode("button",{onClick:S=>u(v),class:"btn btn-outline btn-xs btn-accent ml-4",for:"my_modal_4"},"使用",8,_hoisted_18$2)])]),createBaseVNode("td",_hoisted_19$2,[createBaseVNode("a",{href:v.url,target:"_blank",class:"link text-primary lowercase text-left"},toDisplayString(v.url),9,_hoisted_20$2),g[15]||(g[15]=createBaseVNode("br",null,null,-1)),createBaseVNode("span",_hoisted_21$2,toDisplayString(v.title),1)])]))),128))])])]),g[17]||(g[17]=createBaseVNode("div",{class:"modal-action"},[createBaseVNode("form",{method:"dialog"},[createBaseVNode("button",{class:"btn"},"关闭")])],-1))])])]))}},Qrcode=_export_sfc(_sfc_main$5,[["__scopeId","data-v-90a9eadb"]]),UNIHANS=["阿","哎","安","肮","凹","八","挀","扳","邦","勹","陂","奔","伻","屄","边","灬","憋","汃","冫","癶","峬","嚓","偲","参","仓","撡","冊","嵾","曽","叉","芆","辿","伥","抄","车","抻","阷","吃","充","抽","出","欻","揣","巛","刅","吹","旾","逴","呲","匆","凑","粗","汆","崔","邨","搓","咑","呆","丹","当","刀","嘚","扥","灯","氐","甸","刁","爹","丁","丟","东","吺","厾","耑","垖","吨","多","妸","诶","奀","鞥","儿","发","帆","匚","飞","分","丰","覅","仏","紑","夫","旮","侅","甘","冈","皋","戈","给","根","刯","工","勾","估","瓜","乖","关","光","归","丨","呙","哈","咍","佄","夯","茠","诃","黒","拫","亨","噷","叿","齁","乎","花","怀","欢","巟","灰","昏","吙","丌","加","戋","江","艽","阶","巾","坕","冂","丩","凥","姢","噘","军","咔","开","刊","忼","尻","匼","肎","劥","空","抠","扝","夸","蒯","宽","匡","亏","坤","扩","垃","来","兰","啷","捞","肋","勒","崚","哩","俩","奁","良","撩","毟","拎","伶","溜","囖","龙","瞜","噜","驴","娈","掠","抡","罗","呣","妈","埋","嫚","牤","猫","么","呅","门","甿","咪","宀","喵","乜","民","名","谬","摸","哞","毪","嗯","拏","腉","囡","囔","孬","疒","娞","恁","能","妮","拈","娘","鸟","捏","囜","宁","妞","农","羺","奴","女","奻","疟","黁","挪","喔","讴","妑","拍","眅","乓","抛","呸","喷","匉","丕","囨","剽","氕","姘","乒","钋","剖","仆","七","掐","千","呛","悄","癿","亲","靑","卭","丘","区","峑","缺","夋","呥","穣","娆","惹","人","扔","日","茸","厹","邚","挼","堧","婑","瞤","捼","仨","毢","三","桒","掻","閪","森","僧","杀","筛","山","伤","弰","奢","申","升","尸","収","书","刷","衰","闩","双","脽","吮","说","厶","忪","捜","苏","狻","夊","孙","唆","他","囼","坍","汤","夲","忑","熥","剔","天","旫","帖","厅","囲","偷","凸","湍","推","吞","乇","穵","歪","弯","尣","危","昷","翁","挝","乌","夕","虲","仙","乡","灱","些","心","星","凶","休","吁","吅","削","坃","丫","恹","央","幺","倻","一","囙","应","哟","佣","优","扜","囦","曰","晕","帀","災","兂","匨","傮","则","贼","怎","増","扎","捚","沾","张","佋","蜇","贞","争","之","中","州","朱","抓","拽","专","妆","隹","宒","卓","乲","宗","邹","租","钻","厜","尊","昨","兙"],PINYINS=["A","AI","AN","ANG","AO","BA","BAI","BAN","BANG","BAO","BEI","BEN","BENG","BI","BIAN","BIAO","BIE","BIN","BING","BO","BU","CA","CAI","CAN","CANG","CAO","CE","CEN","CENG","CHA","CHAI","CHAN","CHANG","CHAO","CHE","CHEN","CHENG","CHI","CHONG","CHOU","CHU","CHUA","CHUAI","CHUAN","CHUANG","CHUI","CHUN","CHUO","CI","CONG","COU","CU","CUAN","CUI","CUN","CUO","DA","DAI","DAN","DANG","DAO","DE","DEN","DENG","DI","DIAN","DIAO","DIE","DING","DIU","DONG","DOU","DU","DUAN","DUI","DUN","DUO","E","EI","EN","ENG","ER","FA","FAN","FANG","FEI","FEN","FENG","FIAO","FO","FOU","FU","GA","GAI","GAN","GANG","GAO","GE","GEI","GEN","GENG","GONG","GOU","GU","GUA","GUAI","GUAN","GUANG","GUI","GUN","GUO","HA","HAI","HAN","HANG","HAO","HE","HEI","HEN","HENG","HM","HONG","HOU","HU","HUA","HUAI","HUAN","HUANG","HUI","HUN","HUO","JI","JIA","JIAN","JIANG","JIAO","JIE","JIN","JING","JIONG","JIU","JU","JUAN","JUE","JUN","KA","KAI","KAN","KANG","KAO","KE","KEN","KENG","KONG","KOU","KU","KUA","KUAI","KUAN","KUANG","KUI","KUN","KUO","LA","LAI","LAN","LANG","LAO","LE","LEI","LENG","LI","LIA","LIAN","LIANG","LIAO","LIE","LIN","LING","LIU","LO","LONG","LOU","LU","LV","LUAN","LVE","LUN","LUO","M","MA","MAI","MAN","MANG","MAO","ME","MEI","MEN","MENG","MI","MIAN","MIAO","MIE","MIN","MING","MIU","MO","MOU","MU","N","NA","NAI","NAN","NANG","NAO","NE","NEI","NEN","NENG","NI","NIAN","NIANG","NIAO","NIE","NIN","NING","NIU","NONG","NOU","NU","NV","NUAN","NVE","NUN","NUO","O","OU","PA","PAI","PAN","PANG","PAO","PEI","PEN","PENG","PI","PIAN","PIAO","PIE","PIN","PING","PO","POU","PU","QI","QIA","QIAN","QIANG","QIAO","QIE","QIN","QING","QIONG","QIU","QU","QUAN","QUE","QUN","RAN","RANG","RAO","RE","REN","RENG","RI","RONG","ROU","RU","RUA","RUAN","RUI","RUN","RUO","SA","SAI","SAN","SANG","SAO","SE","SEN","SENG","SHA","SHAI","SHAN","SHANG","SHAO","SHE","SHEN","SHENG","SHI","SHOU","SHU","SHUA","SHUAI","SHUAN","SHUANG","SHUI","SHUN","SHUO","SI","SONG","SOU","SU","SUAN","SUI","SUN","SUO","TA","TAI","TAN","TANG","TAO","TE","TENG","TI","TIAN","TIAO","TIE","TING","TONG","TOU","TU","TUAN","TUI","TUN","TUO","WA","WAI","WAN","WANG","WEI","WEN","WENG","WO","WU","XI","XIA","XIAN","XIANG","XIAO","XIE","XIN","XING","XIONG","XIU","XU","XUAN","XUE","XUN","YA","YAN","YANG","YAO","YE","YI","YIN","YING","YO","YONG","YOU","YU","YUAN","YUE","YUN","ZA","ZAI","ZAN","ZANG","ZAO","ZE","ZEI","ZEN","ZENG","ZHA","ZHAI","ZHAN","ZHANG","ZHAO","ZHE","ZHEN","ZHENG","ZHI","ZHONG","ZHOU","ZHU","ZHUA","ZHUAI","ZHUAN","ZHUANG","ZHUI","ZHUN","ZHUO","ZI","ZONG","ZOU","ZU","ZUAN","ZUI","ZUN","ZUO",""],EXCEPTIONS={曾:"ZENG",沈:"SHEN",嗲:"DIA",碡:"ZHOU",聒:"GUO",炔:"QUE",蚵:"KE",砉:"HUA",嬤:"MO",嬷:"MO",蹒:"PAN",蹊:"XI",丬:"PAN",霰:"XIAN",莘:"XIN",豉:"CHI",饧:"XING",筠:"JUN",长:"CHANG",帧:"ZHEN",峙:"SHI",郍:"NA",芎:"XIONG",谁:"SHUI"},DICT$1={PINYINS,UNIHANS,EXCEPTIONS},FIRST_PINYIN_UNIHAN="阿",LAST_PINYIN_UNIHAN="鿿",LATIN=1,PINYIN=2,UNKNOWN=3;let supported=null,COLLATOR;function patchDict(n){n&&(typeof n=="function"&&(n=[n]),n.forEach&&n.forEach(e=>{typeof e=="function"&&e(DICT$1)}))}function isSupported$1(n){return!n&&supported!==null||(typeof Intl=="object"&&Intl.Collator?(COLLATOR=new Intl.Collator(["zh-Hans-CN","zh-CN"]),supported=Intl.Collator.supportedLocalesOf(["zh-CN"]).length===1):supported=!1),supported}function genToken(n){const e=DICT$1.UNIHANS,t=DICT$1.PINYINS,r=DICT$1.EXCEPTIONS,i={source:n};if(n in r)return i.type=PINYIN,i.target=r[n],i;let s=-1,o;if(n.charCodeAt(0)<256)return i.type=LATIN,i.target=n,i;if(o=COLLATOR.compare(n,FIRST_PINYIN_UNIHAN),o<0)return i.type=UNKNOWN,i.target=n,i;if(o===0)i.type=PINYIN,s=0;else{if(o=COLLATOR.compare(n,LAST_PINYIN_UNIHAN),o>0)return i.type=UNKNOWN,i.target=n,i;o===0&&(i.type=PINYIN,s=e.length-1)}if(i.type=PINYIN,s<0){let a=0,l=e.length-1;for(;a<=l;){s=~~((a+l)/2);let c=e[s];if(o=COLLATOR.compare(n,c),o===0)break;o>0?a=s+1:l=s-1}}return o<0&&s--,i.target=t[s],i.target||(i.type=UNKNOWN,i.target=i.source),i}function parse(n){if(typeof n!="string")throw new Error("argument should be string.");if(!isSupported$1())throw new Error("not support Intl or zh-CN language.");return n.split("").map(e=>genToken(e))}const pinyin={isSupported:isSupported$1,parse,patchDict,genToken,convertToPinyin(n,e,t){return parse(n).map(r=>t&&r.type===PINYIN?r.target.toLowerCase():r.target).join(e||"")},firstWordToPinyin(n,e,t){return parse(n).map(r=>(t&&r.type===PINYIN,r.target.toLowerCase().substr(0,1))).join(e||"")}};let patcher=function(n){n.EXCEPTIONS={嗲:"DIA",碡:"ZHOU",聒:"GUO",炔:"QUE",蚵:"KE",砉:"HUA",嬷:"MO",蹊:"XI",丬:"PAN",霰:"XIAN",豉:"CHI",饧:"XING",帧:"ZHEN",芎:"XIONG",谁:"SHUI",钶:"KE"},n.UNIHANS[91]="伕",n.UNIHANS[347]="仚",n.UNIHANS[393]="诌",n.UNIHANS[39]="婤",n.UNIHANS[50]="腠",n.UNIHANS[369]="攸",n.UNIHANS[123]="乯",n.UNIHANS[171]="刕",n.UNIHANS[102]="佝",n.UNIHANS[126]="犿",n.UNIHANS[176]="列",n.UNIHANS[178]="刢",n.UNIHANS[252]="娝",n.UNIHANS[330]="偸"},shouldPatch=function(n){return typeof n!="function"?!1:n("伕").target==="FOU"&&n("仚").target==="XIA"&&n("诌").target==="ZHONG"&&n("婤").target==="CHONG"&&n("腠").target==="CONG"&&n("攸").target==="YONG"&&n("乯").target==="HOU"&&n("刕").target==="LENG"&&n("佝").target==="GONG"&&n("犿").target==="HUAI"&&n("列").target==="LIAO"&&n("刢").target==="LIN"&&n("钶").target==="E"};const patcher56L=Object.freeze(Object.defineProperty({__proto__:null,patcher,shouldPatch},Symbol.toStringTag,{value:"Module"}));pinyin.isSupported()&&shouldPatch(pinyin.genToken)&&pinyin.patchDict(patcher56L);const _hoisted_1$4={class:"changeData p-4 bg-base-100 min-h-[500px]"},_hoisted_2$4={class:"res p-4 bg-base-200 rounded-lg shadow-md"},_hoisted_3$4={class:"flex gap-4 mb-4"},_hoisted_4$4=["data-tip"],_hoisted_5$4={class:"mockup-code bg-base-300 text-base-content"},_hoisted_6$4=["innerHTML"],_hoisted_7$4={id:"my_modal_4",class:"modal"},_hoisted_8$4={class:"modal-box w-11/12 max-w-5xl bg-base-200"},_hoisted_9$4={class:"w-full"},_hoisted_10$2={class:"w-full"},_sfc_main$4={__name:"ChangeData",setup(n){const e=ref("title"),t=ref("dataIndex"),r=ref(""),i=ref("点击复制"),s=ref([]),o=c=>{var u=document.createElement("textarea");u.setAttribute("readonly","readonly"),u.value=c,document.body.appendChild(u),u.select();var d=document.execCommand("copy");return document.body.removeChild(u),i.value="复制成功",d},a=c=>{let u=[];return r.value.split(c).map(d=>{d&&u.push({[e.value]:d,[t.value]:pinyin.firstWordToPinyin(d),customRender:d.indexOf("时间")>-1?(f,m,g)=>{const v=props.$createElement;return v("div",props.county[f])}:void 0})}),u},l=()=>{i.value="点击复制",r.value.indexOf(",")>-1?s.value=JSON.stringify(a(","),null,"	"):r.value.indexOf("，")>-1?s.value=JSON.stringify(a("，"),null,"	"):s.value=JSON.stringify(a(/[\s\n]/),null,"	")};return(c,u)=>(openBlock(),createElementBlock("div",_hoisted_1$4,[withDirectives(createBaseVNode("textarea",{class:"textarea w-full textarea-bordered bg-base-100 text-base-content",placeholder:"请输入表头",cols:"63",rows:"5","onUpdate:modelValue":u[0]||(u[0]=d=>r.value=d)},"    ",512),[[vModelText,r.value]]),createBaseVNode("div",{class:"flex justify-center my-4"},[createBaseVNode("button",{onClick:l,class:"btn btn-primary"},u[4]||(u[4]=[createTextVNode(" 转化数据 "),createBaseVNode("svg",{class:"icon",height:"20","p-id":"7940",t:"1600052679408",version:"1.1",viewBox:"0 0 1024 1024",width:"20",xmlns:"http://www.w3.org/2000/svg"},[createBaseVNode("path",{d:"M 223.361 656.774 H 501.401 V 368.029 H 223.361 v 288.745 Z M 3.3391 394.331 v 231.082 c 0 37.8764 25.5309 31.3608 25.5309 31.3608 h 122.984 V 368.029 H 24.7458 s -21.4067 -0.678536 -21.4067 26.3028 Z m 1007.51 90.0756 c -35.2839 -34.4771 -377.398 -287.565 -377.398 -287.565 s -39.4069 -38.9818 -39.4069 19.456 v 151.729 h -0.414226 v 288.746 h 0.055993 v 161.675 c 0 47.9112 38.0065 6.25133 38.0065 6.25133 l 376.25 -291.311 c -0.000602 0.001204 28.6214 -23.9553 2.90681 -48.9811 Z m 0 0",fill:"currentColor","p-id":"7941"})],-1)]))]),createBaseVNode("div",_hoisted_2$4,[createBaseVNode("div",_hoisted_3$4,[createBaseVNode("button",{onClick:l,class:"btn btn-secondary"},"点击转化"),createBaseVNode("div",{class:"tooltip","data-tip":i.value},[createBaseVNode("button",{onClick:u[1]||(u[1]=d=>o(s.value)),class:"btn btn-primary"},"复制")],8,_hoisted_4$4),u[5]||(u[5]=createBaseVNode("button",{onclick:"my_modal_4.showModal()",class:"btn btn-accent"},"配置",-1))]),createBaseVNode("div",_hoisted_5$4,[createBaseVNode("pre",{innerHTML:s.value},null,8,_hoisted_6$4)])]),createBaseVNode("dialog",_hoisted_7$4,[createBaseVNode("div",_hoisted_8$4,[u[8]||(u[8]=createBaseVNode("h3",{class:"font-bold text-lg text-base-content"},"表格生成配置",-1)),createBaseVNode("div",_hoisted_9$4,[u[6]||(u[6]=createBaseVNode("label",{class:"label"},[createBaseVNode("span",{class:"label-text"},"生成标题key(默认title)")],-1)),withDirectives(createBaseVNode("input",{type:"text",onChange:l,"onUpdate:modelValue":u[2]||(u[2]=d=>e.value=d),placeholder:"title",class:"input input-bordered w-full bg-base-100"},null,544),[[vModelText,e.value]])]),createBaseVNode("div",_hoisted_10$2,[u[7]||(u[7]=createBaseVNode("label",{class:"label"},[createBaseVNode("span",{class:"label-text"},"生成数据key(默认dataIndex)")],-1)),withDirectives(createBaseVNode("input",{type:"text",onChange:l,"onUpdate:modelValue":u[3]||(u[3]=d=>t.value=d),placeholder:"dataIndex",class:"input input-bordered w-full bg-base-100"},null,544),[[vModelText,t.value]])]),u[9]||(u[9]=createBaseVNode("div",{class:"modal-action"},[createBaseVNode("form",{method:"dialog"},[createBaseVNode("button",{class:"btn"},"关闭")])],-1))])])]))}},Change=_export_sfc(_sfc_main$4,[["__scopeId","data-v-f9e402ba"]]),scriptRel="modulepreload",assetsURL=function(n,e){return new URL(n,e).href},seen={},__vitePreload=function(e,t,r){let i=Promise.resolve();if(t&&t.length>0){const o=document.getElementsByTagName("link"),a=document.querySelector("meta[property=csp-nonce]"),l=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));i=Promise.allSettled(t.map(c=>{if(c=assetsURL(c,r),c in seen)return;seen[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(!!r)for(let g=o.length-1;g>=0;g--){const v=o[g];if(v.href===c&&(!u||v.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${c}"]${d}`))return;const m=document.createElement("link");if(m.rel=u?"stylesheet":scriptRel,u||(m.as="script"),m.crossOrigin="",m.href=c,l&&m.setAttribute("nonce",l),document.head.appendChild(m),u)return new Promise((g,v)=>{m.addEventListener("load",g),m.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return i.then(o=>{for(const a of o||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})},bundledLanguagesInfo=[{id:"abap",name:"ABAP",import:()=>__vitePreload(()=>import("./abap-BwpQXVS2.js"),[],import.meta.url)},{id:"actionscript-3",name:"ActionScript",import:()=>__vitePreload(()=>import("./actionscript-3-Ci-La1BS.js"),[],import.meta.url)},{id:"ada",name:"Ada",import:()=>__vitePreload(()=>import("./ada-DOAn35dn.js"),[],import.meta.url)},{id:"angular-html",name:"Angular HTML",import:()=>__vitePreload(()=>import("./angular-html-GqBVQ6Dm.js").then(n=>n.f),__vite__mapDeps([0,1,2,3]),import.meta.url)},{id:"angular-ts",name:"Angular TypeScript",import:()=>__vitePreload(()=>import("./angular-ts-MKs4dlu_.js"),__vite__mapDeps([4,0,1,2,3,5]),import.meta.url)},{id:"apache",name:"Apache Conf",import:()=>__vitePreload(()=>import("./apache-Dn00JSTd.js"),[],import.meta.url)},{id:"apex",name:"Apex",import:()=>__vitePreload(()=>import("./apex-BzwtH5UL.js"),[],import.meta.url)},{id:"apl",name:"APL",import:()=>__vitePreload(()=>import("./apl-C6GBNg32.js"),__vite__mapDeps([6,1,2,3,7,8,9]),import.meta.url)},{id:"applescript",name:"AppleScript",import:()=>__vitePreload(()=>import("./applescript-DIt9OTko.js"),[],import.meta.url)},{id:"ara",name:"Ara",import:()=>__vitePreload(()=>import("./ara-CJxt7p29.js"),[],import.meta.url)},{id:"asciidoc",name:"AsciiDoc",aliases:["adoc"],import:()=>__vitePreload(()=>import("./asciidoc-CcSEeikT.js"),[],import.meta.url)},{id:"asm",name:"Assembly",import:()=>__vitePreload(()=>import("./asm-DPTZissz.js"),[],import.meta.url)},{id:"astro",name:"Astro",import:()=>__vitePreload(()=>import("./astro-DTSlZd1t.js"),__vite__mapDeps([10,9,2,11,3,12]),import.meta.url)},{id:"awk",name:"AWK",import:()=>__vitePreload(()=>import("./awk-BINKOAKH.js"),[],import.meta.url)},{id:"ballerina",name:"Ballerina",import:()=>__vitePreload(()=>import("./ballerina-DCcCncrU.js"),[],import.meta.url)},{id:"bat",name:"Batch File",aliases:["batch"],import:()=>__vitePreload(()=>import("./bat-B9Vj0mJK.js"),[],import.meta.url)},{id:"beancount",name:"Beancount",import:()=>__vitePreload(()=>import("./beancount-DDUKAZWS.js"),[],import.meta.url)},{id:"berry",name:"Berry",aliases:["be"],import:()=>__vitePreload(()=>import("./berry-DnyWjya5.js"),[],import.meta.url)},{id:"bibtex",name:"BibTeX",import:()=>__vitePreload(()=>import("./bibtex-CpWBKVjh.js"),[],import.meta.url)},{id:"bicep",name:"Bicep",import:()=>__vitePreload(()=>import("./bicep-BWkuYGGO.js"),[],import.meta.url)},{id:"blade",name:"Blade",import:()=>__vitePreload(()=>import("./blade-CPEzV-UE.js"),__vite__mapDeps([13,1,2,3,7,8,14,9]),import.meta.url)},{id:"bsl",name:"1C (Enterprise)",aliases:["1c"],import:()=>__vitePreload(()=>import("./bsl-Dgyn0ogV.js"),__vite__mapDeps([15,16]),import.meta.url)},{id:"c",name:"C",import:()=>__vitePreload(()=>import("./c-BhsLqr-4.js"),[],import.meta.url)},{id:"cadence",name:"Cadence",aliases:["cdc"],import:()=>__vitePreload(()=>import("./cadence-CEjiMJLT.js"),[],import.meta.url)},{id:"cairo",name:"Cairo",import:()=>__vitePreload(()=>import("./cairo-DMFdBl0X.js"),[],import.meta.url)},{id:"clarity",name:"Clarity",import:()=>__vitePreload(()=>import("./clarity-CXmV_HiI.js"),[],import.meta.url)},{id:"clojure",name:"Clojure",aliases:["clj"],import:()=>__vitePreload(()=>import("./clojure-mLcCfA0-.js"),[],import.meta.url)},{id:"cmake",name:"CMake",import:()=>__vitePreload(()=>import("./cmake-DbXoA79R.js"),[],import.meta.url)},{id:"cobol",name:"COBOL",import:()=>__vitePreload(()=>import("./cobol-NX_YbRMJ.js"),__vite__mapDeps([17,1,2,3,8]),import.meta.url)},{id:"codeowners",name:"CODEOWNERS",import:()=>__vitePreload(()=>import("./codeowners-Bp6g37R7.js"),[],import.meta.url)},{id:"codeql",name:"CodeQL",aliases:["ql"],import:()=>__vitePreload(()=>import("./codeql-Bdprqoiu.js"),[],import.meta.url)},{id:"coffee",name:"CoffeeScript",aliases:["coffeescript"],import:()=>__vitePreload(()=>import("./coffee-CXcjgkhu.js"),__vite__mapDeps([18,2]),import.meta.url)},{id:"common-lisp",name:"Common Lisp",aliases:["lisp"],import:()=>__vitePreload(()=>import("./common-lisp-CQO4gZEw.js"),[],import.meta.url)},{id:"coq",name:"Coq",import:()=>__vitePreload(()=>import("./coq-BCzYJAay.js"),[],import.meta.url)},{id:"cpp",name:"C++",aliases:["c++"],import:()=>__vitePreload(()=>import("./cpp-IRqjNdQP.js"),__vite__mapDeps([19,20,21,22,14]),import.meta.url)},{id:"crystal",name:"Crystal",import:()=>__vitePreload(()=>import("./crystal-DFEzbmK1.js"),__vite__mapDeps([23,1,2,3,14,22,24]),import.meta.url)},{id:"csharp",name:"C#",aliases:["c#","cs"],import:()=>__vitePreload(()=>import("./csharp-D7v6OrNy.js"),[],import.meta.url)},{id:"css",name:"CSS",import:()=>__vitePreload(()=>import("./css-u4bm_LMz.js"),[],import.meta.url)},{id:"csv",name:"CSV",import:()=>__vitePreload(()=>import("./csv-B0qRVHPH.js"),[],import.meta.url)},{id:"cue",name:"CUE",import:()=>__vitePreload(()=>import("./cue-DmZ-uG0V.js"),[],import.meta.url)},{id:"cypher",name:"Cypher",aliases:["cql"],import:()=>__vitePreload(()=>import("./cypher-DfpIq38s.js"),[],import.meta.url)},{id:"d",name:"D",import:()=>__vitePreload(()=>import("./d-B5L7zzq-.js"),[],import.meta.url)},{id:"dart",name:"Dart",import:()=>__vitePreload(()=>import("./dart-D9W_gRNE.js"),[],import.meta.url)},{id:"dax",name:"DAX",import:()=>__vitePreload(()=>import("./dax-yA8e6OR-.js"),[],import.meta.url)},{id:"desktop",name:"Desktop",import:()=>__vitePreload(()=>import("./desktop-DEIpsLCJ.js"),[],import.meta.url)},{id:"diff",name:"Diff",import:()=>__vitePreload(()=>import("./diff-Dnfm4U7b.js"),[],import.meta.url)},{id:"docker",name:"Dockerfile",aliases:["dockerfile"],import:()=>__vitePreload(()=>import("./docker-BHpzmqOf.js"),[],import.meta.url)},{id:"dotenv",name:"dotEnv",import:()=>__vitePreload(()=>import("./dotenv-DQxx3LPD.js"),[],import.meta.url)},{id:"dream-maker",name:"Dream Maker",import:()=>__vitePreload(()=>import("./dream-maker-BMwgFBEQ.js"),[],import.meta.url)},{id:"edge",name:"Edge",import:()=>__vitePreload(()=>import("./edge-Cq_6DOij.js"),__vite__mapDeps([25,11,1,2,3,26]),import.meta.url)},{id:"elixir",name:"Elixir",import:()=>__vitePreload(()=>import("./elixir-BoNJ9vXU.js"),__vite__mapDeps([27,1,2,3]),import.meta.url)},{id:"elm",name:"Elm",import:()=>__vitePreload(()=>import("./elm-CTr_twwF.js"),__vite__mapDeps([28,21,22]),import.meta.url)},{id:"emacs-lisp",name:"Emacs Lisp",aliases:["elisp"],import:()=>__vitePreload(()=>import("./emacs-lisp-CMz7PuSU.js"),[],import.meta.url)},{id:"erb",name:"ERB",import:()=>__vitePreload(()=>import("./erb-DuefeV9w.js"),__vite__mapDeps([29,1,2,3,30,7,8,14,22,24,31]),import.meta.url)},{id:"erlang",name:"Erlang",aliases:["erl"],import:()=>__vitePreload(()=>import("./erlang-CMOi41r9.js"),[],import.meta.url)},{id:"fennel",name:"Fennel",import:()=>__vitePreload(()=>import("./fennel-dZn0vQkf.js"),[],import.meta.url)},{id:"fish",name:"Fish",import:()=>__vitePreload(()=>import("./fish-CQzXS8_C.js"),[],import.meta.url)},{id:"fluent",name:"Fluent",aliases:["ftl"],import:()=>__vitePreload(()=>import("./fluent-CNRQ974Q.js"),[],import.meta.url)},{id:"fortran-fixed-form",name:"Fortran (Fixed Form)",aliases:["f","for","f77"],import:()=>__vitePreload(()=>import("./fortran-fixed-form-C9lV_GL-.js"),__vite__mapDeps([32,33]),import.meta.url)},{id:"fortran-free-form",name:"Fortran (Free Form)",aliases:["f90","f95","f03","f08","f18"],import:()=>__vitePreload(()=>import("./fortran-free-form-B3Z_eaxm.js"),[],import.meta.url)},{id:"fsharp",name:"F#",aliases:["f#","fs"],import:()=>__vitePreload(()=>import("./fsharp-Vw5t3P44.js"),__vite__mapDeps([34,35]),import.meta.url)},{id:"gdresource",name:"GDResource",import:()=>__vitePreload(()=>import("./gdresource-D_y5yz_M.js"),__vite__mapDeps([36,37,38]),import.meta.url)},{id:"gdscript",name:"GDScript",import:()=>__vitePreload(()=>import("./gdscript-BIguuW30.js"),[],import.meta.url)},{id:"gdshader",name:"GDShader",import:()=>__vitePreload(()=>import("./gdshader-BSHf-0eb.js"),[],import.meta.url)},{id:"genie",name:"Genie",import:()=>__vitePreload(()=>import("./genie-DJEtsjbi.js"),[],import.meta.url)},{id:"gherkin",name:"Gherkin",import:()=>__vitePreload(()=>import("./gherkin--30QC5Em.js"),[],import.meta.url)},{id:"git-commit",name:"Git Commit Message",import:()=>__vitePreload(()=>import("./git-commit-C0WNX4K0.js"),__vite__mapDeps([39,40]),import.meta.url)},{id:"git-rebase",name:"Git Rebase Message",import:()=>__vitePreload(()=>import("./git-rebase-3YLVFLpI.js"),__vite__mapDeps([41,24]),import.meta.url)},{id:"gleam",name:"Gleam",import:()=>__vitePreload(()=>import("./gleam-C30t_gpS.js"),[],import.meta.url)},{id:"glimmer-js",name:"Glimmer JS",aliases:["gjs"],import:()=>__vitePreload(()=>import("./glimmer-js-D4fdoRWd.js"),__vite__mapDeps([42,2,11,3,1]),import.meta.url)},{id:"glimmer-ts",name:"Glimmer TS",aliases:["gts"],import:()=>__vitePreload(()=>import("./glimmer-ts-DFoQQgBS.js"),__vite__mapDeps([43,11,3,2,1]),import.meta.url)},{id:"glsl",name:"GLSL",import:()=>__vitePreload(()=>import("./glsl-bwZ1_LLM.js"),__vite__mapDeps([21,22]),import.meta.url)},{id:"gnuplot",name:"Gnuplot",import:()=>__vitePreload(()=>import("./gnuplot-CmWLV2bY.js"),[],import.meta.url)},{id:"go",name:"Go",import:()=>__vitePreload(()=>import("./go-Cv7ZOjGq.js"),[],import.meta.url)},{id:"graphql",name:"GraphQL",aliases:["gql"],import:()=>__vitePreload(()=>import("./graphql-DqgCZ2sd.js"),__vite__mapDeps([44,2,11,45,46]),import.meta.url)},{id:"groovy",name:"Groovy",import:()=>__vitePreload(()=>import("./groovy-BWslPs4p.js"),[],import.meta.url)},{id:"hack",name:"Hack",import:()=>__vitePreload(()=>import("./hack-BV5LM4CS.js"),__vite__mapDeps([47,1,2,3,14]),import.meta.url)},{id:"haml",name:"Ruby Haml",import:()=>__vitePreload(()=>import("./haml-B1jT_oKV.js"),__vite__mapDeps([48,2,3]),import.meta.url)},{id:"handlebars",name:"Handlebars",aliases:["hbs"],import:()=>__vitePreload(()=>import("./handlebars-HtVeTy3a.js"),__vite__mapDeps([49,1,2,3,50]),import.meta.url)},{id:"haskell",name:"Haskell",aliases:["hs"],import:()=>__vitePreload(()=>import("./haskell-ChDww4um.js"),[],import.meta.url)},{id:"haxe",name:"Haxe",import:()=>__vitePreload(()=>import("./haxe-BgqZeg96.js"),[],import.meta.url)},{id:"hcl",name:"HashiCorp HCL",import:()=>__vitePreload(()=>import("./hcl-Cztwc-HH.js"),[],import.meta.url)},{id:"hjson",name:"Hjson",import:()=>__vitePreload(()=>import("./hjson-D9Bn7OQI.js"),[],import.meta.url)},{id:"hlsl",name:"HLSL",import:()=>__vitePreload(()=>import("./hlsl-DkpUthgY.js"),[],import.meta.url)},{id:"html",name:"HTML",import:()=>__vitePreload(()=>import("./html-DG1TtFnM.js"),__vite__mapDeps([1,2,3]),import.meta.url)},{id:"html-derivative",name:"HTML (Derivative)",import:()=>__vitePreload(()=>import("./html-derivative-CDVwFiY1.js"),__vite__mapDeps([26,1,2,3]),import.meta.url)},{id:"http",name:"HTTP",import:()=>__vitePreload(()=>import("./http-CYnz8shJ.js"),__vite__mapDeps([51,24,9,7,8,44,2,11,45,46]),import.meta.url)},{id:"hxml",name:"HXML",import:()=>__vitePreload(()=>import("./hxml-BfFmssGd.js"),__vite__mapDeps([52,53]),import.meta.url)},{id:"hy",name:"Hy",import:()=>__vitePreload(()=>import("./hy-YurBl9Qv.js"),[],import.meta.url)},{id:"imba",name:"Imba",import:()=>__vitePreload(()=>import("./imba-C6vdFTm2.js"),__vite__mapDeps([54,11]),import.meta.url)},{id:"ini",name:"INI",aliases:["properties"],import:()=>__vitePreload(()=>import("./ini-BjABl1g7.js"),[],import.meta.url)},{id:"java",name:"Java",import:()=>__vitePreload(()=>import("./java-BN40hmum.js"),[],import.meta.url)},{id:"javascript",name:"JavaScript",aliases:["js"],import:()=>__vitePreload(()=>import("./javascript-DNgb01dh.js"),[],import.meta.url)},{id:"jinja",name:"Jinja",import:()=>__vitePreload(()=>import("./jinja-BORjBBXU.js"),__vite__mapDeps([55,1,2,3]),import.meta.url)},{id:"jison",name:"Jison",import:()=>__vitePreload(()=>import("./jison-Ct8rtT8R.js"),__vite__mapDeps([56,2]),import.meta.url)},{id:"json",name:"JSON",import:()=>__vitePreload(()=>import("./json-DWmkr0yC.js"),[],import.meta.url)},{id:"json5",name:"JSON5",import:()=>__vitePreload(()=>import("./json5-BDjtpMT8.js"),[],import.meta.url)},{id:"jsonc",name:"JSON with Comments",import:()=>__vitePreload(()=>import("./jsonc-B8E-_56i.js"),[],import.meta.url)},{id:"jsonl",name:"JSON Lines",import:()=>__vitePreload(()=>import("./jsonl-NKd-Y1zG.js"),[],import.meta.url)},{id:"jsonnet",name:"Jsonnet",import:()=>__vitePreload(()=>import("./jsonnet-CpRrwcwt.js"),[],import.meta.url)},{id:"jssm",name:"JSSM",aliases:["fsl"],import:()=>__vitePreload(()=>import("./jssm-DlYXzDlu.js"),[],import.meta.url)},{id:"jsx",name:"JSX",import:()=>__vitePreload(()=>import("./jsx-CM4fc1WH.js"),[],import.meta.url)},{id:"julia",name:"Julia",aliases:["jl"],import:()=>__vitePreload(()=>import("./julia-Czdw582_.js"),__vite__mapDeps([57,19,20,21,22,14,58,2,59]),import.meta.url)},{id:"kotlin",name:"Kotlin",aliases:["kt","kts"],import:()=>__vitePreload(()=>import("./kotlin-BZRbnyjI.js"),[],import.meta.url)},{id:"kusto",name:"Kusto",aliases:["kql"],import:()=>__vitePreload(()=>import("./kusto-plSVBvJQ.js"),[],import.meta.url)},{id:"latex",name:"LaTeX",import:()=>__vitePreload(()=>import("./latex-BpoAco4y.js"),__vite__mapDeps([60,61,59]),import.meta.url)},{id:"lean",name:"Lean 4",aliases:["lean4"],import:()=>__vitePreload(()=>import("./lean-yLioyJ2E.js"),[],import.meta.url)},{id:"less",name:"Less",import:()=>__vitePreload(()=>import("./less-Dk1rBueR.js"),[],import.meta.url)},{id:"liquid",name:"Liquid",import:()=>__vitePreload(()=>import("./liquid-0snwLfvK.js"),__vite__mapDeps([62,1,2,3,9]),import.meta.url)},{id:"log",name:"Log file",import:()=>__vitePreload(()=>import("./log-B4_rEpOs.js"),[],import.meta.url)},{id:"logo",name:"Logo",import:()=>__vitePreload(()=>import("./logo-Dtn98rcr.js"),[],import.meta.url)},{id:"lua",name:"Lua",import:()=>__vitePreload(()=>import("./lua-B2--UKVN.js"),__vite__mapDeps([31,22]),import.meta.url)},{id:"luau",name:"Luau",import:()=>__vitePreload(()=>import("./luau-DepYB8Ml.js"),[],import.meta.url)},{id:"make",name:"Makefile",aliases:["makefile"],import:()=>__vitePreload(()=>import("./make-DNDvMORL.js"),[],import.meta.url)},{id:"markdown",name:"Markdown",aliases:["md"],import:()=>__vitePreload(()=>import("./markdown-CNXuF1yM.js"),[],import.meta.url)},{id:"marko",name:"Marko",import:()=>__vitePreload(()=>import("./marko-BxSrAFJn.js"),__vite__mapDeps([63,3,64,5,2]),import.meta.url)},{id:"matlab",name:"MATLAB",import:()=>__vitePreload(()=>import("./matlab-Kxp7UmFj.js"),[],import.meta.url)},{id:"mdc",name:"MDC",import:()=>__vitePreload(()=>import("./mdc-DfEMzj3F.js"),__vite__mapDeps([65,35,50,26,1,2,3]),import.meta.url)},{id:"mdx",name:"MDX",import:()=>__vitePreload(()=>import("./mdx-Bcw97oti.js"),[],import.meta.url)},{id:"mermaid",name:"Mermaid",aliases:["mmd"],import:()=>__vitePreload(()=>import("./mermaid-D0xWnrgR.js"),[],import.meta.url)},{id:"mipsasm",name:"MIPS Assembly",aliases:["mips"],import:()=>__vitePreload(()=>import("./mipsasm-BzaEo2Du.js"),[],import.meta.url)},{id:"mojo",name:"Mojo",import:()=>__vitePreload(()=>import("./mojo-B2bjgU-v.js"),[],import.meta.url)},{id:"move",name:"Move",import:()=>__vitePreload(()=>import("./move-EZUUsui8.js"),[],import.meta.url)},{id:"narrat",name:"Narrat Language",aliases:["nar"],import:()=>__vitePreload(()=>import("./narrat-DLbgOhZU.js"),[],import.meta.url)},{id:"nextflow",name:"Nextflow",aliases:["nf"],import:()=>__vitePreload(()=>import("./nextflow-B2uSYIFn.js"),[],import.meta.url)},{id:"nginx",name:"Nginx",import:()=>__vitePreload(()=>import("./nginx-Dw0nYz9L.js"),__vite__mapDeps([66,31,22]),import.meta.url)},{id:"nim",name:"Nim",import:()=>__vitePreload(()=>import("./nim-NHYZZDnF.js"),__vite__mapDeps([67,22,1,2,3,7,8,21,35]),import.meta.url)},{id:"nix",name:"Nix",import:()=>__vitePreload(()=>import("./nix-DVWcdiGS.js"),[],import.meta.url)},{id:"nushell",name:"nushell",aliases:["nu"],import:()=>__vitePreload(()=>import("./nushell-ZJvK9Z2N.js"),[],import.meta.url)},{id:"objective-c",name:"Objective-C",aliases:["objc"],import:()=>__vitePreload(()=>import("./objective-c-B6NdQBKR.js"),[],import.meta.url)},{id:"objective-cpp",name:"Objective-C++",import:()=>__vitePreload(()=>import("./objective-cpp-BkG9CdHo.js"),[],import.meta.url)},{id:"ocaml",name:"OCaml",import:()=>__vitePreload(()=>import("./ocaml-CLmbwNS9.js"),[],import.meta.url)},{id:"pascal",name:"Pascal",import:()=>__vitePreload(()=>import("./pascal-JqZropPD.js"),[],import.meta.url)},{id:"perl",name:"Perl",import:()=>__vitePreload(()=>import("./perl-DLffUHFU.js"),__vite__mapDeps([68,1,2,3,7,8,14]),import.meta.url)},{id:"php",name:"PHP",import:()=>__vitePreload(()=>import("./php-D3VTUn6x.js"),__vite__mapDeps([69,1,2,3,7,8,14,9]),import.meta.url)},{id:"plsql",name:"PL/SQL",import:()=>__vitePreload(()=>import("./plsql-LKU2TuZ1.js"),[],import.meta.url)},{id:"po",name:"Gettext PO",aliases:["pot","potx"],import:()=>__vitePreload(()=>import("./po-BFLt1xDp.js"),[],import.meta.url)},{id:"postcss",name:"PostCSS",import:()=>__vitePreload(()=>import("./postcss-DmF4-xLG.js"),[],import.meta.url)},{id:"powerquery",name:"PowerQuery",import:()=>__vitePreload(()=>import("./powerquery-ByY1Guvr.js"),[],import.meta.url)},{id:"powershell",name:"PowerShell",aliases:["ps","ps1"],import:()=>__vitePreload(()=>import("./powershell-DES0gjzB.js"),[],import.meta.url)},{id:"prisma",name:"Prisma",import:()=>__vitePreload(()=>import("./prisma-DFIOpqzz.js"),[],import.meta.url)},{id:"prolog",name:"Prolog",import:()=>__vitePreload(()=>import("./prolog-BNxDCkIA.js"),[],import.meta.url)},{id:"proto",name:"Protocol Buffer 3",aliases:["protobuf"],import:()=>__vitePreload(()=>import("./proto-hdsyEllQ.js"),[],import.meta.url)},{id:"pug",name:"Pug",aliases:["jade"],import:()=>__vitePreload(()=>import("./pug-BbGfWiEl.js"),__vite__mapDeps([70,2,3,1]),import.meta.url)},{id:"puppet",name:"Puppet",import:()=>__vitePreload(()=>import("./puppet-DWMP3yrW.js"),[],import.meta.url)},{id:"purescript",name:"PureScript",import:()=>__vitePreload(()=>import("./purescript-DvQyZZSe.js"),[],import.meta.url)},{id:"python",name:"Python",aliases:["py"],import:()=>__vitePreload(()=>import("./python-CK56Z9cH.js"),[],import.meta.url)},{id:"qml",name:"QML",import:()=>__vitePreload(()=>import("./qml-Dhho_E4W.js"),__vite__mapDeps([71,2]),import.meta.url)},{id:"qmldir",name:"QML Directory",import:()=>__vitePreload(()=>import("./qmldir-C8lEn-DE.js"),[],import.meta.url)},{id:"qss",name:"Qt Style Sheets",import:()=>__vitePreload(()=>import("./qss-DhMKtDLN.js"),[],import.meta.url)},{id:"r",name:"R",import:()=>__vitePreload(()=>import("./r-Cqv5JV-q.js"),[],import.meta.url)},{id:"racket",name:"Racket",import:()=>__vitePreload(()=>import("./racket-CwIbMU3B.js"),[],import.meta.url)},{id:"raku",name:"Raku",aliases:["perl6"],import:()=>__vitePreload(()=>import("./raku-DZ4hUExO.js"),[],import.meta.url)},{id:"razor",name:"ASP.NET Razor",import:()=>__vitePreload(()=>import("./razor-CDyaIOPG.js"),__vite__mapDeps([72,1,2,3,73]),import.meta.url)},{id:"reg",name:"Windows Registry Script",import:()=>__vitePreload(()=>import("./reg-CrOfvjVs.js"),[],import.meta.url)},{id:"regexp",name:"RegExp",aliases:["regex"],import:()=>__vitePreload(()=>import("./regexp-DoiKbUTj.js"),[],import.meta.url)},{id:"rel",name:"Rel",import:()=>__vitePreload(()=>import("./rel-Dzwn3p-3.js"),[],import.meta.url)},{id:"riscv",name:"RISC-V",import:()=>__vitePreload(()=>import("./riscv-BGct0Hx7.js"),[],import.meta.url)},{id:"rst",name:"reStructuredText",import:()=>__vitePreload(()=>import("./rst-BtGMdPX_.js"),__vite__mapDeps([74,26,1,2,3,19,20,21,22,14,58,24,50,75,30,7,8,31]),import.meta.url)},{id:"ruby",name:"Ruby",aliases:["rb"],import:()=>__vitePreload(()=>import("./ruby-C8Yez0Ov.js"),__vite__mapDeps([30,1,2,3,7,8,14,22,24,31]),import.meta.url)},{id:"rust",name:"Rust",aliases:["rs"],import:()=>__vitePreload(()=>import("./rust-Bjs2cL5p.js"),[],import.meta.url)},{id:"sas",name:"SAS",import:()=>__vitePreload(()=>import("./sas-K_Wwm3IX.js"),__vite__mapDeps([76,14]),import.meta.url)},{id:"sass",name:"Sass",import:()=>__vitePreload(()=>import("./sass-BrbOHqWv.js"),[],import.meta.url)},{id:"scala",name:"Scala",import:()=>__vitePreload(()=>import("./scala-Lp17StYA.js"),[],import.meta.url)},{id:"scheme",name:"Scheme",import:()=>__vitePreload(()=>import("./scheme-BbccZ3y2.js"),[],import.meta.url)},{id:"scss",name:"SCSS",import:()=>__vitePreload(()=>import("./scss-BfMQ58X7.js"),__vite__mapDeps([5,3]),import.meta.url)},{id:"sdbl",name:"1C (Query)",aliases:["1c-query"],import:()=>__vitePreload(()=>import("./sdbl-BLhTXw86.js"),[],import.meta.url)},{id:"shaderlab",name:"ShaderLab",aliases:["shader"],import:()=>__vitePreload(()=>import("./shaderlab-CsYUIUcf.js"),__vite__mapDeps([77,78]),import.meta.url)},{id:"shellscript",name:"Shell",aliases:["bash","sh","shell","zsh"],import:()=>__vitePreload(()=>import("./shellscript-HNM5thJl.js"),[],import.meta.url)},{id:"shellsession",name:"Shell Session",aliases:["console"],import:()=>__vitePreload(()=>import("./shellsession-DU_2P5ZA.js"),__vite__mapDeps([79,24]),import.meta.url)},{id:"smalltalk",name:"Smalltalk",import:()=>__vitePreload(()=>import("./smalltalk-DsCg8CPl.js"),[],import.meta.url)},{id:"solidity",name:"Solidity",import:()=>__vitePreload(()=>import("./solidity-DymQr0nX.js"),[],import.meta.url)},{id:"soy",name:"Closure Templates",aliases:["closure-templates"],import:()=>__vitePreload(()=>import("./soy-aWhPD8Nq.js"),__vite__mapDeps([80,1,2,3]),import.meta.url)},{id:"sparql",name:"SPARQL",import:()=>__vitePreload(()=>import("./sparql-B5YtT9lV.js"),__vite__mapDeps([81,82]),import.meta.url)},{id:"splunk",name:"Splunk Query Language",aliases:["spl"],import:()=>__vitePreload(()=>import("./splunk-j_FrBdja.js"),[],import.meta.url)},{id:"sql",name:"SQL",import:()=>__vitePreload(()=>import("./sql-D8nBeWSR.js"),[],import.meta.url)},{id:"ssh-config",name:"SSH Config",import:()=>__vitePreload(()=>import("./ssh-config-D-RymO5g.js"),[],import.meta.url)},{id:"stata",name:"Stata",import:()=>__vitePreload(()=>import("./stata-bRt97scT.js"),__vite__mapDeps([83,14]),import.meta.url)},{id:"stylus",name:"Stylus",aliases:["styl"],import:()=>__vitePreload(()=>import("./stylus-DwU8c_yx.js"),[],import.meta.url)},{id:"svelte",name:"Svelte",import:()=>__vitePreload(()=>import("./svelte-DK3KTNg_.js"),__vite__mapDeps([84,2,11,3,12]),import.meta.url)},{id:"swift",name:"Swift",import:()=>__vitePreload(()=>import("./swift-D2TqM893.js"),[],import.meta.url)},{id:"system-verilog",name:"SystemVerilog",import:()=>__vitePreload(()=>import("./system-verilog-DFQ4Xr-4.js"),[],import.meta.url)},{id:"systemd",name:"Systemd Units",import:()=>__vitePreload(()=>import("./systemd-DA0ESIWO.js"),[],import.meta.url)},{id:"talonscript",name:"TalonScript",aliases:["talon"],import:()=>__vitePreload(()=>import("./talonscript-CGXjegLJ.js"),[],import.meta.url)},{id:"tasl",name:"Tasl",import:()=>__vitePreload(()=>import("./tasl-CQjiPCtT.js"),[],import.meta.url)},{id:"tcl",name:"Tcl",import:()=>__vitePreload(()=>import("./tcl-NUI3YrRW.js"),[],import.meta.url)},{id:"templ",name:"Templ",import:()=>__vitePreload(()=>import("./templ-CP2hJ0oK.js"),__vite__mapDeps([85,86,2,3]),import.meta.url)},{id:"terraform",name:"Terraform",aliases:["tf","tfvars"],import:()=>__vitePreload(()=>import("./terraform-rf8nNrOk.js"),[],import.meta.url)},{id:"tex",name:"TeX",import:()=>__vitePreload(()=>import("./tex-Dej6pUpk.js"),__vite__mapDeps([61,59]),import.meta.url)},{id:"toml",name:"TOML",import:()=>__vitePreload(()=>import("./toml-Dwo6uFCY.js"),[],import.meta.url)},{id:"ts-tags",name:"TypeScript with Tags",aliases:["lit"],import:()=>__vitePreload(()=>import("./ts-tags-CiO5kd_m.js"),__vite__mapDeps([87,11,3,2,21,22,1,14,7,8]),import.meta.url)},{id:"tsv",name:"TSV",import:()=>__vitePreload(()=>import("./tsv-B_m7g4N7.js"),[],import.meta.url)},{id:"tsx",name:"TSX",import:()=>__vitePreload(()=>import("./tsx-DqpEK-75.js"),[],import.meta.url)},{id:"turtle",name:"Turtle",import:()=>__vitePreload(()=>import("./turtle-C0hdQUNN.js"),[],import.meta.url)},{id:"twig",name:"Twig",import:()=>__vitePreload(()=>import("./twig-DN6YEzOP.js"),__vite__mapDeps([88,3,2,5,69,1,7,8,14,9,58,30,22,24,31]),import.meta.url)},{id:"typescript",name:"TypeScript",aliases:["ts"],import:()=>__vitePreload(()=>import("./typescript-CVESyXxo.js"),[],import.meta.url)},{id:"typespec",name:"TypeSpec",aliases:["tsp"],import:()=>__vitePreload(()=>import("./typespec-B_R80ZlN.js"),[],import.meta.url)},{id:"typst",name:"Typst",aliases:["typ"],import:()=>__vitePreload(()=>import("./typst-F89DG-fP.js"),[],import.meta.url)},{id:"v",name:"V",import:()=>__vitePreload(()=>import("./v-DH4N8IuU.js"),[],import.meta.url)},{id:"vala",name:"Vala",import:()=>__vitePreload(()=>import("./vala-C8pgRvQH.js"),[],import.meta.url)},{id:"vb",name:"Visual Basic",aliases:["cmd"],import:()=>__vitePreload(()=>import("./vb-Bv-mwDEg.js"),[],import.meta.url)},{id:"verilog",name:"Verilog",import:()=>__vitePreload(()=>import("./verilog-6RUVFG9U.js"),[],import.meta.url)},{id:"vhdl",name:"VHDL",import:()=>__vitePreload(()=>import("./vhdl-IBB5Tl9j.js"),[],import.meta.url)},{id:"viml",name:"Vim Script",aliases:["vim","vimscript"],import:()=>__vitePreload(()=>import("./viml-CIxipgmy.js"),[],import.meta.url)},{id:"vue",name:"Vue",import:()=>__vitePreload(()=>import("./vue-xldAUJov.js"),__vite__mapDeps([89,1,2,3,11,9,26]),import.meta.url)},{id:"vue-html",name:"Vue HTML",import:()=>__vitePreload(()=>import("./vue-html-x3hEOujm.js"),__vite__mapDeps([90,89,1,2,3,11,9,26]),import.meta.url)},{id:"vyper",name:"Vyper",aliases:["vy"],import:()=>__vitePreload(()=>import("./vyper-DzaHHFTY.js"),[],import.meta.url)},{id:"wasm",name:"WebAssembly",import:()=>__vitePreload(()=>import("./wasm-sH2JAGjN.js"),[],import.meta.url)},{id:"wenyan",name:"Wenyan",aliases:["文言"],import:()=>__vitePreload(()=>import("./wenyan-7A4Fjokl.js"),[],import.meta.url)},{id:"wgsl",name:"WGSL",import:()=>__vitePreload(()=>import("./wgsl-CSoQzgif.js"),[],import.meta.url)},{id:"wikitext",name:"Wikitext",aliases:["mediawiki","wiki"],import:()=>__vitePreload(()=>import("./wikitext-BqtQrzRp.js"),[],import.meta.url)},{id:"wolfram",name:"Wolfram",aliases:["wl"],import:()=>__vitePreload(()=>import("./wolfram-aeT0-ak7.js"),[],import.meta.url)},{id:"xml",name:"XML",import:()=>__vitePreload(()=>import("./xml-BOQ9RtXF.js"),__vite__mapDeps([7,8]),import.meta.url)},{id:"xsl",name:"XSL",import:()=>__vitePreload(()=>import("./xsl-BqG2VzO2.js"),__vite__mapDeps([91,7,8]),import.meta.url)},{id:"yaml",name:"YAML",aliases:["yml"],import:()=>__vitePreload(()=>import("./yaml-CIiI48o2.js"),[],import.meta.url)},{id:"zenscript",name:"ZenScript",import:()=>__vitePreload(()=>import("./zenscript-NgWrSVUg.js"),[],import.meta.url)},{id:"zig",name:"Zig",import:()=>__vitePreload(()=>import("./zig-D44NvAEk.js"),[],import.meta.url)}],bundledLanguagesBase=Object.fromEntries(bundledLanguagesInfo.map(n=>[n.id,n.import])),bundledLanguagesAlias=Object.fromEntries(bundledLanguagesInfo.flatMap(n=>{var e;return((e=n.aliases)==null?void 0:e.map(t=>[t,n.import]))||[]})),bundledLanguages={...bundledLanguagesBase,...bundledLanguagesAlias},bundledThemesInfo=[{id:"andromeeda",displayName:"Andromeeda",type:"dark",import:()=>__vitePreload(()=>import("./andromeeda-C3khCPGq.js"),[],import.meta.url)},{id:"aurora-x",displayName:"Aurora X",type:"dark",import:()=>__vitePreload(()=>import("./aurora-x-D-2ljcwZ.js"),[],import.meta.url)},{id:"ayu-dark",displayName:"Ayu Dark",type:"dark",import:()=>__vitePreload(()=>import("./ayu-dark-Cv9koXgw.js"),[],import.meta.url)},{id:"catppuccin-frappe",displayName:"Catppuccin Frappé",type:"dark",import:()=>__vitePreload(()=>import("./catppuccin-frappe-CD_QflpE.js"),[],import.meta.url)},{id:"catppuccin-latte",displayName:"Catppuccin Latte",type:"light",import:()=>__vitePreload(()=>import("./catppuccin-latte-DRW-0cLl.js"),[],import.meta.url)},{id:"catppuccin-macchiato",displayName:"Catppuccin Macchiato",type:"dark",import:()=>__vitePreload(()=>import("./catppuccin-macchiato-C-_shW-Y.js"),[],import.meta.url)},{id:"catppuccin-mocha",displayName:"Catppuccin Mocha",type:"dark",import:()=>__vitePreload(()=>import("./catppuccin-mocha-LGGdnPYs.js"),[],import.meta.url)},{id:"dark-plus",displayName:"Dark Plus",type:"dark",import:()=>__vitePreload(()=>import("./dark-plus-B74Y8nHz.js"),[],import.meta.url)},{id:"dracula",displayName:"Dracula Theme",type:"dark",import:()=>__vitePreload(()=>import("./dracula-BzJJZx-M.js"),[],import.meta.url)},{id:"dracula-soft",displayName:"Dracula Theme Soft",type:"dark",import:()=>__vitePreload(()=>import("./dracula-soft-BXkSAIEj.js"),[],import.meta.url)},{id:"everforest-dark",displayName:"Everforest Dark",type:"dark",import:()=>__vitePreload(()=>import("./everforest-dark-BgDCqdQA.js"),[],import.meta.url)},{id:"everforest-light",displayName:"Everforest Light",type:"light",import:()=>__vitePreload(()=>import("./everforest-light-C8M2exoo.js"),[],import.meta.url)},{id:"github-dark",displayName:"GitHub Dark",type:"dark",import:()=>__vitePreload(()=>import("./github-dark-DHJKELXO.js"),[],import.meta.url)},{id:"github-dark-default",displayName:"GitHub Dark Default",type:"dark",import:()=>__vitePreload(()=>import("./github-dark-default-Cuk6v7N8.js"),[],import.meta.url)},{id:"github-dark-dimmed",displayName:"GitHub Dark Dimmed",type:"dark",import:()=>__vitePreload(()=>import("./github-dark-dimmed-DH5Ifo-i.js"),[],import.meta.url)},{id:"github-dark-high-contrast",displayName:"GitHub Dark High Contrast",type:"dark",import:()=>__vitePreload(()=>import("./github-dark-high-contrast-E3gJ1_iC.js"),[],import.meta.url)},{id:"github-light",displayName:"GitHub Light",type:"light",import:()=>__vitePreload(()=>import("./github-light-DAi9KRSo.js"),[],import.meta.url)},{id:"github-light-default",displayName:"GitHub Light Default",type:"light",import:()=>__vitePreload(()=>import("./github-light-default-D7oLnXFd.js"),[],import.meta.url)},{id:"github-light-high-contrast",displayName:"GitHub Light High Contrast",type:"light",import:()=>__vitePreload(()=>import("./github-light-high-contrast-BfjtVDDH.js"),[],import.meta.url)},{id:"houston",displayName:"Houston",type:"dark",import:()=>__vitePreload(()=>import("./houston-DnULxvSX.js"),[],import.meta.url)},{id:"kanagawa-dragon",displayName:"Kanagawa Dragon",type:"dark",import:()=>__vitePreload(()=>import("./kanagawa-dragon-RXHOmnpW.js"),[],import.meta.url)},{id:"kanagawa-lotus",displayName:"Kanagawa Lotus",type:"light",import:()=>__vitePreload(()=>import("./kanagawa-lotus-zchoCBdH.js"),[],import.meta.url)},{id:"kanagawa-wave",displayName:"Kanagawa Wave",type:"dark",import:()=>__vitePreload(()=>import("./kanagawa-wave-2aygx1xg.js"),[],import.meta.url)},{id:"laserwave",displayName:"LaserWave",type:"dark",import:()=>__vitePreload(()=>import("./laserwave-DUszq2jm.js"),[],import.meta.url)},{id:"light-plus",displayName:"Light Plus",type:"light",import:()=>__vitePreload(()=>import("./light-plus-w1el_4yc.js"),[],import.meta.url)},{id:"material-theme",displayName:"Material Theme",type:"dark",import:()=>__vitePreload(()=>import("./material-theme-D5KoaKCx.js"),[],import.meta.url)},{id:"material-theme-darker",displayName:"Material Theme Darker",type:"dark",import:()=>__vitePreload(()=>import("./material-theme-darker-BfHTSMKl.js"),[],import.meta.url)},{id:"material-theme-lighter",displayName:"Material Theme Lighter",type:"light",import:()=>__vitePreload(()=>import("./material-theme-lighter-B0m2ddpp.js"),[],import.meta.url)},{id:"material-theme-ocean",displayName:"Material Theme Ocean",type:"dark",import:()=>__vitePreload(()=>import("./material-theme-ocean-CyktbL80.js"),[],import.meta.url)},{id:"material-theme-palenight",displayName:"Material Theme Palenight",type:"dark",import:()=>__vitePreload(()=>import("./material-theme-palenight-Csfq5Kiy.js"),[],import.meta.url)},{id:"min-dark",displayName:"Min Dark",type:"dark",import:()=>__vitePreload(()=>import("./min-dark-CafNBF8u.js"),[],import.meta.url)},{id:"min-light",displayName:"Min Light",type:"light",import:()=>__vitePreload(()=>import("./min-light-CTRr51gU.js"),[],import.meta.url)},{id:"monokai",displayName:"Monokai",type:"dark",import:()=>__vitePreload(()=>import("./monokai-CQWsIgnU.js"),[],import.meta.url)},{id:"night-owl",displayName:"Night Owl",type:"dark",import:()=>__vitePreload(()=>import("./night-owl-C6J8XiCD.js"),[],import.meta.url)},{id:"nord",displayName:"Nord",type:"dark",import:()=>__vitePreload(()=>import("./nord-Ddv68eIx.js"),[],import.meta.url)},{id:"one-dark-pro",displayName:"One Dark Pro",type:"dark",import:()=>__vitePreload(()=>import("./one-dark-pro-GBQ2dnAY.js"),[],import.meta.url)},{id:"one-light",displayName:"One Light",type:"light",import:()=>__vitePreload(()=>import("./one-light-PoHY5YXO.js"),[],import.meta.url)},{id:"plastic",displayName:"Plastic",type:"dark",import:()=>__vitePreload(()=>import("./plastic-3e1v2bzS.js"),[],import.meta.url)},{id:"poimandres",displayName:"Poimandres",type:"dark",import:()=>__vitePreload(()=>import("./poimandres-CS3Unz2-.js"),[],import.meta.url)},{id:"red",displayName:"Red",type:"dark",import:()=>__vitePreload(()=>import("./red-2pWuV6-S.js"),[],import.meta.url)},{id:"rose-pine",displayName:"Rosé Pine",type:"dark",import:()=>__vitePreload(()=>import("./rose-pine-CmCqftbK.js"),[],import.meta.url)},{id:"rose-pine-dawn",displayName:"Rosé Pine Dawn",type:"light",import:()=>__vitePreload(()=>import("./rose-pine-dawn-Ds-gbosJ.js"),[],import.meta.url)},{id:"rose-pine-moon",displayName:"Rosé Pine Moon",type:"dark",import:()=>__vitePreload(()=>import("./rose-pine-moon-CjDtw9vr.js"),[],import.meta.url)},{id:"slack-dark",displayName:"Slack Dark",type:"dark",import:()=>__vitePreload(()=>import("./slack-dark-BthQWCQV.js"),[],import.meta.url)},{id:"slack-ochin",displayName:"Slack Ochin",type:"light",import:()=>__vitePreload(()=>import("./slack-ochin-DqwNpetd.js"),[],import.meta.url)},{id:"snazzy-light",displayName:"Snazzy Light",type:"light",import:()=>__vitePreload(()=>import("./snazzy-light-Bw305WKR.js"),[],import.meta.url)},{id:"solarized-dark",displayName:"Solarized Dark",type:"dark",import:()=>__vitePreload(()=>import("./solarized-dark-CmY0Y6Yh.js"),[],import.meta.url)},{id:"solarized-light",displayName:"Solarized Light",type:"light",import:()=>__vitePreload(()=>import("./solarized-light-DZQMDcrx.js"),[],import.meta.url)},{id:"synthwave-84",displayName:"Synthwave '84",type:"dark",import:()=>__vitePreload(()=>import("./synthwave-84-CbfX1IO0.js"),[],import.meta.url)},{id:"tokyo-night",displayName:"Tokyo Night",type:"dark",import:()=>__vitePreload(()=>import("./tokyo-night-DBQeEorK.js"),[],import.meta.url)},{id:"vesper",displayName:"Vesper",type:"dark",import:()=>__vitePreload(()=>import("./vesper-BEBZ7ncR.js"),[],import.meta.url)},{id:"vitesse-black",displayName:"Vitesse Black",type:"dark",import:()=>__vitePreload(()=>import("./vitesse-black-Bkuqu6BP.js"),[],import.meta.url)},{id:"vitesse-dark",displayName:"Vitesse Dark",type:"dark",import:()=>__vitePreload(()=>import("./vitesse-dark-D0r3Knsf.js"),[],import.meta.url)},{id:"vitesse-light",displayName:"Vitesse Light",type:"light",import:()=>__vitePreload(()=>import("./vitesse-light-CVO1_9PV.js"),[],import.meta.url)}],bundledThemes=Object.fromEntries(bundledThemesInfo.map(n=>[n.id,n.import]));let ShikiError$2=class extends Error{constructor(e){super(e),this.name="ShikiError"}},ShikiError$1=class extends Error{constructor(e){super(e),this.name="ShikiError"}};function getHeapMax(){return 2147483648}function _emscripten_get_now(){return typeof performance<"u"?performance.now():Date.now()}const alignUp=(n,e)=>n+(e-n%e)%e;async function main(n){let e,t;const r={};function i(m){t=m,r.HEAPU8=new Uint8Array(m),r.HEAPU32=new Uint32Array(m)}function s(m,g,v){r.HEAPU8.copyWithin(m,g,g+v)}function o(m){try{return e.grow(m-t.byteLength+65535>>>16),i(e.buffer),1}catch{}}function a(m){const g=r.HEAPU8.length;m=m>>>0;const v=getHeapMax();if(m>v)return!1;for(let x=1;x<=4;x*=2){let S=g*(1+.2/x);S=Math.min(S,m+100663296);const C=Math.min(v,alignUp(Math.max(m,S),65536));if(o(C))return!0}return!1}const l=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function c(m,g,v=1024){const x=g+v;let S=g;for(;m[S]&&!(S>=x);)++S;if(S-g>16&&m.buffer&&l)return l.decode(m.subarray(g,S));let C="";for(;g<S;){let R=m[g++];if(!(R&128)){C+=String.fromCharCode(R);continue}const k=m[g++]&63;if((R&224)===192){C+=String.fromCharCode((R&31)<<6|k);continue}const I=m[g++]&63;if((R&240)===224?R=(R&15)<<12|k<<6|I:R=(R&7)<<18|k<<12|I<<6|m[g++]&63,R<65536)C+=String.fromCharCode(R);else{const F=R-65536;C+=String.fromCharCode(55296|F>>10,56320|F&1023)}}return C}function u(m,g){return m?c(r.HEAPU8,m,g):""}const d={emscripten_get_now:_emscripten_get_now,emscripten_memcpy_big:s,emscripten_resize_heap:a,fd_write:()=>0};async function f(){const g=await n({env:d,wasi_snapshot_preview1:d});e=g.memory,i(e.buffer),Object.assign(r,g),r.UTF8ToString=u}return await f(),r}let onigBinding=null;function throwLastOnigError(n){throw new ShikiError$1(n.UTF8ToString(n.getLastOnigError()))}class UtfString{constructor(e){Fe(this,"utf16Length");Fe(this,"utf8Length");Fe(this,"utf16Value");Fe(this,"utf8Value");Fe(this,"utf16OffsetToUtf8");Fe(this,"utf8OffsetToUtf16");const t=e.length,r=UtfString._utf8ByteLength(e),i=r!==t,s=i?new Uint32Array(t+1):null;i&&(s[t]=r);const o=i?new Uint32Array(r+1):null;i&&(o[r]=t);const a=new Uint8Array(r);let l=0;for(let c=0;c<t;c++){const u=e.charCodeAt(c);let d=u,f=!1;if(u>=55296&&u<=56319&&c+1<t){const m=e.charCodeAt(c+1);m>=56320&&m<=57343&&(d=(u-55296<<10)+65536|m-56320,f=!0)}i&&(s[c]=l,f&&(s[c+1]=l),d<=127?o[l+0]=c:d<=2047?(o[l+0]=c,o[l+1]=c):d<=65535?(o[l+0]=c,o[l+1]=c,o[l+2]=c):(o[l+0]=c,o[l+1]=c,o[l+2]=c,o[l+3]=c)),d<=127?a[l++]=d:d<=2047?(a[l++]=192|(d&1984)>>>6,a[l++]=128|(d&63)>>>0):d<=65535?(a[l++]=224|(d&61440)>>>12,a[l++]=128|(d&4032)>>>6,a[l++]=128|(d&63)>>>0):(a[l++]=240|(d&1835008)>>>18,a[l++]=128|(d&258048)>>>12,a[l++]=128|(d&4032)>>>6,a[l++]=128|(d&63)>>>0),f&&c++}this.utf16Length=t,this.utf8Length=r,this.utf16Value=e,this.utf8Value=a,this.utf16OffsetToUtf8=s,this.utf8OffsetToUtf16=o}static _utf8ByteLength(e){let t=0;for(let r=0,i=e.length;r<i;r++){const s=e.charCodeAt(r);let o=s,a=!1;if(s>=55296&&s<=56319&&r+1<i){const l=e.charCodeAt(r+1);l>=56320&&l<=57343&&(o=(s-55296<<10)+65536|l-56320,a=!0)}o<=127?t+=1:o<=2047?t+=2:o<=65535?t+=3:t+=4,a&&r++}return t}createString(e){const t=e.omalloc(this.utf8Length);return e.HEAPU8.set(this.utf8Value,t),t}}const Ke=class Ke{constructor(e){Fe(this,"id",++Ke.LAST_ID);Fe(this,"_onigBinding");Fe(this,"content");Fe(this,"utf16Length");Fe(this,"utf8Length");Fe(this,"utf16OffsetToUtf8");Fe(this,"utf8OffsetToUtf16");Fe(this,"ptr");if(!onigBinding)throw new ShikiError$1("Must invoke loadWasm first.");this._onigBinding=onigBinding,this.content=e;const t=new UtfString(e);this.utf16Length=t.utf16Length,this.utf8Length=t.utf8Length,this.utf16OffsetToUtf8=t.utf16OffsetToUtf8,this.utf8OffsetToUtf16=t.utf8OffsetToUtf16,this.utf8Length<1e4&&!Ke._sharedPtrInUse?(Ke._sharedPtr||(Ke._sharedPtr=onigBinding.omalloc(1e4)),Ke._sharedPtrInUse=!0,onigBinding.HEAPU8.set(t.utf8Value,Ke._sharedPtr),this.ptr=Ke._sharedPtr):this.ptr=t.createString(onigBinding)}convertUtf8OffsetToUtf16(e){return this.utf8OffsetToUtf16?e<0?0:e>this.utf8Length?this.utf16Length:this.utf8OffsetToUtf16[e]:e}convertUtf16OffsetToUtf8(e){return this.utf16OffsetToUtf8?e<0?0:e>this.utf16Length?this.utf8Length:this.utf16OffsetToUtf8[e]:e}dispose(){this.ptr===Ke._sharedPtr?Ke._sharedPtrInUse=!1:this._onigBinding.ofree(this.ptr)}};Fe(Ke,"LAST_ID",0),Fe(Ke,"_sharedPtr",0),Fe(Ke,"_sharedPtrInUse",!1);let OnigString=Ke;class OnigScanner{constructor(e){Fe(this,"_onigBinding");Fe(this,"_ptr");if(!onigBinding)throw new ShikiError$1("Must invoke loadWasm first.");const t=[],r=[];for(let a=0,l=e.length;a<l;a++){const c=new UtfString(e[a]);t[a]=c.createString(onigBinding),r[a]=c.utf8Length}const i=onigBinding.omalloc(4*e.length);onigBinding.HEAPU32.set(t,i/4);const s=onigBinding.omalloc(4*e.length);onigBinding.HEAPU32.set(r,s/4);const o=onigBinding.createOnigScanner(i,s,e.length);for(let a=0,l=e.length;a<l;a++)onigBinding.ofree(t[a]);onigBinding.ofree(s),onigBinding.ofree(i),o===0&&throwLastOnigError(onigBinding),this._onigBinding=onigBinding,this._ptr=o}dispose(){this._onigBinding.freeOnigScanner(this._ptr)}findNextMatchSync(e,t,r){let i=0;if(typeof r=="number"&&(i=r),typeof e=="string"){e=new OnigString(e);const s=this._findNextMatchSync(e,t,!1,i);return e.dispose(),s}return this._findNextMatchSync(e,t,!1,i)}_findNextMatchSync(e,t,r,i){const s=this._onigBinding,o=s.findNextOnigScannerMatch(this._ptr,e.id,e.ptr,e.utf8Length,e.convertUtf16OffsetToUtf8(t),i);if(o===0)return null;const a=s.HEAPU32;let l=o/4;const c=a[l++],u=a[l++],d=[];for(let f=0;f<u;f++){const m=e.convertUtf8OffsetToUtf16(a[l++]),g=e.convertUtf8OffsetToUtf16(a[l++]);d[f]={start:m,end:g,length:g-m}}return{index:c,captureIndices:d}}}function isInstantiatorOptionsObject(n){return typeof n.instantiator=="function"}function isInstantiatorModule(n){return typeof n.default=="function"}function isDataOptionsObject(n){return typeof n.data<"u"}function isResponse(n){return typeof Response<"u"&&n instanceof Response}function isArrayBuffer(n){var e;return typeof ArrayBuffer<"u"&&(n instanceof ArrayBuffer||ArrayBuffer.isView(n))||typeof Buffer<"u"&&((e=Buffer.isBuffer)==null?void 0:e.call(Buffer,n))||typeof SharedArrayBuffer<"u"&&n instanceof SharedArrayBuffer||typeof Uint32Array<"u"&&n instanceof Uint32Array}let initPromise;function loadWasm(n){if(initPromise)return initPromise;async function e(){onigBinding=await main(async t=>{let r=n;return r=await r,typeof r=="function"&&(r=await r(t)),typeof r=="function"&&(r=await r(t)),isInstantiatorOptionsObject(r)?r=await r.instantiator(t):isInstantiatorModule(r)?r=await r.default(t):(isDataOptionsObject(r)&&(r=r.data),isResponse(r)?typeof WebAssembly.instantiateStreaming=="function"?r=await _makeResponseStreamingLoader(r)(t):r=await _makeResponseNonStreamingLoader(r)(t):isArrayBuffer(r)?r=await _makeArrayBufferLoader(r)(t):r instanceof WebAssembly.Module?r=await _makeArrayBufferLoader(r)(t):"default"in r&&r.default instanceof WebAssembly.Module&&(r=await _makeArrayBufferLoader(r.default)(t))),"instance"in r&&(r=r.instance),"exports"in r&&(r=r.exports),r})}return initPromise=e(),initPromise}function _makeArrayBufferLoader(n){return e=>WebAssembly.instantiate(n,e)}function _makeResponseStreamingLoader(n){return e=>WebAssembly.instantiateStreaming(n,e)}function _makeResponseNonStreamingLoader(n){return async e=>{const t=await n.arrayBuffer();return WebAssembly.instantiate(t,e)}}let _defaultWasmLoader;function getDefaultWasmLoader(){return _defaultWasmLoader}async function createOnigurumaEngine(n){return n&&await loadWasm(n),{createScanner(e){return new OnigScanner(e)},createString(e){return new OnigString(e)}}}function clone(n){return doClone(n)}function doClone(n){return Array.isArray(n)?cloneArray(n):typeof n=="object"?cloneObj(n):n}function cloneArray(n){let e=[];for(let t=0,r=n.length;t<r;t++)e[t]=doClone(n[t]);return e}function cloneObj(n){let e={};for(let t in n)e[t]=doClone(n[t]);return e}function mergeObjects(n,...e){return e.forEach(t=>{for(let r in t)n[r]=t[r]}),n}function basename(n){const e=~n.lastIndexOf("/")||~n.lastIndexOf("\\");return e===0?n:~e===n.length-1?basename(n.substring(0,n.length-1)):n.substr(~e+1)}var CAPTURING_REGEX_SOURCE=/\$(\d+)|\${(\d+):\/(downcase|upcase)}/g,RegexSource=class{static hasCaptures(n){return n===null?!1:(CAPTURING_REGEX_SOURCE.lastIndex=0,CAPTURING_REGEX_SOURCE.test(n))}static replaceCaptures(n,e,t){return n.replace(CAPTURING_REGEX_SOURCE,(r,i,s,o)=>{let a=t[parseInt(i||s,10)];if(a){let l=e.substring(a.start,a.end);for(;l[0]===".";)l=l.substring(1);switch(o){case"downcase":return l.toLowerCase();case"upcase":return l.toUpperCase();default:return l}}else return r})}};function strcmp(n,e){return n<e?-1:n>e?1:0}function strArrCmp(n,e){if(n===null&&e===null)return 0;if(!n)return-1;if(!e)return 1;let t=n.length,r=e.length;if(t===r){for(let i=0;i<t;i++){let s=strcmp(n[i],e[i]);if(s!==0)return s}return 0}return t-r}function isValidHexColor(n){return!!(/^#[0-9a-f]{6}$/i.test(n)||/^#[0-9a-f]{8}$/i.test(n)||/^#[0-9a-f]{3}$/i.test(n)||/^#[0-9a-f]{4}$/i.test(n))}function escapeRegExpCharacters(n){return n.replace(/[\-\\\{\}\*\+\?\|\^\$\.\,\[\]\(\)\#\s]/g,"\\$&")}var CachedFn=class{constructor(n){this.fn=n,this.cache=new Map}get(n){if(this.cache.has(n))return this.cache.get(n);const e=this.fn(n);return this.cache.set(n,e),e}},Theme=class{constructor(n,e,t){this._colorMap=n,this._defaults=e,this._root=t,this._cachedMatchRoot=new CachedFn(r=>this._root.match(r))}static createFromRawTheme(n,e){return this.createFromParsedTheme(parseTheme(n),e)}static createFromParsedTheme(n,e){return resolveParsedThemeRules(n,e)}getColorMap(){return this._colorMap.getColorMap()}getDefaults(){return this._defaults}match(n){if(n===null)return this._defaults;const e=n.scopeName,r=this._cachedMatchRoot.get(e).find(i=>_scopePathMatchesParentScopes(n.parent,i.parentScopes));return r?new StyleAttributes(r.fontStyle,r.foreground,r.background):null}},ScopeStack=class Gt{constructor(e,t){this.parent=e,this.scopeName=t}static push(e,t){for(const r of t)e=new Gt(e,r);return e}static from(...e){let t=null;for(let r=0;r<e.length;r++)t=new Gt(t,e[r]);return t}push(e){return new Gt(this,e)}getSegments(){let e=this;const t=[];for(;e;)t.push(e.scopeName),e=e.parent;return t.reverse(),t}toString(){return this.getSegments().join(" ")}extends(e){return this===e?!0:this.parent===null?!1:this.parent.extends(e)}getExtensionIfDefined(e){const t=[];let r=this;for(;r&&r!==e;)t.push(r.scopeName),r=r.parent;return r===e?t.reverse():void 0}};function _scopePathMatchesParentScopes(n,e){if(e.length===0)return!0;for(let t=0;t<e.length;t++){let r=e[t],i=!1;if(r===">"){if(t===e.length-1)return!1;r=e[++t],i=!0}for(;n&&!_matchesScope(n.scopeName,r);){if(i)return!1;n=n.parent}if(!n)return!1;n=n.parent}return!0}function _matchesScope(n,e){return e===n||n.startsWith(e)&&n[e.length]==="."}var StyleAttributes=class{constructor(n,e,t){this.fontStyle=n,this.foregroundId=e,this.backgroundId=t}};function parseTheme(n){if(!n)return[];if(!n.settings||!Array.isArray(n.settings))return[];let e=n.settings,t=[],r=0;for(let i=0,s=e.length;i<s;i++){let o=e[i];if(!o.settings)continue;let a;if(typeof o.scope=="string"){let d=o.scope;d=d.replace(/^[,]+/,""),d=d.replace(/[,]+$/,""),a=d.split(",")}else Array.isArray(o.scope)?a=o.scope:a=[""];let l=-1;if(typeof o.settings.fontStyle=="string"){l=0;let d=o.settings.fontStyle.split(" ");for(let f=0,m=d.length;f<m;f++)switch(d[f]){case"italic":l=l|1;break;case"bold":l=l|2;break;case"underline":l=l|4;break;case"strikethrough":l=l|8;break}}let c=null;typeof o.settings.foreground=="string"&&isValidHexColor(o.settings.foreground)&&(c=o.settings.foreground);let u=null;typeof o.settings.background=="string"&&isValidHexColor(o.settings.background)&&(u=o.settings.background);for(let d=0,f=a.length;d<f;d++){let g=a[d].trim().split(" "),v=g[g.length-1],x=null;g.length>1&&(x=g.slice(0,g.length-1),x.reverse()),t[r++]=new ParsedThemeRule(v,x,i,l,c,u)}}return t}var ParsedThemeRule=class{constructor(n,e,t,r,i,s){this.scope=n,this.parentScopes=e,this.index=t,this.fontStyle=r,this.foreground=i,this.background=s}},FontStyle=(n=>(n[n.NotSet=-1]="NotSet",n[n.None=0]="None",n[n.Italic=1]="Italic",n[n.Bold=2]="Bold",n[n.Underline=4]="Underline",n[n.Strikethrough=8]="Strikethrough",n))(FontStyle||{});function resolveParsedThemeRules(n,e){n.sort((l,c)=>{let u=strcmp(l.scope,c.scope);return u!==0||(u=strArrCmp(l.parentScopes,c.parentScopes),u!==0)?u:l.index-c.index});let t=0,r="#000000",i="#ffffff";for(;n.length>=1&&n[0].scope==="";){let l=n.shift();l.fontStyle!==-1&&(t=l.fontStyle),l.foreground!==null&&(r=l.foreground),l.background!==null&&(i=l.background)}let s=new ColorMap(e),o=new StyleAttributes(t,s.getId(r),s.getId(i)),a=new ThemeTrieElement(new ThemeTrieElementRule(0,null,-1,0,0),[]);for(let l=0,c=n.length;l<c;l++){let u=n[l];a.insert(0,u.scope,u.parentScopes,u.fontStyle,s.getId(u.foreground),s.getId(u.background))}return new Theme(s,o,a)}var ColorMap=class{constructor(n){if(this._lastColorId=0,this._id2color=[],this._color2id=Object.create(null),Array.isArray(n)){this._isFrozen=!0;for(let e=0,t=n.length;e<t;e++)this._color2id[n[e]]=e,this._id2color[e]=n[e]}else this._isFrozen=!1}getId(n){if(n===null)return 0;n=n.toUpperCase();let e=this._color2id[n];if(e)return e;if(this._isFrozen)throw new Error(`Missing color in color map - ${n}`);return e=++this._lastColorId,this._color2id[n]=e,this._id2color[e]=n,e}getColorMap(){return this._id2color.slice(0)}},emptyParentScopes=Object.freeze([]),ThemeTrieElementRule=class Mn{constructor(e,t,r,i,s){this.scopeDepth=e,this.parentScopes=t||emptyParentScopes,this.fontStyle=r,this.foreground=i,this.background=s}clone(){return new Mn(this.scopeDepth,this.parentScopes,this.fontStyle,this.foreground,this.background)}static cloneArr(e){let t=[];for(let r=0,i=e.length;r<i;r++)t[r]=e[r].clone();return t}acceptOverwrite(e,t,r,i){this.scopeDepth>e?console.log("how did this happen?"):this.scopeDepth=e,t!==-1&&(this.fontStyle=t),r!==0&&(this.foreground=r),i!==0&&(this.background=i)}},ThemeTrieElement=class nn{constructor(e,t=[],r={}){this._mainRule=e,this._children=r,this._rulesWithParentScopes=t}static _cmpBySpecificity(e,t){if(e.scopeDepth!==t.scopeDepth)return t.scopeDepth-e.scopeDepth;let r=0,i=0;for(;e.parentScopes[r]===">"&&r++,t.parentScopes[i]===">"&&i++,!(r>=e.parentScopes.length||i>=t.parentScopes.length);){const s=t.parentScopes[i].length-e.parentScopes[r].length;if(s!==0)return s;r++,i++}return t.parentScopes.length-e.parentScopes.length}match(e){if(e!==""){let r=e.indexOf("."),i,s;if(r===-1?(i=e,s=""):(i=e.substring(0,r),s=e.substring(r+1)),this._children.hasOwnProperty(i))return this._children[i].match(s)}const t=this._rulesWithParentScopes.concat(this._mainRule);return t.sort(nn._cmpBySpecificity),t}insert(e,t,r,i,s,o){if(t===""){this._doInsertHere(e,r,i,s,o);return}let a=t.indexOf("."),l,c;a===-1?(l=t,c=""):(l=t.substring(0,a),c=t.substring(a+1));let u;this._children.hasOwnProperty(l)?u=this._children[l]:(u=new nn(this._mainRule.clone(),ThemeTrieElementRule.cloneArr(this._rulesWithParentScopes)),this._children[l]=u),u.insert(e+1,c,r,i,s,o)}_doInsertHere(e,t,r,i,s){if(t===null){this._mainRule.acceptOverwrite(e,r,i,s);return}for(let o=0,a=this._rulesWithParentScopes.length;o<a;o++){let l=this._rulesWithParentScopes[o];if(strArrCmp(l.parentScopes,t)===0){l.acceptOverwrite(e,r,i,s);return}}r===-1&&(r=this._mainRule.fontStyle),i===0&&(i=this._mainRule.foreground),s===0&&(s=this._mainRule.background),this._rulesWithParentScopes.push(new ThemeTrieElementRule(e,t,r,i,s))}},EncodedTokenMetadata=class ze{static toBinaryStr(e){return e.toString(2).padStart(32,"0")}static print(e){const t=ze.getLanguageId(e),r=ze.getTokenType(e),i=ze.getFontStyle(e),s=ze.getForeground(e),o=ze.getBackground(e);console.log({languageId:t,tokenType:r,fontStyle:i,foreground:s,background:o})}static getLanguageId(e){return(e&255)>>>0}static getTokenType(e){return(e&768)>>>8}static containsBalancedBrackets(e){return(e&1024)!==0}static getFontStyle(e){return(e&30720)>>>11}static getForeground(e){return(e&16744448)>>>15}static getBackground(e){return(e&4278190080)>>>24}static set(e,t,r,i,s,o,a){let l=ze.getLanguageId(e),c=ze.getTokenType(e),u=ze.containsBalancedBrackets(e)?1:0,d=ze.getFontStyle(e),f=ze.getForeground(e),m=ze.getBackground(e);return t!==0&&(l=t),r!==8&&(c=r),i!==null&&(u=i?1:0),s!==-1&&(d=s),o!==0&&(f=o),a!==0&&(m=a),(l<<0|c<<8|u<<10|d<<11|f<<15|m<<24)>>>0}};function toOptionalTokenType(n){return n}function fromOptionalTokenType(n){return n}function createMatchers(n,e){const t=[],r=newTokenizer(n);let i=r.next();for(;i!==null;){let l=0;if(i.length===2&&i.charAt(1)===":"){switch(i.charAt(0)){case"R":l=1;break;case"L":l=-1;break;default:console.log(`Unknown priority ${i} in scope selector`)}i=r.next()}let c=o();if(t.push({matcher:c,priority:l}),i!==",")break;i=r.next()}return t;function s(){if(i==="-"){i=r.next();const l=s();return c=>!!l&&!l(c)}if(i==="("){i=r.next();const l=a();return i===")"&&(i=r.next()),l}if(isIdentifier(i)){const l=[];do l.push(i),i=r.next();while(isIdentifier(i));return c=>e(l,c)}return null}function o(){const l=[];let c=s();for(;c;)l.push(c),c=s();return u=>l.every(d=>d(u))}function a(){const l=[];let c=o();for(;c&&(l.push(c),i==="|"||i===",");){do i=r.next();while(i==="|"||i===",");c=o()}return u=>l.some(d=>d(u))}}function isIdentifier(n){return!!n&&!!n.match(/[\w\.:]+/)}function newTokenizer(n){let e=/([LR]:|[\w\.:][\w\.:\-]*|[\,\|\-\(\)])/g,t=e.exec(n);return{next:()=>{if(!t)return null;const r=t[0];return t=e.exec(n),r}}}function disposeOnigString(n){typeof n.dispose=="function"&&n.dispose()}var TopLevelRuleReference=class{constructor(n){this.scopeName=n}toKey(){return this.scopeName}},TopLevelRepositoryRuleReference=class{constructor(n,e){this.scopeName=n,this.ruleName=e}toKey(){return`${this.scopeName}#${this.ruleName}`}},ExternalReferenceCollector=class{constructor(){this._references=[],this._seenReferenceKeys=new Set,this.visitedRule=new Set}get references(){return this._references}add(n){const e=n.toKey();this._seenReferenceKeys.has(e)||(this._seenReferenceKeys.add(e),this._references.push(n))}},ScopeDependencyProcessor=class{constructor(n,e){this.repo=n,this.initialScopeName=e,this.seenFullScopeRequests=new Set,this.seenPartialScopeRequests=new Set,this.seenFullScopeRequests.add(this.initialScopeName),this.Q=[new TopLevelRuleReference(this.initialScopeName)]}processQueue(){const n=this.Q;this.Q=[];const e=new ExternalReferenceCollector;for(const t of n)collectReferencesOfReference(t,this.initialScopeName,this.repo,e);for(const t of e.references)if(t instanceof TopLevelRuleReference){if(this.seenFullScopeRequests.has(t.scopeName))continue;this.seenFullScopeRequests.add(t.scopeName),this.Q.push(t)}else{if(this.seenFullScopeRequests.has(t.scopeName)||this.seenPartialScopeRequests.has(t.toKey()))continue;this.seenPartialScopeRequests.add(t.toKey()),this.Q.push(t)}}};function collectReferencesOfReference(n,e,t,r){const i=t.lookup(n.scopeName);if(!i){if(n.scopeName===e)throw new Error(`No grammar provided for <${e}>`);return}const s=t.lookup(e);n instanceof TopLevelRuleReference?collectExternalReferencesInTopLevelRule({baseGrammar:s,selfGrammar:i},r):collectExternalReferencesInTopLevelRepositoryRule(n.ruleName,{baseGrammar:s,selfGrammar:i,repository:i.repository},r);const o=t.injections(n.scopeName);if(o)for(const a of o)r.add(new TopLevelRuleReference(a))}function collectExternalReferencesInTopLevelRepositoryRule(n,e,t){if(e.repository&&e.repository[n]){const r=e.repository[n];collectExternalReferencesInRules([r],e,t)}}function collectExternalReferencesInTopLevelRule(n,e){n.selfGrammar.patterns&&Array.isArray(n.selfGrammar.patterns)&&collectExternalReferencesInRules(n.selfGrammar.patterns,{...n,repository:n.selfGrammar.repository},e),n.selfGrammar.injections&&collectExternalReferencesInRules(Object.values(n.selfGrammar.injections),{...n,repository:n.selfGrammar.repository},e)}function collectExternalReferencesInRules(n,e,t){for(const r of n){if(t.visitedRule.has(r))continue;t.visitedRule.add(r);const i=r.repository?mergeObjects({},e.repository,r.repository):e.repository;Array.isArray(r.patterns)&&collectExternalReferencesInRules(r.patterns,{...e,repository:i},t);const s=r.include;if(!s)continue;const o=parseInclude(s);switch(o.kind){case 0:collectExternalReferencesInTopLevelRule({...e,selfGrammar:e.baseGrammar},t);break;case 1:collectExternalReferencesInTopLevelRule(e,t);break;case 2:collectExternalReferencesInTopLevelRepositoryRule(o.ruleName,{...e,repository:i},t);break;case 3:case 4:const a=o.scopeName===e.selfGrammar.scopeName?e.selfGrammar:o.scopeName===e.baseGrammar.scopeName?e.baseGrammar:void 0;if(a){const l={baseGrammar:e.baseGrammar,selfGrammar:a,repository:i};o.kind===4?collectExternalReferencesInTopLevelRepositoryRule(o.ruleName,l,t):collectExternalReferencesInTopLevelRule(l,t)}else o.kind===4?t.add(new TopLevelRepositoryRuleReference(o.scopeName,o.ruleName)):t.add(new TopLevelRuleReference(o.scopeName));break}}}var BaseReference=class{constructor(){this.kind=0}},SelfReference=class{constructor(){this.kind=1}},RelativeReference=class{constructor(n){this.ruleName=n,this.kind=2}},TopLevelReference=class{constructor(n){this.scopeName=n,this.kind=3}},TopLevelRepositoryReference=class{constructor(n,e){this.scopeName=n,this.ruleName=e,this.kind=4}};function parseInclude(n){if(n==="$base")return new BaseReference;if(n==="$self")return new SelfReference;const e=n.indexOf("#");if(e===-1)return new TopLevelReference(n);if(e===0)return new RelativeReference(n.substring(1));{const t=n.substring(0,e),r=n.substring(e+1);return new TopLevelRepositoryReference(t,r)}}var HAS_BACK_REFERENCES=/\\(\d+)/,BACK_REFERENCING_END=/\\(\d+)/g,endRuleId=-1,whileRuleId=-2;function ruleIdFromNumber(n){return n}function ruleIdToNumber(n){return n}var Rule=class{constructor(n,e,t,r){this.$location=n,this.id=e,this._name=t||null,this._nameIsCapturing=RegexSource.hasCaptures(this._name),this._contentName=r||null,this._contentNameIsCapturing=RegexSource.hasCaptures(this._contentName)}get debugName(){const n=this.$location?`${basename(this.$location.filename)}:${this.$location.line}`:"unknown";return`${this.constructor.name}#${this.id} @ ${n}`}getName(n,e){return!this._nameIsCapturing||this._name===null||n===null||e===null?this._name:RegexSource.replaceCaptures(this._name,n,e)}getContentName(n,e){return!this._contentNameIsCapturing||this._contentName===null?this._contentName:RegexSource.replaceCaptures(this._contentName,n,e)}},CaptureRule=class extends Rule{constructor(n,e,t,r,i){super(n,e,t,r),this.retokenizeCapturedWithRuleId=i}dispose(){}collectPatterns(n,e){throw new Error("Not supported!")}compile(n,e){throw new Error("Not supported!")}compileAG(n,e,t,r){throw new Error("Not supported!")}},MatchRule=class extends Rule{constructor(n,e,t,r,i){super(n,e,t,null),this._match=new RegExpSource(r,this.id),this.captures=i,this._cachedCompiledPatterns=null}dispose(){this._cachedCompiledPatterns&&(this._cachedCompiledPatterns.dispose(),this._cachedCompiledPatterns=null)}get debugMatchRegExp(){return`${this._match.source}`}collectPatterns(n,e){e.push(this._match)}compile(n,e){return this._getCachedCompiledPatterns(n).compile(n)}compileAG(n,e,t,r){return this._getCachedCompiledPatterns(n).compileAG(n,t,r)}_getCachedCompiledPatterns(n){return this._cachedCompiledPatterns||(this._cachedCompiledPatterns=new RegExpSourceList,this.collectPatterns(n,this._cachedCompiledPatterns)),this._cachedCompiledPatterns}},IncludeOnlyRule=class extends Rule{constructor(n,e,t,r,i){super(n,e,t,r),this.patterns=i.patterns,this.hasMissingPatterns=i.hasMissingPatterns,this._cachedCompiledPatterns=null}dispose(){this._cachedCompiledPatterns&&(this._cachedCompiledPatterns.dispose(),this._cachedCompiledPatterns=null)}collectPatterns(n,e){for(const t of this.patterns)n.getRule(t).collectPatterns(n,e)}compile(n,e){return this._getCachedCompiledPatterns(n).compile(n)}compileAG(n,e,t,r){return this._getCachedCompiledPatterns(n).compileAG(n,t,r)}_getCachedCompiledPatterns(n){return this._cachedCompiledPatterns||(this._cachedCompiledPatterns=new RegExpSourceList,this.collectPatterns(n,this._cachedCompiledPatterns)),this._cachedCompiledPatterns}},BeginEndRule=class extends Rule{constructor(n,e,t,r,i,s,o,a,l,c){super(n,e,t,r),this._begin=new RegExpSource(i,this.id),this.beginCaptures=s,this._end=new RegExpSource(o||"￿",-1),this.endHasBackReferences=this._end.hasBackReferences,this.endCaptures=a,this.applyEndPatternLast=l||!1,this.patterns=c.patterns,this.hasMissingPatterns=c.hasMissingPatterns,this._cachedCompiledPatterns=null}dispose(){this._cachedCompiledPatterns&&(this._cachedCompiledPatterns.dispose(),this._cachedCompiledPatterns=null)}get debugBeginRegExp(){return`${this._begin.source}`}get debugEndRegExp(){return`${this._end.source}`}getEndWithResolvedBackReferences(n,e){return this._end.resolveBackReferences(n,e)}collectPatterns(n,e){e.push(this._begin)}compile(n,e){return this._getCachedCompiledPatterns(n,e).compile(n)}compileAG(n,e,t,r){return this._getCachedCompiledPatterns(n,e).compileAG(n,t,r)}_getCachedCompiledPatterns(n,e){if(!this._cachedCompiledPatterns){this._cachedCompiledPatterns=new RegExpSourceList;for(const t of this.patterns)n.getRule(t).collectPatterns(n,this._cachedCompiledPatterns);this.applyEndPatternLast?this._cachedCompiledPatterns.push(this._end.hasBackReferences?this._end.clone():this._end):this._cachedCompiledPatterns.unshift(this._end.hasBackReferences?this._end.clone():this._end)}return this._end.hasBackReferences&&(this.applyEndPatternLast?this._cachedCompiledPatterns.setSource(this._cachedCompiledPatterns.length()-1,e):this._cachedCompiledPatterns.setSource(0,e)),this._cachedCompiledPatterns}},BeginWhileRule=class extends Rule{constructor(n,e,t,r,i,s,o,a,l){super(n,e,t,r),this._begin=new RegExpSource(i,this.id),this.beginCaptures=s,this.whileCaptures=a,this._while=new RegExpSource(o,whileRuleId),this.whileHasBackReferences=this._while.hasBackReferences,this.patterns=l.patterns,this.hasMissingPatterns=l.hasMissingPatterns,this._cachedCompiledPatterns=null,this._cachedCompiledWhilePatterns=null}dispose(){this._cachedCompiledPatterns&&(this._cachedCompiledPatterns.dispose(),this._cachedCompiledPatterns=null),this._cachedCompiledWhilePatterns&&(this._cachedCompiledWhilePatterns.dispose(),this._cachedCompiledWhilePatterns=null)}get debugBeginRegExp(){return`${this._begin.source}`}get debugWhileRegExp(){return`${this._while.source}`}getWhileWithResolvedBackReferences(n,e){return this._while.resolveBackReferences(n,e)}collectPatterns(n,e){e.push(this._begin)}compile(n,e){return this._getCachedCompiledPatterns(n).compile(n)}compileAG(n,e,t,r){return this._getCachedCompiledPatterns(n).compileAG(n,t,r)}_getCachedCompiledPatterns(n){if(!this._cachedCompiledPatterns){this._cachedCompiledPatterns=new RegExpSourceList;for(const e of this.patterns)n.getRule(e).collectPatterns(n,this._cachedCompiledPatterns)}return this._cachedCompiledPatterns}compileWhile(n,e){return this._getCachedCompiledWhilePatterns(n,e).compile(n)}compileWhileAG(n,e,t,r){return this._getCachedCompiledWhilePatterns(n,e).compileAG(n,t,r)}_getCachedCompiledWhilePatterns(n,e){return this._cachedCompiledWhilePatterns||(this._cachedCompiledWhilePatterns=new RegExpSourceList,this._cachedCompiledWhilePatterns.push(this._while.hasBackReferences?this._while.clone():this._while)),this._while.hasBackReferences&&this._cachedCompiledWhilePatterns.setSource(0,e||"￿"),this._cachedCompiledWhilePatterns}},RuleFactory=class He{static createCaptureRule(e,t,r,i,s){return e.registerRule(o=>new CaptureRule(t,o,r,i,s))}static getCompiledRuleId(e,t,r){return e.id||t.registerRule(i=>{if(e.id=i,e.match)return new MatchRule(e.$vscodeTextmateLocation,e.id,e.name,e.match,He._compileCaptures(e.captures,t,r));if(typeof e.begin>"u"){e.repository&&(r=mergeObjects({},r,e.repository));let s=e.patterns;return typeof s>"u"&&e.include&&(s=[{include:e.include}]),new IncludeOnlyRule(e.$vscodeTextmateLocation,e.id,e.name,e.contentName,He._compilePatterns(s,t,r))}return e.while?new BeginWhileRule(e.$vscodeTextmateLocation,e.id,e.name,e.contentName,e.begin,He._compileCaptures(e.beginCaptures||e.captures,t,r),e.while,He._compileCaptures(e.whileCaptures||e.captures,t,r),He._compilePatterns(e.patterns,t,r)):new BeginEndRule(e.$vscodeTextmateLocation,e.id,e.name,e.contentName,e.begin,He._compileCaptures(e.beginCaptures||e.captures,t,r),e.end,He._compileCaptures(e.endCaptures||e.captures,t,r),e.applyEndPatternLast,He._compilePatterns(e.patterns,t,r))}),e.id}static _compileCaptures(e,t,r){let i=[];if(e){let s=0;for(const o in e){if(o==="$vscodeTextmateLocation")continue;const a=parseInt(o,10);a>s&&(s=a)}for(let o=0;o<=s;o++)i[o]=null;for(const o in e){if(o==="$vscodeTextmateLocation")continue;const a=parseInt(o,10);let l=0;e[o].patterns&&(l=He.getCompiledRuleId(e[o],t,r)),i[a]=He.createCaptureRule(t,e[o].$vscodeTextmateLocation,e[o].name,e[o].contentName,l)}}return i}static _compilePatterns(e,t,r){let i=[];if(e)for(let s=0,o=e.length;s<o;s++){const a=e[s];let l=-1;if(a.include){const c=parseInclude(a.include);switch(c.kind){case 0:case 1:l=He.getCompiledRuleId(r[a.include],t,r);break;case 2:let u=r[c.ruleName];u&&(l=He.getCompiledRuleId(u,t,r));break;case 3:case 4:const d=c.scopeName,f=c.kind===4?c.ruleName:null,m=t.getExternalGrammar(d,r);if(m)if(f){let g=m.repository[f];g&&(l=He.getCompiledRuleId(g,t,m.repository))}else l=He.getCompiledRuleId(m.repository.$self,t,m.repository);break}}else l=He.getCompiledRuleId(a,t,r);if(l!==-1){const c=t.getRule(l);let u=!1;if((c instanceof IncludeOnlyRule||c instanceof BeginEndRule||c instanceof BeginWhileRule)&&c.hasMissingPatterns&&c.patterns.length===0&&(u=!0),u)continue;i.push(l)}}return{patterns:i,hasMissingPatterns:(e?e.length:0)!==i.length}}},RegExpSource=class Fn{constructor(e,t){if(e){const r=e.length;let i=0,s=[],o=!1;for(let a=0;a<r;a++)if(e.charAt(a)==="\\"&&a+1<r){const c=e.charAt(a+1);c==="z"?(s.push(e.substring(i,a)),s.push("$(?!\\n)(?<!\\n)"),i=a+2):(c==="A"||c==="G")&&(o=!0),a++}this.hasAnchor=o,i===0?this.source=e:(s.push(e.substring(i,r)),this.source=s.join(""))}else this.hasAnchor=!1,this.source=e;this.hasAnchor?this._anchorCache=this._buildAnchorCache():this._anchorCache=null,this.ruleId=t,this.hasBackReferences=HAS_BACK_REFERENCES.test(this.source)}clone(){return new Fn(this.source,this.ruleId)}setSource(e){this.source!==e&&(this.source=e,this.hasAnchor&&(this._anchorCache=this._buildAnchorCache()))}resolveBackReferences(e,t){let r=t.map(i=>e.substring(i.start,i.end));return BACK_REFERENCING_END.lastIndex=0,this.source.replace(BACK_REFERENCING_END,(i,s)=>escapeRegExpCharacters(r[parseInt(s,10)]||""))}_buildAnchorCache(){let e=[],t=[],r=[],i=[],s,o,a,l;for(s=0,o=this.source.length;s<o;s++)a=this.source.charAt(s),e[s]=a,t[s]=a,r[s]=a,i[s]=a,a==="\\"&&s+1<o&&(l=this.source.charAt(s+1),l==="A"?(e[s+1]="￿",t[s+1]="￿",r[s+1]="A",i[s+1]="A"):l==="G"?(e[s+1]="￿",t[s+1]="G",r[s+1]="￿",i[s+1]="G"):(e[s+1]=l,t[s+1]=l,r[s+1]=l,i[s+1]=l),s++);return{A0_G0:e.join(""),A0_G1:t.join(""),A1_G0:r.join(""),A1_G1:i.join("")}}resolveAnchors(e,t){return!this.hasAnchor||!this._anchorCache?this.source:e?t?this._anchorCache.A1_G1:this._anchorCache.A1_G0:t?this._anchorCache.A0_G1:this._anchorCache.A0_G0}},RegExpSourceList=class{constructor(){this._items=[],this._hasAnchors=!1,this._cached=null,this._anchorCache={A0_G0:null,A0_G1:null,A1_G0:null,A1_G1:null}}dispose(){this._disposeCaches()}_disposeCaches(){this._cached&&(this._cached.dispose(),this._cached=null),this._anchorCache.A0_G0&&(this._anchorCache.A0_G0.dispose(),this._anchorCache.A0_G0=null),this._anchorCache.A0_G1&&(this._anchorCache.A0_G1.dispose(),this._anchorCache.A0_G1=null),this._anchorCache.A1_G0&&(this._anchorCache.A1_G0.dispose(),this._anchorCache.A1_G0=null),this._anchorCache.A1_G1&&(this._anchorCache.A1_G1.dispose(),this._anchorCache.A1_G1=null)}push(n){this._items.push(n),this._hasAnchors=this._hasAnchors||n.hasAnchor}unshift(n){this._items.unshift(n),this._hasAnchors=this._hasAnchors||n.hasAnchor}length(){return this._items.length}setSource(n,e){this._items[n].source!==e&&(this._disposeCaches(),this._items[n].setSource(e))}compile(n){if(!this._cached){let e=this._items.map(t=>t.source);this._cached=new CompiledRule(n,e,this._items.map(t=>t.ruleId))}return this._cached}compileAG(n,e,t){return this._hasAnchors?e?t?(this._anchorCache.A1_G1||(this._anchorCache.A1_G1=this._resolveAnchors(n,e,t)),this._anchorCache.A1_G1):(this._anchorCache.A1_G0||(this._anchorCache.A1_G0=this._resolveAnchors(n,e,t)),this._anchorCache.A1_G0):t?(this._anchorCache.A0_G1||(this._anchorCache.A0_G1=this._resolveAnchors(n,e,t)),this._anchorCache.A0_G1):(this._anchorCache.A0_G0||(this._anchorCache.A0_G0=this._resolveAnchors(n,e,t)),this._anchorCache.A0_G0):this.compile(n)}_resolveAnchors(n,e,t){let r=this._items.map(i=>i.resolveAnchors(e,t));return new CompiledRule(n,r,this._items.map(i=>i.ruleId))}},CompiledRule=class{constructor(n,e,t){this.regExps=e,this.rules=t,this.scanner=n.createOnigScanner(e)}dispose(){typeof this.scanner.dispose=="function"&&this.scanner.dispose()}toString(){const n=[];for(let e=0,t=this.rules.length;e<t;e++)n.push("   - "+this.rules[e]+": "+this.regExps[e]);return n.join(`
`)}findNextMatchSync(n,e,t){const r=this.scanner.findNextMatchSync(n,e,t);return r?{ruleId:this.rules[r.index],captureIndices:r.captureIndices}:null}},BasicScopeAttributes=class{constructor(n,e){this.languageId=n,this.tokenType=e}},_BasicScopeAttributesProvider=class rn{constructor(e,t){this._getBasicScopeAttributes=new CachedFn(r=>{const i=this._scopeToLanguage(r),s=this._toStandardTokenType(r);return new BasicScopeAttributes(i,s)}),this._defaultAttributes=new BasicScopeAttributes(e,8),this._embeddedLanguagesMatcher=new ScopeMatcher(Object.entries(t||{}))}getDefaultAttributes(){return this._defaultAttributes}getBasicScopeAttributes(e){return e===null?rn._NULL_SCOPE_METADATA:this._getBasicScopeAttributes.get(e)}_scopeToLanguage(e){return this._embeddedLanguagesMatcher.match(e)||0}_toStandardTokenType(e){const t=e.match(rn.STANDARD_TOKEN_TYPE_REGEXP);if(!t)return 8;switch(t[1]){case"comment":return 1;case"string":return 2;case"regex":return 3;case"meta.embedded":return 0}throw new Error("Unexpected match for standard token type!")}};_BasicScopeAttributesProvider._NULL_SCOPE_METADATA=new BasicScopeAttributes(0,0);_BasicScopeAttributesProvider.STANDARD_TOKEN_TYPE_REGEXP=/\b(comment|string|regex|meta\.embedded)\b/;var BasicScopeAttributesProvider=_BasicScopeAttributesProvider,ScopeMatcher=class{constructor(n){if(n.length===0)this.values=null,this.scopesRegExp=null;else{this.values=new Map(n);const e=n.map(([t,r])=>escapeRegExpCharacters(t));e.sort(),e.reverse(),this.scopesRegExp=new RegExp(`^((${e.join(")|(")}))($|\\.)`,"")}}match(n){if(!this.scopesRegExp)return;const e=n.match(this.scopesRegExp);if(e)return this.values.get(e[1])}},TokenizeStringResult=class{constructor(n,e){this.stack=n,this.stoppedEarly=e}};function _tokenizeString(n,e,t,r,i,s,o,a){const l=e.content.length;let c=!1,u=-1;if(o){const m=_checkWhileConditions(n,e,t,r,i,s);i=m.stack,r=m.linePos,t=m.isFirstLine,u=m.anchorPosition}const d=Date.now();for(;!c;){if(a!==0&&Date.now()-d>a)return new TokenizeStringResult(i,!0);f()}return new TokenizeStringResult(i,!1);function f(){const m=matchRuleOrInjections(n,e,t,r,i,u);if(!m){s.produce(i,l),c=!0;return}const g=m.captureIndices,v=m.matchedRuleId,x=g&&g.length>0?g[0].end>r:!1;if(v===endRuleId){const S=i.getRule(n);s.produce(i,g[0].start),i=i.withContentNameScopesList(i.nameScopesList),handleCaptures(n,e,t,i,s,S.endCaptures,g),s.produce(i,g[0].end);const C=i;if(i=i.parent,u=C.getAnchorPos(),!x&&C.getEnterPos()===r){i=C,s.produce(i,l),c=!0;return}}else{const S=n.getRule(v);s.produce(i,g[0].start);const C=i,R=S.getName(e.content,g),k=i.contentNameScopesList.pushAttributed(R,n);if(i=i.push(v,r,u,g[0].end===l,null,k,k),S instanceof BeginEndRule){const I=S;handleCaptures(n,e,t,i,s,I.beginCaptures,g),s.produce(i,g[0].end),u=g[0].end;const F=I.getContentName(e.content,g),N=k.pushAttributed(F,n);if(i=i.withContentNameScopesList(N),I.endHasBackReferences&&(i=i.withEndRule(I.getEndWithResolvedBackReferences(e.content,g))),!x&&C.hasSameRuleAs(i)){i=i.pop(),s.produce(i,l),c=!0;return}}else if(S instanceof BeginWhileRule){const I=S;handleCaptures(n,e,t,i,s,I.beginCaptures,g),s.produce(i,g[0].end),u=g[0].end;const F=I.getContentName(e.content,g),N=k.pushAttributed(F,n);if(i=i.withContentNameScopesList(N),I.whileHasBackReferences&&(i=i.withEndRule(I.getWhileWithResolvedBackReferences(e.content,g))),!x&&C.hasSameRuleAs(i)){i=i.pop(),s.produce(i,l),c=!0;return}}else if(handleCaptures(n,e,t,i,s,S.captures,g),s.produce(i,g[0].end),i=i.pop(),!x){i=i.safePop(),s.produce(i,l),c=!0;return}}g[0].end>r&&(r=g[0].end,t=!1)}}function _checkWhileConditions(n,e,t,r,i,s){let o=i.beginRuleCapturedEOL?0:-1;const a=[];for(let l=i;l;l=l.pop()){const c=l.getRule(n);c instanceof BeginWhileRule&&a.push({rule:c,stack:l})}for(let l=a.pop();l;l=a.pop()){const{ruleScanner:c,findOptions:u}=prepareRuleWhileSearch(l.rule,n,l.stack.endRule,t,r===o),d=c.findNextMatchSync(e,r,u);if(d){if(d.ruleId!==whileRuleId){i=l.stack.pop();break}d.captureIndices&&d.captureIndices.length&&(s.produce(l.stack,d.captureIndices[0].start),handleCaptures(n,e,t,l.stack,s,l.rule.whileCaptures,d.captureIndices),s.produce(l.stack,d.captureIndices[0].end),o=d.captureIndices[0].end,d.captureIndices[0].end>r&&(r=d.captureIndices[0].end,t=!1))}else{i=l.stack.pop();break}}return{stack:i,linePos:r,anchorPosition:o,isFirstLine:t}}function matchRuleOrInjections(n,e,t,r,i,s){const o=matchRule(n,e,t,r,i,s),a=n.getInjections();if(a.length===0)return o;const l=matchInjections(a,n,e,t,r,i,s);if(!l)return o;if(!o)return l;const c=o.captureIndices[0].start,u=l.captureIndices[0].start;return u<c||l.priorityMatch&&u===c?l:o}function matchRule(n,e,t,r,i,s){const o=i.getRule(n),{ruleScanner:a,findOptions:l}=prepareRuleSearch(o,n,i.endRule,t,r===s),c=a.findNextMatchSync(e,r,l);return c?{captureIndices:c.captureIndices,matchedRuleId:c.ruleId}:null}function matchInjections(n,e,t,r,i,s,o){let a=Number.MAX_VALUE,l=null,c,u=0;const d=s.contentNameScopesList.getScopeNames();for(let f=0,m=n.length;f<m;f++){const g=n[f];if(!g.matcher(d))continue;const v=e.getRule(g.ruleId),{ruleScanner:x,findOptions:S}=prepareRuleSearch(v,e,null,r,i===o),C=x.findNextMatchSync(t,i,S);if(!C)continue;const R=C.captureIndices[0].start;if(!(R>=a)&&(a=R,l=C.captureIndices,c=C.ruleId,u=g.priority,a===i))break}return l?{priorityMatch:u===-1,captureIndices:l,matchedRuleId:c}:null}function prepareRuleSearch(n,e,t,r,i){return{ruleScanner:n.compileAG(e,t,r,i),findOptions:0}}function prepareRuleWhileSearch(n,e,t,r,i){return{ruleScanner:n.compileWhileAG(e,t,r,i),findOptions:0}}function handleCaptures(n,e,t,r,i,s,o){if(s.length===0)return;const a=e.content,l=Math.min(s.length,o.length),c=[],u=o[0].end;for(let d=0;d<l;d++){const f=s[d];if(f===null)continue;const m=o[d];if(m.length===0)continue;if(m.start>u)break;for(;c.length>0&&c[c.length-1].endPos<=m.start;)i.produceFromScopes(c[c.length-1].scopes,c[c.length-1].endPos),c.pop();if(c.length>0?i.produceFromScopes(c[c.length-1].scopes,m.start):i.produce(r,m.start),f.retokenizeCapturedWithRuleId){const v=f.getName(a,o),x=r.contentNameScopesList.pushAttributed(v,n),S=f.getContentName(a,o),C=x.pushAttributed(S,n),R=r.push(f.retokenizeCapturedWithRuleId,m.start,-1,!1,null,x,C),k=n.createOnigString(a.substring(0,m.end));_tokenizeString(n,k,t&&m.start===0,m.start,R,i,!1,0),disposeOnigString(k);continue}const g=f.getName(a,o);if(g!==null){const x=(c.length>0?c[c.length-1].scopes:r.contentNameScopesList).pushAttributed(g,n);c.push(new LocalStackElement(x,m.end))}}for(;c.length>0;)i.produceFromScopes(c[c.length-1].scopes,c[c.length-1].endPos),c.pop()}var LocalStackElement=class{constructor(n,e){this.scopes=n,this.endPos=e}};function createGrammar(n,e,t,r,i,s,o,a){return new Grammar(n,e,t,r,i,s,o,a)}function collectInjections(n,e,t,r,i){const s=createMatchers(e,nameMatcher),o=RuleFactory.getCompiledRuleId(t,r,i.repository);for(const a of s)n.push({debugSelector:e,matcher:a.matcher,ruleId:o,grammar:i,priority:a.priority})}function nameMatcher(n,e){if(e.length<n.length)return!1;let t=0;return n.every(r=>{for(let i=t;i<e.length;i++)if(scopesAreMatching(e[i],r))return t=i+1,!0;return!1})}function scopesAreMatching(n,e){if(!n)return!1;if(n===e)return!0;const t=e.length;return n.length>t&&n.substr(0,t)===e&&n[t]==="."}var Grammar=class{constructor(n,e,t,r,i,s,o,a){if(this._rootScopeName=n,this.balancedBracketSelectors=s,this._onigLib=a,this._basicScopeAttributesProvider=new BasicScopeAttributesProvider(t,r),this._rootId=-1,this._lastRuleId=0,this._ruleId2desc=[null],this._includedGrammars={},this._grammarRepository=o,this._grammar=initGrammar(e,null),this._injections=null,this._tokenTypeMatchers=[],i)for(const l of Object.keys(i)){const c=createMatchers(l,nameMatcher);for(const u of c)this._tokenTypeMatchers.push({matcher:u.matcher,type:i[l]})}}get themeProvider(){return this._grammarRepository}dispose(){for(const n of this._ruleId2desc)n&&n.dispose()}createOnigScanner(n){return this._onigLib.createOnigScanner(n)}createOnigString(n){return this._onigLib.createOnigString(n)}getMetadataForScope(n){return this._basicScopeAttributesProvider.getBasicScopeAttributes(n)}_collectInjections(){const n={lookup:i=>i===this._rootScopeName?this._grammar:this.getExternalGrammar(i),injections:i=>this._grammarRepository.injections(i)},e=[],t=this._rootScopeName,r=n.lookup(t);if(r){const i=r.injections;if(i)for(let o in i)collectInjections(e,o,i[o],this,r);const s=this._grammarRepository.injections(t);s&&s.forEach(o=>{const a=this.getExternalGrammar(o);if(a){const l=a.injectionSelector;l&&collectInjections(e,l,a,this,a)}})}return e.sort((i,s)=>i.priority-s.priority),e}getInjections(){return this._injections===null&&(this._injections=this._collectInjections()),this._injections}registerRule(n){const e=++this._lastRuleId,t=n(e);return this._ruleId2desc[e]=t,t}getRule(n){return this._ruleId2desc[n]}getExternalGrammar(n,e){if(this._includedGrammars[n])return this._includedGrammars[n];if(this._grammarRepository){const t=this._grammarRepository.lookup(n);if(t)return this._includedGrammars[n]=initGrammar(t,e&&e.$base),this._includedGrammars[n]}}tokenizeLine(n,e,t=0){const r=this._tokenize(n,e,!1,t);return{tokens:r.lineTokens.getResult(r.ruleStack,r.lineLength),ruleStack:r.ruleStack,stoppedEarly:r.stoppedEarly}}tokenizeLine2(n,e,t=0){const r=this._tokenize(n,e,!0,t);return{tokens:r.lineTokens.getBinaryResult(r.ruleStack,r.lineLength),ruleStack:r.ruleStack,stoppedEarly:r.stoppedEarly}}_tokenize(n,e,t,r){this._rootId===-1&&(this._rootId=RuleFactory.getCompiledRuleId(this._grammar.repository.$self,this,this._grammar.repository),this.getInjections());let i;if(!e||e===StateStackImpl.NULL){i=!0;const c=this._basicScopeAttributesProvider.getDefaultAttributes(),u=this.themeProvider.getDefaults(),d=EncodedTokenMetadata.set(0,c.languageId,c.tokenType,null,u.fontStyle,u.foregroundId,u.backgroundId),f=this.getRule(this._rootId).getName(null,null);let m;f?m=AttributedScopeStack.createRootAndLookUpScopeName(f,d,this):m=AttributedScopeStack.createRoot("unknown",d),e=new StateStackImpl(null,this._rootId,-1,-1,!1,null,m,m)}else i=!1,e.reset();n=n+`
`;const s=this.createOnigString(n),o=s.content.length,a=new LineTokens(t,n,this._tokenTypeMatchers,this.balancedBracketSelectors),l=_tokenizeString(this,s,i,0,e,a,!0,r);return disposeOnigString(s),{lineLength:o,lineTokens:a,ruleStack:l.stack,stoppedEarly:l.stoppedEarly}}};function initGrammar(n,e){return n=clone(n),n.repository=n.repository||{},n.repository.$self={$vscodeTextmateLocation:n.$vscodeTextmateLocation,patterns:n.patterns,name:n.scopeName},n.repository.$base=e||n.repository.$self,n}var AttributedScopeStack=class Ye{constructor(e,t,r){this.parent=e,this.scopePath=t,this.tokenAttributes=r}static fromExtension(e,t){let r=e,i=(e==null?void 0:e.scopePath)??null;for(const s of t)i=ScopeStack.push(i,s.scopeNames),r=new Ye(r,i,s.encodedTokenAttributes);return r}static createRoot(e,t){return new Ye(null,new ScopeStack(null,e),t)}static createRootAndLookUpScopeName(e,t,r){const i=r.getMetadataForScope(e),s=new ScopeStack(null,e),o=r.themeProvider.themeMatch(s),a=Ye.mergeAttributes(t,i,o);return new Ye(null,s,a)}get scopeName(){return this.scopePath.scopeName}toString(){return this.getScopeNames().join(" ")}equals(e){return Ye.equals(this,e)}static equals(e,t){do{if(e===t||!e&&!t)return!0;if(!e||!t||e.scopeName!==t.scopeName||e.tokenAttributes!==t.tokenAttributes)return!1;e=e.parent,t=t.parent}while(!0)}static mergeAttributes(e,t,r){let i=-1,s=0,o=0;return r!==null&&(i=r.fontStyle,s=r.foregroundId,o=r.backgroundId),EncodedTokenMetadata.set(e,t.languageId,t.tokenType,null,i,s,o)}pushAttributed(e,t){if(e===null)return this;if(e.indexOf(" ")===-1)return Ye._pushAttributed(this,e,t);const r=e.split(/ /g);let i=this;for(const s of r)i=Ye._pushAttributed(i,s,t);return i}static _pushAttributed(e,t,r){const i=r.getMetadataForScope(t),s=e.scopePath.push(t),o=r.themeProvider.themeMatch(s),a=Ye.mergeAttributes(e.tokenAttributes,i,o);return new Ye(e,s,a)}getScopeNames(){return this.scopePath.getSegments()}getExtensionIfDefined(e){var i;const t=[];let r=this;for(;r&&r!==e;)t.push({encodedTokenAttributes:r.tokenAttributes,scopeNames:r.scopePath.getExtensionIfDefined(((i=r.parent)==null?void 0:i.scopePath)??null)}),r=r.parent;return r===e?t.reverse():void 0}},_StateStackImpl=class ct{constructor(e,t,r,i,s,o,a,l){this.parent=e,this.ruleId=t,this.beginRuleCapturedEOL=s,this.endRule=o,this.nameScopesList=a,this.contentNameScopesList=l,this._stackElementBrand=void 0,this.depth=this.parent?this.parent.depth+1:1,this._enterPos=r,this._anchorPos=i}equals(e){return e===null?!1:ct._equals(this,e)}static _equals(e,t){return e===t?!0:this._structuralEquals(e,t)?AttributedScopeStack.equals(e.contentNameScopesList,t.contentNameScopesList):!1}static _structuralEquals(e,t){do{if(e===t||!e&&!t)return!0;if(!e||!t||e.depth!==t.depth||e.ruleId!==t.ruleId||e.endRule!==t.endRule)return!1;e=e.parent,t=t.parent}while(!0)}clone(){return this}static _reset(e){for(;e;)e._enterPos=-1,e._anchorPos=-1,e=e.parent}reset(){ct._reset(this)}pop(){return this.parent}safePop(){return this.parent?this.parent:this}push(e,t,r,i,s,o,a){return new ct(this,e,t,r,i,s,o,a)}getEnterPos(){return this._enterPos}getAnchorPos(){return this._anchorPos}getRule(e){return e.getRule(this.ruleId)}toString(){const e=[];return this._writeString(e,0),"["+e.join(",")+"]"}_writeString(e,t){var r,i;return this.parent&&(t=this.parent._writeString(e,t)),e[t++]=`(${this.ruleId}, ${(r=this.nameScopesList)==null?void 0:r.toString()}, ${(i=this.contentNameScopesList)==null?void 0:i.toString()})`,t}withContentNameScopesList(e){return this.contentNameScopesList===e?this:this.parent.push(this.ruleId,this._enterPos,this._anchorPos,this.beginRuleCapturedEOL,this.endRule,this.nameScopesList,e)}withEndRule(e){return this.endRule===e?this:new ct(this.parent,this.ruleId,this._enterPos,this._anchorPos,this.beginRuleCapturedEOL,e,this.nameScopesList,this.contentNameScopesList)}hasSameRuleAs(e){let t=this;for(;t&&t._enterPos===e._enterPos;){if(t.ruleId===e.ruleId)return!0;t=t.parent}return!1}toStateStackFrame(){var e,t,r;return{ruleId:this.ruleId,beginRuleCapturedEOL:this.beginRuleCapturedEOL,endRule:this.endRule,nameScopesList:((t=this.nameScopesList)==null?void 0:t.getExtensionIfDefined(((e=this.parent)==null?void 0:e.nameScopesList)??null))??[],contentNameScopesList:((r=this.contentNameScopesList)==null?void 0:r.getExtensionIfDefined(this.nameScopesList))??[]}}static pushFrame(e,t){const r=AttributedScopeStack.fromExtension((e==null?void 0:e.nameScopesList)??null,t.nameScopesList);return new ct(e,t.ruleId,t.enterPos??-1,t.anchorPos??-1,t.beginRuleCapturedEOL,t.endRule,r,AttributedScopeStack.fromExtension(r,t.contentNameScopesList))}};_StateStackImpl.NULL=new _StateStackImpl(null,0,0,0,!1,null,null,null);var StateStackImpl=_StateStackImpl,BalancedBracketSelectors=class{constructor(n,e){this.allowAny=!1,this.balancedBracketScopes=n.flatMap(t=>t==="*"?(this.allowAny=!0,[]):createMatchers(t,nameMatcher).map(r=>r.matcher)),this.unbalancedBracketScopes=e.flatMap(t=>createMatchers(t,nameMatcher).map(r=>r.matcher))}get matchesAlways(){return this.allowAny&&this.unbalancedBracketScopes.length===0}get matchesNever(){return this.balancedBracketScopes.length===0&&!this.allowAny}match(n){for(const e of this.unbalancedBracketScopes)if(e(n))return!1;for(const e of this.balancedBracketScopes)if(e(n))return!0;return this.allowAny}},LineTokens=class{constructor(n,e,t,r){this.balancedBracketSelectors=r,this._emitBinaryTokens=n,this._tokenTypeOverrides=t,this._lineText=null,this._tokens=[],this._binaryTokens=[],this._lastTokenEndIndex=0}produce(n,e){this.produceFromScopes(n.contentNameScopesList,e)}produceFromScopes(n,e){var r;if(this._lastTokenEndIndex>=e)return;if(this._emitBinaryTokens){let i=(n==null?void 0:n.tokenAttributes)??0,s=!1;if((r=this.balancedBracketSelectors)!=null&&r.matchesAlways&&(s=!0),this._tokenTypeOverrides.length>0||this.balancedBracketSelectors&&!this.balancedBracketSelectors.matchesAlways&&!this.balancedBracketSelectors.matchesNever){const o=(n==null?void 0:n.getScopeNames())??[];for(const a of this._tokenTypeOverrides)a.matcher(o)&&(i=EncodedTokenMetadata.set(i,0,a.type,null,-1,0,0));this.balancedBracketSelectors&&(s=this.balancedBracketSelectors.match(o))}if(s&&(i=EncodedTokenMetadata.set(i,0,8,s,-1,0,0)),this._binaryTokens.length>0&&this._binaryTokens[this._binaryTokens.length-1]===i){this._lastTokenEndIndex=e;return}this._binaryTokens.push(this._lastTokenEndIndex),this._binaryTokens.push(i),this._lastTokenEndIndex=e;return}const t=(n==null?void 0:n.getScopeNames())??[];this._tokens.push({startIndex:this._lastTokenEndIndex,endIndex:e,scopes:t}),this._lastTokenEndIndex=e}getResult(n,e){return this._tokens.length>0&&this._tokens[this._tokens.length-1].startIndex===e-1&&this._tokens.pop(),this._tokens.length===0&&(this._lastTokenEndIndex=-1,this.produce(n,e),this._tokens[this._tokens.length-1].startIndex=0),this._tokens}getBinaryResult(n,e){this._binaryTokens.length>0&&this._binaryTokens[this._binaryTokens.length-2]===e-1&&(this._binaryTokens.pop(),this._binaryTokens.pop()),this._binaryTokens.length===0&&(this._lastTokenEndIndex=-1,this.produce(n,e),this._binaryTokens[this._binaryTokens.length-2]=0);const t=new Uint32Array(this._binaryTokens.length);for(let r=0,i=this._binaryTokens.length;r<i;r++)t[r]=this._binaryTokens[r];return t}},SyncRegistry=class{constructor(n,e){this._onigLib=e,this._grammars=new Map,this._rawGrammars=new Map,this._injectionGrammars=new Map,this._theme=n}dispose(){for(const n of this._grammars.values())n.dispose()}setTheme(n){this._theme=n}getColorMap(){return this._theme.getColorMap()}addGrammar(n,e){this._rawGrammars.set(n.scopeName,n),e&&this._injectionGrammars.set(n.scopeName,e)}lookup(n){return this._rawGrammars.get(n)}injections(n){return this._injectionGrammars.get(n)}getDefaults(){return this._theme.getDefaults()}themeMatch(n){return this._theme.match(n)}grammarForScopeName(n,e,t,r,i){if(!this._grammars.has(n)){let s=this._rawGrammars.get(n);if(!s)return null;this._grammars.set(n,createGrammar(n,s,e,t,r,i,this,this._onigLib))}return this._grammars.get(n)}},Registry$1=class{constructor(e){this._options=e,this._syncRegistry=new SyncRegistry(Theme.createFromRawTheme(e.theme,e.colorMap),e.onigLib),this._ensureGrammarCache=new Map}dispose(){this._syncRegistry.dispose()}setTheme(e,t){this._syncRegistry.setTheme(Theme.createFromRawTheme(e,t))}getColorMap(){return this._syncRegistry.getColorMap()}loadGrammarWithEmbeddedLanguages(e,t,r){return this.loadGrammarWithConfiguration(e,t,{embeddedLanguages:r})}loadGrammarWithConfiguration(e,t,r){return this._loadGrammar(e,t,r.embeddedLanguages,r.tokenTypes,new BalancedBracketSelectors(r.balancedBracketSelectors||[],r.unbalancedBracketSelectors||[]))}loadGrammar(e){return this._loadGrammar(e,0,null,null,null)}_loadGrammar(e,t,r,i,s){const o=new ScopeDependencyProcessor(this._syncRegistry,e);for(;o.Q.length>0;)o.Q.map(a=>this._loadSingleGrammar(a.scopeName)),o.processQueue();return this._grammarForScopeName(e,t,r,i,s)}_loadSingleGrammar(e){this._ensureGrammarCache.has(e)||(this._doLoadSingleGrammar(e),this._ensureGrammarCache.set(e,!0))}_doLoadSingleGrammar(e){const t=this._options.loadGrammar(e);if(t){const r=typeof this._options.getInjections=="function"?this._options.getInjections(e):void 0;this._syncRegistry.addGrammar(t,r)}}addGrammar(e,t=[],r=0,i=null){return this._syncRegistry.addGrammar(e,t),this._grammarForScopeName(e.scopeName,r,i)}_grammarForScopeName(e,t=0,r=null,i=null,s=null){return this._syncRegistry.grammarForScopeName(e,t,r,i,s)}},INITIAL=StateStackImpl.NULL;const htmlVoidElements=["area","base","basefont","bgsound","br","col","command","embed","frame","hr","image","img","input","keygen","link","meta","param","source","track","wbr"];class Schema{constructor(e,t,r){this.property=e,this.normal=t,r&&(this.space=r)}}Schema.prototype.property={};Schema.prototype.normal={};Schema.prototype.space=null;function merge(n,e){const t={},r={};let i=-1;for(;++i<n.length;)Object.assign(t,n[i].property),Object.assign(r,n[i].normal);return new Schema(t,r,e)}function normalize(n){return n.toLowerCase()}class Info{constructor(e,t){this.property=e,this.attribute=t}}Info.prototype.space=null;Info.prototype.boolean=!1;Info.prototype.booleanish=!1;Info.prototype.overloadedBoolean=!1;Info.prototype.number=!1;Info.prototype.commaSeparated=!1;Info.prototype.spaceSeparated=!1;Info.prototype.commaOrSpaceSeparated=!1;Info.prototype.mustUseProperty=!1;Info.prototype.defined=!1;let powers=0;const boolean=increment(),booleanish=increment(),overloadedBoolean=increment(),number=increment(),spaceSeparated=increment(),commaSeparated=increment(),commaOrSpaceSeparated=increment();function increment(){return 2**++powers}const types=Object.freeze(Object.defineProperty({__proto__:null,boolean,booleanish,commaOrSpaceSeparated,commaSeparated,number,overloadedBoolean,spaceSeparated},Symbol.toStringTag,{value:"Module"})),checks=Object.keys(types);class DefinedInfo extends Info{constructor(e,t,r,i){let s=-1;if(super(e,t),mark(this,"space",i),typeof r=="number")for(;++s<checks.length;){const o=checks[s];mark(this,checks[s],(r&types[o])===types[o])}}}DefinedInfo.prototype.defined=!0;function mark(n,e,t){t&&(n[e]=t)}const own$3={}.hasOwnProperty;function create(n){const e={},t={};let r;for(r in n.properties)if(own$3.call(n.properties,r)){const i=n.properties[r],s=new DefinedInfo(r,n.transform(n.attributes||{},r),i,n.space);n.mustUseProperty&&n.mustUseProperty.includes(r)&&(s.mustUseProperty=!0),e[r]=s,t[normalize(r)]=r,t[normalize(s.attribute)]=r}return new Schema(e,t,n.space)}const xlink=create({space:"xlink",transform(n,e){return"xlink:"+e.slice(5).toLowerCase()},properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null}}),xml=create({space:"xml",transform(n,e){return"xml:"+e.slice(3).toLowerCase()},properties:{xmlLang:null,xmlBase:null,xmlSpace:null}});function caseSensitiveTransform(n,e){return e in n?n[e]:e}function caseInsensitiveTransform(n,e){return caseSensitiveTransform(n,e.toLowerCase())}const xmlns=create({space:"xmlns",attributes:{xmlnsxlink:"xmlns:xlink"},transform:caseInsensitiveTransform,properties:{xmlns:null,xmlnsXLink:null}}),aria=create({transform(n,e){return e==="role"?e:"aria-"+e.slice(4).toLowerCase()},properties:{ariaActiveDescendant:null,ariaAtomic:booleanish,ariaAutoComplete:null,ariaBusy:booleanish,ariaChecked:booleanish,ariaColCount:number,ariaColIndex:number,ariaColSpan:number,ariaControls:spaceSeparated,ariaCurrent:null,ariaDescribedBy:spaceSeparated,ariaDetails:null,ariaDisabled:booleanish,ariaDropEffect:spaceSeparated,ariaErrorMessage:null,ariaExpanded:booleanish,ariaFlowTo:spaceSeparated,ariaGrabbed:booleanish,ariaHasPopup:null,ariaHidden:booleanish,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:spaceSeparated,ariaLevel:number,ariaLive:null,ariaModal:booleanish,ariaMultiLine:booleanish,ariaMultiSelectable:booleanish,ariaOrientation:null,ariaOwns:spaceSeparated,ariaPlaceholder:null,ariaPosInSet:number,ariaPressed:booleanish,ariaReadOnly:booleanish,ariaRelevant:null,ariaRequired:booleanish,ariaRoleDescription:spaceSeparated,ariaRowCount:number,ariaRowIndex:number,ariaRowSpan:number,ariaSelected:booleanish,ariaSetSize:number,ariaSort:null,ariaValueMax:number,ariaValueMin:number,ariaValueNow:number,ariaValueText:null,role:null}}),html$3=create({space:"html",attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},transform:caseInsensitiveTransform,mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:commaSeparated,acceptCharset:spaceSeparated,accessKey:spaceSeparated,action:null,allow:null,allowFullScreen:boolean,allowPaymentRequest:boolean,allowUserMedia:boolean,alt:null,as:null,async:boolean,autoCapitalize:null,autoComplete:spaceSeparated,autoFocus:boolean,autoPlay:boolean,blocking:spaceSeparated,capture:null,charSet:null,checked:boolean,cite:null,className:spaceSeparated,cols:number,colSpan:null,content:null,contentEditable:booleanish,controls:boolean,controlsList:spaceSeparated,coords:number|commaSeparated,crossOrigin:null,data:null,dateTime:null,decoding:null,default:boolean,defer:boolean,dir:null,dirName:null,disabled:boolean,download:overloadedBoolean,draggable:booleanish,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:boolean,formTarget:null,headers:spaceSeparated,height:number,hidden:boolean,high:number,href:null,hrefLang:null,htmlFor:spaceSeparated,httpEquiv:spaceSeparated,id:null,imageSizes:null,imageSrcSet:null,inert:boolean,inputMode:null,integrity:null,is:null,isMap:boolean,itemId:null,itemProp:spaceSeparated,itemRef:spaceSeparated,itemScope:boolean,itemType:spaceSeparated,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:boolean,low:number,manifest:null,max:null,maxLength:number,media:null,method:null,min:null,minLength:number,multiple:boolean,muted:boolean,name:null,nonce:null,noModule:boolean,noValidate:boolean,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:boolean,optimum:number,pattern:null,ping:spaceSeparated,placeholder:null,playsInline:boolean,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:boolean,referrerPolicy:null,rel:spaceSeparated,required:boolean,reversed:boolean,rows:number,rowSpan:number,sandbox:spaceSeparated,scope:null,scoped:boolean,seamless:boolean,selected:boolean,shadowRootClonable:boolean,shadowRootDelegatesFocus:boolean,shadowRootMode:null,shape:null,size:number,sizes:null,slot:null,span:number,spellCheck:booleanish,src:null,srcDoc:null,srcLang:null,srcSet:null,start:number,step:null,style:null,tabIndex:number,target:null,title:null,translate:null,type:null,typeMustMatch:boolean,useMap:null,value:booleanish,width:number,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:spaceSeparated,axis:null,background:null,bgColor:null,border:number,borderColor:null,bottomMargin:number,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:boolean,declare:boolean,event:null,face:null,frame:null,frameBorder:null,hSpace:number,leftMargin:number,link:null,longDesc:null,lowSrc:null,marginHeight:number,marginWidth:number,noResize:boolean,noHref:boolean,noShade:boolean,noWrap:boolean,object:null,profile:null,prompt:null,rev:null,rightMargin:number,rules:null,scheme:null,scrolling:booleanish,standby:null,summary:null,text:null,topMargin:number,valueType:null,version:null,vAlign:null,vLink:null,vSpace:number,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:boolean,disableRemotePlayback:boolean,prefix:null,property:null,results:number,security:null,unselectable:null}}),svg$1=create({space:"svg",attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},transform:caseSensitiveTransform,properties:{about:commaOrSpaceSeparated,accentHeight:number,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:number,amplitude:number,arabicForm:null,ascent:number,attributeName:null,attributeType:null,azimuth:number,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:number,by:null,calcMode:null,capHeight:number,className:spaceSeparated,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:number,diffuseConstant:number,direction:null,display:null,dur:null,divisor:number,dominantBaseline:null,download:boolean,dx:null,dy:null,edgeMode:null,editable:null,elevation:number,enableBackground:null,end:null,event:null,exponent:number,externalResourcesRequired:null,fill:null,fillOpacity:number,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:commaSeparated,g2:commaSeparated,glyphName:commaSeparated,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:number,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:number,horizOriginX:number,horizOriginY:number,id:null,ideographic:number,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:number,k:number,k1:number,k2:number,k3:number,k4:number,kernelMatrix:commaOrSpaceSeparated,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:number,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:number,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:number,overlineThickness:number,paintOrder:null,panose1:null,path:null,pathLength:number,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:spaceSeparated,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:number,pointsAtY:number,pointsAtZ:number,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:commaOrSpaceSeparated,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:commaOrSpaceSeparated,rev:commaOrSpaceSeparated,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:commaOrSpaceSeparated,requiredFeatures:commaOrSpaceSeparated,requiredFonts:commaOrSpaceSeparated,requiredFormats:commaOrSpaceSeparated,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:number,specularExponent:number,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:number,strikethroughThickness:number,string:null,stroke:null,strokeDashArray:commaOrSpaceSeparated,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:number,strokeOpacity:number,strokeWidth:null,style:null,surfaceScale:number,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:commaOrSpaceSeparated,tabIndex:number,tableValues:null,target:null,targetX:number,targetY:number,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:commaOrSpaceSeparated,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:number,underlineThickness:number,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:number,values:null,vAlphabetic:number,vMathematical:number,vectorEffect:null,vHanging:number,vIdeographic:number,version:null,vertAdvY:number,vertOriginX:number,vertOriginY:number,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:number,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null}}),valid=/^data[-\w.:]+$/i,dash=/-[a-z]/g,cap=/[A-Z]/g;function find(n,e){const t=normalize(e);let r=e,i=Info;if(t in n.normal)return n.property[n.normal[t]];if(t.length>4&&t.slice(0,4)==="data"&&valid.test(e)){if(e.charAt(4)==="-"){const s=e.slice(5).replace(dash,camelcase);r="data"+s.charAt(0).toUpperCase()+s.slice(1)}else{const s=e.slice(4);if(!dash.test(s)){let o=s.replace(cap,kebab);o.charAt(0)!=="-"&&(o="-"+o),e="data"+o}}i=DefinedInfo}return new i(r,e)}function kebab(n){return"-"+n.toLowerCase()}function camelcase(n){return n.charAt(1).toUpperCase()}const html$2=merge([xml,xlink,xmlns,aria,html$3],"html"),svg=merge([xml,xlink,xmlns,aria,svg$1],"svg"),own$2={}.hasOwnProperty;function zwitch(n,e){const t=e||{};function r(i,...s){let o=r.invalid;const a=r.handlers;if(i&&own$2.call(i,n)){const l=String(i[n]);o=own$2.call(a,l)?a[l]:r.unknown}if(o)return o.call(this,i,...s)}return r.handlers=t.handlers||{},r.invalid=t.invalid,r.unknown=t.unknown,r}const defaultSubsetRegex=/["&'<>`]/g,surrogatePairsRegex=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,controlCharactersRegex=/[\x01-\t\v\f\x0E-\x1F\x7F\x81\x8D\x8F\x90\x9D\xA0-\uFFFF]/g,regexEscapeRegex=/[|\\{}()[\]^$+*?.]/g,subsetToRegexCache=new WeakMap;function core(n,e){if(n=n.replace(e.subset?charactersToExpressionCached(e.subset):defaultSubsetRegex,r),e.subset||e.escapeOnly)return n;return n.replace(surrogatePairsRegex,t).replace(controlCharactersRegex,r);function t(i,s,o){return e.format((i.charCodeAt(0)-55296)*1024+i.charCodeAt(1)-56320+65536,o.charCodeAt(s+2),e)}function r(i,s,o){return e.format(i.charCodeAt(0),o.charCodeAt(s+1),e)}}function charactersToExpressionCached(n){let e=subsetToRegexCache.get(n);return e||(e=charactersToExpression(n),subsetToRegexCache.set(n,e)),e}function charactersToExpression(n){const e=[];let t=-1;for(;++t<n.length;)e.push(n[t].replace(regexEscapeRegex,"\\$&"));return new RegExp("(?:"+e.join("|")+")","g")}const hexadecimalRegex=/[\dA-Fa-f]/;function toHexadecimal(n,e,t){const r="&#x"+n.toString(16).toUpperCase();return t&&e&&!hexadecimalRegex.test(String.fromCharCode(e))?r:r+";"}const decimalRegex=/\d/;function toDecimal(n,e,t){const r="&#"+String(n);return t&&e&&!decimalRegex.test(String.fromCharCode(e))?r:r+";"}const characterEntitiesLegacy=["AElig","AMP","Aacute","Acirc","Agrave","Aring","Atilde","Auml","COPY","Ccedil","ETH","Eacute","Ecirc","Egrave","Euml","GT","Iacute","Icirc","Igrave","Iuml","LT","Ntilde","Oacute","Ocirc","Ograve","Oslash","Otilde","Ouml","QUOT","REG","THORN","Uacute","Ucirc","Ugrave","Uuml","Yacute","aacute","acirc","acute","aelig","agrave","amp","aring","atilde","auml","brvbar","ccedil","cedil","cent","copy","curren","deg","divide","eacute","ecirc","egrave","eth","euml","frac12","frac14","frac34","gt","iacute","icirc","iexcl","igrave","iquest","iuml","laquo","lt","macr","micro","middot","nbsp","not","ntilde","oacute","ocirc","ograve","ordf","ordm","oslash","otilde","ouml","para","plusmn","pound","quot","raquo","reg","sect","shy","sup1","sup2","sup3","szlig","thorn","times","uacute","ucirc","ugrave","uml","uuml","yacute","yen","yuml"],characterEntitiesHtml4={nbsp:" ",iexcl:"¡",cent:"¢",pound:"£",curren:"¤",yen:"¥",brvbar:"¦",sect:"§",uml:"¨",copy:"©",ordf:"ª",laquo:"«",not:"¬",shy:"­",reg:"®",macr:"¯",deg:"°",plusmn:"±",sup2:"²",sup3:"³",acute:"´",micro:"µ",para:"¶",middot:"·",cedil:"¸",sup1:"¹",ordm:"º",raquo:"»",frac14:"¼",frac12:"½",frac34:"¾",iquest:"¿",Agrave:"À",Aacute:"Á",Acirc:"Â",Atilde:"Ã",Auml:"Ä",Aring:"Å",AElig:"Æ",Ccedil:"Ç",Egrave:"È",Eacute:"É",Ecirc:"Ê",Euml:"Ë",Igrave:"Ì",Iacute:"Í",Icirc:"Î",Iuml:"Ï",ETH:"Ð",Ntilde:"Ñ",Ograve:"Ò",Oacute:"Ó",Ocirc:"Ô",Otilde:"Õ",Ouml:"Ö",times:"×",Oslash:"Ø",Ugrave:"Ù",Uacute:"Ú",Ucirc:"Û",Uuml:"Ü",Yacute:"Ý",THORN:"Þ",szlig:"ß",agrave:"à",aacute:"á",acirc:"â",atilde:"ã",auml:"ä",aring:"å",aelig:"æ",ccedil:"ç",egrave:"è",eacute:"é",ecirc:"ê",euml:"ë",igrave:"ì",iacute:"í",icirc:"î",iuml:"ï",eth:"ð",ntilde:"ñ",ograve:"ò",oacute:"ó",ocirc:"ô",otilde:"õ",ouml:"ö",divide:"÷",oslash:"ø",ugrave:"ù",uacute:"ú",ucirc:"û",uuml:"ü",yacute:"ý",thorn:"þ",yuml:"ÿ",fnof:"ƒ",Alpha:"Α",Beta:"Β",Gamma:"Γ",Delta:"Δ",Epsilon:"Ε",Zeta:"Ζ",Eta:"Η",Theta:"Θ",Iota:"Ι",Kappa:"Κ",Lambda:"Λ",Mu:"Μ",Nu:"Ν",Xi:"Ξ",Omicron:"Ο",Pi:"Π",Rho:"Ρ",Sigma:"Σ",Tau:"Τ",Upsilon:"Υ",Phi:"Φ",Chi:"Χ",Psi:"Ψ",Omega:"Ω",alpha:"α",beta:"β",gamma:"γ",delta:"δ",epsilon:"ε",zeta:"ζ",eta:"η",theta:"θ",iota:"ι",kappa:"κ",lambda:"λ",mu:"μ",nu:"ν",xi:"ξ",omicron:"ο",pi:"π",rho:"ρ",sigmaf:"ς",sigma:"σ",tau:"τ",upsilon:"υ",phi:"φ",chi:"χ",psi:"ψ",omega:"ω",thetasym:"ϑ",upsih:"ϒ",piv:"ϖ",bull:"•",hellip:"…",prime:"′",Prime:"″",oline:"‾",frasl:"⁄",weierp:"℘",image:"ℑ",real:"ℜ",trade:"™",alefsym:"ℵ",larr:"←",uarr:"↑",rarr:"→",darr:"↓",harr:"↔",crarr:"↵",lArr:"⇐",uArr:"⇑",rArr:"⇒",dArr:"⇓",hArr:"⇔",forall:"∀",part:"∂",exist:"∃",empty:"∅",nabla:"∇",isin:"∈",notin:"∉",ni:"∋",prod:"∏",sum:"∑",minus:"−",lowast:"∗",radic:"√",prop:"∝",infin:"∞",ang:"∠",and:"∧",or:"∨",cap:"∩",cup:"∪",int:"∫",there4:"∴",sim:"∼",cong:"≅",asymp:"≈",ne:"≠",equiv:"≡",le:"≤",ge:"≥",sub:"⊂",sup:"⊃",nsub:"⊄",sube:"⊆",supe:"⊇",oplus:"⊕",otimes:"⊗",perp:"⊥",sdot:"⋅",lceil:"⌈",rceil:"⌉",lfloor:"⌊",rfloor:"⌋",lang:"〈",rang:"〉",loz:"◊",spades:"♠",clubs:"♣",hearts:"♥",diams:"♦",quot:'"',amp:"&",lt:"<",gt:">",OElig:"Œ",oelig:"œ",Scaron:"Š",scaron:"š",Yuml:"Ÿ",circ:"ˆ",tilde:"˜",ensp:" ",emsp:" ",thinsp:" ",zwnj:"‌",zwj:"‍",lrm:"‎",rlm:"‏",ndash:"–",mdash:"—",lsquo:"‘",rsquo:"’",sbquo:"‚",ldquo:"“",rdquo:"”",bdquo:"„",dagger:"†",Dagger:"‡",permil:"‰",lsaquo:"‹",rsaquo:"›",euro:"€"},dangerous=["cent","copy","divide","gt","lt","not","para","times"],own$1={}.hasOwnProperty,characters={};let key;for(key in characterEntitiesHtml4)own$1.call(characterEntitiesHtml4,key)&&(characters[characterEntitiesHtml4[key]]=key);const notAlphanumericRegex=/[^\dA-Za-z]/;function toNamed(n,e,t,r){const i=String.fromCharCode(n);if(own$1.call(characters,i)){const s=characters[i],o="&"+s;return t&&characterEntitiesLegacy.includes(s)&&!dangerous.includes(s)&&(!r||e&&e!==61&&notAlphanumericRegex.test(String.fromCharCode(e)))?o:o+";"}return""}function formatSmart(n,e,t){let r=toHexadecimal(n,e,t.omitOptionalSemicolons),i;if((t.useNamedReferences||t.useShortestReferences)&&(i=toNamed(n,e,t.omitOptionalSemicolons,t.attribute)),(t.useShortestReferences||!i)&&t.useShortestReferences){const s=toDecimal(n,e,t.omitOptionalSemicolons);s.length<r.length&&(r=s)}return i&&(!t.useShortestReferences||i.length<r.length)?i:r}function stringifyEntities(n,e){return core(n,Object.assign({format:formatSmart},e))}const htmlCommentRegex=/^>|^->|<!--|-->|--!>|<!-$/g,bogusCommentEntitySubset=[">"],commentEntitySubset=["<",">"];function comment(n,e,t,r){return r.settings.bogusComments?"<?"+stringifyEntities(n.value,Object.assign({},r.settings.characterReferences,{subset:bogusCommentEntitySubset}))+">":"<!--"+n.value.replace(htmlCommentRegex,i)+"-->";function i(s){return stringifyEntities(s,Object.assign({},r.settings.characterReferences,{subset:commentEntitySubset}))}}function doctype(n,e,t,r){return"<!"+(r.settings.upperDoctype?"DOCTYPE":"doctype")+(r.settings.tightDoctype?"":" ")+"html>"}function ccount(n,e){const t=String(n);if(typeof e!="string")throw new TypeError("Expected character");let r=0,i=t.indexOf(e);for(;i!==-1;)r++,i=t.indexOf(e,i+e.length);return r}function stringify$2(n,e){const t=e||{};return(n[n.length-1]===""?[...n,""]:n).join((t.padRight?" ":"")+","+(t.padLeft===!1?"":" ")).trim()}function stringify$1(n){return n.join(" ").trim()}const re=/[ \t\n\f\r]/g;function whitespace(n){return typeof n=="object"?n.type==="text"?empty(n.value):!1:empty(n)}function empty(n){return n.replace(re,"")===""}const siblingAfter=siblings(1),siblingBefore=siblings(-1),emptyChildren$1=[];function siblings(n){return e;function e(t,r,i){const s=t?t.children:emptyChildren$1;let o=(r||0)+n,a=s[o];if(!i)for(;a&&whitespace(a);)o+=n,a=s[o];return a}}const own={}.hasOwnProperty;function omission(n){return e;function e(t,r,i){return own.call(n,t.tagName)&&n[t.tagName](t,r,i)}}const closing=omission({body:body$1,caption:headOrColgroupOrCaption,colgroup:headOrColgroupOrCaption,dd,dt,head:headOrColgroupOrCaption,html:html$1,li,optgroup,option,p,rp:rubyElement,rt:rubyElement,tbody:tbody$1,td:cells,tfoot,th:cells,thead,tr});function headOrColgroupOrCaption(n,e,t){const r=siblingAfter(t,e,!0);return!r||r.type!=="comment"&&!(r.type==="text"&&whitespace(r.value.charAt(0)))}function html$1(n,e,t){const r=siblingAfter(t,e);return!r||r.type!=="comment"}function body$1(n,e,t){const r=siblingAfter(t,e);return!r||r.type!=="comment"}function p(n,e,t){const r=siblingAfter(t,e);return r?r.type==="element"&&(r.tagName==="address"||r.tagName==="article"||r.tagName==="aside"||r.tagName==="blockquote"||r.tagName==="details"||r.tagName==="div"||r.tagName==="dl"||r.tagName==="fieldset"||r.tagName==="figcaption"||r.tagName==="figure"||r.tagName==="footer"||r.tagName==="form"||r.tagName==="h1"||r.tagName==="h2"||r.tagName==="h3"||r.tagName==="h4"||r.tagName==="h5"||r.tagName==="h6"||r.tagName==="header"||r.tagName==="hgroup"||r.tagName==="hr"||r.tagName==="main"||r.tagName==="menu"||r.tagName==="nav"||r.tagName==="ol"||r.tagName==="p"||r.tagName==="pre"||r.tagName==="section"||r.tagName==="table"||r.tagName==="ul"):!t||!(t.type==="element"&&(t.tagName==="a"||t.tagName==="audio"||t.tagName==="del"||t.tagName==="ins"||t.tagName==="map"||t.tagName==="noscript"||t.tagName==="video"))}function li(n,e,t){const r=siblingAfter(t,e);return!r||r.type==="element"&&r.tagName==="li"}function dt(n,e,t){const r=siblingAfter(t,e);return!!(r&&r.type==="element"&&(r.tagName==="dt"||r.tagName==="dd"))}function dd(n,e,t){const r=siblingAfter(t,e);return!r||r.type==="element"&&(r.tagName==="dt"||r.tagName==="dd")}function rubyElement(n,e,t){const r=siblingAfter(t,e);return!r||r.type==="element"&&(r.tagName==="rp"||r.tagName==="rt")}function optgroup(n,e,t){const r=siblingAfter(t,e);return!r||r.type==="element"&&r.tagName==="optgroup"}function option(n,e,t){const r=siblingAfter(t,e);return!r||r.type==="element"&&(r.tagName==="option"||r.tagName==="optgroup")}function thead(n,e,t){const r=siblingAfter(t,e);return!!(r&&r.type==="element"&&(r.tagName==="tbody"||r.tagName==="tfoot"))}function tbody$1(n,e,t){const r=siblingAfter(t,e);return!r||r.type==="element"&&(r.tagName==="tbody"||r.tagName==="tfoot")}function tfoot(n,e,t){return!siblingAfter(t,e)}function tr(n,e,t){const r=siblingAfter(t,e);return!r||r.type==="element"&&r.tagName==="tr"}function cells(n,e,t){const r=siblingAfter(t,e);return!r||r.type==="element"&&(r.tagName==="td"||r.tagName==="th")}const opening=omission({body,colgroup,head,html,tbody});function html(n){const e=siblingAfter(n,-1);return!e||e.type!=="comment"}function head(n){const e=new Set;for(const r of n.children)if(r.type==="element"&&(r.tagName==="base"||r.tagName==="title")){if(e.has(r.tagName))return!1;e.add(r.tagName)}const t=n.children[0];return!t||t.type==="element"}function body(n){const e=siblingAfter(n,-1,!0);return!e||e.type!=="comment"&&!(e.type==="text"&&whitespace(e.value.charAt(0)))&&!(e.type==="element"&&(e.tagName==="meta"||e.tagName==="link"||e.tagName==="script"||e.tagName==="style"||e.tagName==="template"))}function colgroup(n,e,t){const r=siblingBefore(t,e),i=siblingAfter(n,-1,!0);return t&&r&&r.type==="element"&&r.tagName==="colgroup"&&closing(r,t.children.indexOf(r),t)?!1:!!(i&&i.type==="element"&&i.tagName==="col")}function tbody(n,e,t){const r=siblingBefore(t,e),i=siblingAfter(n,-1);return t&&r&&r.type==="element"&&(r.tagName==="thead"||r.tagName==="tbody")&&closing(r,t.children.indexOf(r),t)?!1:!!(i&&i.type==="element"&&i.tagName==="tr")}const constants={name:[[`	
\f\r &/=>`.split(""),`	
\f\r "&'/=>\``.split("")],[`\0	
\f\r "&'/<=>`.split(""),`\0	
\f\r "&'/<=>\``.split("")]],unquoted:[[`	
\f\r &>`.split(""),`\0	
\f\r "&'<=>\``.split("")],[`\0	
\f\r "&'<=>\``.split(""),`\0	
\f\r "&'<=>\``.split("")]],single:[["&'".split(""),"\"&'`".split("")],["\0&'".split(""),"\0\"&'`".split("")]],double:[['"&'.split(""),"\"&'`".split("")],['\0"&'.split(""),"\0\"&'`".split("")]]};function element(n,e,t,r){const i=r.schema,s=i.space==="svg"?!1:r.settings.omitOptionalTags;let o=i.space==="svg"?r.settings.closeEmptyElements:r.settings.voids.includes(n.tagName.toLowerCase());const a=[];let l;i.space==="html"&&n.tagName==="svg"&&(r.schema=svg);const c=serializeAttributes(r,n.properties),u=r.all(i.space==="html"&&n.tagName==="template"?n.content:n);return r.schema=i,u&&(o=!1),(c||!s||!opening(n,e,t))&&(a.push("<",n.tagName,c?" "+c:""),o&&(i.space==="svg"||r.settings.closeSelfClosing)&&(l=c.charAt(c.length-1),(!r.settings.tightSelfClosing||l==="/"||l&&l!=='"'&&l!=="'")&&a.push(" "),a.push("/")),a.push(">")),a.push(u),!o&&(!s||!closing(n,e,t))&&a.push("</"+n.tagName+">"),a.join("")}function serializeAttributes(n,e){const t=[];let r=-1,i;if(e){for(i in e)if(e[i]!==null&&e[i]!==void 0){const s=serializeAttribute(n,i,e[i]);s&&t.push(s)}}for(;++r<t.length;){const s=n.settings.tightAttributes?t[r].charAt(t[r].length-1):void 0;r!==t.length-1&&s!=='"'&&s!=="'"&&(t[r]+=" ")}return t.join("")}function serializeAttribute(n,e,t){const r=find(n.schema,e),i=n.settings.allowParseErrors&&n.schema.space==="html"?0:1,s=n.settings.allowDangerousCharacters?0:1;let o=n.quote,a;if(r.overloadedBoolean&&(t===r.attribute||t==="")?t=!0:(r.boolean||r.overloadedBoolean&&typeof t!="string")&&(t=!!t),t==null||t===!1||typeof t=="number"&&Number.isNaN(t))return"";const l=stringifyEntities(r.attribute,Object.assign({},n.settings.characterReferences,{subset:constants.name[i][s]}));return t===!0||(t=Array.isArray(t)?(r.commaSeparated?stringify$2:stringify$1)(t,{padLeft:!n.settings.tightCommaSeparatedLists}):String(t),n.settings.collapseEmptyAttributes&&!t)?l:(n.settings.preferUnquoted&&(a=stringifyEntities(t,Object.assign({},n.settings.characterReferences,{attribute:!0,subset:constants.unquoted[i][s]}))),a!==t&&(n.settings.quoteSmart&&ccount(t,o)>ccount(t,n.alternative)&&(o=n.alternative),a=o+stringifyEntities(t,Object.assign({},n.settings.characterReferences,{subset:(o==="'"?constants.single:constants.double)[i][s],attribute:!0}))+o),l+(a&&"="+a))}const textEntitySubset=["<","&"];function text(n,e,t,r){return t&&t.type==="element"&&(t.tagName==="script"||t.tagName==="style")?n.value:stringifyEntities(n.value,Object.assign({},r.settings.characterReferences,{subset:textEntitySubset}))}function raw(n,e,t,r){return r.settings.allowDangerousHtml?n.value:text(n,e,t,r)}function root(n,e,t,r){return r.all(n)}const handle=zwitch("type",{invalid,unknown,handlers:{comment,doctype,element,raw,root,text}});function invalid(n){throw new Error("Expected node, not `"+n+"`")}function unknown(n){const e=n;throw new Error("Cannot compile unknown node `"+e.type+"`")}const emptyOptions={},emptyCharacterReferences={},emptyChildren=[];function toHtml(n,e){const t=emptyOptions,r=t.quote||'"',i=r==='"'?"'":'"';if(r!=='"'&&r!=="'")throw new Error("Invalid quote `"+r+"`, expected `'` or `\"`");return{one,all,settings:{omitOptionalTags:t.omitOptionalTags||!1,allowParseErrors:t.allowParseErrors||!1,allowDangerousCharacters:t.allowDangerousCharacters||!1,quoteSmart:t.quoteSmart||!1,preferUnquoted:t.preferUnquoted||!1,tightAttributes:t.tightAttributes||!1,upperDoctype:t.upperDoctype||!1,tightDoctype:t.tightDoctype||!1,bogusComments:t.bogusComments||!1,tightCommaSeparatedLists:t.tightCommaSeparatedLists||!1,tightSelfClosing:t.tightSelfClosing||!1,collapseEmptyAttributes:t.collapseEmptyAttributes||!1,allowDangerousHtml:t.allowDangerousHtml||!1,voids:t.voids||htmlVoidElements,characterReferences:t.characterReferences||emptyCharacterReferences,closeSelfClosing:t.closeSelfClosing||!1,closeEmptyElements:t.closeEmptyElements||!1},schema:t.space==="svg"?svg:html$2,quote:r,alternative:i}.one(Array.isArray(n)?{type:"root",children:n}:n,void 0,void 0)}function one(n,e,t){return handle(n,e,t,this)}function all(n){const e=[],t=n&&n.children||emptyChildren;let r=-1;for(;++r<t.length;)e[r]=this.one(t[r],r,n);return e.join("")}function toArray(n){return Array.isArray(n)?n:[n]}function splitLines(n,e=!1){var s;const t=n.split(/(\r?\n)/g);let r=0;const i=[];for(let o=0;o<t.length;o+=2){const a=e?t[o]+(t[o+1]||""):t[o];i.push([a,r]),r+=t[o].length,r+=((s=t[o+1])==null?void 0:s.length)||0}return i}function isPlainLang(n){return!n||["plaintext","txt","text","plain"].includes(n)}function isSpecialLang(n){return n==="ansi"||isPlainLang(n)}function isNoneTheme(n){return n==="none"}function isSpecialTheme(n){return isNoneTheme(n)}function addClassToHast(n,e){var t;if(!e)return n;n.properties||(n.properties={}),(t=n.properties).class||(t.class=[]),typeof n.properties.class=="string"&&(n.properties.class=n.properties.class.split(/\s+/g)),Array.isArray(n.properties.class)||(n.properties.class=[]);const r=Array.isArray(e)?e:e.split(/\s+/g);for(const i of r)i&&!n.properties.class.includes(i)&&n.properties.class.push(i);return n}function splitToken(n,e){let t=0;const r=[];for(const i of e)i>t&&r.push({...n,content:n.content.slice(t,i),offset:n.offset+t}),t=i;return t<n.content.length&&r.push({...n,content:n.content.slice(t),offset:n.offset+t}),r}function splitTokens(n,e){const t=Array.from(e instanceof Set?e:new Set(e)).sort((r,i)=>r-i);return t.length?n.map(r=>r.flatMap(i=>{const s=t.filter(o=>i.offset<o&&o<i.offset+i.content.length).map(o=>o-i.offset).sort((o,a)=>o-a);return s.length?splitToken(i,s):i})):n}async function normalizeGetter(n){return Promise.resolve(typeof n=="function"?n():n).then(e=>e.default||e)}function resolveColorReplacements(n,e){const t=typeof n=="string"?{}:{...n.colorReplacements},r=typeof n=="string"?n:n.name;for(const[i,s]of Object.entries((e==null?void 0:e.colorReplacements)||{}))typeof s=="string"?t[i]=s:i===r&&Object.assign(t,s);return t}function applyColorReplacements(n,e){return n&&((e==null?void 0:e[n==null?void 0:n.toLowerCase()])||n)}function getTokenStyleObject(n){const e={};return n.color&&(e.color=n.color),n.bgColor&&(e["background-color"]=n.bgColor),n.fontStyle&&(n.fontStyle&FontStyle.Italic&&(e["font-style"]="italic"),n.fontStyle&FontStyle.Bold&&(e["font-weight"]="bold"),n.fontStyle&FontStyle.Underline&&(e["text-decoration"]="underline")),e}function stringifyTokenStyle(n){return typeof n=="string"?n:Object.entries(n).map(([e,t])=>`${e}:${t}`).join(";")}function createPositionConverter(n){const e=splitLines(n,!0).map(([i])=>i);function t(i){if(i===n.length)return{line:e.length-1,character:e[e.length-1].length};let s=i,o=0;for(const a of e){if(s<a.length)break;s-=a.length,o++}return{line:o,character:s}}function r(i,s){let o=0;for(let a=0;a<i;a++)o+=e[a].length;return o+=s,o}return{lines:e,indexToPos:t,posToIndex:r}}class ShikiError extends Error{constructor(e){super(e),this.name="ShikiError"}}var __defProp$2=Object.defineProperty,__defNormalProp$2=(n,e,t)=>e in n?__defProp$2(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,__publicField$2=(n,e,t)=>(__defNormalProp$2(n,typeof e!="symbol"?e+"":e,t),t);const _grammarStateMap=new WeakMap;function setLastGrammarStateToMap(n,e){_grammarStateMap.set(n,e)}function getLastGrammarStateFromMap(n){return _grammarStateMap.get(n)}class GrammarState{constructor(...e){if(__publicField$2(this,"_stacks",{}),__publicField$2(this,"lang"),e.length===2){const[t,r]=e;this.lang=r,this._stacks=t}else{const[t,r,i]=e;this.lang=r,this._stacks={[i]:t}}}get themes(){return Object.keys(this._stacks)}get theme(){return this.themes[0]}get _stack(){return this._stacks[this.theme]}static initial(e,t){return new GrammarState(Object.fromEntries(toArray(t).map(r=>[r,INITIAL])),e)}getInternalStack(e=this.theme){return this._stacks[e]}get scopes(){return getScopes(this._stacks[this.theme])}getScopes(e=this.theme){return getScopes(this._stacks[e])}toJSON(){return{lang:this.lang,theme:this.theme,themes:this.themes,scopes:this.scopes}}}function getScopes(n){const e=[],t=new Set;function r(i){var o;if(t.has(i))return;t.add(i);const s=(o=i==null?void 0:i.nameScopesList)==null?void 0:o.scopeName;s&&e.push(s),i.parent&&r(i.parent)}return r(n),e}function getGrammarStack(n,e){if(!(n instanceof GrammarState))throw new ShikiError("Invalid grammar state");return n.getInternalStack(e)}function transformerDecorations(){const n=new WeakMap;function e(t){if(!n.has(t.meta)){let r=function(o){if(typeof o=="number"){if(o<0||o>t.source.length)throw new ShikiError(`Invalid decoration offset: ${o}. Code length: ${t.source.length}`);return{...i.indexToPos(o),offset:o}}else{const a=i.lines[o.line];if(a===void 0)throw new ShikiError(`Invalid decoration position ${JSON.stringify(o)}. Lines length: ${i.lines.length}`);if(o.character<0||o.character>a.length)throw new ShikiError(`Invalid decoration position ${JSON.stringify(o)}. Line ${o.line} length: ${a.length}`);return{...o,offset:i.posToIndex(o.line,o.character)}}};const i=createPositionConverter(t.source),s=(t.options.decorations||[]).map(o=>({...o,start:r(o.start),end:r(o.end)}));verifyIntersections(s),n.set(t.meta,{decorations:s,converter:i,source:t.source})}return n.get(t.meta)}return{name:"shiki:decorations",tokens(t){var o;if(!((o=this.options.decorations)!=null&&o.length))return;const i=e(this).decorations.flatMap(a=>[a.start.offset,a.end.offset]);return splitTokens(t,i)},code(t){var u;if(!((u=this.options.decorations)!=null&&u.length))return;const r=e(this),i=Array.from(t.children).filter(d=>d.type==="element"&&d.tagName==="span");if(i.length!==r.converter.lines.length)throw new ShikiError(`Number of lines in code element (${i.length}) does not match the number of lines in the source (${r.converter.lines.length}). Failed to apply decorations.`);function s(d,f,m,g){const v=i[d];let x="",S=-1,C=-1;if(f===0&&(S=0),m===0&&(C=0),m===Number.POSITIVE_INFINITY&&(C=v.children.length),S===-1||C===-1)for(let k=0;k<v.children.length;k++)x+=stringify(v.children[k]),S===-1&&x.length===f&&(S=k+1),C===-1&&x.length===m&&(C=k+1);if(S===-1)throw new ShikiError(`Failed to find start index for decoration ${JSON.stringify(g.start)}`);if(C===-1)throw new ShikiError(`Failed to find end index for decoration ${JSON.stringify(g.end)}`);const R=v.children.slice(S,C);if(!g.alwaysWrap&&R.length===v.children.length)a(v,g,"line");else if(!g.alwaysWrap&&R.length===1&&R[0].type==="element")a(R[0],g,"token");else{const k={type:"element",tagName:"span",properties:{},children:R};a(k,g,"wrapper"),v.children.splice(S,R.length,k)}}function o(d,f){i[d]=a(i[d],f,"line")}function a(d,f,m){var x;const g=f.properties||{},v=f.transform||(S=>S);return d.tagName=f.tagName||"span",d.properties={...d.properties,...g,class:d.properties.class},(x=f.properties)!=null&&x.class&&addClassToHast(d,f.properties.class),d=v(d,m)||d,d}const l=[],c=r.decorations.sort((d,f)=>f.start.offset-d.start.offset);for(const d of c){const{start:f,end:m}=d;if(f.line===m.line)s(f.line,f.character,m.character,d);else if(f.line<m.line){s(f.line,f.character,Number.POSITIVE_INFINITY,d);for(let g=f.line+1;g<m.line;g++)l.unshift(()=>o(g,d));s(m.line,0,m.character,d)}}l.forEach(d=>d())}}}function verifyIntersections(n){for(let e=0;e<n.length;e++){const t=n[e];if(t.start.offset>t.end.offset)throw new ShikiError(`Invalid decoration range: ${JSON.stringify(t.start)} - ${JSON.stringify(t.end)}`);for(let r=e+1;r<n.length;r++){const i=n[r],s=t.start.offset<i.start.offset&&i.start.offset<t.end.offset,o=t.start.offset<i.end.offset&&i.end.offset<t.end.offset,a=i.start.offset<t.start.offset&&t.start.offset<i.end.offset,l=i.start.offset<t.end.offset&&t.end.offset<i.end.offset;if(s||o||a||l){if(o&&o||a&&l)continue;throw new ShikiError(`Decorations ${JSON.stringify(t.start)} and ${JSON.stringify(i.start)} intersect.`)}}}}function stringify(n){return n.type==="text"?n.value:n.type==="element"?n.children.map(stringify).join(""):""}const builtInTransformers=[transformerDecorations()];function getTransformers(n){return[...n.transformers||[],...builtInTransformers]}var namedColors=["black","red","green","yellow","blue","magenta","cyan","white","brightBlack","brightRed","brightGreen","brightYellow","brightBlue","brightMagenta","brightCyan","brightWhite"],decorations={1:"bold",2:"dim",3:"italic",4:"underline",7:"reverse",9:"strikethrough"};function findSequence(n,e){const t=n.indexOf("\x1B[",e);if(t!==-1){const r=n.indexOf("m",t);return{sequence:n.substring(t+2,r).split(";"),startPosition:t,position:r+1}}return{position:n.length}}function parseColor(n,e){let t=1;const r=n[e+t++];let i;if(r==="2"){const s=[n[e+t++],n[e+t++],n[e+t]].map(o=>Number.parseInt(o));s.length===3&&!s.some(o=>Number.isNaN(o))&&(i={type:"rgb",rgb:s})}else if(r==="5"){const s=Number.parseInt(n[e+t]);Number.isNaN(s)||(i={type:"table",index:Number(s)})}return[t,i]}function parseSequence(n){const e=[];for(let t=0;t<n.length;t++){const r=n[t],i=Number.parseInt(r);if(!Number.isNaN(i))if(i===0)e.push({type:"resetAll"});else if(i<=9)decorations[i]&&e.push({type:"setDecoration",value:decorations[i]});else if(i<=29){const s=decorations[i-20];s&&e.push({type:"resetDecoration",value:s})}else if(i<=37)e.push({type:"setForegroundColor",value:{type:"named",name:namedColors[i-30]}});else if(i===38){const[s,o]=parseColor(n,t);o&&e.push({type:"setForegroundColor",value:o}),t+=s}else if(i===39)e.push({type:"resetForegroundColor"});else if(i<=47)e.push({type:"setBackgroundColor",value:{type:"named",name:namedColors[i-40]}});else if(i===48){const[s,o]=parseColor(n,t);o&&e.push({type:"setBackgroundColor",value:o}),t+=s}else i===49?e.push({type:"resetBackgroundColor"}):i>=90&&i<=97?e.push({type:"setForegroundColor",value:{type:"named",name:namedColors[i-90+8]}}):i>=100&&i<=107&&e.push({type:"setBackgroundColor",value:{type:"named",name:namedColors[i-100+8]}})}return e}function createAnsiSequenceParser(){let n=null,e=null,t=new Set;return{parse(r){const i=[];let s=0;do{const o=findSequence(r,s),a=o.sequence?r.substring(s,o.startPosition):r.substring(s);if(a.length>0&&i.push({value:a,foreground:n,background:e,decorations:new Set(t)}),o.sequence){const l=parseSequence(o.sequence);for(const c of l)c.type==="resetAll"?(n=null,e=null,t.clear()):c.type==="resetForegroundColor"?n=null:c.type==="resetBackgroundColor"?e=null:c.type==="resetDecoration"&&t.delete(c.value);for(const c of l)c.type==="setForegroundColor"?n=c.value:c.type==="setBackgroundColor"?e=c.value:c.type==="setDecoration"&&t.add(c.value)}s=o.position}while(s<r.length);return i}}}var defaultNamedColorsMap={black:"#000000",red:"#bb0000",green:"#00bb00",yellow:"#bbbb00",blue:"#0000bb",magenta:"#ff00ff",cyan:"#00bbbb",white:"#eeeeee",brightBlack:"#555555",brightRed:"#ff5555",brightGreen:"#00ff00",brightYellow:"#ffff55",brightBlue:"#5555ff",brightMagenta:"#ff55ff",brightCyan:"#55ffff",brightWhite:"#ffffff"};function createColorPalette(n=defaultNamedColorsMap){function e(a){return n[a]}function t(a){return`#${a.map(l=>Math.max(0,Math.min(l,255)).toString(16).padStart(2,"0")).join("")}`}let r;function i(){if(r)return r;r=[];for(let c=0;c<namedColors.length;c++)r.push(e(namedColors[c]));let a=[0,95,135,175,215,255];for(let c=0;c<6;c++)for(let u=0;u<6;u++)for(let d=0;d<6;d++)r.push(t([a[c],a[u],a[d]]));let l=8;for(let c=0;c<24;c++,l+=10)r.push(t([l,l,l]));return r}function s(a){return i()[a]}function o(a){switch(a.type){case"named":return e(a.name);case"rgb":return t(a.rgb);case"table":return s(a.index)}}return{value:o}}function tokenizeAnsiWithTheme(n,e,t){const r=resolveColorReplacements(n,t),i=splitLines(e),s=createColorPalette(Object.fromEntries(namedColors.map(a=>{var l;return[a,(l=n.colors)==null?void 0:l[`terminal.ansi${a[0].toUpperCase()}${a.substring(1)}`]]}))),o=createAnsiSequenceParser();return i.map(a=>o.parse(a[0]).map(l=>{let c,u;l.decorations.has("reverse")?(c=l.background?s.value(l.background):n.bg,u=l.foreground?s.value(l.foreground):n.fg):(c=l.foreground?s.value(l.foreground):n.fg,u=l.background?s.value(l.background):void 0),c=applyColorReplacements(c,r),u=applyColorReplacements(u,r),l.decorations.has("dim")&&(c=dimColor(c));let d=FontStyle.None;return l.decorations.has("bold")&&(d|=FontStyle.Bold),l.decorations.has("italic")&&(d|=FontStyle.Italic),l.decorations.has("underline")&&(d|=FontStyle.Underline),{content:l.value,offset:a[1],color:c,bgColor:u,fontStyle:d}}))}function dimColor(n){const e=n.match(/#([0-9a-f]{3})([0-9a-f]{3})?([0-9a-f]{2})?/);if(e)if(e[3]){const r=Math.round(Number.parseInt(e[3],16)/2).toString(16).padStart(2,"0");return`#${e[1]}${e[2]}${r}`}else return e[2]?`#${e[1]}${e[2]}80`:`#${Array.from(e[1]).map(r=>`${r}${r}`).join("")}80`;const t=n.match(/var\((--[\w-]+-ansi-[\w-]+)\)/);return t?`var(${t[1]}-dim)`:n}function codeToTokensBase$1(n,e,t={}){const{lang:r="text",theme:i=n.getLoadedThemes()[0]}=t;if(isPlainLang(r)||isNoneTheme(i))return splitLines(e).map(l=>[{content:l[0],offset:l[1]}]);const{theme:s,colorMap:o}=n.setTheme(i);if(r==="ansi")return tokenizeAnsiWithTheme(s,e,t);const a=n.getLanguage(r);if(t.grammarState){if(t.grammarState.lang!==a.name)throw new ShikiError$2(`Grammar state language "${t.grammarState.lang}" does not match highlight language "${a.name}"`);if(!t.grammarState.themes.includes(s.name))throw new ShikiError$2(`Grammar state themes "${t.grammarState.themes}" do not contain highlight theme "${s.name}"`)}return tokenizeWithTheme(e,a,s,o,t)}function getLastGrammarState$1(...n){if(n.length===2)return getLastGrammarStateFromMap(n[1]);const[e,t,r={}]=n,{lang:i="text",theme:s=e.getLoadedThemes()[0]}=r;if(isPlainLang(i)||isNoneTheme(s))throw new ShikiError$2("Plain language does not have grammar state");if(i==="ansi")throw new ShikiError$2("ANSI language does not have grammar state");const{theme:o,colorMap:a}=e.setTheme(s),l=e.getLanguage(i);return new GrammarState(_tokenizeWithTheme(t,l,o,a,r).stateStack,l.name,o.name)}function tokenizeWithTheme(n,e,t,r,i){const s=_tokenizeWithTheme(n,e,t,r,i),o=new GrammarState(_tokenizeWithTheme(n,e,t,r,i).stateStack,e.name,t.name);return setLastGrammarStateToMap(s.tokens,o),s.tokens}function _tokenizeWithTheme(n,e,t,r,i){const s=resolveColorReplacements(t,i),{tokenizeMaxLineLength:o=0,tokenizeTimeLimit:a=500}=i,l=splitLines(n);let c=i.grammarState?getGrammarStack(i.grammarState,t.name)??INITIAL:i.grammarContextCode!=null?_tokenizeWithTheme(i.grammarContextCode,e,t,r,{...i,grammarState:void 0,grammarContextCode:void 0}).stateStack:INITIAL,u=[];const d=[];for(let f=0,m=l.length;f<m;f++){const[g,v]=l[f];if(g===""){u=[],d.push([]);continue}if(o>0&&g.length>=o){u=[],d.push([{content:g,offset:v,color:"",fontStyle:0}]);continue}let x,S,C;i.includeExplanation&&(x=e.tokenizeLine(g,c),S=x.tokens,C=0);const R=e.tokenizeLine2(g,c,a),k=R.tokens.length/2;for(let I=0;I<k;I++){const F=R.tokens[2*I],N=I+1<k?R.tokens[2*I+2]:g.length;if(F===N)continue;const U=R.tokens[2*I+1],M=applyColorReplacements(r[EncodedTokenMetadata.getForeground(U)],s),B=EncodedTokenMetadata.getFontStyle(U),H={content:g.substring(F,N),offset:v+F,color:M,fontStyle:B};if(i.includeExplanation){const K=[];if(i.includeExplanation!=="scopeName")for(const oe of t.settings){let ue;switch(typeof oe.scope){case"string":ue=oe.scope.split(/,/).map(Z=>Z.trim());break;case"object":ue=oe.scope;break;default:continue}K.push({settings:oe,selectors:ue.map(Z=>Z.split(/ /))})}H.explanation=[];let Y=0;for(;F+Y<N;){const oe=S[C],ue=g.substring(oe.startIndex,oe.endIndex);Y+=ue.length,H.explanation.push({content:ue,scopes:i.includeExplanation==="scopeName"?explainThemeScopesNameOnly(oe.scopes):explainThemeScopesFull(K,oe.scopes)}),C+=1}}u.push(H)}d.push(u),u=[],c=R.ruleStack}return{tokens:d,stateStack:c}}function explainThemeScopesNameOnly(n){return n.map(e=>({scopeName:e}))}function explainThemeScopesFull(n,e){const t=[];for(let r=0,i=e.length;r<i;r++){const s=e[r];t[r]={scopeName:s,themeMatches:explainThemeScope(n,s,e.slice(0,r))}}return t}function matchesOne(n,e){return n===e||e.substring(0,n.length)===n&&e[n.length]==="."}function matches(n,e,t){if(!matchesOne(n[n.length-1],e))return!1;let r=n.length-2,i=t.length-1;for(;r>=0&&i>=0;)matchesOne(n[r],t[i])&&(r-=1),i-=1;return r===-1}function explainThemeScope(n,e,t){const r=[];for(const{selectors:i,settings:s}of n)for(const o of i)if(matches(o,e,t)){r.push(s);break}return r}function codeToTokensWithThemes$1(n,e,t){const r=Object.entries(t.themes).filter(l=>l[1]).map(l=>({color:l[0],theme:l[1]})),i=r.map(l=>{const c=codeToTokensBase$1(n,e,{...t,theme:l.theme}),u=getLastGrammarStateFromMap(c),d=typeof l.theme=="string"?l.theme:l.theme.name;return{tokens:c,state:u,theme:d}}),s=syncThemesTokenization(...i.map(l=>l.tokens)),o=s[0].map((l,c)=>l.map((u,d)=>{const f={content:u.content,variants:{},offset:u.offset};return"includeExplanation"in t&&t.includeExplanation&&(f.explanation=u.explanation),s.forEach((m,g)=>{const{content:v,explanation:x,offset:S,...C}=m[c][d];f.variants[r[g].color]=C}),f})),a=i[0].state?new GrammarState(Object.fromEntries(i.map(l=>{var c;return[l.theme,(c=l.state)==null?void 0:c.getInternalStack(l.theme)]})),i[0].state.lang):void 0;return a&&setLastGrammarStateToMap(o,a),o}function syncThemesTokenization(...n){const e=n.map(()=>[]),t=n.length;for(let r=0;r<n[0].length;r++){const i=n.map(l=>l[r]),s=e.map(()=>[]);e.forEach((l,c)=>l.push(s[c]));const o=i.map(()=>0),a=i.map(l=>l[0]);for(;a.every(l=>l);){const l=Math.min(...a.map(c=>c.content.length));for(let c=0;c<t;c++){const u=a[c];u.content.length===l?(s[c].push(u),o[c]+=1,a[c]=i[c][o[c]]):(s[c].push({...u,content:u.content.slice(0,l)}),a[c]={...u,content:u.content.slice(l),offset:u.offset+l})}}}return e}function codeToTokens$1(n,e,t){let r,i,s,o,a,l;if("themes"in t){const{defaultColor:c="light",cssVariablePrefix:u="--shiki-"}=t,d=Object.entries(t.themes).filter(x=>x[1]).map(x=>({color:x[0],theme:x[1]})).sort((x,S)=>x.color===c?-1:S.color===c?1:0);if(d.length===0)throw new ShikiError$2("`themes` option must not be empty");const f=codeToTokensWithThemes$1(n,e,t);if(l=getLastGrammarStateFromMap(f),c&&!d.find(x=>x.color===c))throw new ShikiError$2(`\`themes\` option must contain the defaultColor key \`${c}\``);const m=d.map(x=>n.getTheme(x.theme)),g=d.map(x=>x.color);s=f.map(x=>x.map(S=>mergeToken(S,g,u,c))),l&&setLastGrammarStateToMap(s,l);const v=d.map(x=>resolveColorReplacements(x.theme,t));i=d.map((x,S)=>(S===0&&c?"":`${u+x.color}:`)+(applyColorReplacements(m[S].fg,v[S])||"inherit")).join(";"),r=d.map((x,S)=>(S===0&&c?"":`${u+x.color}-bg:`)+(applyColorReplacements(m[S].bg,v[S])||"inherit")).join(";"),o=`shiki-themes ${m.map(x=>x.name).join(" ")}`,a=c?void 0:[i,r].join(";")}else if("theme"in t){const c=resolveColorReplacements(t.theme,t);s=codeToTokensBase$1(n,e,t);const u=n.getTheme(t.theme);r=applyColorReplacements(u.bg,c),i=applyColorReplacements(u.fg,c),o=u.name,l=getLastGrammarStateFromMap(s)}else throw new ShikiError$2("Invalid options, either `theme` or `themes` must be provided");return{tokens:s,fg:i,bg:r,themeName:o,rootStyle:a,grammarState:l}}function mergeToken(n,e,t,r){const i={content:n.content,explanation:n.explanation,offset:n.offset},s=e.map(l=>getTokenStyleObject(n.variants[l])),o=new Set(s.flatMap(l=>Object.keys(l))),a={};return s.forEach((l,c)=>{for(const u of o){const d=l[u]||"inherit";if(c===0&&r)a[u]=d;else{const f=u==="color"?"":u==="background-color"?"-bg":`-${u}`,m=t+e[c]+(u==="color"?"":f);a[m]=d}}}),i.htmlStyle=a,i}function codeToHast$1(n,e,t,r={meta:{},options:t,codeToHast:(i,s)=>codeToHast$1(n,i,s),codeToTokens:(i,s)=>codeToTokens$1(n,i,s)}){var m,g;let i=e;for(const v of getTransformers(t))i=((m=v.preprocess)==null?void 0:m.call(r,i,t))||i;let{tokens:s,fg:o,bg:a,themeName:l,rootStyle:c,grammarState:u}=codeToTokens$1(n,i,t);const{mergeWhitespaces:d=!0}=t;d===!0?s=mergeWhitespaceTokens(s):d==="never"&&(s=splitWhitespaceTokens(s));const f={...r,get source(){return i}};for(const v of getTransformers(t))s=((g=v.tokens)==null?void 0:g.call(f,s))||s;return tokensToHast(s,{...t,fg:o,bg:a,themeName:l,rootStyle:c},f,u)}function tokensToHast(n,e,t,r=getLastGrammarStateFromMap(n)){var g,v,x;const i=getTransformers(e),s=[],o={type:"root",children:[]},{structure:a="classic",tabindex:l="0"}=e;let c={type:"element",tagName:"pre",properties:{class:`shiki ${e.themeName||""}`,style:e.rootStyle||`background-color:${e.bg};color:${e.fg}`,...l!==!1&&l!=null?{tabindex:l.toString()}:{},...Object.fromEntries(Array.from(Object.entries(e.meta||{})).filter(([S])=>!S.startsWith("_")))},children:[]},u={type:"element",tagName:"code",properties:{},children:s};const d=[],f={...t,structure:a,addClassToHast,get source(){return t.source},get tokens(){return n},get options(){return e},get root(){return o},get pre(){return c},get code(){return u},get lines(){return d}};if(n.forEach((S,C)=>{var I,F;C&&(a==="inline"?o.children.push({type:"element",tagName:"br",properties:{},children:[]}):a==="classic"&&s.push({type:"text",value:`
`}));let R={type:"element",tagName:"span",properties:{class:"line"},children:[]},k=0;for(const N of S){let U={type:"element",tagName:"span",properties:{...N.htmlAttrs},children:[{type:"text",value:N.content}]};N.htmlStyle;const M=stringifyTokenStyle(N.htmlStyle||getTokenStyleObject(N));M&&(U.properties.style=M);for(const B of i)U=((I=B==null?void 0:B.span)==null?void 0:I.call(f,U,C+1,k,R,N))||U;a==="inline"?o.children.push(U):a==="classic"&&R.children.push(U),k+=N.content.length}if(a==="classic"){for(const N of i)R=((F=N==null?void 0:N.line)==null?void 0:F.call(f,R,C+1))||R;d.push(R),s.push(R)}}),a==="classic"){for(const S of i)u=((g=S==null?void 0:S.code)==null?void 0:g.call(f,u))||u;c.children.push(u);for(const S of i)c=((v=S==null?void 0:S.pre)==null?void 0:v.call(f,c))||c;o.children.push(c)}let m=o;for(const S of i)m=((x=S==null?void 0:S.root)==null?void 0:x.call(f,m))||m;return r&&setLastGrammarStateToMap(m,r),m}function mergeWhitespaceTokens(n){return n.map(e=>{const t=[];let r="",i=0;return e.forEach((s,o)=>{const l=!(s.fontStyle&&s.fontStyle&FontStyle.Underline);l&&s.content.match(/^\s+$/)&&e[o+1]?(i||(i=s.offset),r+=s.content):r?(l?t.push({...s,offset:i,content:r+s.content}):t.push({content:r,offset:i},s),i=0,r=""):t.push(s)}),t})}function splitWhitespaceTokens(n){return n.map(e=>e.flatMap(t=>{if(t.content.match(/^\s+$/))return t;const r=t.content.match(/^(\s*)(.*?)(\s*)$/);if(!r)return t;const[,i,s,o]=r;if(!i&&!o)return t;const a=[{...t,offset:t.offset+i.length,content:s}];return i&&a.unshift({content:i,offset:t.offset}),o&&a.push({content:o,offset:t.offset+i.length+s.length}),a}))}function codeToHtml$1(n,e,t){var s;const r={meta:{},options:t,codeToHast:(o,a)=>codeToHast$1(n,o,a),codeToTokens:(o,a)=>codeToTokens$1(n,o,a)};let i=toHtml(codeToHast$1(n,e,t,r));for(const o of getTransformers(t))i=((s=o.postprocess)==null?void 0:s.call(r,i,t))||i;return i}const VSCODE_FALLBACK_EDITOR_FG={light:"#333333",dark:"#bbbbbb"},VSCODE_FALLBACK_EDITOR_BG={light:"#fffffe",dark:"#1e1e1e"},RESOLVED_KEY="__shiki_resolved";function normalizeTheme(n){var a,l,c,u,d;if(n!=null&&n[RESOLVED_KEY])return n;const e={...n};e.tokenColors&&!e.settings&&(e.settings=e.tokenColors,delete e.tokenColors),e.type||(e.type="dark"),e.colorReplacements={...e.colorReplacements},e.settings||(e.settings=[]);let{bg:t,fg:r}=e;if(!t||!r){const f=e.settings?e.settings.find(m=>!m.name&&!m.scope):void 0;(a=f==null?void 0:f.settings)!=null&&a.foreground&&(r=f.settings.foreground),(l=f==null?void 0:f.settings)!=null&&l.background&&(t=f.settings.background),!r&&((c=e==null?void 0:e.colors)!=null&&c["editor.foreground"])&&(r=e.colors["editor.foreground"]),!t&&((u=e==null?void 0:e.colors)!=null&&u["editor.background"])&&(t=e.colors["editor.background"]),r||(r=e.type==="light"?VSCODE_FALLBACK_EDITOR_FG.light:VSCODE_FALLBACK_EDITOR_FG.dark),t||(t=e.type==="light"?VSCODE_FALLBACK_EDITOR_BG.light:VSCODE_FALLBACK_EDITOR_BG.dark),e.fg=r,e.bg=t}e.settings[0]&&e.settings[0].settings&&!e.settings[0].scope||e.settings.unshift({settings:{foreground:e.fg,background:e.bg}});let i=0;const s=new Map;function o(f){var g;if(s.has(f))return s.get(f);i+=1;const m=`#${i.toString(16).padStart(8,"0").toLowerCase()}`;return(g=e.colorReplacements)!=null&&g[`#${m}`]?o(f):(s.set(f,m),m)}e.settings=e.settings.map(f=>{var x,S;const m=((x=f.settings)==null?void 0:x.foreground)&&!f.settings.foreground.startsWith("#"),g=((S=f.settings)==null?void 0:S.background)&&!f.settings.background.startsWith("#");if(!m&&!g)return f;const v={...f,settings:{...f.settings}};if(m){const C=o(f.settings.foreground);e.colorReplacements[C]=f.settings.foreground,v.settings.foreground=C}if(g){const C=o(f.settings.background);e.colorReplacements[C]=f.settings.background,v.settings.background=C}return v});for(const f of Object.keys(e.colors||{}))if((f==="editor.foreground"||f==="editor.background"||f.startsWith("terminal.ansi"))&&!((d=e.colors[f])!=null&&d.startsWith("#"))){const m=o(e.colors[f]);e.colorReplacements[m]=e.colors[f],e.colors[f]=m}return Object.defineProperty(e,RESOLVED_KEY,{enumerable:!1,writable:!1,value:!0}),e}async function resolveLangs(n){return Array.from(new Set((await Promise.all(n.filter(e=>!isSpecialLang(e)).map(async e=>await normalizeGetter(e).then(t=>Array.isArray(t)?t:[t])))).flat()))}async function resolveThemes(n){return(await Promise.all(n.map(async t=>isSpecialTheme(t)?null:normalizeTheme(await normalizeGetter(t))))).filter(t=>!!t)}var __defProp$1=Object.defineProperty,__defNormalProp$1=(n,e,t)=>e in n?__defProp$1(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,__publicField$1=(n,e,t)=>(__defNormalProp$1(n,typeof e!="symbol"?e+"":e,t),t);class Registry extends Registry$1{constructor(e,t,r,i={}){super(e),this._resolver=e,this._themes=t,this._langs=r,this._alias=i,__publicField$1(this,"_resolvedThemes",new Map),__publicField$1(this,"_resolvedGrammars",new Map),__publicField$1(this,"_langMap",new Map),__publicField$1(this,"_langGraph",new Map),__publicField$1(this,"_textmateThemeCache",new WeakMap),__publicField$1(this,"_loadedThemesCache",null),__publicField$1(this,"_loadedLanguagesCache",null),this._themes.map(s=>this.loadTheme(s)),this.loadLanguages(this._langs)}getTheme(e){return typeof e=="string"?this._resolvedThemes.get(e):this.loadTheme(e)}loadTheme(e){const t=normalizeTheme(e);return t.name&&(this._resolvedThemes.set(t.name,t),this._loadedThemesCache=null),t}getLoadedThemes(){return this._loadedThemesCache||(this._loadedThemesCache=[...this._resolvedThemes.keys()]),this._loadedThemesCache}setTheme(e){let t=this._textmateThemeCache.get(e);t||(t=Theme.createFromRawTheme(e),this._textmateThemeCache.set(e,t)),this._syncRegistry.setTheme(t)}getGrammar(e){if(this._alias[e]){const t=new Set([e]);for(;this._alias[e];){if(e=this._alias[e],t.has(e))throw new ShikiError(`Circular alias \`${Array.from(t).join(" -> ")} -> ${e}\``);t.add(e)}}return this._resolvedGrammars.get(e)}loadLanguage(e){var s,o,a,l;if(this.getGrammar(e.name))return;const t=new Set([...this._langMap.values()].filter(c=>{var u;return(u=c.embeddedLangsLazy)==null?void 0:u.includes(e.name)}));this._resolver.addLanguage(e);const r={balancedBracketSelectors:e.balancedBracketSelectors||["*"],unbalancedBracketSelectors:e.unbalancedBracketSelectors||[]};this._syncRegistry._rawGrammars.set(e.scopeName,e);const i=this.loadGrammarWithConfiguration(e.scopeName,1,r);if(i.name=e.name,this._resolvedGrammars.set(e.name,i),e.aliases&&e.aliases.forEach(c=>{this._alias[c]=e.name}),this._loadedLanguagesCache=null,t.size)for(const c of t)this._resolvedGrammars.delete(c.name),this._loadedLanguagesCache=null,(o=(s=this._syncRegistry)==null?void 0:s._injectionGrammars)==null||o.delete(c.scopeName),(l=(a=this._syncRegistry)==null?void 0:a._grammars)==null||l.delete(c.scopeName),this.loadLanguage(this._langMap.get(c.name))}dispose(){super.dispose(),this._resolvedThemes.clear(),this._resolvedGrammars.clear(),this._langMap.clear(),this._langGraph.clear(),this._loadedThemesCache=null}loadLanguages(e){for(const i of e)this.resolveEmbeddedLanguages(i);const t=Array.from(this._langGraph.entries()),r=t.filter(([i,s])=>!s);if(r.length){const i=t.filter(([s,o])=>{var a;return o&&((a=o.embeddedLangs)==null?void 0:a.some(l=>r.map(([c])=>c).includes(l)))}).filter(s=>!r.includes(s));throw new ShikiError(`Missing languages ${r.map(([s])=>`\`${s}\``).join(", ")}, required by ${i.map(([s])=>`\`${s}\``).join(", ")}`)}for(const[i,s]of t)this._resolver.addLanguage(s);for(const[i,s]of t)this.loadLanguage(s)}getLoadedLanguages(){return this._loadedLanguagesCache||(this._loadedLanguagesCache=[...new Set([...this._resolvedGrammars.keys(),...Object.keys(this._alias)])]),this._loadedLanguagesCache}resolveEmbeddedLanguages(e){if(this._langMap.set(e.name,e),this._langGraph.set(e.name,e),e.embeddedLangs)for(const t of e.embeddedLangs)this._langGraph.set(t,this._langMap.get(t))}}var __defProp=Object.defineProperty,__defNormalProp=(n,e,t)=>e in n?__defProp(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,__publicField=(n,e,t)=>(__defNormalProp(n,typeof e!="symbol"?e+"":e,t),t);class Resolver{constructor(e,t){__publicField(this,"_langs",new Map),__publicField(this,"_scopeToLang",new Map),__publicField(this,"_injections",new Map),__publicField(this,"_onigLib"),this._onigLib={createOnigScanner:r=>e.createScanner(r),createOnigString:r=>e.createString(r)},t.forEach(r=>this.addLanguage(r))}get onigLib(){return this._onigLib}getLangRegistration(e){return this._langs.get(e)}loadGrammar(e){return this._scopeToLang.get(e)}addLanguage(e){this._langs.set(e.name,e),e.aliases&&e.aliases.forEach(t=>{this._langs.set(t,e)}),this._scopeToLang.set(e.scopeName,e),e.injectTo&&e.injectTo.forEach(t=>{this._injections.get(t)||this._injections.set(t,[]),this._injections.get(t).push(e.scopeName)})}getInjections(e){const t=e.split(".");let r=[];for(let i=1;i<=t.length;i++){const s=t.slice(0,i).join(".");r=[...r,...this._injections.get(s)||[]]}return r}}let instancesCount=0;function createShikiInternalSync(n){instancesCount+=1,n.warnings!==!1&&instancesCount>=10&&instancesCount%10===0&&console.warn(`[Shiki] ${instancesCount} instances have been created. Shiki is supposed to be used as a singleton, consider refactoring your code to cache your highlighter instance; Or call \`highlighter.dispose()\` to release unused instances.`);let e=!1;if(!n.engine)throw new ShikiError("`engine` option is required for synchronous mode");const t=(n.langs||[]).flat(1),r=(n.themes||[]).flat(1).map(normalizeTheme),i=new Resolver(n.engine,t),s=new Registry(i,r,t,n.langAlias);let o;function a(C){x();const R=s.getGrammar(typeof C=="string"?C:C.name);if(!R)throw new ShikiError(`Language \`${C}\` not found, you may need to load it first`);return R}function l(C){if(C==="none")return{bg:"",fg:"",name:"none",settings:[],type:"dark"};x();const R=s.getTheme(C);if(!R)throw new ShikiError(`Theme \`${C}\` not found, you may need to load it first`);return R}function c(C){x();const R=l(C);o!==C&&(s.setTheme(R),o=C);const k=s.getColorMap();return{theme:R,colorMap:k}}function u(){return x(),s.getLoadedThemes()}function d(){return x(),s.getLoadedLanguages()}function f(...C){x(),s.loadLanguages(C.flat(1))}async function m(...C){return f(await resolveLangs(C))}function g(...C){x();for(const R of C.flat(1))s.loadTheme(R)}async function v(...C){return x(),g(await resolveThemes(C))}function x(){if(e)throw new ShikiError("Shiki instance has been disposed")}function S(){e||(e=!0,s.dispose(),instancesCount-=1)}return{setTheme:c,getTheme:l,getLanguage:a,getLoadedThemes:u,getLoadedLanguages:d,loadLanguage:m,loadLanguageSync:f,loadTheme:v,loadThemeSync:g,dispose:S,[Symbol.dispose]:S}}async function createShikiInternal(n={}){n.loadWasm;const[e,t,r]=await Promise.all([resolveThemes(n.themes||[]),resolveLangs(n.langs||[]),n.engine||createOnigurumaEngine(n.loadWasm||getDefaultWasmLoader())]);return createShikiInternalSync({...n,loadWasm:void 0,themes:e,langs:t,engine:r})}async function createHighlighterCore(n={}){const e=await createShikiInternal(n);return{getLastGrammarState:(...t)=>getLastGrammarState$1(e,...t),codeToTokensBase:(t,r)=>codeToTokensBase$1(e,t,r),codeToTokensWithThemes:(t,r)=>codeToTokensWithThemes$1(e,t,r),codeToTokens:(t,r)=>codeToTokens$1(e,t,r),codeToHast:(t,r)=>codeToHast$1(e,t,r),codeToHtml:(t,r)=>codeToHtml$1(e,t,r),...e,getInternalContext:()=>e}}function createdBundledHighlighter(n,e,t){let r,i,s;{const a=n;r=a.langs,i=a.themes,s=a.engine}async function o(a){function l(m){if(typeof m=="string"){if(isSpecialLang(m))return[];const g=r[m];if(!g)throw new ShikiError$2(`Language \`${m}\` is not included in this bundle. You may want to load it from external source.`);return g}return m}function c(m){if(isSpecialTheme(m))return"none";if(typeof m=="string"){const g=i[m];if(!g)throw new ShikiError$2(`Theme \`${m}\` is not included in this bundle. You may want to load it from external source.`);return g}return m}const u=(a.themes??[]).map(m=>c(m)),d=(a.langs??[]).map(m=>l(m)),f=await createHighlighterCore({engine:a.engine??s(),...a,themes:u,langs:d});return{...f,loadLanguage(...m){return f.loadLanguage(...m.map(l))},loadTheme(...m){return f.loadTheme(...m.map(c))}}}return o}function makeSingletonHighlighter(n){let e;async function t(r={}){if(e){const i=await e;return await Promise.all([i.loadTheme(...r.themes||[]),i.loadLanguage(...r.langs||[])]),i}else return e=n({...r,themes:r.themes||[],langs:r.langs||[]}),e}return t}function createSingletonShorthands(n){const e=makeSingletonHighlighter(n);return{getSingletonHighlighter(t){return e(t)},async codeToHtml(t,r){return(await e({langs:[r.lang],themes:"theme"in r?[r.theme]:Object.values(r.themes)})).codeToHtml(t,r)},async codeToHast(t,r){return(await e({langs:[r.lang],themes:"theme"in r?[r.theme]:Object.values(r.themes)})).codeToHast(t,r)},async codeToTokens(t,r){return(await e({langs:[r.lang],themes:"theme"in r?[r.theme]:Object.values(r.themes)})).codeToTokens(t,r)},async codeToTokensBase(t,r){return(await e({langs:[r.lang],themes:[r.theme]})).codeToTokensBase(t,r)},async codeToTokensWithThemes(t,r){return(await e({langs:[r.lang],themes:Object.values(r.themes).filter(Boolean)})).codeToTokensWithThemes(t,r)},async getLastGrammarState(t,r){return(await e({langs:[r.lang],themes:[r.theme]})).getLastGrammarState(t,r)}}}const createHighlighter=createdBundledHighlighter({langs:bundledLanguages,themes:bundledThemes,engine:()=>createOnigurumaEngine(__vitePreload(()=>import("./wasm-CG6Dc4jp.js"),[],import.meta.url))}),{codeToHtml,codeToHast,codeToTokens,codeToTokensBase,codeToTokensWithThemes,getSingletonHighlighter,getLastGrammarState}=createSingletonShorthands(createHighlighter),DECRYPT=0,ROUND=32,BLOCK=16,Sbox=[214,144,233,254,204,225,61,183,22,182,20,194,40,251,44,5,43,103,154,118,42,190,4,195,170,68,19,38,73,134,6,153,156,66,80,244,145,239,152,122,51,84,11,67,237,207,172,98,228,179,28,169,201,8,232,149,128,223,148,250,117,143,63,166,71,7,167,252,243,115,23,186,131,89,60,25,230,133,79,168,104,107,129,178,113,100,218,139,248,235,15,75,112,86,157,53,30,36,14,94,99,88,209,162,37,34,124,59,1,33,120,135,212,0,70,87,159,211,39,82,76,54,2,231,160,196,200,158,234,191,138,210,64,199,56,181,163,247,242,206,249,97,21,161,224,174,93,164,155,52,26,85,173,147,50,48,245,140,177,227,29,246,226,46,130,102,202,96,192,41,35,171,13,83,78,111,213,219,55,69,222,253,142,47,3,255,106,114,109,108,91,81,141,27,175,146,187,221,188,127,17,217,92,65,31,16,90,216,10,193,49,136,165,205,123,189,45,116,208,18,184,229,180,176,137,105,151,74,12,150,119,126,101,185,241,9,197,110,198,132,24,240,125,236,58,220,77,32,121,238,95,62,215,203,57,72],CK=[462357,472066609,943670861,1415275113,1886879365,2358483617,2830087869,3301692121,3773296373,4228057617,404694573,876298825,1347903077,1819507329,2291111581,2762715833,3234320085,3705924337,4177462797,337322537,808926789,1280531041,1752135293,2223739545,2695343797,3166948049,3638552301,4110090761,269950501,741554753,1213159005,1684763257];function hexToArray(n){const e=[];for(let t=0,r=n.length;t<r;t+=2)e.push(parseInt(n.substr(t,2),16));return e}function utf8ToHex(n){const t=new TextEncoder().encode(n);let r="";for(const i of t){const s=i.toString(16).padStart(2,"0");r+=s}return r}function isString(n){return typeof n=="string"}function ArrayToHex(n){return n.map(e=>(e=e.toString(16),e.length===1?"0"+e:e)).join("")}function utf8ToArray(n){const e=[];for(let t=0,r=n.length;t<r;t++){const i=n.codePointAt(t);if(i<=127)e.push(i);else if(i<=2047)e.push(192|i>>>6),e.push(128|i&63);else if(i<=55295||i>=57344&&i<=65535)e.push(224|i>>>12),e.push(128|i>>>6&63),e.push(128|i&63);else if(i>=65536&&i<=1114111)t++,e.push(240|i>>>18&28),e.push(128|i>>>12&63),e.push(128|i>>>6&63),e.push(128|i&63);else throw e.push(i),new Error("input is not supported")}return e}function arrayToUtf8(n){const e=[];for(let t=0,r=n.length;t<r;t++)n[t]>=240&&n[t]<=247?(e.push(String.fromCodePoint(((n[t]&7)<<18)+((n[t+1]&63)<<12)+((n[t+2]&63)<<6)+(n[t+3]&63))),t+=3):n[t]>=224&&n[t]<=239?(e.push(String.fromCodePoint(((n[t]&15)<<12)+((n[t+1]&63)<<6)+(n[t+2]&63))),t+=2):n[t]>=192&&n[t]<=223?(e.push(String.fromCodePoint(((n[t]&31)<<6)+(n[t+1]&63))),t++):e.push(String.fromCodePoint(n[t]));return e.join("")}function rotl(n,e){const t=e&31;return n<<t|n>>>32-t}function byteSub(n){return(Sbox[n>>>24&255]&255)<<24|(Sbox[n>>>16&255]&255)<<16|(Sbox[n>>>8&255]&255)<<8|Sbox[n&255]&255}function l1(n){return n^rotl(n,2)^rotl(n,10)^rotl(n,18)^rotl(n,24)}function l2(n){return n^rotl(n,13)^rotl(n,23)}function sms4Crypt(n,e,t){const r=new Array(4),i=new Array(4);for(let s=0;s<4;s++)i[0]=n[4*s]&255,i[1]=n[4*s+1]&255,i[2]=n[4*s+2]&255,i[3]=n[4*s+3]&255,r[s]=i[0]<<24|i[1]<<16|i[2]<<8|i[3];for(let s=0,o;s<32;s+=4)o=r[1]^r[2]^r[3]^t[s+0],r[0]^=l1(byteSub(o)),o=r[2]^r[3]^r[0]^t[s+1],r[1]^=l1(byteSub(o)),o=r[3]^r[0]^r[1]^t[s+2],r[2]^=l1(byteSub(o)),o=r[0]^r[1]^r[2]^t[s+3],r[3]^=l1(byteSub(o));for(let s=0;s<16;s+=4)e[s]=r[3-s/4]>>>24&255,e[s+1]=r[3-s/4]>>>16&255,e[s+2]=r[3-s/4]>>>8&255,e[s+3]=r[3-s/4]&255}function sms4KeyExt(n,e,t){const r=new Array(4),i=new Array(4);for(let s=0;s<4;s++)i[0]=n[0+4*s]&255,i[1]=n[1+4*s]&255,i[2]=n[2+4*s]&255,i[3]=n[3+4*s]&255,r[s]=i[0]<<24|i[1]<<16|i[2]<<8|i[3];r[0]^=2746333894,r[1]^=1453994832,r[2]^=1736282519,r[3]^=2993693404;for(let s=0,o;s<32;s+=4)o=r[1]^r[2]^r[3]^CK[s+0],e[s+0]=r[0]^=l2(byteSub(o)),o=r[2]^r[3]^r[0]^CK[s+1],e[s+1]=r[1]^=l2(byteSub(o)),o=r[3]^r[0]^r[1]^CK[s+2],e[s+2]=r[2]^=l2(byteSub(o)),o=r[0]^r[1]^r[2]^CK[s+3],e[s+3]=r[3]^=l2(byteSub(o));if(t===DECRYPT)for(let s=0,o;s<16;s++)o=e[s],e[s]=e[31-s],e[31-s]=o}function SM4(n,e,t,{padding:r="pkcs#7",mode:i,iv:s=[],output:o="string",input:a="hex"}={}){if(i==="cbc"&&(isString(s)&&(s=hexToArray(s)),s.length!==128/8))throw new Error("iv is invalid");if(isString(e)&&(e=a==="utf8"?utf8ToHex(e):hexToArray(e)),e.length!==128/8)throw new Error("key is invalid");if(isString(n)?t!==DECRYPT?n=utf8ToArray(n):n=hexToArray(n):n=[...n],(r==="pkcs#5"||r==="pkcs#7")&&t!==DECRYPT){const m=BLOCK-n.length%BLOCK;for(let g=0;g<m;g++)n.push(m)}const l=new Array(ROUND);sms4KeyExt(e,l,t);const c=[];let u=s,d=n.length,f=0;for(;d>=BLOCK;){const m=n.slice(f,f+16),g=new Array(16);if(i==="cbc")for(let v=0;v<BLOCK;v++)t!==DECRYPT&&(m[v]^=u[v]);sms4Crypt(m,g,l);for(let v=0;v<BLOCK;v++)i==="cbc"&&t===DECRYPT&&(g[v]^=u[v]),c[f+v]=g[v];i==="cbc"&&(t!==DECRYPT?u=g:u=m),d-=BLOCK,f+=BLOCK}if((r==="pkcs#5"||r==="pkcs#7")&&t===DECRYPT){const m=c.length,g=c[m-1];for(let v=1;v<=g;v++)if(c[m-v]!==g)throw new Error("padding is invalid");c.splice(m-g,g)}return o!=="array"?t!==DECRYPT?ArrayToHex(c):arrayToUtf8(c):c}const _4={encrypt:(n,e,t={})=>{if(n===""||n===null||n===void 0)return n;try{const r=SM4(n+"",e,1,t);return t.output==="array"?r:r.toString("hex")}catch(r){return console.error("🐛: ~ encrypt ~ error:",n,r),n}},decrypt:(n,e,t={})=>{if(n===""||n===null||n===void 0)return n;try{const r=SM4(n,e,0,t);if(r==="")throw new Error("Decryption failed");if(t.output==="array")return r;{const i=r.toString("utf8");try{return JSON.parse(i)}catch{return i}}}catch(r){return console.error("🐛: ~ decrypt ~ error:",n,r),n}}};function encrypt(n){const{SM4Key:e}=userStore();if(n===""||n===null||n===void 0)return n;try{return e?_4.encrypt(n+"",e):n}catch{return n}}function decrypt(n){const{SM4Key:e}=userStore();if(n===""||n===null||n===void 0)return n;try{return e?_4.decrypt(n,e):n}catch{return n}}const _hoisted_1$3={class:"changeData p-4 bg-base-100"},_hoisted_2$3={class:"res p-4 bg-base-200 rounded-lg shadow-md mt-4"},_hoisted_3$3={class:"flex gap-4 mb-4"},_hoisted_4$3=["data-tip"],_hoisted_5$3={class:"mockup-code bg-base-300 text-base-content"},_hoisted_6$3=["innerHTML"],_hoisted_7$3={id:"my_modal_4",class:"modal"},_hoisted_8$3={class:"modal-box w-11/12 max-w-5xl bg-base-200"},_hoisted_9$3={class:"w-full"},_sfc_main$3={__name:"Devtools",setup(n){const e=ref(""),t=ref("点击复制"),r=ref(""),{SM4Key:i,addKey:s}=userStore(),o=computed({get(){return i},set(u){s(u)}}),a=ref("解密"),l=u=>{const d=document.createElement("textarea");d.setAttribute("readonly","readonly"),d.value=JSON.stringify(u),document.body.appendChild(d),d.select();const f=document.execCommand("copy");return document.body.removeChild(d),t.value="复制成功",f},c=async()=>{if(t.value="点击复制",!!e.value)try{const u=a.value==="解密"?decrypt(e.value.replace(/['""']/g,"")):encrypt(e.value,"");let d=null;u&&(u.includes("}")||u.includes("]"))?d=await codeToHtml(u,{lang:"json5",theme:document.documentElement.getAttribute("data-theme")==="dark"?"one-dark-pro":"min-light"}):d=u,r.value=d}catch{r.value={}}};return(u,d)=>(openBlock(),createElementBlock("div",_hoisted_1$3,[withDirectives(createBaseVNode("textarea",{class:"textarea w-full textarea-bordered bg-base-100 text-base-content",placeholder:"请输入加密内容,支持引号输入",cols:"63",rows:"5","onUpdate:modelValue":d[0]||(d[0]=f=>e.value=f)},"    ",512),[[vModelText,e.value]]),createBaseVNode("div",_hoisted_2$3,[createBaseVNode("div",_hoisted_3$3,[createBaseVNode("button",{onClick:c,class:"btn btn-primary"},"转化数据"),createBaseVNode("div",{class:"tooltip","data-tip":t.value},[createBaseVNode("button",{onClick:d[1]||(d[1]=f=>l(r.value)),class:"btn btn-secondary"},"复制结果")],8,_hoisted_4$3),d[5]||(d[5]=createBaseVNode("button",{onclick:"my_modal_4.showModal()",class:"btn btn-accent"},"配置",-1)),withDirectives(createBaseVNode("select",{"onUpdate:modelValue":d[2]||(d[2]=f=>a.value=f),onChange:c,class:"select select-bordered bg-base-100"},d[4]||(d[4]=[createBaseVNode("option",null,"解密",-1),createBaseVNode("option",null,"加密",-1)]),544),[[vModelSelect,a.value]])]),createBaseVNode("div",_hoisted_5$3,[createBaseVNode("pre",{innerHTML:r.value,class:"whitespace-pre-wrap break-all"},null,8,_hoisted_6$3)])]),createBaseVNode("dialog",_hoisted_7$3,[createBaseVNode("div",_hoisted_8$3,[d[7]||(d[7]=createBaseVNode("h3",{class:"font-bold text-lg text-base-content"},"加密配置",-1)),createBaseVNode("div",_hoisted_9$3,[d[6]||(d[6]=createBaseVNode("label",{class:"label"},[createBaseVNode("span",{class:"label-text"},"密钥key")],-1)),withDirectives(createBaseVNode("input",{type:"text",onChange:c,"onUpdate:modelValue":d[3]||(d[3]=f=>o.value=f),placeholder:"密钥key",class:"input input-bordered w-full bg-base-100"},null,544),[[vModelText,o.value]])]),d[8]||(d[8]=createBaseVNode("div",{class:"modal-action"},[createBaseVNode("form",{method:"dialog"},[createBaseVNode("button",{class:"btn"},"关闭")])],-1))])])]))}},Devtools=_export_sfc(_sfc_main$3,[["__scopeId","data-v-92d3e250"]]);var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs$1(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var jsfuck={};/*! JSFuck 0.4.0 - http://jsfuck.com */(function(n){(function(e){var t="USE_CHAR_CODE",r=32,i=126,s={false:"![]",true:"!![]",undefined:"[][[]]",NaN:"+[![]]",Infinity:"+(+!+[]+(!+[]+[])[!+[]+!+[]+!+[]]+[+!+[]]+[+[]]+[+[]]+[+[]])"},o={Array:"[]",Number:"(+[])",String:"([]+[])",Boolean:"(![])",Function:'[]["filter"]',RegExp:'Function("return/0/")()'},a={a:'(false+"")[1]',b:'(+(11))["toString"](20)',c:'([]["filter"]+"")[3]',d:'(undefined+"")[2]',e:'(true+"")[3]',f:'(false+"")[0]',g:"(+false+[false]+String)[20]",h:'(+(101))["toString"](21)[1]',i:"([false]+undefined)[10]",j:'(+(40))["toString"](21)[1]',k:'(+(20))["toString"](21)',l:'(false+"")[2]',m:'(Number+"")[11]',n:'(undefined+"")[1]',o:'(true+[]["filter"])[10]',p:'(+(211))["toString"](31)[1]',q:'(+(212))["toString"](31)[1]',r:'(true+"")[1]',s:'(false+"")[3]',t:'(true+"")[0]',u:'(undefined+"")[0]',v:'(+(31))["toString"](32)',w:'(+(32))["toString"](33)',x:'(+(101))["toString"](34)[1]',y:"(NaN+[Infinity])[10]",z:'(+(35))["toString"](36)',A:"(+false+Array)[10]",B:"(+false+Boolean)[10]",C:'Function("return escape")()("<")[2]',D:'Function("return escape")()("=")[2]',E:'(RegExp+"")[12]',F:"(+false+Function)[10]",G:'(false+Function("return Date")()())[30]',H:t,I:'(Infinity+"")[0]',K:t,L:t,M:'(true+Function("return Date")()())[30]',N:'(NaN+"")[0]',P:t,Q:t,R:"(+false+RegExp)[10]",S:"(+false+String)[10]",T:'(NaN+Function("return Date")()())[30]',U:t,V:t,W:t,X:t,Y:t,Z:t," ":'(NaN+[]["filter"])[11]',"!":t,'"':'("")["fontcolor"]()[12]',"#":t,$:t,"%":'Function("return escape")()("<")[0]',"&":t,"'":t,"(":'(false+[]["filter"])[20]',")":'(true+[]["filter"])[20]',"*":t,"+":"(+(+!+[]+(!+[]+[])[!+[]+!+[]+!+[]]+[+!+[]]+[+[]]+[+[]])+[])[2]",",":'[[]]["concat"]([[]])+""',"-":'(+(.+[0000000001])+"")[2]',".":"(+(+!+[]+[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+[!+[]+!+[]]+[+[]])+[])[+!+[]]","/":'(false+[+false])["italics"]()[10]',":":'(RegExp()+"")[3]',";":t,"<":'("")["italics"]()[0]',"=":'("")["fontcolor"]()[11]',">":'("")["italics"]()[2]',"?":'(RegExp()+"")[2]',"@":t,"[":'(GLOBAL+"")[0]',"\\":t,"]":t,"^":t,_:t,"`":t,"{":'(NaN+[]["filter"])[21]',"|":t,"}":t,"~":t},l='Function("return this")()';function c(){for(var g in a)a[g]===t&&(a[g]='Function("return unescape")()("%"'+g.charCodeAt(0).toString(16).replace(/(\d+)/g,'+($1)+"')+'")')}function u(){var g,v,x;for(v=0;v<10;v++){for(g="+[]",v>0&&(g="+!"+g),x=1;x<v;x++)g="+!+[]"+g;v>1&&(g=g.substr(1)),a[v]="["+g+"]"}}function d(){var g="",v,x,S;function C(I,F){v=v.replace(new RegExp(I,"gi"),F)}function R(I,F){return a[F]}function k(I,F){var N=F.split(""),U=+N.shift(),M="+[]";for(U>0&&(M="+!"+M),x=1;x<U;x++)M="+!+[]"+M;return U>1&&(M=M.substr(1)),[M].concat(N).join("+").replace(/(\d)/g,R)}for(x=r;x<=i;x++)if(g=String.fromCharCode(x),v=a[g],!!v){for(S in o)C("\\b"+S,o[S]+'["constructor"]');for(S in s)C(S,s[S]);C("(\\d\\d+)",k),C("\\((\\d)\\)",R),C("\\[(\\d)\\]",R),C("GLOBAL",l),C('\\+""',"+[]"),C('""',"[]+[]"),a[g]=v}}function f(){var g=/[^\[\]\(\)\!\+]{1}/g,v,x,S,C=i-r;function R(){var F,N,U=!1;S={};for(F in a)N=a[F],N.match(g)&&(S[F]=N,U=!0);return U}function k(F,N){return N.split("").join("+")}function I(F){return S[F]?F:a[F]}for(v in a)a[v]=a[v].replace(/\"([^\"]+)\"/gi,k);for(;R();){for(v in S)x=a[v],x=x.replace(g,I),a[v]=x,S[v]=x;C--===0&&console.error("Could not compile the following chars:",S)}}function m(g,v){var x=[];if(!g)return"";var S="";for(var C in s)S+=C+"|";return S+=".",g.replace(new RegExp(S,"g"),function(R){var k=s[R];k?x.push("["+k+"]+[]"):(k=a[R],k?x.push(k):R==="J"?(k="([]["+m("filter")+"]["+m("constructor")+"]("+m("return new Date(200000000)")+")()+[])[!+[]+!+[]+!+[]+!+[]]",x.push(k),a[R]=k):R==="O"?(k="([]["+m("filter")+"]["+m("constructor")+"]("+m("return new Date(24000000000)")+")()+[])[!+[]+!+[]+!+[]+!+[]]",x.push(k),a[R]=k):(k="([]+[])["+m("constructor")+"]["+m("fromCharCode")+"]("+m(R.charCodeAt(0)+"")+")",x.push(k),a[R]=k))}),x=x.join("+"),/^\d$/.test(g)&&(x+="+[]"),v&&(x="[]["+m("filter")+"]["+m("constructor")+"]("+x+")()"),x}u(),c(),d(),f(),e.JSFuck={encode:m}})(n)})(jsfuck);const _hoisted_1$2={class:"min-h-screen bg-base-100 text-base-content p-4 font-sans"},_hoisted_2$2={class:"max-w-4xl mx-auto bg-base-200 rounded-lg shadow-md overflow-hidden"},_hoisted_3$2={class:"p-6"},_hoisted_4$2={class:"mb-4"},_hoisted_5$2={class:"bg-base-200 border border-base-300 rounded-lg p-4"},_hoisted_6$2={key:1,class:"relative"},_hoisted_7$2={class:"mt-4 flex flex-col space-y-2"},_hoisted_8$2={class:"flex items-center"},_hoisted_9$2={class:"flex items-center"},_sfc_main$2={__name:"Jsfuck",setup(__props){const activeTab=ref("input"),inputCode=ref("alert(1);"),outputCode=ref(""),canEval=ref(!1),parentScope=ref(!1),copyToClipboard=()=>{if(outputCode.value.length===0){alert("没有内容可复制。");return}navigator.clipboard.writeText(outputCode.value).then(()=>{alert("内容已复制到剪贴板！")}).catch(n=>{console.error("复制失败:",n),alert("复制失败，请手动复制。")})},cleanCode=()=>{inputCode.value="",activeTab.value="input"},encodeJSFuck=()=>{if(inputCode.value.trim().length===0){alert("请先输入代码。");return}console.log(jsfuck.JSFuck),outputCode.value=jsfuck.JSFuck.encode(inputCode.value,canEval.value,parentScope.value),activeTab.value="output"};function runJs(){let value=eval(outputCode.value);return canEval.value||alert('"'+value+'"'),!1}const saveEncodedResult=()=>{if(outputCode.value.length===0){alert("没有内容可保存。");return}const n=new Blob([outputCode.value],{type:"text/plain"}),e=URL.createObjectURL(n),t=document.createElement("a");t.href=e,t.download=`jsfuck_encoded_${Date.now()}.js`,document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(e)};return(n,e)=>(openBlock(),createElementBlock("div",_hoisted_1$2,[createBaseVNode("div",_hoisted_2$2,[createBaseVNode("div",_hoisted_3$2,[e[8]||(e[8]=createStaticVNode('<h1 class="text-3xl font-bold text-center text-primary mb-4" data-v-fc96f071>JSFuck</h1><h2 class="text-xl text-center text-base-content/70 mb-6" data-v-fc96f071>JS加密</h2><div class="text-sm text-center mb-4 text-base-content/80" data-v-fc96f071> 前后端开发者常用工具 </div><div class="text-center mb-6" data-v-fc96f071><p class="text-sm font-semibold text-base-content" data-v-fc96f071> JSFuck是一种怪异的JS代码加密方法，可将代码全都转换成&quot;[]!()+&quot;形式的字符。<br data-v-fc96f071> 严格的说，JSFuck加密更像是一种编码。 </p></div><div class="text-xs opacity-80 mb-6 text-base-content/70" data-v-fc96f071><p data-v-fc96f071> 可加密前端Web浏览器、后端Node.JS等环境下的标准JS代码。<br data-v-fc96f071> JSFuck会使代码体积极度膨胀，因此只适宜少量代码加密，建议代码量不超过<span class="text-base font-medium" data-v-fc96f071>512字节</span>。<br data-v-fc96f071> 优点：加密结果非常怪异，完全不像JS代码，令人望而生畏。<br data-v-fc96f071> 缺点：对执行性能有很大影响、加密代码容易被还原。<br data-v-fc96f071></p><p class="mt-2" data-v-fc96f071>注意：代码尽可能是规范JS语法，例如：一行变量定义以&quot;；&quot;号结尾，而非直接回车结束。</p><p class="mt-2" data-v-fc96f071> TIP：少量JS代码或敏感信息（如密钥等）用JSFuk加密效果不错，<br data-v-fc96f071>较多代码建议使用专业JS混淆加密工具等。 </p></div>',5)),createBaseVNode("div",_hoisted_4$2,[createBaseVNode("button",{onClick:e[0]||(e[0]=t=>activeTab.value="input"),class:normalizeClass(["px-4 py-2 rounded-t-lg transition-colors",activeTab.value==="input"?"bg-primary text-primary-content":"bg-base-300 text-base-content hover:bg-base-300/80"])}," JS源代码 ",2),createBaseVNode("button",{onClick:e[1]||(e[1]=t=>activeTab.value="output"),class:normalizeClass(["px-4 py-2 rounded-t-lg transition-colors",activeTab.value==="output"?"bg-primary text-primary-content":"bg-base-300 text-base-content hover:bg-base-300/80"])}," JSFuck JS加密结果 ",2)]),createBaseVNode("div",_hoisted_5$2,[activeTab.value==="input"?withDirectives((openBlock(),createElementBlock("textarea",{key:0,"onUpdate:modelValue":e[2]||(e[2]=t=>inputCode.value=t),placeholder:"请输入要加密的JS代码...",class:"w-full h-40 textarea textarea-bordered bg-base-100 text-base-content focus:border-primary"},"          ",512)),[[vModelText,inputCode.value]]):(openBlock(),createElementBlock("div",_hoisted_6$2,[withDirectives(createBaseVNode("textarea",{"onUpdate:modelValue":e[3]||(e[3]=t=>outputCode.value=t),placeholder:"JSFuck加密结果将显示在这里...",class:"w-full h-40 textarea textarea-bordered bg-base-300 text-base-content resize-none focus:outline-none",readonly:""},"            ",512),[[vModelText,outputCode.value]]),createBaseVNode("button",{onClick:copyToClipboard,class:"absolute right-2 top-2 btn btn-primary btn-sm"}," 复制结果 "),createBaseVNode("button",{onClick:runJs,class:"absolute right-2 top-12 btn btn-warning btn-sm"}," 运行代码 ")]))]),createBaseVNode("div",_hoisted_7$2,[createBaseVNode("div",_hoisted_8$2,[withDirectives(createBaseVNode("input",{id:"eval","onUpdate:modelValue":e[4]||(e[4]=t=>canEval.value=t),type:"checkbox",class:"checkbox checkbox-primary mr-2"},null,512),[[vModelCheckbox,canEval.value]]),e[6]||(e[6]=createBaseVNode("label",{for:"eval",class:"text-sm text-base-content"},"可执行代码（如不启用，加密结果是编码后的字符串，而非可执行的代码。）",-1))]),createBaseVNode("div",_hoisted_9$2,[withDirectives(createBaseVNode("input",{id:"scope","onUpdate:modelValue":e[5]||(e[5]=t=>parentScope.value=t),type:"checkbox",class:"checkbox checkbox-primary mr-2"},null,512),[[vModelCheckbox,parentScope.value]]),e[7]||(e[7]=createBaseVNode("label",{for:"scope",class:"text-sm text-base-content"},' 在父作用域中运行(例如"var a=1;"，不启用此选项时，变量a定义在"加密代码"局部作用域中，外部调用时会显示a是undefined，启用后变量a可以被"加密代码"外的其它代码访问。) ',-1))])]),createBaseVNode("div",{class:"mt-6 flex justify-center space-x-4"},[createBaseVNode("button",{onClick:cleanCode,class:"btn btn-error"}," 清空JS源代码 "),createBaseVNode("button",{onClick:encodeJSFuck,class:"btn btn-primary"}," JSFuck加密 "),createBaseVNode("button",{onClick:saveEncodedResult,class:"btn btn-success"}," 保存JS加密结果 ")]),e[9]||(e[9]=createStaticVNode('<h2 class="text-center my-4 text-base-content" data-v-fc96f071>Basics</h2><ul class="pre text-base-content/80" data-v-fc96f071><li data-v-fc96f071>false =&gt; ![]</li><li data-v-fc96f071>true =&gt; !![]</li><li data-v-fc96f071>undefined =&gt; [][[]]</li><li data-v-fc96f071>NaN =&gt; +[![]]</li><li data-v-fc96f071>0 =&gt; +[]</li><li data-v-fc96f071>1 =&gt; +!+[]</li><li data-v-fc96f071>2 =&gt; !+[]+!+[]</li><li data-v-fc96f071>10 =&gt; [+!+[]]+[+[]]</li><li data-v-fc96f071>Array =&gt; []</li><li data-v-fc96f071>Number =&gt; +[]</li><li data-v-fc96f071>String =&gt; []+[]</li><li data-v-fc96f071>Boolean =&gt; ![]</li><li data-v-fc96f071>Function =&gt; [][&quot;filter&quot;]</li><li data-v-fc96f071>eval =&gt; [][&quot;filter&quot;][&quot;constructor&quot;]( CODE )()</li><li data-v-fc96f071>window =&gt; [][&quot;filter&quot;][&quot;constructor&quot;](&quot;return this&quot;)()</li></ul>',2))])])]))}},Jsfuck=_export_sfc(_sfc_main$2,[["__scopeId","data-v-fc96f071"]]),_imports_0=""+new URL("bg-QUFETq7A.webp",import.meta.url).href;var DPlayer_min={exports:{}};(function(n,e){(function(t,r){n.exports=r()})(self,()=>(()=>{var t={916:(o,a,l)=>{var c=l(471);o.exports=function(u){var d,f="",m=(u=u||{}).video,g=u.options,v=c.$escape,x=u.tran,S=u.icons,C=u.index,R=c.$each;return u.$value,u.$index,f+=`<div class="dplayer-mask"></div>
<div class="dplayer-video-wrap">
    `,d=l(568)(m),f+=d,f+=`
    `,g.logo&&(f+=`
    <div class="dplayer-logo">
        <img src="`,f+=v(g.logo),f+=`">
    </div>
    `),f+=`
    <div class="dplayer-danmaku"`,g.danmaku&&g.danmaku.bottom&&(f+=' style="margin-bottom:',f+=v(g.danmaku.bottom),f+='"'),f+=`>
        <div class="dplayer-danmaku-item dplayer-danmaku-item--demo"></div>
    </div>
    <div class="dplayer-subtitle"></div>
    <div class="dplayer-bezel">
        <span class="dplayer-bezel-icon"></span>
        `,g.danmaku&&(f+=`
        <span class="dplayer-danloading">`,f+=v(x("danmaku-loading")),f+=`</span>
        `),f+=`
        <span class="diplayer-loading-icon">`,f+=S.loading,f+=`</span>
    </div>
</div>
<div class="dplayer-controller-mask"></div>
<div class="dplayer-controller">
    <div class="dplayer-icons dplayer-comment-box">
        <button class="dplayer-icon dplayer-comment-setting-icon" data-balloon="`,f+=v(x("setting")),f+=`" data-balloon-pos="up">
            <span class="dplayer-icon-content">`,f+=S.pallette,f+=`</span>
        </button>
        <div class="dplayer-comment-setting-box">
            <div class="dplayer-comment-setting-color">
                <div class="dplayer-comment-setting-title">`,f+=v(x("set-danmaku-color")),f+=`</div>
                <label>
                    <input type="radio" name="dplayer-danmaku-color-`,f+=v(C),f+=`" value="#fff" checked>
                    <span style="background: #fff;"></span>
                </label>
                <label>
                    <input type="radio" name="dplayer-danmaku-color-`,f+=v(C),f+=`" value="#e54256">
                    <span style="background: #e54256"></span>
                </label>
                <label>
                    <input type="radio" name="dplayer-danmaku-color-`,f+=v(C),f+=`" value="#ffe133">
                    <span style="background: #ffe133"></span>
                </label>
                <label>
                    <input type="radio" name="dplayer-danmaku-color-`,f+=v(C),f+=`" value="#64DD17">
                    <span style="background: #64DD17"></span>
                </label>
                <label>
                    <input type="radio" name="dplayer-danmaku-color-`,f+=v(C),f+=`" value="#39ccff">
                    <span style="background: #39ccff"></span>
                </label>
                <label>
                    <input type="radio" name="dplayer-danmaku-color-`,f+=v(C),f+=`" value="#D500F9">
                    <span style="background: #D500F9"></span>
                </label>
            </div>
            <div class="dplayer-comment-setting-type">
                <div class="dplayer-comment-setting-title">`,f+=v(x("set-danmaku-type")),f+=`</div>
                <label>
                    <input type="radio" name="dplayer-danmaku-type-`,f+=v(C),f+=`" value="1">
                    <span>`,f+=v(x("top")),f+=`</span>
                </label>
                <label>
                    <input type="radio" name="dplayer-danmaku-type-`,f+=v(C),f+=`" value="0" checked>
                    <span>`,f+=v(x("rolling")),f+=`</span>
                </label>
                <label>
                    <input type="radio" name="dplayer-danmaku-type-`,f+=v(C),f+=`" value="2">
                    <span>`,f+=v(x("bottom")),f+=`</span>
                </label>
            </div>
        </div>
        <input class="dplayer-comment-input" type="text" placeholder="`,f+=v(x("input-danmaku-enter")),f+=`" maxlength="30">
        <button class="dplayer-icon dplayer-send-icon" data-balloon="`,f+=v(x("send")),f+=`" data-balloon-pos="up">
            <span class="dplayer-icon-content">`,f+=S.send,f+=`</span>
        </button>
    </div>
    <div class="dplayer-icons dplayer-icons-left">
        <button class="dplayer-icon dplayer-play-icon">
            <span class="dplayer-icon-content">`,f+=S.play,f+=`</span>
        </button>
        <div class="dplayer-volume">
            <button class="dplayer-icon dplayer-volume-icon">
                <span class="dplayer-icon-content">`,f+=S.volumeDown,f+=`</span>
            </button>
            <div class="dplayer-volume-bar-wrap" data-balloon-pos="up">
                <div class="dplayer-volume-bar">
                    <div class="dplayer-volume-bar-inner" style="background: `,f+=v(g.theme),f+=`;">
                        <span class="dplayer-thumb" style="background: `,f+=v(g.theme),f+=`"></span>
                    </div>
                </div>
            </div>
        </div>
        <span class="dplayer-time">
            <span class="dplayer-ptime">0:00</span> /
            <span class="dplayer-dtime">0:00</span>
        </span>
        `,g.live&&(f+=`
        <span class="dplayer-live-badge"><span class="dplayer-live-dot" style="background: `,f+=v(g.theme),f+=';"></span>',f+=v(x("live")),f+=`</span>
        `),f+=`
    </div>
    <div class="dplayer-icons dplayer-icons-right">
        `,g.video.quality&&(f+=`
        <div class="dplayer-quality">
            <button class="dplayer-icon dplayer-quality-icon">`,f+=v(g.video.quality[g.video.defaultQuality].name),f+=`</button>
            <div class="dplayer-quality-mask">
                <div class="dplayer-quality-list">
                `,R(g.video.quality,function(k,I){f+=`
                    <div class="dplayer-quality-item" data-index="`,f+=v(I),f+='">',f+=v(k.name),f+=`</div>
                `}),f+=`
                </div>
            </div>
        </div>
        `),f+=`
        `,g.screenshot&&(f+=`
        <div class="dplayer-icon dplayer-camera-icon" data-balloon="`,f+=v(x("screenshot")),f+=`" data-balloon-pos="up">
            <span class="dplayer-icon-content">`,f+=S.camera,f+=`</span>
        </div>
        `),f+=`
        `,g.airplay&&(f+=`
        <div class="dplayer-icon dplayer-airplay-icon" data-balloon="`,f+=v(x("airplay")),f+=`" data-balloon-pos="up">
            <span class="dplayer-icon-content">`,f+=S.airplay,f+=`</span>
        </div>
        `),f+=`
        `,g.chromecast&&(f+=`
        <div class="dplayer-icon dplayer-chromecast-icon" data-balloon="`,f+=v(x("chromecast")),f+=`" data-balloon-pos="up">
            <span class="dplayer-icon-content">`,f+=S.chromecast,f+=`</span>
        </div>
        `),f+=`
        <div class="dplayer-comment">
            <button class="dplayer-icon dplayer-comment-icon" data-balloon="`,f+=v(x("send-danmaku")),f+=`" data-balloon-pos="up">
                <span class="dplayer-icon-content">`,f+=S.comment,f+=`</span>
            </button>
        </div>
        `,g.subtitle&&(f+=`
        `,typeof g.subtitle.url=="string"?(f+=`
        <div class="dplayer-subtitle-btn">
            <button class="dplayer-icon dplayer-subtitle-icon" data-balloon="`,f+=v(x("hide-subs")),f+=`" data-balloon-pos="up">
                <span class="dplayer-icon-content">`,f+=S.subtitle,f+=`</span>
            </button>
        </div>
        `):(f+=`
        <div class="dplayer-subtitles">
            <button class="dplayer-icon dplayer-subtitles-icon" data-balloon="`,f+=v(x("subtitle")),f+=`" data-balloon-pos="up">
                <span class="dplayer-icon-content">`,f+=S.subtitle,f+=`</span>
            </button>
            <div class="dplayer-subtitles-box">
                <div class="dplayer-subtitles-panel">
                    `,R(g.subtitle.url,function(k,I){f+=`
                        <div class="dplayer-subtitles-item" data-subtitle="`,f+=v(k.url),f+=`">
                            <!-- if lang, show tran(lang). if lang and name, show name + (tran(lang)). if name, show name. off option use lang for translation. -->
                            <span class="dplayer-label">`,f+=v(k.lang?k.name?k.name+" ("+x(k.lang)+")":x(k.lang):k.name),f+=`</span>
                        </div>
                    `}),f+=`
                </div>
            </div>
        </div>
        `),f+=`
        `),f+=`
        <div class="dplayer-setting">
            <button class="dplayer-icon dplayer-setting-icon" data-balloon="`,f+=v(x("setting")),f+=`" data-balloon-pos="up">
                <span class="dplayer-icon-content">`,f+=S.setting,f+=`</span>
            </button>
            <div class="dplayer-setting-box">
                <div class="dplayer-setting-origin-panel">
                    <div class="dplayer-setting-item dplayer-setting-speed">
                        <span class="dplayer-label">`,f+=v(x("speed")),f+=`</span>
                        <div class="dplayer-toggle">`,f+=S.right,f+=`</div>
                    </div>
                    <div class="dplayer-setting-item dplayer-setting-loop">
                        <span class="dplayer-label">`,f+=v(x("loop")),f+=`</span>
                        <div class="dplayer-toggle">
                            <input class="dplayer-toggle-setting-input" type="checkbox" name="dplayer-toggle">
                            <label for="dplayer-toggle"></label>
                        </div>
                    </div>
                    <div class="dplayer-setting-item dplayer-setting-showdan">
                        <span class="dplayer-label">`,f+=v(x("show-danmaku")),f+=`</span>
                        <div class="dplayer-toggle">
                            <input class="dplayer-showdan-setting-input" type="checkbox" name="dplayer-toggle-dan">
                            <label for="dplayer-toggle-dan"></label>
                        </div>
                    </div>
                    <div class="dplayer-setting-item dplayer-setting-danunlimit">
                        <span class="dplayer-label">`,f+=v(x("unlimited-danmaku")),f+=`</span>
                        <div class="dplayer-toggle">
                            <input class="dplayer-danunlimit-setting-input" type="checkbox" name="dplayer-toggle-danunlimit">
                            <label for="dplayer-toggle-danunlimit"></label>
                        </div>
                    </div>
                    <div class="dplayer-setting-item dplayer-setting-danmaku">
                        <span class="dplayer-label">`,f+=v(x("opacity-danmaku")),f+=`</span>
                        <div class="dplayer-danmaku-bar-wrap">
                            <div class="dplayer-danmaku-bar">
                                <div class="dplayer-danmaku-bar-inner">
                                    <span class="dplayer-thumb"></span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="dplayer-setting-speed-panel">
                    `,R(g.playbackSpeed,function(k,I){f+=`
                        <div class="dplayer-setting-speed-item" data-speed="`,f+=v(k),f+=`">
                            <span class="dplayer-label">`,f+=v(k===1?x("normal"):k),f+=`</span>
                        </div>
                    `}),f+=`
                </div>
            </div>
        </div>
        <div class="dplayer-full">
            <button class="dplayer-icon dplayer-full-in-icon" data-balloon="`,f+=v(x("web-fullscreen")),f+=`" data-balloon-pos="up">
                <span class="dplayer-icon-content">`,f+=S.fullWeb,f+=`</span>
            </button>
            <button class="dplayer-icon dplayer-full-icon" data-balloon="`,f+=v(x("fullscreen")),f+=`" data-balloon-pos="up">
                <span class="dplayer-icon-content">`,f+=S.full,f+=`</span>
            </button>
        </div>
    </div>
    <div class="dplayer-bar-wrap">
        <div class="dplayer-bar-time hidden">00:00</div>
        <div class="dplayer-bar-preview"></div>
        <div class="dplayer-bar">
            <div class="dplayer-loaded" style="width: 0;"></div>
            <div class="dplayer-played" style="width: 0; background: `,f+=v(g.theme),f+=`">
                <span class="dplayer-thumb" style="background: `,f+=v(g.theme),f+=`"></span>
            </div>
        </div>
    </div>
</div>
<div class="dplayer-info-panel dplayer-info-panel-hide">
    <div class="dplayer-info-panel-close">[x]</div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-version">
        <span class="dplayer-info-panel-item-title">Player version</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-fps">
        <span class="dplayer-info-panel-item-title">Player FPS</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-type">
        <span class="dplayer-info-panel-item-title">Video type</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-url">
        <span class="dplayer-info-panel-item-title">Video url</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-resolution">
        <span class="dplayer-info-panel-item-title">Video resolution</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-duration">
        <span class="dplayer-info-panel-item-title">Video duration</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    `,g.danmaku&&(f+=`
    <div class="dplayer-info-panel-item dplayer-info-panel-item-danmaku-id">
        <span class="dplayer-info-panel-item-title">Danmaku id</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-danmaku-api">
        <span class="dplayer-info-panel-item-title">Danmaku api</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    <div class="dplayer-info-panel-item dplayer-info-panel-item-danmaku-amount">
        <span class="dplayer-info-panel-item-title">Danmaku amount</span>
        <span class="dplayer-info-panel-item-data"></span>
    </div>
    `),f+=`
</div>
<div class="dplayer-menu">
    `,R(g.contextmenu,function(k,I){f+=`
        <div class="dplayer-menu-item">
            <a`,k.link&&(f+=' target="_blank"'),f+=' href="',f+=v(k.link||"javascript:void(0);"),f+='">',k.key&&(f+=" ",f+=v(x(k.key))),k.text&&(f+=" ",f+=v(k.text)),f+=`</a>
        </div>
    `}),f+=`
</div>
<div class="dplayer-notice-list"></div>
<button class="dplayer-mobile-play">
    `,f+=S.play,f+=`
</button>`}},568:(o,a,l)=>{var c=l(471);o.exports=function(u){var d="",f=(u=u||{}).enableSubtitle,m=u.subtitle,g=u.current,v=u.airplay,x=u.pic,S=c.$escape,C=u.screenshot,R=u.preload,k=u.url;return f=m&&m.type==="webvtt",d+=`
<video
    class="dplayer-video `,g&&(d+="dplayer-video-current"),d+=`"
    webkit-playsinline
    `,v&&(d+=' x-webkit-airplay="allow" '),d+=`
    playsinline
    `,x&&(d+='poster="',d+=S(x),d+='"'),d+=`
    `,(C||f)&&(d+='crossorigin="anonymous"'),d+=`
    `,R&&(d+='preload="',d+=S(R),d+='"'),d+=`
    `,v?d+=`
    nosrc
    `:k&&(d+=`
    src="`,d+=S(k),d+=`"
    `),d+=`
    >
    `,v&&(d+=`
    <source src="`,d+=S(k),d+=`">
    `),d+=`
    `,f&&(d+=`
    <track class="dplayer-subtrack" kind="metadata" default src="`,d+=S(typeof m.url=="string"?m.url:m.url[m.index].url),d+=`"></track>
    `),d+`
</video>`}},49:(o,a,l)=>{l.d(a,{Z:()=>m});var c=l(415),u=l.n(c),d=l(352),f=l.n(d)()(u());f.push([o.id,`:root {
  --balloon-border-radius: 2px;
  --balloon-color: rgba(16, 16, 16, 0.95);
  --balloon-text-color: #fff;
  --balloon-font-size: 12px;
  --balloon-move: 4px; }

button[aria-label][data-balloon-pos] {
  overflow: visible; }

[aria-label][data-balloon-pos] {
  position: relative;
  cursor: pointer; }
  [aria-label][data-balloon-pos]:after {
    opacity: 0;
    pointer-events: none;
    transition: all 0.18s ease-out 0.18s;
    text-indent: 0;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
    font-weight: normal;
    font-style: normal;
    text-shadow: none;
    font-size: 12px;
    font-size: var(--balloon-font-size);
    background: rgba(16, 16, 16, 0.95);
    background: var(--balloon-color);
    border-radius: 2px;
    color: #fff;
    color: var(--balloon-text-color);
    border-radius: var(--balloon-border-radius);
    content: attr(aria-label);
    padding: .5em 1em;
    position: absolute;
    white-space: nowrap;
    z-index: 10; }
  [aria-label][data-balloon-pos]:before {
    width: 0;
    height: 0;
    border: 5px solid transparent;
    border-top-color: rgba(16, 16, 16, 0.95);
    border-top-color: var(--balloon-color);
    opacity: 0;
    pointer-events: none;
    transition: all 0.18s ease-out 0.18s;
    content: "";
    position: absolute;
    z-index: 10; }
  [aria-label][data-balloon-pos]:hover:before, [aria-label][data-balloon-pos]:hover:after, [aria-label][data-balloon-pos][data-balloon-visible]:before, [aria-label][data-balloon-pos][data-balloon-visible]:after, [aria-label][data-balloon-pos]:not([data-balloon-nofocus]):focus:before, [aria-label][data-balloon-pos]:not([data-balloon-nofocus]):focus:after {
    opacity: 1;
    pointer-events: none; }
  [aria-label][data-balloon-pos].font-awesome:after {
    font-family: FontAwesome, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif; }
  [aria-label][data-balloon-pos][data-balloon-break]:after {
    white-space: pre; }
  [aria-label][data-balloon-pos][data-balloon-break][data-balloon-length]:after {
    white-space: pre-line;
    word-break: break-word; }
  [aria-label][data-balloon-pos][data-balloon-blunt]:before, [aria-label][data-balloon-pos][data-balloon-blunt]:after {
    transition: none; }
  [aria-label][data-balloon-pos][data-balloon-pos="up"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos="up"][data-balloon-visible]:after, [aria-label][data-balloon-pos][data-balloon-pos="down"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos="down"][data-balloon-visible]:after {
    transform: translate(-50%, 0); }
  [aria-label][data-balloon-pos][data-balloon-pos="up"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos="up"][data-balloon-visible]:before, [aria-label][data-balloon-pos][data-balloon-pos="down"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos="down"][data-balloon-visible]:before {
    transform: translate(-50%, 0); }
  [aria-label][data-balloon-pos][data-balloon-pos*="-left"]:after {
    left: 0; }
  [aria-label][data-balloon-pos][data-balloon-pos*="-left"]:before {
    left: 5px; }
  [aria-label][data-balloon-pos][data-balloon-pos*="-right"]:after {
    right: 0; }
  [aria-label][data-balloon-pos][data-balloon-pos*="-right"]:before {
    right: 5px; }
  [aria-label][data-balloon-pos][data-balloon-po*="-left"]:hover:after, [aria-label][data-balloon-pos][data-balloon-po*="-left"][data-balloon-visible]:after, [aria-label][data-balloon-pos][data-balloon-pos*="-right"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos*="-right"][data-balloon-visible]:after {
    transform: translate(0, 0); }
  [aria-label][data-balloon-pos][data-balloon-po*="-left"]:hover:before, [aria-label][data-balloon-pos][data-balloon-po*="-left"][data-balloon-visible]:before, [aria-label][data-balloon-pos][data-balloon-pos*="-right"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos*="-right"][data-balloon-visible]:before {
    transform: translate(0, 0); }
  [aria-label][data-balloon-pos][data-balloon-pos^="up"]:before, [aria-label][data-balloon-pos][data-balloon-pos^="up"]:after {
    bottom: 100%;
    transform-origin: top;
    transform: translate(0, 4px);
    transform: translate(0, var(--balloon-move)); }
  [aria-label][data-balloon-pos][data-balloon-pos^="up"]:after {
    margin-bottom: 10px; }
  [aria-label][data-balloon-pos][data-balloon-pos="up"]:before, [aria-label][data-balloon-pos][data-balloon-pos="up"]:after {
    left: 50%;
    transform: translate(-50%, 4px);
    transform: translate(-50%, var(--balloon-move)); }
  [aria-label][data-balloon-pos][data-balloon-pos^="down"]:before, [aria-label][data-balloon-pos][data-balloon-pos^="down"]:after {
    top: 100%;
    transform: translate(0, calc(4px * -1));
    transform: translate(0, calc(var(--balloon-move) * -1)); }
  [aria-label][data-balloon-pos][data-balloon-pos^="down"]:after {
    margin-top: 10px; }
  [aria-label][data-balloon-pos][data-balloon-pos^="down"]:before {
    width: 0;
    height: 0;
    border: 5px solid transparent;
    border-bottom-color: rgba(16, 16, 16, 0.95);
    border-bottom-color: var(--balloon-color); }
  [aria-label][data-balloon-pos][data-balloon-pos="down"]:after, [aria-label][data-balloon-pos][data-balloon-pos="down"]:before {
    left: 50%;
    transform: translate(-50%, calc(4px * -1));
    transform: translate(-50%, calc(var(--balloon-move) * -1)); }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos="left"][data-balloon-visible]:after, [aria-label][data-balloon-pos][data-balloon-pos="right"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos="right"][data-balloon-visible]:after {
    transform: translate(0, -50%); }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos="left"][data-balloon-visible]:before, [aria-label][data-balloon-pos][data-balloon-pos="right"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos="right"][data-balloon-visible]:before {
    transform: translate(0, -50%); }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:after, [aria-label][data-balloon-pos][data-balloon-pos="left"]:before {
    right: 100%;
    top: 50%;
    transform: translate(4px, -50%);
    transform: translate(var(--balloon-move), -50%); }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:after {
    margin-right: 10px; }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:before {
    width: 0;
    height: 0;
    border: 5px solid transparent;
    border-left-color: rgba(16, 16, 16, 0.95);
    border-left-color: var(--balloon-color); }
  [aria-label][data-balloon-pos][data-balloon-pos="right"]:after, [aria-label][data-balloon-pos][data-balloon-pos="right"]:before {
    left: 100%;
    top: 50%;
    transform: translate(calc(4px * -1), -50%);
    transform: translate(calc(var(--balloon-move) * -1), -50%); }
  [aria-label][data-balloon-pos][data-balloon-pos="right"]:after {
    margin-left: 10px; }
  [aria-label][data-balloon-pos][data-balloon-pos="right"]:before {
    width: 0;
    height: 0;
    border: 5px solid transparent;
    border-right-color: rgba(16, 16, 16, 0.95);
    border-right-color: var(--balloon-color); }
  [aria-label][data-balloon-pos][data-balloon-length]:after {
    white-space: normal; }
  [aria-label][data-balloon-pos][data-balloon-length="small"]:after {
    width: 80px; }
  [aria-label][data-balloon-pos][data-balloon-length="medium"]:after {
    width: 150px; }
  [aria-label][data-balloon-pos][data-balloon-length="large"]:after {
    width: 260px; }
  [aria-label][data-balloon-pos][data-balloon-length="xlarge"]:after {
    width: 380px; }
    @media screen and (max-width: 768px) {
      [aria-label][data-balloon-pos][data-balloon-length="xlarge"]:after {
        width: 90vw; } }
  [aria-label][data-balloon-pos][data-balloon-length="fit"]:after {
    width: 100%; }
`,"",{version:3,sources:["webpack://./node_modules/.pnpm/balloon-css@1.2.0/node_modules/balloon-css/balloon.css"],names:[],mappings:"AAAA;EACE,4BAA4B;EAC5B,uCAAuC;EACvC,0BAA0B;EAC1B,yBAAyB;EACzB,mBAAmB,EAAE;;AAEvB;EACE,iBAAiB,EAAE;;AAErB;EACE,kBAAkB;EAClB,eAAe,EAAE;EACjB;IACE,UAAU;IACV,oBAAoB;IACpB,oCAAoC;IACpC,cAAc;IACd,wIAAwI;IACxI,mBAAmB;IACnB,kBAAkB;IAClB,iBAAiB;IACjB,eAAmC;IAAnC,mCAAmC;IACnC,kCAAgC;IAAhC,gCAAgC;IAChC,kBAAkB;IAClB,WAAgC;IAAhC,gCAAgC;IAChC,2CAA2C;IAC3C,yBAAyB;IACzB,iBAAiB;IACjB,kBAAkB;IAClB,mBAAmB;IACnB,WAAW,EAAE;EACf;IACE,QAAQ;IACR,SAAS;IACT,6BAA6B;IAC7B,wCAAsC;IAAtC,sCAAsC;IACtC,UAAU;IACV,oBAAoB;IACpB,oCAAoC;IACpC,WAAW;IACX,kBAAkB;IAClB,WAAW,EAAE;EACf;IACE,UAAU;IACV,oBAAoB,EAAE;EACxB;IACE,qJAAqJ,EAAE;EACzJ;IACE,gBAAgB,EAAE;EACpB;IACE,qBAAqB;IACrB,sBAAsB,EAAE;EAC1B;IACE,gBAAgB,EAAE;EACpB;IACE,6BAA6B,EAAE;EACjC;IACE,6BAA6B,EAAE;EACjC;IACE,OAAO,EAAE;EACX;IACE,SAAS,EAAE;EACb;IACE,QAAQ,EAAE;EACZ;IACE,UAAU,EAAE;EACd;IACE,0BAA0B,EAAE;EAC9B;IACE,0BAA0B,EAAE;EAC9B;IACE,YAAY;IACZ,qBAAqB;IACrB,4BAA4C;IAA5C,4CAA4C,EAAE;EAChD;IACE,mBAAmB,EAAE;EACvB;IACE,SAAS;IACT,+BAA+C;IAA/C,+CAA+C,EAAE;EACnD;IACE,SAAS;IACT,uCAAuD;IAAvD,uDAAuD,EAAE;EAC3D;IACE,gBAAgB,EAAE;EACpB;IACE,QAAQ;IACR,SAAS;IACT,6BAA6B;IAC7B,2CAAyC;IAAzC,yCAAyC,EAAE;EAC7C;IACE,SAAS;IACT,0CAA0D;IAA1D,0DAA0D,EAAE;EAC9D;IACE,6BAA6B,EAAE;EACjC;IACE,6BAA6B,EAAE;EACjC;IACE,WAAW;IACX,QAAQ;IACR,+BAA+C;IAA/C,+CAA+C,EAAE;EACnD;IACE,kBAAkB,EAAE;EACtB;IACE,QAAQ;IACR,SAAS;IACT,6BAA6B;IAC7B,yCAAuC;IAAvC,uCAAuC,EAAE;EAC3C;IACE,UAAU;IACV,QAAQ;IACR,0CAA0D;IAA1D,0DAA0D,EAAE;EAC9D;IACE,iBAAiB,EAAE;EACrB;IACE,QAAQ;IACR,SAAS;IACT,6BAA6B;IAC7B,0CAAwC;IAAxC,wCAAwC,EAAE;EAC5C;IACE,mBAAmB,EAAE;EACvB;IACE,WAAW,EAAE;EACf;IACE,YAAY,EAAE;EAChB;IACE,YAAY,EAAE;EAChB;IACE,YAAY,EAAE;IACd;MACE;QACE,WAAW,EAAE,EAAE;EACrB;IACE,WAAW,EAAE",sourcesContent:[`:root {
  --balloon-border-radius: 2px;
  --balloon-color: rgba(16, 16, 16, 0.95);
  --balloon-text-color: #fff;
  --balloon-font-size: 12px;
  --balloon-move: 4px; }

button[aria-label][data-balloon-pos] {
  overflow: visible; }

[aria-label][data-balloon-pos] {
  position: relative;
  cursor: pointer; }
  [aria-label][data-balloon-pos]:after {
    opacity: 0;
    pointer-events: none;
    transition: all 0.18s ease-out 0.18s;
    text-indent: 0;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
    font-weight: normal;
    font-style: normal;
    text-shadow: none;
    font-size: var(--balloon-font-size);
    background: var(--balloon-color);
    border-radius: 2px;
    color: var(--balloon-text-color);
    border-radius: var(--balloon-border-radius);
    content: attr(aria-label);
    padding: .5em 1em;
    position: absolute;
    white-space: nowrap;
    z-index: 10; }
  [aria-label][data-balloon-pos]:before {
    width: 0;
    height: 0;
    border: 5px solid transparent;
    border-top-color: var(--balloon-color);
    opacity: 0;
    pointer-events: none;
    transition: all 0.18s ease-out 0.18s;
    content: "";
    position: absolute;
    z-index: 10; }
  [aria-label][data-balloon-pos]:hover:before, [aria-label][data-balloon-pos]:hover:after, [aria-label][data-balloon-pos][data-balloon-visible]:before, [aria-label][data-balloon-pos][data-balloon-visible]:after, [aria-label][data-balloon-pos]:not([data-balloon-nofocus]):focus:before, [aria-label][data-balloon-pos]:not([data-balloon-nofocus]):focus:after {
    opacity: 1;
    pointer-events: none; }
  [aria-label][data-balloon-pos].font-awesome:after {
    font-family: FontAwesome, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif; }
  [aria-label][data-balloon-pos][data-balloon-break]:after {
    white-space: pre; }
  [aria-label][data-balloon-pos][data-balloon-break][data-balloon-length]:after {
    white-space: pre-line;
    word-break: break-word; }
  [aria-label][data-balloon-pos][data-balloon-blunt]:before, [aria-label][data-balloon-pos][data-balloon-blunt]:after {
    transition: none; }
  [aria-label][data-balloon-pos][data-balloon-pos="up"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos="up"][data-balloon-visible]:after, [aria-label][data-balloon-pos][data-balloon-pos="down"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos="down"][data-balloon-visible]:after {
    transform: translate(-50%, 0); }
  [aria-label][data-balloon-pos][data-balloon-pos="up"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos="up"][data-balloon-visible]:before, [aria-label][data-balloon-pos][data-balloon-pos="down"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos="down"][data-balloon-visible]:before {
    transform: translate(-50%, 0); }
  [aria-label][data-balloon-pos][data-balloon-pos*="-left"]:after {
    left: 0; }
  [aria-label][data-balloon-pos][data-balloon-pos*="-left"]:before {
    left: 5px; }
  [aria-label][data-balloon-pos][data-balloon-pos*="-right"]:after {
    right: 0; }
  [aria-label][data-balloon-pos][data-balloon-pos*="-right"]:before {
    right: 5px; }
  [aria-label][data-balloon-pos][data-balloon-po*="-left"]:hover:after, [aria-label][data-balloon-pos][data-balloon-po*="-left"][data-balloon-visible]:after, [aria-label][data-balloon-pos][data-balloon-pos*="-right"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos*="-right"][data-balloon-visible]:after {
    transform: translate(0, 0); }
  [aria-label][data-balloon-pos][data-balloon-po*="-left"]:hover:before, [aria-label][data-balloon-pos][data-balloon-po*="-left"][data-balloon-visible]:before, [aria-label][data-balloon-pos][data-balloon-pos*="-right"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos*="-right"][data-balloon-visible]:before {
    transform: translate(0, 0); }
  [aria-label][data-balloon-pos][data-balloon-pos^="up"]:before, [aria-label][data-balloon-pos][data-balloon-pos^="up"]:after {
    bottom: 100%;
    transform-origin: top;
    transform: translate(0, var(--balloon-move)); }
  [aria-label][data-balloon-pos][data-balloon-pos^="up"]:after {
    margin-bottom: 10px; }
  [aria-label][data-balloon-pos][data-balloon-pos="up"]:before, [aria-label][data-balloon-pos][data-balloon-pos="up"]:after {
    left: 50%;
    transform: translate(-50%, var(--balloon-move)); }
  [aria-label][data-balloon-pos][data-balloon-pos^="down"]:before, [aria-label][data-balloon-pos][data-balloon-pos^="down"]:after {
    top: 100%;
    transform: translate(0, calc(var(--balloon-move) * -1)); }
  [aria-label][data-balloon-pos][data-balloon-pos^="down"]:after {
    margin-top: 10px; }
  [aria-label][data-balloon-pos][data-balloon-pos^="down"]:before {
    width: 0;
    height: 0;
    border: 5px solid transparent;
    border-bottom-color: var(--balloon-color); }
  [aria-label][data-balloon-pos][data-balloon-pos="down"]:after, [aria-label][data-balloon-pos][data-balloon-pos="down"]:before {
    left: 50%;
    transform: translate(-50%, calc(var(--balloon-move) * -1)); }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos="left"][data-balloon-visible]:after, [aria-label][data-balloon-pos][data-balloon-pos="right"]:hover:after, [aria-label][data-balloon-pos][data-balloon-pos="right"][data-balloon-visible]:after {
    transform: translate(0, -50%); }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos="left"][data-balloon-visible]:before, [aria-label][data-balloon-pos][data-balloon-pos="right"]:hover:before, [aria-label][data-balloon-pos][data-balloon-pos="right"][data-balloon-visible]:before {
    transform: translate(0, -50%); }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:after, [aria-label][data-balloon-pos][data-balloon-pos="left"]:before {
    right: 100%;
    top: 50%;
    transform: translate(var(--balloon-move), -50%); }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:after {
    margin-right: 10px; }
  [aria-label][data-balloon-pos][data-balloon-pos="left"]:before {
    width: 0;
    height: 0;
    border: 5px solid transparent;
    border-left-color: var(--balloon-color); }
  [aria-label][data-balloon-pos][data-balloon-pos="right"]:after, [aria-label][data-balloon-pos][data-balloon-pos="right"]:before {
    left: 100%;
    top: 50%;
    transform: translate(calc(var(--balloon-move) * -1), -50%); }
  [aria-label][data-balloon-pos][data-balloon-pos="right"]:after {
    margin-left: 10px; }
  [aria-label][data-balloon-pos][data-balloon-pos="right"]:before {
    width: 0;
    height: 0;
    border: 5px solid transparent;
    border-right-color: var(--balloon-color); }
  [aria-label][data-balloon-pos][data-balloon-length]:after {
    white-space: normal; }
  [aria-label][data-balloon-pos][data-balloon-length="small"]:after {
    width: 80px; }
  [aria-label][data-balloon-pos][data-balloon-length="medium"]:after {
    width: 150px; }
  [aria-label][data-balloon-pos][data-balloon-length="large"]:after {
    width: 260px; }
  [aria-label][data-balloon-pos][data-balloon-length="xlarge"]:after {
    width: 380px; }
    @media screen and (max-width: 768px) {
      [aria-label][data-balloon-pos][data-balloon-length="xlarge"]:after {
        width: 90vw; } }
  [aria-label][data-balloon-pos][data-balloon-length="fit"]:after {
    width: 100%; }
`],sourceRoot:""}]);const m=f},685:(o,a,l)=>{l.d(a,{Z:()=>R});var c=l(415),u=l.n(c),d=l(352),f=l.n(d),m=l(49),g=l(80),v=l.n(g),x=new URL(l(831),l.b),S=f()(u());S.i(m.Z);var C=v()(x);S.push([o.id,`@keyframes my-face {
  2% {
    transform: translate(0, 1.5px) rotate(1.5deg);
  }
  4% {
    transform: translate(0, -1.5px) rotate(-0.5deg);
  }
  6% {
    transform: translate(0, 1.5px) rotate(-1.5deg);
  }
  8% {
    transform: translate(0, -1.5px) rotate(-1.5deg);
  }
  10% {
    transform: translate(0, 2.5px) rotate(1.5deg);
  }
  12% {
    transform: translate(0, -0.5px) rotate(1.5deg);
  }
  14% {
    transform: translate(0, -1.5px) rotate(1.5deg);
  }
  16% {
    transform: translate(0, -0.5px) rotate(-1.5deg);
  }
  18% {
    transform: translate(0, 0.5px) rotate(-1.5deg);
  }
  20% {
    transform: translate(0, -1.5px) rotate(2.5deg);
  }
  22% {
    transform: translate(0, 0.5px) rotate(-1.5deg);
  }
  24% {
    transform: translate(0, 1.5px) rotate(1.5deg);
  }
  26% {
    transform: translate(0, 0.5px) rotate(0.5deg);
  }
  28% {
    transform: translate(0, 0.5px) rotate(1.5deg);
  }
  30% {
    transform: translate(0, -0.5px) rotate(2.5deg);
  }
  32% {
    transform: translate(0, 1.5px) rotate(-0.5deg);
  }
  34% {
    transform: translate(0, 1.5px) rotate(-0.5deg);
  }
  36% {
    transform: translate(0, -1.5px) rotate(2.5deg);
  }
  38% {
    transform: translate(0, 1.5px) rotate(-1.5deg);
  }
  40% {
    transform: translate(0, -0.5px) rotate(2.5deg);
  }
  42% {
    transform: translate(0, 2.5px) rotate(-1.5deg);
  }
  44% {
    transform: translate(0, 1.5px) rotate(0.5deg);
  }
  46% {
    transform: translate(0, -1.5px) rotate(2.5deg);
  }
  48% {
    transform: translate(0, -0.5px) rotate(0.5deg);
  }
  50% {
    transform: translate(0, 0.5px) rotate(0.5deg);
  }
  52% {
    transform: translate(0, 2.5px) rotate(2.5deg);
  }
  54% {
    transform: translate(0, -1.5px) rotate(1.5deg);
  }
  56% {
    transform: translate(0, 2.5px) rotate(2.5deg);
  }
  58% {
    transform: translate(0, 0.5px) rotate(2.5deg);
  }
  60% {
    transform: translate(0, 2.5px) rotate(2.5deg);
  }
  62% {
    transform: translate(0, -0.5px) rotate(2.5deg);
  }
  64% {
    transform: translate(0, -0.5px) rotate(1.5deg);
  }
  66% {
    transform: translate(0, 1.5px) rotate(-0.5deg);
  }
  68% {
    transform: translate(0, -1.5px) rotate(-0.5deg);
  }
  70% {
    transform: translate(0, 1.5px) rotate(0.5deg);
  }
  72% {
    transform: translate(0, 2.5px) rotate(1.5deg);
  }
  74% {
    transform: translate(0, -0.5px) rotate(0.5deg);
  }
  76% {
    transform: translate(0, -0.5px) rotate(2.5deg);
  }
  78% {
    transform: translate(0, -0.5px) rotate(1.5deg);
  }
  80% {
    transform: translate(0, 1.5px) rotate(1.5deg);
  }
  82% {
    transform: translate(0, -0.5px) rotate(0.5deg);
  }
  84% {
    transform: translate(0, 1.5px) rotate(2.5deg);
  }
  86% {
    transform: translate(0, -1.5px) rotate(-1.5deg);
  }
  88% {
    transform: translate(0, -0.5px) rotate(2.5deg);
  }
  90% {
    transform: translate(0, 2.5px) rotate(-0.5deg);
  }
  92% {
    transform: translate(0, 0.5px) rotate(-0.5deg);
  }
  94% {
    transform: translate(0, 2.5px) rotate(0.5deg);
  }
  96% {
    transform: translate(0, -0.5px) rotate(1.5deg);
  }
  98% {
    transform: translate(0, -1.5px) rotate(-0.5deg);
  }
  0%,
  100% {
    transform: translate(0, 0) rotate(0deg);
  }
}
.dplayer {
  position: relative;
  overflow: hidden;
  -webkit-user-select: none;
     -moz-user-select: none;
          user-select: none;
  line-height: 1;
}
.dplayer * {
  box-sizing: content-box;
}
.dplayer svg {
  width: 100%;
  height: 100%;
}
.dplayer svg path,
.dplayer svg circle {
  fill: #fff;
}
.dplayer:-webkit-full-screen {
  width: 100%;
  height: 100%;
  background: #000;
  position: fixed;
  z-index: 100000;
  left: 0;
  top: 0;
  margin: 0;
  padding: 0;
  transform: translate(0, 0);
}
.dplayer.dplayer-no-danmaku .dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box .dplayer-setting-showdan,
.dplayer.dplayer-no-danmaku .dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box .dplayer-setting-danmaku,
.dplayer.dplayer-no-danmaku .dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box .dplayer-setting-danunlimit {
  display: none;
}
.dplayer.dplayer-no-danmaku .dplayer-controller .dplayer-icons .dplayer-comment {
  display: none;
}
.dplayer.dplayer-no-danmaku .dplayer-danmaku {
  display: none;
}
.dplayer.dplayer-live .dplayer-time {
  display: none;
}
.dplayer.dplayer-live .dplayer-bar-wrap {
  display: none;
}
.dplayer.dplayer-live .dplayer-setting-speed {
  display: none;
}
.dplayer.dplayer-live .dplayer-setting-loop {
  display: none;
}
.dplayer.dplayer-live.dplayer-no-danmaku .dplayer-setting {
  display: none;
}
.dplayer.dplayer-arrow .dplayer-danmaku {
  font-size: 18px;
}
.dplayer.dplayer-arrow .dplayer-icon {
  margin: 0 -3px;
}
.dplayer.dplayer-playing .dplayer-danmaku .dplayer-danmaku-move {
  animation-play-state: running;
}
@media (min-width: 900px) {
  .dplayer.dplayer-playing .dplayer-controller-mask {
    opacity: 0;
  }
  .dplayer.dplayer-playing .dplayer-controller {
    opacity: 0;
  }
  .dplayer.dplayer-playing:hover .dplayer-controller-mask {
    opacity: 1;
  }
  .dplayer.dplayer-playing:hover .dplayer-controller {
    opacity: 1;
  }
}
.dplayer.dplayer-loading .dplayer-bezel .diplayer-loading-icon {
  display: block;
}
.dplayer.dplayer-loading .dplayer-danmaku,
.dplayer.dplayer-paused .dplayer-danmaku,
.dplayer.dplayer-loading .dplayer-danmaku-move,
.dplayer.dplayer-paused .dplayer-danmaku-move {
  animation-play-state: paused;
}
.dplayer.dplayer-hide-controller {
  cursor: none;
}
.dplayer.dplayer-hide-controller .dplayer-controller-mask {
  opacity: 0;
  transform: translateY(100%);
}
.dplayer.dplayer-hide-controller .dplayer-controller {
  opacity: 0;
  transform: translateY(100%);
}
.dplayer.dplayer-show-controller .dplayer-controller-mask {
  opacity: 1;
}
.dplayer.dplayer-show-controller .dplayer-controller {
  opacity: 1;
}
.dplayer.dplayer-fulled {
  width: 100% !important;
  height: 100% !important;
}
.dplayer.dplayer-fulled {
  position: fixed;
  z-index: 100000;
  left: 0;
  top: 0;
}
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-volume,
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-camera-icon,
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-airplay-icon,
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-chromecast-icon,
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-play-icon {
  display: none;
}
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-full .dplayer-full-in-icon {
  position: static;
  display: inline-block;
}
.dplayer.dplayer-mobile .dplayer-bar-time {
  display: none;
}
.dplayer.dplayer-mobile.dplayer-hide-controller .dplayer-mobile-play {
  display: none;
}
.dplayer.dplayer-mobile .dplayer-mobile-play {
  display: block;
}
.dplayer-web-fullscreen-fix {
  position: fixed;
  top: 0;
  left: 0;
  margin: 0;
  padding: 0;
}
[data-balloon]:before {
  display: none;
}
[data-balloon]:after {
  padding: 0.3em 0.7em;
  background: rgba(17, 17, 17, 0.7);
}
[data-balloon][data-balloon-pos="up"]:after {
  margin-bottom: 0;
}
.dplayer-bezel {
  position: absolute;
  left: 0;
  right: 0;
  top: 0;
  bottom: 0;
  font-size: 22px;
  color: #fff;
  pointer-events: none;
}
.dplayer-bezel .dplayer-bezel-icon {
  position: absolute;
  top: 50%;
  left: 50%;
  margin: -26px 0 0 -26px;
  height: 52px;
  width: 52px;
  padding: 12px;
  box-sizing: border-box;
  background: rgba(0, 0, 0, 0.5);
  border-radius: 50%;
  opacity: 0;
  pointer-events: none;
}
.dplayer-bezel .dplayer-bezel-icon.dplayer-bezel-transition {
  animation: bezel-hide 0.5s linear;
}
@keyframes bezel-hide {
  from {
    opacity: 1;
    transform: scale(1);
  }
  to {
    opacity: 0;
    transform: scale(2);
  }
}
.dplayer-bezel .dplayer-danloading {
  position: absolute;
  top: 50%;
  margin-top: -7px;
  width: 100%;
  text-align: center;
  font-size: 14px;
  line-height: 14px;
  animation: my-face 5s infinite ease-in-out;
}
.dplayer-bezel .diplayer-loading-icon {
  display: none;
  position: absolute;
  top: 50%;
  left: 50%;
  margin: -18px 0 0 -18px;
  height: 36px;
  width: 36px;
  pointer-events: none;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-hide {
  display: none;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot {
  animation: diplayer-loading-dot-fade 0.8s ease infinite;
  opacity: 0;
  transform-origin: 4px 4px;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-1 {
  animation-delay: 0.1s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-2 {
  animation-delay: 0.2s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-3 {
  animation-delay: 0.3s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-4 {
  animation-delay: 0.4s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-5 {
  animation-delay: 0.5s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-6 {
  animation-delay: 0.6s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-7 {
  animation-delay: 0.7s;
}
@keyframes diplayer-loading-dot-fade {
  0% {
    opacity: 0.7;
    transform: scale(1.2, 1.2);
  }
  50% {
    opacity: 0.25;
    transform: scale(0.9, 0.9);
  }
  to {
    opacity: 0.25;
    transform: scale(0.85, 0.85);
  }
}
.dplayer-controller-mask {
  background: url(`+C+`) repeat-x bottom;
  height: 98px;
  width: 100%;
  position: absolute;
  bottom: 0;
  transition: all 0.3s ease;
}
.dplayer-controller {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 41px;
  padding: 0 20px;
  -webkit-user-select: none;
     -moz-user-select: none;
          user-select: none;
  transition: all 0.3s ease;
}
.dplayer-controller.dplayer-controller-comment .dplayer-icons {
  display: none;
}
.dplayer-controller.dplayer-controller-comment .dplayer-icons.dplayer-comment-box {
  display: block;
}
.dplayer-controller .dplayer-bar-wrap {
  padding: 5px 0;
  cursor: pointer;
  position: absolute;
  bottom: 33px;
  width: calc(100% - 40px);
  height: 3px;
}
.dplayer-controller .dplayer-bar-wrap:hover .dplayer-bar .dplayer-played .dplayer-thumb {
  transform: scale(1);
}
.dplayer-controller .dplayer-bar-wrap:hover .dplayer-highlight {
  display: block;
  width: 8px;
  transform: translateX(-4px);
  top: 4px;
  height: 40%;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-highlight {
  z-index: 12;
  position: absolute;
  top: 5px;
  width: 6px;
  height: 20%;
  border-radius: 6px;
  background-color: #fff;
  text-align: center;
  transform: translateX(-3px);
  transition: all 0.2s ease-in-out;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-highlight:hover .dplayer-highlight-text {
  display: block;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-highlight:hover ~ .dplayer-bar-preview {
  opacity: 0;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-highlight:hover ~ .dplayer-bar-time {
  opacity: 0;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-highlight .dplayer-highlight-text {
  display: none;
  position: absolute;
  left: 50%;
  top: -24px;
  padding: 5px 8px;
  background-color: rgba(0, 0, 0, 0.62);
  color: #fff;
  border-radius: 4px;
  font-size: 12px;
  white-space: nowrap;
  transform: translateX(-50%);
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar-preview {
  position: absolute;
  background: #fff;
  pointer-events: none;
  display: none;
  background-size: 16000px 100%;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar-preview-canvas {
  position: absolute;
  width: 100%;
  height: 100%;
  z-index: 1;
  pointer-events: none;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar-time {
  position: absolute;
  left: 0px;
  top: -20px;
  border-radius: 4px;
  padding: 5px 7px;
  background-color: rgba(0, 0, 0, 0.62);
  color: #fff;
  font-size: 12px;
  text-align: center;
  opacity: 1;
  transition: opacity 0.1s ease-in-out;
  word-wrap: normal;
  word-break: normal;
  z-index: 2;
  pointer-events: none;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar-time.hidden {
  opacity: 0;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar {
  position: relative;
  height: 3px;
  width: 100%;
  background: rgba(255, 255, 255, 0.2);
  cursor: pointer;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar .dplayer-loaded {
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  background: rgba(255, 255, 255, 0.4);
  height: 3px;
  transition: all 0.5s ease;
  will-change: width;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar .dplayer-played {
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  height: 3px;
  will-change: width;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar .dplayer-played .dplayer-thumb {
  position: absolute;
  top: 0;
  right: 5px;
  margin-top: -4px;
  margin-right: -10px;
  height: 11px;
  width: 11px;
  border-radius: 50%;
  cursor: pointer;
  transition: all 0.3s ease-in-out;
  transform: scale(0);
}
.dplayer-controller .dplayer-icons {
  height: 38px;
  position: absolute;
  bottom: 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box {
  display: none;
  position: absolute;
  transition: all 0.3s ease-in-out;
  z-index: 2;
  height: 38px;
  bottom: 0;
  left: 20px;
  right: 20px;
  color: #fff;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-icon {
  padding: 7px;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-icon {
  position: absolute;
  left: 0;
  top: 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-send-icon {
  position: absolute;
  right: 0;
  top: 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box {
  position: absolute;
  background: rgba(28, 28, 28, 0.9);
  bottom: 41px;
  left: 0;
  box-shadow: 0 0 25px rgba(0, 0, 0, 0.3);
  border-radius: 4px;
  padding: 10px 10px 16px;
  font-size: 14px;
  width: 204px;
  transition: all 0.3s ease-in-out;
  transform: scale(0);
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box.dplayer-comment-setting-open {
  transform: scale(1);
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box input[type=radio] {
  display: none;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box label {
  cursor: pointer;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-title {
  font-size: 13px;
  color: #fff;
  line-height: 30px;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type {
  font-size: 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type .dplayer-comment-setting-title {
  margin-bottom: 6px;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type label:nth-child(2) span {
  border-radius: 4px 0 0 4px;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type label:nth-child(4) span {
  border-radius: 0 4px 4px 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type span {
  width: 33%;
  padding: 4px 6px;
  line-height: 16px;
  display: inline-block;
  font-size: 12px;
  color: #fff;
  border: 1px solid #fff;
  margin-right: -1px;
  box-sizing: border-box;
  text-align: center;
  cursor: pointer;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type input:checked + span {
  background: #E4E4E6;
  color: #1c1c1c;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-color {
  font-size: 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-color label {
  font-size: 0;
  padding: 6px;
  display: inline-block;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-color span {
  width: 22px;
  height: 22px;
  display: inline-block;
  border-radius: 50%;
  box-sizing: border-box;
  cursor: pointer;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-color span:hover {
  animation: my-face 5s infinite ease-in-out;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-input {
  outline: none;
  border: none;
  padding: 8px 31px;
  font-size: 14px;
  line-height: 18px;
  text-align: center;
  border-radius: 4px;
  background: none;
  margin: 0;
  height: 100%;
  box-sizing: border-box;
  width: 100%;
  color: #fff;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-input::-moz-placeholder {
  color: #fff;
  opacity: 0.8;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-input::placeholder {
  color: #fff;
  opacity: 0.8;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-input::-ms-clear {
  display: none;
}
.dplayer-controller .dplayer-icons.dplayer-icons-left .dplayer-icon {
  padding: 7px;
}
.dplayer-controller .dplayer-icons.dplayer-icons-right {
  right: 20px;
}
.dplayer-controller .dplayer-icons.dplayer-icons-right .dplayer-icon {
  padding: 8px;
}
.dplayer-controller .dplayer-icons .dplayer-time,
.dplayer-controller .dplayer-icons .dplayer-live-badge {
  line-height: 38px;
  color: #eee;
  text-shadow: 0 0 2px rgba(0, 0, 0, 0.5);
  vertical-align: middle;
  font-size: 13px;
  cursor: default;
}
.dplayer-controller .dplayer-icons .dplayer-live-dot {
  display: inline-block;
  width: 6px;
  height: 6px;
  vertical-align: 4%;
  margin-right: 5px;
  content: '';
  border-radius: 6px;
}
.dplayer-controller .dplayer-icons .dplayer-icon {
  width: 40px;
  height: 100%;
  border: none;
  background-color: transparent;
  outline: none;
  cursor: pointer;
  vertical-align: middle;
  box-sizing: border-box;
  display: inline-block;
}
.dplayer-controller .dplayer-icons .dplayer-icon .dplayer-icon-content {
  transition: all 0.2s ease-in-out;
  opacity: 0.8;
}
.dplayer-controller .dplayer-icons .dplayer-icon:hover .dplayer-icon-content {
  opacity: 1;
}
.dplayer-controller .dplayer-icons .dplayer-icon.dplayer-quality-icon {
  color: #fff;
  width: auto;
  line-height: 22px;
  font-size: 14px;
}
.dplayer-controller .dplayer-icons .dplayer-icon.dplayer-comment-icon {
  padding: 10px 9px 9px;
}
.dplayer-controller .dplayer-icons .dplayer-icon.dplayer-setting-icon {
  padding-top: 8.5px;
}
.dplayer-controller .dplayer-icons .dplayer-icon.dplayer-volume-icon {
  width: 43px;
}
.dplayer-controller .dplayer-icons .dplayer-volume {
  position: relative;
  display: inline-block;
  cursor: pointer;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-volume:hover .dplayer-volume-bar-wrap .dplayer-volume-bar {
  width: 45px;
}
.dplayer-controller .dplayer-icons .dplayer-volume:hover .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner .dplayer-thumb {
  transform: scale(1);
}
.dplayer-controller .dplayer-icons .dplayer-volume.dplayer-volume-active .dplayer-volume-bar-wrap .dplayer-volume-bar {
  width: 45px;
}
.dplayer-controller .dplayer-icons .dplayer-volume.dplayer-volume-active .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner .dplayer-thumb {
  transform: scale(1);
}
.dplayer-controller .dplayer-icons .dplayer-volume .dplayer-volume-bar-wrap {
  display: inline-block;
  margin: 0 10px 0 -5px;
  vertical-align: middle;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-volume .dplayer-volume-bar-wrap .dplayer-volume-bar {
  position: relative;
  top: 17px;
  width: 0;
  height: 3px;
  background: #aaa;
  transition: all 0.3s ease-in-out;
}
.dplayer-controller .dplayer-icons .dplayer-volume .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner {
  position: absolute;
  bottom: 0;
  left: 0;
  height: 100%;
  transition: all 0.1s ease;
  will-change: width;
}
.dplayer-controller .dplayer-icons .dplayer-volume .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner .dplayer-thumb {
  position: absolute;
  top: 0;
  right: 5px;
  margin-top: -4px;
  margin-right: -10px;
  height: 11px;
  width: 11px;
  border-radius: 50%;
  cursor: pointer;
  transition: all 0.3s ease-in-out;
  transform: scale(0);
}
.dplayer-controller .dplayer-icons .dplayer-subtitle-btn {
  display: inline-block;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-subtitles {
  display: inline-block;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-subtitles .dplayer-subtitles-box {
  position: absolute;
  right: 0;
  bottom: 50px;
  transform: scale(0);
  width: -moz-fit-content;
  width: fit-content;
  max-width: 240px;
  min-width: 120px;
  border-radius: 2px;
  background: rgba(28, 28, 28, 0.9);
  padding: 7px 0;
  transition: all 0.3s ease-in-out;
  overflow: auto;
  z-index: 2;
}
.dplayer-controller .dplayer-icons .dplayer-subtitles .dplayer-subtitles-box.dplayer-subtitles-panel {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-subtitles .dplayer-subtitles-box.dplayer-subtitles-box-open {
  transform: scale(1);
}
.dplayer-controller .dplayer-icons .dplayer-subtitles .dplayer-subtitles-item {
  height: 30px;
  padding: 5px 10px;
  box-sizing: border-box;
  cursor: pointer;
  position: relative;
}
.dplayer-controller .dplayer-icons .dplayer-subtitles .dplayer-subtitles-item:hover {
  background-color: rgba(255, 255, 255, 0.1);
}
.dplayer-controller .dplayer-icons .dplayer-setting {
  display: inline-block;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box {
  position: absolute;
  right: 0;
  bottom: 50px;
  transform: scale(0);
  width: 150px;
  border-radius: 2px;
  background: rgba(28, 28, 28, 0.9);
  padding: 7px 0;
  transition: all 0.3s ease-in-out;
  overflow: hidden;
  z-index: 2;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box > div {
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box > div.dplayer-setting-origin-panel {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box.dplayer-setting-box-open {
  transform: scale(1);
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box.dplayer-setting-box-narrow {
  width: 70px;
  text-align: center;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box.dplayer-setting-box-speed .dplayer-setting-origin-panel {
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box.dplayer-setting-box-speed .dplayer-setting-speed-panel {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-item,
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-speed-item {
  height: 30px;
  padding: 5px 10px;
  box-sizing: border-box;
  cursor: pointer;
  position: relative;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-item:hover,
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-speed-item:hover {
  background-color: rgba(255, 255, 255, 0.1);
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku {
  padding: 5px 0;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-label {
  padding: 0 10px;
  display: inline;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku:hover .dplayer-label {
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku:hover .dplayer-danmaku-bar-wrap {
  display: inline-block;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku.dplayer-setting-danmaku-active .dplayer-label {
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku.dplayer-setting-danmaku-active .dplayer-danmaku-bar-wrap {
  display: inline-block;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-danmaku-bar-wrap {
  padding: 0 10px;
  box-sizing: border-box;
  display: none;
  vertical-align: middle;
  height: 100%;
  width: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-danmaku-bar-wrap .dplayer-danmaku-bar {
  position: relative;
  top: 8.5px;
  width: 100%;
  height: 3px;
  background: #fff;
  transition: all 0.3s ease-in-out;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-danmaku-bar-wrap .dplayer-danmaku-bar .dplayer-danmaku-bar-inner {
  position: absolute;
  bottom: 0;
  left: 0;
  height: 100%;
  transition: all 0.1s ease;
  background: #aaa;
  will-change: width;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-danmaku-bar-wrap .dplayer-danmaku-bar .dplayer-danmaku-bar-inner .dplayer-thumb {
  position: absolute;
  top: 0;
  right: 5px;
  margin-top: -4px;
  margin-right: -10px;
  height: 11px;
  width: 11px;
  border-radius: 50%;
  cursor: pointer;
  transition: all 0.3s ease-in-out;
  background: #aaa;
}
.dplayer-controller .dplayer-icons .dplayer-full {
  display: inline-block;
  height: 100%;
  position: relative;
}
.dplayer-controller .dplayer-icons .dplayer-full:hover .dplayer-full-in-icon {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-full .dplayer-full-in-icon {
  position: absolute;
  top: -30px;
  z-index: 1;
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-quality {
  position: relative;
  display: inline-block;
  height: 100%;
  z-index: 2;
}
.dplayer-controller .dplayer-icons .dplayer-quality:hover .dplayer-quality-list {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-quality:hover .dplayer-quality-mask {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-quality .dplayer-quality-mask {
  display: none;
  position: absolute;
  bottom: 38px;
  left: -18px;
  width: 80px;
  padding-bottom: 12px;
}
.dplayer-controller .dplayer-icons .dplayer-quality .dplayer-quality-list {
  display: none;
  font-size: 12px;
  width: 80px;
  border-radius: 2px;
  background: rgba(28, 28, 28, 0.9);
  padding: 5px 0;
  transition: all 0.3s ease-in-out;
  overflow: hidden;
  color: #fff;
  text-align: center;
}
.dplayer-controller .dplayer-icons .dplayer-quality .dplayer-quality-item {
  height: 25px;
  box-sizing: border-box;
  cursor: pointer;
  line-height: 25px;
}
.dplayer-controller .dplayer-icons .dplayer-quality .dplayer-quality-item:hover {
  background-color: rgba(255, 255, 255, 0.1);
}
.dplayer-controller .dplayer-icons .dplayer-comment {
  display: inline-block;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-label {
  color: #eee;
  font-size: 13px;
  display: inline-block;
  vertical-align: middle;
  white-space: nowrap;
}
.dplayer-controller .dplayer-icons .dplayer-toggle {
  width: 32px;
  height: 20px;
  text-align: center;
  font-size: 0;
  vertical-align: middle;
  position: absolute;
  top: 5px;
  right: 10px;
}
.dplayer-controller .dplayer-icons .dplayer-toggle input {
  max-height: 0;
  max-width: 0;
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-toggle input + label {
  display: inline-block;
  position: relative;
  box-shadow: #dfdfdf 0 0 0 0 inset;
  border: 1px solid #dfdfdf;
  height: 20px;
  width: 32px;
  border-radius: 10px;
  box-sizing: border-box;
  cursor: pointer;
  transition: 0.2s ease-in-out;
}
.dplayer-controller .dplayer-icons .dplayer-toggle input + label:before {
  content: "";
  position: absolute;
  display: block;
  height: 18px;
  width: 18px;
  top: 0;
  left: 0;
  border-radius: 15px;
  transition: 0.2s ease-in-out;
}
.dplayer-controller .dplayer-icons .dplayer-toggle input + label:after {
  content: "";
  position: absolute;
  display: block;
  left: 0;
  top: 0;
  border-radius: 15px;
  background: #fff;
  transition: 0.2s ease-in-out;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
  height: 18px;
  width: 18px;
}
.dplayer-controller .dplayer-icons .dplayer-toggle input:checked + label {
  border-color: rgba(255, 255, 255, 0.5);
}
.dplayer-controller .dplayer-icons .dplayer-toggle input:checked + label:before {
  width: 30px;
  background: rgba(255, 255, 255, 0.5);
}
.dplayer-controller .dplayer-icons .dplayer-toggle input:checked + label:after {
  left: 12px;
}
.dplayer-mobile-play {
  display: none;
  width: 50px;
  height: 50px;
  border: none;
  background-color: transparent;
  outline: none;
  cursor: pointer;
  box-sizing: border-box;
  bottom: 0;
  opacity: 0.8;
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
}
.dplayer-danmaku {
  position: absolute;
  left: 0;
  right: 0;
  top: 0;
  bottom: 0;
  font-size: 22px;
  color: #fff;
}
.dplayer-danmaku .dplayer-danmaku-item {
  display: inline-block;
  pointer-events: none;
  -webkit-user-select: none;
     -moz-user-select: none;
          user-select: none;
  cursor: default;
  white-space: nowrap;
  text-shadow: 0.5px 0.5px 0.5px rgba(0, 0, 0, 0.5);
}
.dplayer-danmaku .dplayer-danmaku-item--demo {
  position: absolute;
  visibility: hidden;
}
.dplayer-danmaku .dplayer-danmaku-right {
  position: absolute;
  right: 0;
  transform: translateX(100%);
}
.dplayer-danmaku .dplayer-danmaku-right.dplayer-danmaku-move {
  will-change: transform;
  animation-name: 'danmaku';
  animation-timing-function: linear;
  animation-play-state: paused;
}
@keyframes danmaku {
  from {
    transform: translateX(100%);
  }
}
.dplayer-danmaku .dplayer-danmaku-top,
.dplayer-danmaku .dplayer-danmaku-bottom {
  position: absolute;
  width: 100%;
  text-align: center;
  visibility: hidden;
}
.dplayer-danmaku .dplayer-danmaku-top.dplayer-danmaku-move,
.dplayer-danmaku .dplayer-danmaku-bottom.dplayer-danmaku-move {
  will-change: visibility;
  animation-name: 'danmaku-center';
  animation-timing-function: linear;
  animation-play-state: paused;
}
@keyframes danmaku-center {
  from {
    visibility: visible;
  }
  to {
    visibility: visible;
  }
}
.dplayer-logo {
  pointer-events: none;
  position: absolute;
  left: 20px;
  top: 20px;
  max-width: 50px;
  max-height: 50px;
}
.dplayer-logo img {
  max-width: 100%;
  max-height: 100%;
  background: none;
}
.dplayer-menu {
  position: absolute;
  width: 170px;
  border-radius: 2px;
  background: rgba(28, 28, 28, 0.85);
  padding: 5px 0;
  overflow: hidden;
  z-index: 3;
  display: none;
}
.dplayer-menu.dplayer-menu-show {
  display: block;
}
.dplayer-menu .dplayer-menu-item {
  height: 30px;
  box-sizing: border-box;
  cursor: pointer;
}
.dplayer-menu .dplayer-menu-item:hover {
  background-color: rgba(255, 255, 255, 0.1);
}
.dplayer-menu .dplayer-menu-item a {
  padding: 0 10px;
  line-height: 30px;
  color: #eee;
  font-size: 13px;
  display: inline-block;
  vertical-align: middle;
  width: 100%;
  box-sizing: border-box;
  white-space: nowrap;
  text-overflow: ellipsis;
  overflow: hidden;
}
.dplayer-menu .dplayer-menu-item a:hover {
  text-decoration: none;
}
.dplayer-notice-list {
  position: absolute;
  bottom: 60px;
  left: 20px;
}
.dplayer-notice-list .dplayer-notice {
  border-radius: 2px;
  background: rgba(28, 28, 28, 0.9);
  transition: all 0.3s ease-in-out;
  overflow: hidden;
  color: #fff;
  display: table;
  pointer-events: none;
  animation: showNotice 0.3s ease 1 forwards;
}
.dplayer-notice-list .remove-notice {
  animation: removeNotice 0.3s ease 1 forwards;
}
@keyframes showNotice {
  from {
    padding: 0;
    font-size: 0;
    margin-top: 0;
  }
  to {
    padding: 7px 20px;
    font-size: 14px;
    margin-top: 5px;
  }
}
@keyframes removeNotice {
  0% {
    padding: 7px 20px;
    font-size: 14px;
    margin-top: 5px;
  }
  20% {
    font-size: 12px;
  }
  21% {
    font-size: 0;
    padding: 7px 10px;
  }
  100% {
    padding: 0;
    margin-top: 0;
    font-size: 0;
  }
}
.dplayer-subtitle {
  position: absolute;
  bottom: 40px;
  width: 90%;
  left: 5%;
  text-align: center;
  color: #fff;
  text-shadow: 0.5px 0.5px 0.5px rgba(0, 0, 0, 0.5);
  font-size: 20px;
}
.dplayer-subtitle.dplayer-subtitle-hide {
  display: none;
}
.dplayer-mask {
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
  z-index: 1;
  display: none;
}
.dplayer-mask.dplayer-mask-show {
  display: block;
}
.dplayer-video-wrap {
  position: relative;
  background: #000;
  font-size: 0;
  width: 100%;
  height: 100%;
}
.dplayer-video-wrap .dplayer-video {
  width: 100%;
  height: 100%;
  display: none;
}
.dplayer-video-wrap .dplayer-video-current {
  display: block;
}
.dplayer-video-wrap .dplayer-video-prepare {
  display: none;
}
.dplayer-info-panel {
  position: absolute;
  top: 10px;
  left: 10px;
  width: 400px;
  background: rgba(28, 28, 28, 0.8);
  padding: 10px;
  color: #fff;
  font-size: 12px;
  border-radius: 2px;
}
.dplayer-info-panel-hide {
  display: none;
}
.dplayer-info-panel .dplayer-info-panel-close {
  cursor: pointer;
  position: absolute;
  right: 10px;
  top: 10px;
}
.dplayer-info-panel .dplayer-info-panel-item > span {
  display: inline-block;
  vertical-align: middle;
  line-height: 15px;
  white-space: nowrap;
  text-overflow: ellipsis;
  overflow: hidden;
}
.dplayer-info-panel .dplayer-info-panel-item-title {
  width: 100px;
  text-align: right;
  margin-right: 10px;
}
.dplayer-info-panel .dplayer-info-panel-item-data {
  width: 260px;
}
`,"",{version:3,sources:["webpack://./src/css/global.less","webpack://./src/css/index.less","webpack://./src/css/player.less","webpack://./src/css/balloon.less","webpack://./src/css/bezel.less","webpack://./src/css/notice.less","webpack://./src/css/controller.less","webpack://./src/css/danmaku.less","webpack://./src/css/logo.less","webpack://./src/css/menu.less","webpack://./src/css/subtitle.less","webpack://./src/css/video.less","webpack://./src/css/info-panel.less"],names:[],mappings:"AAAA;EACI;IACI,6CAAA;ECEN;EDAE;IACI,+CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,+CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,+CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,+CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,+CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,6CAAA;ECEN;EDAE;IACI,8CAAA;ECEN;EDAE;IACI,+CAAA;ECEN;EDAE;;IAEI,uCAAA;ECEN;AACF;ACzJA;EACI,kBAAA;EACA,gBAAA;EACA,yBAAA;KAAA,sBAAA;UAAA,iBAAA;EACA,cAAA;AD2JJ;AC/JA;EAOQ,uBAAA;AD2JR;AClKA;EAWQ,WAAA;EACA,YAAA;AD0JR;ACtKA;;EAgBY,UAAA;AD0JZ;ACtJI;EACI,WAAA;EACA,YAAA;EACA,gBAAA;EACA,eAAA;EACA,eAAA;EACA,OAAA;EACA,MAAA;EACA,SAAA;EACA,UAAA;EACA,0BAAA;ADwJR;ACpJI;;;EAKY,aAAA;ADoJhB;ACzJI;EAUQ,aAAA;ADkJZ;AC5JI;EAcQ,aAAA;ADiJZ;AC7II;EAEQ,aAAA;AD8IZ;AChJI;EAKQ,aAAA;AD8IZ;ACnJI;EAQQ,aAAA;AD8IZ;ACtJI;EAWQ,aAAA;AD8IZ;AC3IQ;EAEQ,aAAA;AD4IhB;ACvII;EAEQ,eAAA;ADwIZ;AC1II;EAKQ,cAAA;ADwIZ;ACpII;EAEQ,6BAAA;ADqIZ;AClIQ;EAAA;IAEQ,UAAA;EDoId;ECtIM;IAKQ,UAAA;EDoId;ECjIU;IAEQ,UAAA;EDkIlB;ECpIU;IAKQ,UAAA;EDkIlB;AACF;AC7HI;EAEQ,cAAA;AD8HZ;AC1HI;;;;EAIQ,4BAAA;AD4HZ;ACxHI;EACI,YAAA;AD0HR;AC3HI;EAIQ,UAAA;EACA,2BAAA;AD0HZ;AC/HI;EAQQ,UAAA;EACA,2BAAA;AD0HZ;ACvHI;EAEQ,UAAA;ADwHZ;AC1HI;EAKQ,UAAA;ADwHZ;ACrHI;EAKI,sBAAA;EACA,uBAAA;ADuHR;AC7HI;EACI,eAAA;EACA,eAAA;EACA,OAAA;EACA,MAAA;ADyHR;ACrHI;;;;;EAOY,aAAA;ADqHhB;AC5HI;EAUY,gBAAA;EACA,qBAAA;ADqHhB;AChII;EAgBQ,aAAA;ADmHZ;AChHQ;EAEQ,aAAA;ADiHhB;ACtII;EA0BQ,cAAA;AD+GZ;ACzGA;EACI,eAAA;EACA,MAAA;EACA,OAAA;EACA,SAAA;EACA,UAAA;AD2GJ;AElSA;EACI,aAAA;AFoSJ;AEjSA;EACI,oBAAA;EACA,iCAAA;AFmSJ;AEhSA;EACI,gBAAA;AFkSJ;AG9SA;EACI,kBAAA;EACA,OAAA;EACA,QAAA;EACA,MAAA;EACA,SAAA;EACA,eAAA;EACA,WAAA;EACA,oBAAA;AHgTJ;AGxTA;EAUQ,kBAAA;EACA,QAAA;EACA,SAAA;EACA,uBAAA;EACA,YAAA;EACA,WAAA;EACA,aAAA;EACA,sBAAA;EACA,8BAAA;EACA,kBAAA;EACA,UAAA;EACA,oBAAA;AHiTR;AGhTQ;EACI,iCAAA;AHkTZ;AGhTQ;EACI;IACI,UAAA;IACA,mBAAA;EHkTd;EGhTU;IACI,UAAA;IACA,mBAAA;EHkTd;AACF;AGnVA;EAqCQ,kBAAA;EACA,QAAA;EACA,gBAAA;EACA,WAAA;EACA,kBAAA;EACA,eAAA;EACA,iBAAA;EACA,0CAAA;AHiTR;AG7VA;EA+CQ,aAAA;EACA,kBAAA;EACA,QAAA;EACA,SAAA;EACA,uBAAA;EACA,YAAA;EACA,WAAA;EACA,oBAAA;AHiTR;AGvWA;EAwDY,aAAA;AHkTZ;AG1WA;EA2DY,uDAAA;EACA,UAAA;EACA,yBAAA;AHkTZ;AI/WC;EDgEmB,qBAAA;AHkTpB;AIlXC;EDgEmB,qBAAA;AHqTpB;AIrXC;EDgEmB,qBAAA;AHwTpB;AIxXC;EDgEmB,qBAAA;AH2TpB;AI3XC;EDgEmB,qBAAA;AH8TpB;AI9XC;EDgEmB,qBAAA;AHiUpB;AIjYC;EDgEmB,qBAAA;AHoUpB;AGhUQ;EACI;IACI,YAAA;IACA,0BAAA;EHkUd;EGhUU;IACI,aAAA;IACA,0BAAA;EHkUd;EGhUU;IACI,aAAA;IACA,4BAAA;EHkUd;AACF;AKlZA;EACI,mEAAA;EACA,YAAA;EACA,WAAA;EACA,kBAAA;EACA,SAAA;EACA,yBAAA;ALoZJ;AKjZA;EACI,kBAAA;EACA,SAAA;EACA,OAAA;EACA,QAAA;EACA,YAAA;EACA,eAAA;EACA,yBAAA;KAAA,sBAAA;UAAA,iBAAA;EACA,yBAAA;ALmZJ;AKlZI;EAEQ,aAAA;ALmZZ;AKrZI;EAKQ,cAAA;ALmZZ;AKjaA;EAkBQ,cAAA;EACA,eAAA;EACA,kBAAA;EACA,YAAA;EACA,wBAAA;EACA,WAAA;ALkZR;AKjZQ;EAEQ,mBAAA;ALkZhB;AKpZQ;EAKQ,cAAA;EACA,UAAA;EACA,2BAAA;EACA,QAAA;EACA,WAAA;ALkZhB;AKnbA;EAqCY,WAAA;EACA,kBAAA;EACA,QAAA;EACA,UAAA;EACA,WAAA;EACA,kBAAA;EACA,sBAAA;EACA,kBAAA;EACA,2BAAA;EACA,gCAAA;ALiZZ;AKhZY;EAEQ,cAAA;ALiZpB;AK/YgB;EACI,UAAA;ALiZpB;AK/YgB;EACI,UAAA;ALiZpB;AKxcA;EA2DgB,aAAA;EACA,kBAAA;EACA,SAAA;EACA,UAAA;EACA,gBAAA;EACA,qCAAA;EACA,WAAA;EACA,kBAAA;EACA,eAAA;EACA,mBAAA;EACA,2BAAA;ALgZhB;AKrdA;EAyEY,kBAAA;EACA,gBAAA;EACA,oBAAA;EACA,aAAA;EACA,6BAAA;AL+YZ;AK5dA;EAgFY,kBAAA;EACA,WAAA;EACA,YAAA;EACA,UAAA;EACA,oBAAA;AL+YZ;AKneA;EA0FY,kBAAA;EACA,SAAA;EACA,UAAA;EACA,kBAAA;EACA,gBAAA;EACA,qCAAA;EACA,WAAA;EACA,eAAA;EACA,kBAAA;EACA,UAAA;EACA,oCAAA;EACA,iBAAA;EACA,kBAAA;EACA,UAAA;EACA,oBAAA;AL4YZ;AK7ZY;EACI,UAAA;AL+ZhB;AKvfA;EA2GY,kBAAA;EACA,WAAA;EACA,WAAA;EACA,oCAAA;EACA,eAAA;AL+YZ;AK9fA;EAiHgB,kBAAA;EACA,OAAA;EACA,MAAA;EACA,SAAA;EACA,oCAAA;EACA,WAAA;EACA,yBAAA;EACA,kBAAA;ALgZhB;AKxgBA;EA2HgB,kBAAA;EACA,OAAA;EACA,MAAA;EACA,SAAA;EACA,WAAA;EACA,kBAAA;ALgZhB;AKhhBA;EAkIoB,kBAAA;EACA,MAAA;EACA,UAAA;EACA,gBAAA;EACA,mBAAA;EACA,YAAA;EACA,WAAA;EACA,kBAAA;EACA,eAAA;EACA,gCAAA;EACA,mBAAA;ALiZpB;AK7hBA;EAkJQ,YAAA;EACA,kBAAA;EACA,SAAA;AL8YR;AK7YQ;EACI,aAAA;EACA,kBAAA;EACA,gCAAA;EACA,UAAA;EACA,YAAA;EACA,SAAA;EACA,UAAA;EACA,WAAA;EACA,WAAA;AL+YZ;AKxZQ;EAWQ,YAAA;ALgZhB;AK3ZQ;EAcQ,kBAAA;EACA,OAAA;EACA,MAAA;ALgZhB;AKhaQ;EAmBQ,kBAAA;EACA,QAAA;EACA,MAAA;ALgZhB;AKraQ;EAwBQ,kBAAA;EACA,iCAAA;EACA,YAAA;EACA,OAAA;EACA,uCAAA;EACA,kBAAA;EACA,uBAAA;EACA,eAAA;EACA,YAAA;EACA,gCAAA;EACA,mBAAA;ALgZhB;AK/YgB;EACI,mBAAA;ALiZpB;AKrbQ;EAuCY,aAAA;ALiZpB;AKxbQ;EA0CY,eAAA;ALiZpB;AK3bQ;EA6CY,eAAA;EACA,WAAA;EACA,iBAAA;ALiZpB;AKhcQ;EAkDY,YAAA;ALiZpB;AKncQ;EAoDgB,kBAAA;ALkZxB;AK/YwB;EAEQ,0BAAA;ALgZhC;AK7YwB;EAEQ,0BAAA;AL8YhC;AK5cQ;EAmEgB,UAAA;EACA,gBAAA;EACA,iBAAA;EACA,qBAAA;EACA,eAAA;EACA,WAAA;EACA,sBAAA;EACA,kBAAA;EACA,sBAAA;EACA,kBAAA;EACA,eAAA;AL4YxB;AKzdQ;EAgFgB,mBAAA;EACA,cAAA;AL4YxB;AK7dQ;EAqFY,YAAA;AL2YpB;AKheQ;EAuFgB,YAAA;EACA,YAAA;EACA,qBAAA;AL4YxB;AKreQ;EA4FgB,WAAA;EACA,YAAA;EACA,qBAAA;EACA,kBAAA;EACA,sBAAA;EACA,eAAA;AL4YxB;AK3YwB;EACI,0CAAA;AL6Y5B;AKhfQ;EAyGQ,aAAA;EACA,YAAA;EACA,iBAAA;EACA,eAAA;EACA,iBAAA;EACA,kBAAA;EACA,kBAAA;EACA,gBAAA;EACA,SAAA;EACA,YAAA;EACA,sBAAA;EACA,WAAA;EACA,WAAA;AL0YhB;AKzYgB;EACI,WAAA;EACA,YAAA;AL2YpB;AK7YgB;EACI,WAAA;EACA,YAAA;AL2YpB;AKzYgB;EACI,aAAA;AL2YpB;AKvYQ;EAEQ,YAAA;ALwYhB;AKrYQ;EACI,WAAA;ALuYZ;AKxYQ;EAGQ,YAAA;ALwYhB;AKpqBA;;EAiSY,iBAAA;EACA,WAAA;EACA,uCAAA;EACA,sBAAA;EACA,eAAA;EACA,eAAA;ALuYZ;AK7qBA;EAySY,qBAAA;EACA,UAAA;EACA,WAAA;EACA,kBAAA;EACA,iBAAA;EACA,WAAA;EACA,kBAAA;ALuYZ;AKtrBA;EAkTY,WAAA;EACA,YAAA;EACA,YAAA;EACA,6BAAA;EACA,aAAA;EACA,eAAA;EACA,sBAAA;EACA,sBAAA;EACA,qBAAA;ALuYZ;AKjsBA;EA4TgB,gCAAA;EACA,YAAA;ALwYhB;AKtYY;EAEQ,UAAA;ALuYpB;AKpYY;EACI,WAAA;EACA,WAAA;EACA,iBAAA;EACA,eAAA;ALsYhB;AKpYY;EACI,qBAAA;ALsYhB;AKpYY;EACI,kBAAA;ALsYhB;AKpYY;EACI,WAAA;ALsYhB;AKvtBA;EAqVY,kBAAA;EACA,qBAAA;EACA,eAAA;EACA,YAAA;ALqYZ;AKpYY;EAEQ,WAAA;ALqYpB;AKvYY;EAKQ,mBAAA;ALqYpB;AKlYY;EAEQ,WAAA;ALmYpB;AKrYY;EAKQ,mBAAA;ALmYpB;AKzuBA;EA0WgB,qBAAA;EACA,qBAAA;EACA,sBAAA;EACA,YAAA;ALkYhB;AK/uBA;EA+WoB,kBAAA;EACA,SAAA;EACA,QAAA;EACA,WAAA;EACA,gBAAA;EACA,gCAAA;ALmYpB;AKvvBA;EAsXwB,kBAAA;EACA,SAAA;EACA,OAAA;EACA,YAAA;EACA,yBAAA;EACA,kBAAA;ALoYxB;AK/vBA;EA6X4B,kBAAA;EACA,MAAA;EACA,UAAA;EACA,gBAAA;EACA,mBAAA;EACA,YAAA;EACA,WAAA;EACA,kBAAA;EACA,eAAA;EACA,gCAAA;EACA,mBAAA;ALqY5B;AK5wBA;EA8YY,qBAAA;EACA,YAAA;ALiYZ;AKhxBA;EAkZY,qBAAA;EACA,YAAA;ALiYZ;AKpxBA;EAqZgB,kBAAA;EACA,QAAA;EACA,YAAA;EACA,mBAAA;EACA,uBAAA;EAAA,kBAAA;EACA,gBAAA;EACA,gBAAA;EACA,kBAAA;EACA,iCAAA;EACA,cAAA;EACA,gCAAA;EACA,cAAA;EACA,UAAA;ALkYhB;AKjYgB;EACI,cAAA;ALmYpB;AKjYgB;EACI,mBAAA;ALmYpB;AKzyBA;EA0agB,YAAA;EACA,iBAAA;EACA,sBAAA;EACA,eAAA;EACA,kBAAA;ALkYhB;AKjYgB;EACI,0CAAA;ALmYpB;AKnzBA;EAqbY,qBAAA;EACA,YAAA;ALiYZ;AKvzBA;EAwbgB,kBAAA;EACA,QAAA;EACA,YAAA;EACA,mBAAA;EACA,YAAA;EACA,kBAAA;EACA,iCAAA;EACA,cAAA;EACA,gCAAA;EACA,gBAAA;EACA,UAAA;ALkYhB;AKjYgB;EACI,aAAA;ALmYpB;AKlYoB;EACI,cAAA;ALoYxB;AKjYgB;EACI,mBAAA;ALmYpB;AKjYgB;EACI,WAAA;EACA,kBAAA;ALmYpB;AKjYgB;EAEQ,aAAA;ALkYxB;AKpYgB;EAKQ,cAAA;ALkYxB;AKv1BA;;EA2dgB,YAAA;EACA,iBAAA;EACA,sBAAA;EACA,eAAA;EACA,kBAAA;ALgYhB;AK/XgB;;EACI,0CAAA;ALkYpB;AKn2BA;EAqegB,cAAA;ALiYhB;AKt2BA;EAueoB,eAAA;EACA,eAAA;ALkYpB;AKhYgB;EAEQ,aAAA;ALiYxB;AKnYgB;EAKQ,qBAAA;ALiYxB;AK9XgB;EAEQ,aAAA;AL+XxB;AKjYgB;EAKQ,qBAAA;AL+XxB;AKt3BA;EA2foB,eAAA;EACA,sBAAA;EACA,aAAA;EACA,sBAAA;EACA,YAAA;EACA,WAAA;AL8XpB;AK93BA;EAkgBwB,kBAAA;EACA,UAAA;EACA,WAAA;EACA,WAAA;EACA,gBAAA;EACA,gCAAA;AL+XxB;AKt4BA;EAygB4B,kBAAA;EACA,SAAA;EACA,OAAA;EACA,YAAA;EACA,yBAAA;EACA,gBAAA;EACA,kBAAA;ALgY5B;AK/4BA;EAihBgC,kBAAA;EACA,MAAA;EACA,UAAA;EACA,gBAAA;EACA,mBAAA;EACA,YAAA;EACA,WAAA;EACA,kBAAA;EACA,eAAA;EACA,gCAAA;EACA,gBAAA;ALiYhC;AK55BA;EAmiBY,qBAAA;EACA,YAAA;EACA,kBAAA;AL4XZ;AK3XY;EAEQ,cAAA;AL4XpB;AKp6BA;EA4iBgB,kBAAA;EACA,UAAA;EACA,UAAA;EACA,aAAA;AL2XhB;AK16BA;EAmjBY,kBAAA;EACA,qBAAA;EACA,YAAA;EACA,UAAA;AL0XZ;AKzXY;EAEQ,cAAA;AL0XpB;AK5XY;EAKQ,cAAA;AL0XpB;AKt7BA;EAgkBgB,aAAA;EACA,kBAAA;EACA,YAAA;EACA,WAAA;EACA,WAAA;EACA,oBAAA;ALyXhB;AK97BA;EAwkBgB,aAAA;EACA,eAAA;EACA,WAAA;EACA,kBAAA;EACA,iCAAA;EACA,cAAA;EACA,gCAAA;EACA,gBAAA;EACA,WAAA;EACA,kBAAA;ALyXhB;AK18BA;EAolBgB,YAAA;EACA,sBAAA;EACA,eAAA;EACA,iBAAA;ALyXhB;AKxXgB;EACI,0CAAA;AL0XpB;AKn9BA;EA8lBY,qBAAA;EACA,YAAA;ALwXZ;AKv9BA;EAkmBY,WAAA;EACA,eAAA;EACA,qBAAA;EACA,sBAAA;EACA,mBAAA;ALwXZ;AK99BA;EAymBY,WAAA;EACA,YAAA;EACA,kBAAA;EACA,YAAA;EACA,sBAAA;EACA,kBAAA;EACA,QAAA;EACA,WAAA;ALwXZ;AKx+BA;EAknBgB,aAAA;EACA,YAAA;EACA,aAAA;ALyXhB;AK7+BA;EAunBgB,qBAAA;EACA,kBAAA;EACA,iCAAA;EACA,yBAAA;EACA,YAAA;EACA,WAAA;EACA,mBAAA;EACA,sBAAA;EACA,eAAA;EACA,4BAAA;ALyXhB;AKz/BA;EAmoBgB,WAAA;EACA,kBAAA;EACA,cAAA;EACA,YAAA;EACA,WAAA;EACA,MAAA;EACA,OAAA;EACA,mBAAA;EACA,4BAAA;ALyXhB;AKpgCA;EA8oBgB,WAAA;EACA,kBAAA;EACA,cAAA;EACA,OAAA;EACA,MAAA;EACA,mBAAA;EACA,gBAAA;EACA,4BAAA;EACA,wCAAA;EACA,YAAA;EACA,WAAA;ALyXhB;AKjhCA;EA2pBgB,sCAAA;ALyXhB;AKphCA;EA8pBgB,WAAA;EACA,oCAAA;ALyXhB;AKxhCA;EAkqBgB,UAAA;ALyXhB;AKnXA;EACI,aAAA;EACA,WAAA;EACA,YAAA;EACA,YAAA;EACA,6BAAA;EACA,aAAA;EACA,eAAA;EACA,sBAAA;EAEA,SAAA;EACA,YAAA;EACA,kBAAA;EACA,SAAA;EACA,QAAA;EACA,gCAAA;ALoXJ;AMpjCA;EACI,kBAAA;EACA,OAAA;EACA,QAAA;EACA,MAAA;EACA,SAAA;EACA,eAAA;EACA,WAAA;ANsjCJ;AM7jCA;EASQ,qBAAA;EACA,oBAAA;EACA,yBAAA;KAAA,sBAAA;UAAA,iBAAA;EACA,eAAA;EACA,mBAAA;EACA,iDAAA;ANujCR;AMtjCQ;EACI,kBAAA;EACA,kBAAA;ANwjCZ;AMzkCA;EAqBQ,kBAAA;EACA,QAAA;EACA,2BAAA;ANujCR;AMtjCQ;EACI,sBAAA;EACA,yBAAA;EACA,iCAAA;EACA,4BAAA;ANwjCZ;AMrjCI;EACI;IACI,2BAAA;ENujCV;AACF;AMzlCA;;EAsCQ,kBAAA;EACA,WAAA;EACA,kBAAA;EACA,kBAAA;ANujCR;AMtjCQ;;EACI,uBAAA;EACA,gCAAA;EACA,iCAAA;EACA,4BAAA;ANyjCZ;AMtjCI;EACI;IACI,mBAAA;ENwjCV;EMtjCM;IACI,mBAAA;ENwjCV;AACF;AO/mCA;EACI,oBAAA;EACA,kBAAA;EACA,UAAA;EACA,SAAA;EACA,eAAA;EACA,gBAAA;APinCJ;AOvnCA;EAQQ,eAAA;EACA,gBAAA;EACA,gBAAA;APknCR;AQ5nCA;EACI,kBAAA;EACA,YAAA;EACA,kBAAA;EACA,kCAAA;EACA,cAAA;EACA,gBAAA;EACA,UAAA;EACA,aAAA;AR8nCJ;AQ7nCI;EACI,cAAA;AR+nCR;AQzoCA;EAaQ,YAAA;EACA,sBAAA;EACA,eAAA;AR+nCR;AQ9nCQ;EACI,0CAAA;ARgoCZ;AQjpCA;EAqBY,eAAA;EACA,iBAAA;EACA,WAAA;EACA,eAAA;EACA,qBAAA;EACA,sBAAA;EACA,WAAA;EACA,sBAAA;EACA,mBAAA;EACA,uBAAA;EACA,gBAAA;AR+nCZ;AQ9nCY;EACI,qBAAA;ARgoChB;AIjqCA;EACI,kBAAA;EACA,YAAA;EACA,UAAA;AJmqCJ;AItqCA;EAMQ,kBAAA;EACA,iCAAA;EACA,gCAAA;EACA,gBAAA;EACA,WAAA;EACA,cAAA;EACA,oBAAA;EACA,0CAAA;AJmqCR;AIhrCA;EAiBQ,4CAAA;AJkqCR;AI9pCA;EACI;IACI,UAAA;IACA,YAAA;IACA,aAAA;EJgqCN;EI9pCE;IACI,iBAAA;IACA,eAAA;IACA,eAAA;EJgqCN;AACF;AI7pCA;EACI;IACI,iBAAA;IACA,eAAA;IACA,eAAA;EJ+pCN;EI7pCE;IACI,eAAA;EJ+pCN;EI7pCE;IACI,YAAA;IACA,iBAAA;EJ+pCN;EI7pCE;IACI,UAAA;IACA,aAAA;IACA,YAAA;EJ+pCN;AACF;ASltCA;EACI,kBAAA;EACA,YAAA;EACA,UAAA;EACA,QAAA;EACA,kBAAA;EACA,WAAA;EACA,iDAAA;EACA,eAAA;ATotCJ;ASntCI;EACI,aAAA;ATqtCR;AU/tCA;EACI,kBAAA;EACA,MAAA;EACA,SAAA;EACA,OAAA;EACA,QAAA;EACA,UAAA;EACA,aAAA;AViuCJ;AUhuCI;EACI,cAAA;AVkuCR;AU9tCA;EACI,kBAAA;EACA,gBAAA;EACA,YAAA;EACA,WAAA;EACA,YAAA;AVguCJ;AUruCA;EAOQ,WAAA;EACA,YAAA;EACA,aAAA;AViuCR;AU1uCA;EAYQ,cAAA;AViuCR;AU7uCA;EAeQ,aAAA;AViuCR;AW7vCA;EACI,kBAAA;EACA,SAAA;EACA,UAAA;EACA,YAAA;EACA,iCAAA;EACA,aAAA;EACA,WAAA;EACA,eAAA;EACA,kBAAA;AX+vCJ;AW7vCI;EACI,aAAA;AX+vCR;AW3wCA;EAgBQ,eAAA;EACA,kBAAA;EACA,WAAA;EACA,SAAA;AX8vCR;AW1vCQ;EACI,qBAAA;EACA,sBAAA;EACA,iBAAA;EACA,mBAAA;EACA,uBAAA;EACA,gBAAA;AX4vCZ;AWzxCA;EAkCQ,YAAA;EACA,iBAAA;EACA,kBAAA;AX0vCR;AW9xCA;EAwCQ,YAAA;AXyvCR",sourcesContent:[`@keyframes my-face {
    2% {
        transform: translate(0, 1.5px) rotate(1.5deg);
    }
    4% {
        transform: translate(0, -1.5px) rotate(-0.5deg);
    }
    6% {
        transform: translate(0, 1.5px) rotate(-1.5deg);
    }
    8% {
        transform: translate(0, -1.5px) rotate(-1.5deg);
    }
    10% {
        transform: translate(0, 2.5px) rotate(1.5deg);
    }
    12% {
        transform: translate(0, -0.5px) rotate(1.5deg);
    }
    14% {
        transform: translate(0, -1.5px) rotate(1.5deg);
    }
    16% {
        transform: translate(0, -0.5px) rotate(-1.5deg);
    }
    18% {
        transform: translate(0, 0.5px) rotate(-1.5deg);
    }
    20% {
        transform: translate(0, -1.5px) rotate(2.5deg);
    }
    22% {
        transform: translate(0, 0.5px) rotate(-1.5deg);
    }
    24% {
        transform: translate(0, 1.5px) rotate(1.5deg);
    }
    26% {
        transform: translate(0, 0.5px) rotate(0.5deg);
    }
    28% {
        transform: translate(0, 0.5px) rotate(1.5deg);
    }
    30% {
        transform: translate(0, -0.5px) rotate(2.5deg);
    }
    32% {
        transform: translate(0, 1.5px) rotate(-0.5deg);
    }
    34% {
        transform: translate(0, 1.5px) rotate(-0.5deg);
    }
    36% {
        transform: translate(0, -1.5px) rotate(2.5deg);
    }
    38% {
        transform: translate(0, 1.5px) rotate(-1.5deg);
    }
    40% {
        transform: translate(0, -0.5px) rotate(2.5deg);
    }
    42% {
        transform: translate(0, 2.5px) rotate(-1.5deg);
    }
    44% {
        transform: translate(0, 1.5px) rotate(0.5deg);
    }
    46% {
        transform: translate(0, -1.5px) rotate(2.5deg);
    }
    48% {
        transform: translate(0, -0.5px) rotate(0.5deg);
    }
    50% {
        transform: translate(0, 0.5px) rotate(0.5deg);
    }
    52% {
        transform: translate(0, 2.5px) rotate(2.5deg);
    }
    54% {
        transform: translate(0, -1.5px) rotate(1.5deg);
    }
    56% {
        transform: translate(0, 2.5px) rotate(2.5deg);
    }
    58% {
        transform: translate(0, 0.5px) rotate(2.5deg);
    }
    60% {
        transform: translate(0, 2.5px) rotate(2.5deg);
    }
    62% {
        transform: translate(0, -0.5px) rotate(2.5deg);
    }
    64% {
        transform: translate(0, -0.5px) rotate(1.5deg);
    }
    66% {
        transform: translate(0, 1.5px) rotate(-0.5deg);
    }
    68% {
        transform: translate(0, -1.5px) rotate(-0.5deg);
    }
    70% {
        transform: translate(0, 1.5px) rotate(0.5deg);
    }
    72% {
        transform: translate(0, 2.5px) rotate(1.5deg);
    }
    74% {
        transform: translate(0, -0.5px) rotate(0.5deg);
    }
    76% {
        transform: translate(0, -0.5px) rotate(2.5deg);
    }
    78% {
        transform: translate(0, -0.5px) rotate(1.5deg);
    }
    80% {
        transform: translate(0, 1.5px) rotate(1.5deg);
    }
    82% {
        transform: translate(0, -0.5px) rotate(0.5deg);
    }
    84% {
        transform: translate(0, 1.5px) rotate(2.5deg);
    }
    86% {
        transform: translate(0, -1.5px) rotate(-1.5deg);
    }
    88% {
        transform: translate(0, -0.5px) rotate(2.5deg);
    }
    90% {
        transform: translate(0, 2.5px) rotate(-0.5deg);
    }
    92% {
        transform: translate(0, 0.5px) rotate(-0.5deg);
    }
    94% {
        transform: translate(0, 2.5px) rotate(0.5deg);
    }
    96% {
        transform: translate(0, -0.5px) rotate(1.5deg);
    }
    98% {
        transform: translate(0, -1.5px) rotate(-0.5deg);
    }
    0%,
    100% {
        transform: translate(0, 0) rotate(0deg);
    }
}`,`@import '../../node_modules/balloon-css/balloon.css';
@keyframes my-face {
  2% {
    transform: translate(0, 1.5px) rotate(1.5deg);
  }
  4% {
    transform: translate(0, -1.5px) rotate(-0.5deg);
  }
  6% {
    transform: translate(0, 1.5px) rotate(-1.5deg);
  }
  8% {
    transform: translate(0, -1.5px) rotate(-1.5deg);
  }
  10% {
    transform: translate(0, 2.5px) rotate(1.5deg);
  }
  12% {
    transform: translate(0, -0.5px) rotate(1.5deg);
  }
  14% {
    transform: translate(0, -1.5px) rotate(1.5deg);
  }
  16% {
    transform: translate(0, -0.5px) rotate(-1.5deg);
  }
  18% {
    transform: translate(0, 0.5px) rotate(-1.5deg);
  }
  20% {
    transform: translate(0, -1.5px) rotate(2.5deg);
  }
  22% {
    transform: translate(0, 0.5px) rotate(-1.5deg);
  }
  24% {
    transform: translate(0, 1.5px) rotate(1.5deg);
  }
  26% {
    transform: translate(0, 0.5px) rotate(0.5deg);
  }
  28% {
    transform: translate(0, 0.5px) rotate(1.5deg);
  }
  30% {
    transform: translate(0, -0.5px) rotate(2.5deg);
  }
  32% {
    transform: translate(0, 1.5px) rotate(-0.5deg);
  }
  34% {
    transform: translate(0, 1.5px) rotate(-0.5deg);
  }
  36% {
    transform: translate(0, -1.5px) rotate(2.5deg);
  }
  38% {
    transform: translate(0, 1.5px) rotate(-1.5deg);
  }
  40% {
    transform: translate(0, -0.5px) rotate(2.5deg);
  }
  42% {
    transform: translate(0, 2.5px) rotate(-1.5deg);
  }
  44% {
    transform: translate(0, 1.5px) rotate(0.5deg);
  }
  46% {
    transform: translate(0, -1.5px) rotate(2.5deg);
  }
  48% {
    transform: translate(0, -0.5px) rotate(0.5deg);
  }
  50% {
    transform: translate(0, 0.5px) rotate(0.5deg);
  }
  52% {
    transform: translate(0, 2.5px) rotate(2.5deg);
  }
  54% {
    transform: translate(0, -1.5px) rotate(1.5deg);
  }
  56% {
    transform: translate(0, 2.5px) rotate(2.5deg);
  }
  58% {
    transform: translate(0, 0.5px) rotate(2.5deg);
  }
  60% {
    transform: translate(0, 2.5px) rotate(2.5deg);
  }
  62% {
    transform: translate(0, -0.5px) rotate(2.5deg);
  }
  64% {
    transform: translate(0, -0.5px) rotate(1.5deg);
  }
  66% {
    transform: translate(0, 1.5px) rotate(-0.5deg);
  }
  68% {
    transform: translate(0, -1.5px) rotate(-0.5deg);
  }
  70% {
    transform: translate(0, 1.5px) rotate(0.5deg);
  }
  72% {
    transform: translate(0, 2.5px) rotate(1.5deg);
  }
  74% {
    transform: translate(0, -0.5px) rotate(0.5deg);
  }
  76% {
    transform: translate(0, -0.5px) rotate(2.5deg);
  }
  78% {
    transform: translate(0, -0.5px) rotate(1.5deg);
  }
  80% {
    transform: translate(0, 1.5px) rotate(1.5deg);
  }
  82% {
    transform: translate(0, -0.5px) rotate(0.5deg);
  }
  84% {
    transform: translate(0, 1.5px) rotate(2.5deg);
  }
  86% {
    transform: translate(0, -1.5px) rotate(-1.5deg);
  }
  88% {
    transform: translate(0, -0.5px) rotate(2.5deg);
  }
  90% {
    transform: translate(0, 2.5px) rotate(-0.5deg);
  }
  92% {
    transform: translate(0, 0.5px) rotate(-0.5deg);
  }
  94% {
    transform: translate(0, 2.5px) rotate(0.5deg);
  }
  96% {
    transform: translate(0, -0.5px) rotate(1.5deg);
  }
  98% {
    transform: translate(0, -1.5px) rotate(-0.5deg);
  }
  0%,
  100% {
    transform: translate(0, 0) rotate(0deg);
  }
}
.dplayer {
  position: relative;
  overflow: hidden;
  user-select: none;
  line-height: 1;
}
.dplayer * {
  box-sizing: content-box;
}
.dplayer svg {
  width: 100%;
  height: 100%;
}
.dplayer svg path,
.dplayer svg circle {
  fill: #fff;
}
.dplayer:-webkit-full-screen {
  width: 100%;
  height: 100%;
  background: #000;
  position: fixed;
  z-index: 100000;
  left: 0;
  top: 0;
  margin: 0;
  padding: 0;
  transform: translate(0, 0);
}
.dplayer.dplayer-no-danmaku .dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box .dplayer-setting-showdan,
.dplayer.dplayer-no-danmaku .dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box .dplayer-setting-danmaku,
.dplayer.dplayer-no-danmaku .dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box .dplayer-setting-danunlimit {
  display: none;
}
.dplayer.dplayer-no-danmaku .dplayer-controller .dplayer-icons .dplayer-comment {
  display: none;
}
.dplayer.dplayer-no-danmaku .dplayer-danmaku {
  display: none;
}
.dplayer.dplayer-live .dplayer-time {
  display: none;
}
.dplayer.dplayer-live .dplayer-bar-wrap {
  display: none;
}
.dplayer.dplayer-live .dplayer-setting-speed {
  display: none;
}
.dplayer.dplayer-live .dplayer-setting-loop {
  display: none;
}
.dplayer.dplayer-live.dplayer-no-danmaku .dplayer-setting {
  display: none;
}
.dplayer.dplayer-arrow .dplayer-danmaku {
  font-size: 18px;
}
.dplayer.dplayer-arrow .dplayer-icon {
  margin: 0 -3px;
}
.dplayer.dplayer-playing .dplayer-danmaku .dplayer-danmaku-move {
  animation-play-state: running;
}
@media (min-width: 900px) {
  .dplayer.dplayer-playing .dplayer-controller-mask {
    opacity: 0;
  }
  .dplayer.dplayer-playing .dplayer-controller {
    opacity: 0;
  }
  .dplayer.dplayer-playing:hover .dplayer-controller-mask {
    opacity: 1;
  }
  .dplayer.dplayer-playing:hover .dplayer-controller {
    opacity: 1;
  }
}
.dplayer.dplayer-loading .dplayer-bezel .diplayer-loading-icon {
  display: block;
}
.dplayer.dplayer-loading .dplayer-danmaku,
.dplayer.dplayer-paused .dplayer-danmaku,
.dplayer.dplayer-loading .dplayer-danmaku-move,
.dplayer.dplayer-paused .dplayer-danmaku-move {
  animation-play-state: paused;
}
.dplayer.dplayer-hide-controller {
  cursor: none;
}
.dplayer.dplayer-hide-controller .dplayer-controller-mask {
  opacity: 0;
  transform: translateY(100%);
}
.dplayer.dplayer-hide-controller .dplayer-controller {
  opacity: 0;
  transform: translateY(100%);
}
.dplayer.dplayer-show-controller .dplayer-controller-mask {
  opacity: 1;
}
.dplayer.dplayer-show-controller .dplayer-controller {
  opacity: 1;
}
.dplayer.dplayer-fulled {
  position: fixed;
  z-index: 100000;
  left: 0;
  top: 0;
  width: 100% !important;
  height: 100% !important;
}
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-volume,
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-camera-icon,
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-airplay-icon,
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-chromecast-icon,
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-play-icon {
  display: none;
}
.dplayer.dplayer-mobile .dplayer-controller .dplayer-icons .dplayer-full .dplayer-full-in-icon {
  position: static;
  display: inline-block;
}
.dplayer.dplayer-mobile .dplayer-bar-time {
  display: none;
}
.dplayer.dplayer-mobile.dplayer-hide-controller .dplayer-mobile-play {
  display: none;
}
.dplayer.dplayer-mobile .dplayer-mobile-play {
  display: block;
}
.dplayer-web-fullscreen-fix {
  position: fixed;
  top: 0;
  left: 0;
  margin: 0;
  padding: 0;
}
[data-balloon]:before {
  display: none;
}
[data-balloon]:after {
  padding: 0.3em 0.7em;
  background: rgba(17, 17, 17, 0.7);
}
[data-balloon][data-balloon-pos="up"]:after {
  margin-bottom: 0;
}
.dplayer-bezel {
  position: absolute;
  left: 0;
  right: 0;
  top: 0;
  bottom: 0;
  font-size: 22px;
  color: #fff;
  pointer-events: none;
}
.dplayer-bezel .dplayer-bezel-icon {
  position: absolute;
  top: 50%;
  left: 50%;
  margin: -26px 0 0 -26px;
  height: 52px;
  width: 52px;
  padding: 12px;
  box-sizing: border-box;
  background: rgba(0, 0, 0, 0.5);
  border-radius: 50%;
  opacity: 0;
  pointer-events: none;
}
.dplayer-bezel .dplayer-bezel-icon.dplayer-bezel-transition {
  animation: bezel-hide 0.5s linear;
}
@keyframes bezel-hide {
  from {
    opacity: 1;
    transform: scale(1);
  }
  to {
    opacity: 0;
    transform: scale(2);
  }
}
.dplayer-bezel .dplayer-danloading {
  position: absolute;
  top: 50%;
  margin-top: -7px;
  width: 100%;
  text-align: center;
  font-size: 14px;
  line-height: 14px;
  animation: my-face 5s infinite ease-in-out;
}
.dplayer-bezel .diplayer-loading-icon {
  display: none;
  position: absolute;
  top: 50%;
  left: 50%;
  margin: -18px 0 0 -18px;
  height: 36px;
  width: 36px;
  pointer-events: none;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-hide {
  display: none;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot {
  animation: diplayer-loading-dot-fade 0.8s ease infinite;
  opacity: 0;
  transform-origin: 4px 4px;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-1 {
  animation-delay: 0.1s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-2 {
  animation-delay: 0.2s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-3 {
  animation-delay: 0.3s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-4 {
  animation-delay: 0.4s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-5 {
  animation-delay: 0.5s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-6 {
  animation-delay: 0.6s;
}
.dplayer-bezel .diplayer-loading-icon .diplayer-loading-dot.diplayer-loading-dot-7 {
  animation-delay: 0.7s;
}
@keyframes diplayer-loading-dot-fade {
  0% {
    opacity: 0.7;
    transform: scale(1.2, 1.2);
  }
  50% {
    opacity: 0.25;
    transform: scale(0.9, 0.9);
  }
  to {
    opacity: 0.25;
    transform: scale(0.85, 0.85);
  }
}
.dplayer-controller-mask {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAADGCAYAAAAT+OqFAAAAdklEQVQoz42QQQ7AIAgEF/T/D+kbq/RWAlnQyyazA4aoAB4FsBSA/bFjuF1EOL7VbrIrBuusmrt4ZZORfb6ehbWdnRHEIiITaEUKa5EJqUakRSaEYBJSCY2dEstQY7AuxahwXFrvZmWl2rh4JZ07z9dLtesfNj5q0FU3A5ObbwAAAABJRU5ErkJggg==) repeat-x bottom;
  height: 98px;
  width: 100%;
  position: absolute;
  bottom: 0;
  transition: all 0.3s ease;
}
.dplayer-controller {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 41px;
  padding: 0 20px;
  user-select: none;
  transition: all 0.3s ease;
}
.dplayer-controller.dplayer-controller-comment .dplayer-icons {
  display: none;
}
.dplayer-controller.dplayer-controller-comment .dplayer-icons.dplayer-comment-box {
  display: block;
}
.dplayer-controller .dplayer-bar-wrap {
  padding: 5px 0;
  cursor: pointer;
  position: absolute;
  bottom: 33px;
  width: calc(100% - 40px);
  height: 3px;
}
.dplayer-controller .dplayer-bar-wrap:hover .dplayer-bar .dplayer-played .dplayer-thumb {
  transform: scale(1);
}
.dplayer-controller .dplayer-bar-wrap:hover .dplayer-highlight {
  display: block;
  width: 8px;
  transform: translateX(-4px);
  top: 4px;
  height: 40%;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-highlight {
  z-index: 12;
  position: absolute;
  top: 5px;
  width: 6px;
  height: 20%;
  border-radius: 6px;
  background-color: #fff;
  text-align: center;
  transform: translateX(-3px);
  transition: all 0.2s ease-in-out;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-highlight:hover .dplayer-highlight-text {
  display: block;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-highlight:hover ~ .dplayer-bar-preview {
  opacity: 0;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-highlight:hover ~ .dplayer-bar-time {
  opacity: 0;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-highlight .dplayer-highlight-text {
  display: none;
  position: absolute;
  left: 50%;
  top: -24px;
  padding: 5px 8px;
  background-color: rgba(0, 0, 0, 0.62);
  color: #fff;
  border-radius: 4px;
  font-size: 12px;
  white-space: nowrap;
  transform: translateX(-50%);
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar-preview {
  position: absolute;
  background: #fff;
  pointer-events: none;
  display: none;
  background-size: 16000px 100%;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar-preview-canvas {
  position: absolute;
  width: 100%;
  height: 100%;
  z-index: 1;
  pointer-events: none;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar-time {
  position: absolute;
  left: 0px;
  top: -20px;
  border-radius: 4px;
  padding: 5px 7px;
  background-color: rgba(0, 0, 0, 0.62);
  color: #fff;
  font-size: 12px;
  text-align: center;
  opacity: 1;
  transition: opacity 0.1s ease-in-out;
  word-wrap: normal;
  word-break: normal;
  z-index: 2;
  pointer-events: none;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar-time.hidden {
  opacity: 0;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar {
  position: relative;
  height: 3px;
  width: 100%;
  background: rgba(255, 255, 255, 0.2);
  cursor: pointer;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar .dplayer-loaded {
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  background: rgba(255, 255, 255, 0.4);
  height: 3px;
  transition: all 0.5s ease;
  will-change: width;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar .dplayer-played {
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  height: 3px;
  will-change: width;
}
.dplayer-controller .dplayer-bar-wrap .dplayer-bar .dplayer-played .dplayer-thumb {
  position: absolute;
  top: 0;
  right: 5px;
  margin-top: -4px;
  margin-right: -10px;
  height: 11px;
  width: 11px;
  border-radius: 50%;
  cursor: pointer;
  transition: all 0.3s ease-in-out;
  transform: scale(0);
}
.dplayer-controller .dplayer-icons {
  height: 38px;
  position: absolute;
  bottom: 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box {
  display: none;
  position: absolute;
  transition: all 0.3s ease-in-out;
  z-index: 2;
  height: 38px;
  bottom: 0;
  left: 20px;
  right: 20px;
  color: #fff;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-icon {
  padding: 7px;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-icon {
  position: absolute;
  left: 0;
  top: 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-send-icon {
  position: absolute;
  right: 0;
  top: 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box {
  position: absolute;
  background: rgba(28, 28, 28, 0.9);
  bottom: 41px;
  left: 0;
  box-shadow: 0 0 25px rgba(0, 0, 0, 0.3);
  border-radius: 4px;
  padding: 10px 10px 16px;
  font-size: 14px;
  width: 204px;
  transition: all 0.3s ease-in-out;
  transform: scale(0);
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box.dplayer-comment-setting-open {
  transform: scale(1);
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box input[type=radio] {
  display: none;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box label {
  cursor: pointer;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-title {
  font-size: 13px;
  color: #fff;
  line-height: 30px;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type {
  font-size: 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type .dplayer-comment-setting-title {
  margin-bottom: 6px;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type label:nth-child(2) span {
  border-radius: 4px 0 0 4px;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type label:nth-child(4) span {
  border-radius: 0 4px 4px 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type span {
  width: 33%;
  padding: 4px 6px;
  line-height: 16px;
  display: inline-block;
  font-size: 12px;
  color: #fff;
  border: 1px solid #fff;
  margin-right: -1px;
  box-sizing: border-box;
  text-align: center;
  cursor: pointer;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-type input:checked + span {
  background: #E4E4E6;
  color: #1c1c1c;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-color {
  font-size: 0;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-color label {
  font-size: 0;
  padding: 6px;
  display: inline-block;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-color span {
  width: 22px;
  height: 22px;
  display: inline-block;
  border-radius: 50%;
  box-sizing: border-box;
  cursor: pointer;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-setting-box .dplayer-comment-setting-color span:hover {
  animation: my-face 5s infinite ease-in-out;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-input {
  outline: none;
  border: none;
  padding: 8px 31px;
  font-size: 14px;
  line-height: 18px;
  text-align: center;
  border-radius: 4px;
  background: none;
  margin: 0;
  height: 100%;
  box-sizing: border-box;
  width: 100%;
  color: #fff;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-input::placeholder {
  color: #fff;
  opacity: 0.8;
}
.dplayer-controller .dplayer-icons.dplayer-comment-box .dplayer-comment-input::-ms-clear {
  display: none;
}
.dplayer-controller .dplayer-icons.dplayer-icons-left .dplayer-icon {
  padding: 7px;
}
.dplayer-controller .dplayer-icons.dplayer-icons-right {
  right: 20px;
}
.dplayer-controller .dplayer-icons.dplayer-icons-right .dplayer-icon {
  padding: 8px;
}
.dplayer-controller .dplayer-icons .dplayer-time,
.dplayer-controller .dplayer-icons .dplayer-live-badge {
  line-height: 38px;
  color: #eee;
  text-shadow: 0 0 2px rgba(0, 0, 0, 0.5);
  vertical-align: middle;
  font-size: 13px;
  cursor: default;
}
.dplayer-controller .dplayer-icons .dplayer-live-dot {
  display: inline-block;
  width: 6px;
  height: 6px;
  vertical-align: 4%;
  margin-right: 5px;
  content: '';
  border-radius: 6px;
}
.dplayer-controller .dplayer-icons .dplayer-icon {
  width: 40px;
  height: 100%;
  border: none;
  background-color: transparent;
  outline: none;
  cursor: pointer;
  vertical-align: middle;
  box-sizing: border-box;
  display: inline-block;
}
.dplayer-controller .dplayer-icons .dplayer-icon .dplayer-icon-content {
  transition: all 0.2s ease-in-out;
  opacity: 0.8;
}
.dplayer-controller .dplayer-icons .dplayer-icon:hover .dplayer-icon-content {
  opacity: 1;
}
.dplayer-controller .dplayer-icons .dplayer-icon.dplayer-quality-icon {
  color: #fff;
  width: auto;
  line-height: 22px;
  font-size: 14px;
}
.dplayer-controller .dplayer-icons .dplayer-icon.dplayer-comment-icon {
  padding: 10px 9px 9px;
}
.dplayer-controller .dplayer-icons .dplayer-icon.dplayer-setting-icon {
  padding-top: 8.5px;
}
.dplayer-controller .dplayer-icons .dplayer-icon.dplayer-volume-icon {
  width: 43px;
}
.dplayer-controller .dplayer-icons .dplayer-volume {
  position: relative;
  display: inline-block;
  cursor: pointer;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-volume:hover .dplayer-volume-bar-wrap .dplayer-volume-bar {
  width: 45px;
}
.dplayer-controller .dplayer-icons .dplayer-volume:hover .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner .dplayer-thumb {
  transform: scale(1);
}
.dplayer-controller .dplayer-icons .dplayer-volume.dplayer-volume-active .dplayer-volume-bar-wrap .dplayer-volume-bar {
  width: 45px;
}
.dplayer-controller .dplayer-icons .dplayer-volume.dplayer-volume-active .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner .dplayer-thumb {
  transform: scale(1);
}
.dplayer-controller .dplayer-icons .dplayer-volume .dplayer-volume-bar-wrap {
  display: inline-block;
  margin: 0 10px 0 -5px;
  vertical-align: middle;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-volume .dplayer-volume-bar-wrap .dplayer-volume-bar {
  position: relative;
  top: 17px;
  width: 0;
  height: 3px;
  background: #aaa;
  transition: all 0.3s ease-in-out;
}
.dplayer-controller .dplayer-icons .dplayer-volume .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner {
  position: absolute;
  bottom: 0;
  left: 0;
  height: 100%;
  transition: all 0.1s ease;
  will-change: width;
}
.dplayer-controller .dplayer-icons .dplayer-volume .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner .dplayer-thumb {
  position: absolute;
  top: 0;
  right: 5px;
  margin-top: -4px;
  margin-right: -10px;
  height: 11px;
  width: 11px;
  border-radius: 50%;
  cursor: pointer;
  transition: all 0.3s ease-in-out;
  transform: scale(0);
}
.dplayer-controller .dplayer-icons .dplayer-subtitle-btn {
  display: inline-block;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-subtitles {
  display: inline-block;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-subtitles .dplayer-subtitles-box {
  position: absolute;
  right: 0;
  bottom: 50px;
  transform: scale(0);
  width: fit-content;
  max-width: 240px;
  min-width: 120px;
  border-radius: 2px;
  background: rgba(28, 28, 28, 0.9);
  padding: 7px 0;
  transition: all 0.3s ease-in-out;
  overflow: auto;
  z-index: 2;
}
.dplayer-controller .dplayer-icons .dplayer-subtitles .dplayer-subtitles-box.dplayer-subtitles-panel {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-subtitles .dplayer-subtitles-box.dplayer-subtitles-box-open {
  transform: scale(1);
}
.dplayer-controller .dplayer-icons .dplayer-subtitles .dplayer-subtitles-item {
  height: 30px;
  padding: 5px 10px;
  box-sizing: border-box;
  cursor: pointer;
  position: relative;
}
.dplayer-controller .dplayer-icons .dplayer-subtitles .dplayer-subtitles-item:hover {
  background-color: rgba(255, 255, 255, 0.1);
}
.dplayer-controller .dplayer-icons .dplayer-setting {
  display: inline-block;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box {
  position: absolute;
  right: 0;
  bottom: 50px;
  transform: scale(0);
  width: 150px;
  border-radius: 2px;
  background: rgba(28, 28, 28, 0.9);
  padding: 7px 0;
  transition: all 0.3s ease-in-out;
  overflow: hidden;
  z-index: 2;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box > div {
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box > div.dplayer-setting-origin-panel {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box.dplayer-setting-box-open {
  transform: scale(1);
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box.dplayer-setting-box-narrow {
  width: 70px;
  text-align: center;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box.dplayer-setting-box-speed .dplayer-setting-origin-panel {
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box.dplayer-setting-box-speed .dplayer-setting-speed-panel {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-item,
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-speed-item {
  height: 30px;
  padding: 5px 10px;
  box-sizing: border-box;
  cursor: pointer;
  position: relative;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-item:hover,
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-speed-item:hover {
  background-color: rgba(255, 255, 255, 0.1);
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku {
  padding: 5px 0;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-label {
  padding: 0 10px;
  display: inline;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku:hover .dplayer-label {
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku:hover .dplayer-danmaku-bar-wrap {
  display: inline-block;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku.dplayer-setting-danmaku-active .dplayer-label {
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku.dplayer-setting-danmaku-active .dplayer-danmaku-bar-wrap {
  display: inline-block;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-danmaku-bar-wrap {
  padding: 0 10px;
  box-sizing: border-box;
  display: none;
  vertical-align: middle;
  height: 100%;
  width: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-danmaku-bar-wrap .dplayer-danmaku-bar {
  position: relative;
  top: 8.5px;
  width: 100%;
  height: 3px;
  background: #fff;
  transition: all 0.3s ease-in-out;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-danmaku-bar-wrap .dplayer-danmaku-bar .dplayer-danmaku-bar-inner {
  position: absolute;
  bottom: 0;
  left: 0;
  height: 100%;
  transition: all 0.1s ease;
  background: #aaa;
  will-change: width;
}
.dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-danmaku .dplayer-danmaku-bar-wrap .dplayer-danmaku-bar .dplayer-danmaku-bar-inner .dplayer-thumb {
  position: absolute;
  top: 0;
  right: 5px;
  margin-top: -4px;
  margin-right: -10px;
  height: 11px;
  width: 11px;
  border-radius: 50%;
  cursor: pointer;
  transition: all 0.3s ease-in-out;
  background: #aaa;
}
.dplayer-controller .dplayer-icons .dplayer-full {
  display: inline-block;
  height: 100%;
  position: relative;
}
.dplayer-controller .dplayer-icons .dplayer-full:hover .dplayer-full-in-icon {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-full .dplayer-full-in-icon {
  position: absolute;
  top: -30px;
  z-index: 1;
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-quality {
  position: relative;
  display: inline-block;
  height: 100%;
  z-index: 2;
}
.dplayer-controller .dplayer-icons .dplayer-quality:hover .dplayer-quality-list {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-quality:hover .dplayer-quality-mask {
  display: block;
}
.dplayer-controller .dplayer-icons .dplayer-quality .dplayer-quality-mask {
  display: none;
  position: absolute;
  bottom: 38px;
  left: -18px;
  width: 80px;
  padding-bottom: 12px;
}
.dplayer-controller .dplayer-icons .dplayer-quality .dplayer-quality-list {
  display: none;
  font-size: 12px;
  width: 80px;
  border-radius: 2px;
  background: rgba(28, 28, 28, 0.9);
  padding: 5px 0;
  transition: all 0.3s ease-in-out;
  overflow: hidden;
  color: #fff;
  text-align: center;
}
.dplayer-controller .dplayer-icons .dplayer-quality .dplayer-quality-item {
  height: 25px;
  box-sizing: border-box;
  cursor: pointer;
  line-height: 25px;
}
.dplayer-controller .dplayer-icons .dplayer-quality .dplayer-quality-item:hover {
  background-color: rgba(255, 255, 255, 0.1);
}
.dplayer-controller .dplayer-icons .dplayer-comment {
  display: inline-block;
  height: 100%;
}
.dplayer-controller .dplayer-icons .dplayer-label {
  color: #eee;
  font-size: 13px;
  display: inline-block;
  vertical-align: middle;
  white-space: nowrap;
}
.dplayer-controller .dplayer-icons .dplayer-toggle {
  width: 32px;
  height: 20px;
  text-align: center;
  font-size: 0;
  vertical-align: middle;
  position: absolute;
  top: 5px;
  right: 10px;
}
.dplayer-controller .dplayer-icons .dplayer-toggle input {
  max-height: 0;
  max-width: 0;
  display: none;
}
.dplayer-controller .dplayer-icons .dplayer-toggle input + label {
  display: inline-block;
  position: relative;
  box-shadow: #dfdfdf 0 0 0 0 inset;
  border: 1px solid #dfdfdf;
  height: 20px;
  width: 32px;
  border-radius: 10px;
  box-sizing: border-box;
  cursor: pointer;
  transition: 0.2s ease-in-out;
}
.dplayer-controller .dplayer-icons .dplayer-toggle input + label:before {
  content: "";
  position: absolute;
  display: block;
  height: 18px;
  width: 18px;
  top: 0;
  left: 0;
  border-radius: 15px;
  transition: 0.2s ease-in-out;
}
.dplayer-controller .dplayer-icons .dplayer-toggle input + label:after {
  content: "";
  position: absolute;
  display: block;
  left: 0;
  top: 0;
  border-radius: 15px;
  background: #fff;
  transition: 0.2s ease-in-out;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
  height: 18px;
  width: 18px;
}
.dplayer-controller .dplayer-icons .dplayer-toggle input:checked + label {
  border-color: rgba(255, 255, 255, 0.5);
}
.dplayer-controller .dplayer-icons .dplayer-toggle input:checked + label:before {
  width: 30px;
  background: rgba(255, 255, 255, 0.5);
}
.dplayer-controller .dplayer-icons .dplayer-toggle input:checked + label:after {
  left: 12px;
}
.dplayer-mobile-play {
  display: none;
  width: 50px;
  height: 50px;
  border: none;
  background-color: transparent;
  outline: none;
  cursor: pointer;
  box-sizing: border-box;
  bottom: 0;
  opacity: 0.8;
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
}
.dplayer-danmaku {
  position: absolute;
  left: 0;
  right: 0;
  top: 0;
  bottom: 0;
  font-size: 22px;
  color: #fff;
}
.dplayer-danmaku .dplayer-danmaku-item {
  display: inline-block;
  pointer-events: none;
  user-select: none;
  cursor: default;
  white-space: nowrap;
  text-shadow: 0.5px 0.5px 0.5px rgba(0, 0, 0, 0.5);
}
.dplayer-danmaku .dplayer-danmaku-item--demo {
  position: absolute;
  visibility: hidden;
}
.dplayer-danmaku .dplayer-danmaku-right {
  position: absolute;
  right: 0;
  transform: translateX(100%);
}
.dplayer-danmaku .dplayer-danmaku-right.dplayer-danmaku-move {
  will-change: transform;
  animation-name: 'danmaku';
  animation-timing-function: linear;
  animation-play-state: paused;
}
@keyframes danmaku {
  from {
    transform: translateX(100%);
  }
}
.dplayer-danmaku .dplayer-danmaku-top,
.dplayer-danmaku .dplayer-danmaku-bottom {
  position: absolute;
  width: 100%;
  text-align: center;
  visibility: hidden;
}
.dplayer-danmaku .dplayer-danmaku-top.dplayer-danmaku-move,
.dplayer-danmaku .dplayer-danmaku-bottom.dplayer-danmaku-move {
  will-change: visibility;
  animation-name: 'danmaku-center';
  animation-timing-function: linear;
  animation-play-state: paused;
}
@keyframes danmaku-center {
  from {
    visibility: visible;
  }
  to {
    visibility: visible;
  }
}
.dplayer-logo {
  pointer-events: none;
  position: absolute;
  left: 20px;
  top: 20px;
  max-width: 50px;
  max-height: 50px;
}
.dplayer-logo img {
  max-width: 100%;
  max-height: 100%;
  background: none;
}
.dplayer-menu {
  position: absolute;
  width: 170px;
  border-radius: 2px;
  background: rgba(28, 28, 28, 0.85);
  padding: 5px 0;
  overflow: hidden;
  z-index: 3;
  display: none;
}
.dplayer-menu.dplayer-menu-show {
  display: block;
}
.dplayer-menu .dplayer-menu-item {
  height: 30px;
  box-sizing: border-box;
  cursor: pointer;
}
.dplayer-menu .dplayer-menu-item:hover {
  background-color: rgba(255, 255, 255, 0.1);
}
.dplayer-menu .dplayer-menu-item a {
  padding: 0 10px;
  line-height: 30px;
  color: #eee;
  font-size: 13px;
  display: inline-block;
  vertical-align: middle;
  width: 100%;
  box-sizing: border-box;
  white-space: nowrap;
  text-overflow: ellipsis;
  overflow: hidden;
}
.dplayer-menu .dplayer-menu-item a:hover {
  text-decoration: none;
}
.dplayer-notice-list {
  position: absolute;
  bottom: 60px;
  left: 20px;
}
.dplayer-notice-list .dplayer-notice {
  border-radius: 2px;
  background: rgba(28, 28, 28, 0.9);
  transition: all 0.3s ease-in-out;
  overflow: hidden;
  color: #fff;
  display: table;
  pointer-events: none;
  animation: showNotice 0.3s ease 1 forwards;
}
.dplayer-notice-list .remove-notice {
  animation: removeNotice 0.3s ease 1 forwards;
}
@keyframes showNotice {
  from {
    padding: 0;
    font-size: 0;
    margin-top: 0;
  }
  to {
    padding: 7px 20px;
    font-size: 14px;
    margin-top: 5px;
  }
}
@keyframes removeNotice {
  0% {
    padding: 7px 20px;
    font-size: 14px;
    margin-top: 5px;
  }
  20% {
    font-size: 12px;
  }
  21% {
    font-size: 0;
    padding: 7px 10px;
  }
  100% {
    padding: 0;
    margin-top: 0;
    font-size: 0;
  }
}
.dplayer-subtitle {
  position: absolute;
  bottom: 40px;
  width: 90%;
  left: 5%;
  text-align: center;
  color: #fff;
  text-shadow: 0.5px 0.5px 0.5px rgba(0, 0, 0, 0.5);
  font-size: 20px;
}
.dplayer-subtitle.dplayer-subtitle-hide {
  display: none;
}
.dplayer-mask {
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
  z-index: 1;
  display: none;
}
.dplayer-mask.dplayer-mask-show {
  display: block;
}
.dplayer-video-wrap {
  position: relative;
  background: #000;
  font-size: 0;
  width: 100%;
  height: 100%;
}
.dplayer-video-wrap .dplayer-video {
  width: 100%;
  height: 100%;
  display: none;
}
.dplayer-video-wrap .dplayer-video-current {
  display: block;
}
.dplayer-video-wrap .dplayer-video-prepare {
  display: none;
}
.dplayer-info-panel {
  position: absolute;
  top: 10px;
  left: 10px;
  width: 400px;
  background: rgba(28, 28, 28, 0.8);
  padding: 10px;
  color: #fff;
  font-size: 12px;
  border-radius: 2px;
}
.dplayer-info-panel-hide {
  display: none;
}
.dplayer-info-panel .dplayer-info-panel-close {
  cursor: pointer;
  position: absolute;
  right: 10px;
  top: 10px;
}
.dplayer-info-panel .dplayer-info-panel-item > span {
  display: inline-block;
  vertical-align: middle;
  line-height: 15px;
  white-space: nowrap;
  text-overflow: ellipsis;
  overflow: hidden;
}
.dplayer-info-panel .dplayer-info-panel-item-title {
  width: 100px;
  text-align: right;
  margin-right: 10px;
}
.dplayer-info-panel .dplayer-info-panel-item-data {
  width: 260px;
}
`,`.dplayer {
    position: relative;
    overflow: hidden;
    user-select: none;
    line-height: 1;

    * {
        box-sizing: content-box;
    }

    svg {
        width: 100%;
        height: 100%;

        path,
        circle {
            fill: #fff;
        }
    }

    &:-webkit-full-screen {
        width: 100%;
        height: 100%;
        background: #000;
        position: fixed;
        z-index: 100000;
        left: 0;
        top: 0;
        margin: 0;
        padding: 0;
        transform: translate(0, 0);
        
    }

    &.dplayer-no-danmaku {
        .dplayer-controller .dplayer-icons .dplayer-setting .dplayer-setting-box {
            .dplayer-setting-showdan,
            .dplayer-setting-danmaku,
            .dplayer-setting-danunlimit {
                display: none;
            }
        }

        .dplayer-controller .dplayer-icons .dplayer-comment {
            display: none;
        }

        .dplayer-danmaku {
            display: none;
        }
    }

    &.dplayer-live {
        .dplayer-time {
            display: none;
        }
        .dplayer-bar-wrap {
            display: none;
        }
        .dplayer-setting-speed {
            display: none;
        }
        .dplayer-setting-loop {
            display: none;
        }

        &.dplayer-no-danmaku {
            .dplayer-setting {
                display: none;
            }
        }
    }

    &.dplayer-arrow {
        .dplayer-danmaku {
            font-size: 18px;
        }
        .dplayer-icon {
            margin: 0 -3px;
        }
    }

    &.dplayer-playing {
        .dplayer-danmaku .dplayer-danmaku-move {
            animation-play-state: running;
        }

        @media (min-width: 900px) {
            .dplayer-controller-mask {
                opacity: 0;
            }
            .dplayer-controller {
                opacity: 0;
            }

            &:hover {
                .dplayer-controller-mask {
                    opacity: 1;
                }
                .dplayer-controller {
                    opacity: 1;
                }
            }
        }
    }

    &.dplayer-loading {
        .dplayer-bezel .diplayer-loading-icon {
            display: block;
        }
    }

    &.dplayer-loading,
    &.dplayer-paused {
        .dplayer-danmaku,
        .dplayer-danmaku-move {
            animation-play-state: paused;
        }
    }

    &.dplayer-hide-controller {
        cursor: none;

        .dplayer-controller-mask {
            opacity: 0;
            transform: translateY(100%);
        }
        .dplayer-controller {
            opacity: 0;
            transform: translateY(100%);
        }
    }
    &.dplayer-show-controller {
        .dplayer-controller-mask {
            opacity: 1;
        }
        .dplayer-controller {
            opacity: 1;
        }
    }
    &.dplayer-fulled {
        position: fixed;
        z-index: 100000;
        left: 0;
        top: 0;
        width: 100% !important;
        height: 100% !important;
    }
    &.dplayer-mobile {
        .dplayer-controller .dplayer-icons {
            .dplayer-volume,
            .dplayer-camera-icon,
            .dplayer-airplay-icon,
            .dplayer-chromecast-icon,
            .dplayer-play-icon {
                display: none;
            }
            .dplayer-full .dplayer-full-in-icon {
                position: static;
                display: inline-block;
            }
        }

        .dplayer-bar-time {
            display: none;
        }

        &.dplayer-hide-controller {
            .dplayer-mobile-play {
                display: none;
            }
        }

        .dplayer-mobile-play {
            display: block;
        }
    }
}

// To hide scroll bar, apply this class to <body>
.dplayer-web-fullscreen-fix {
    position: fixed;
    top: 0;
    left: 0;
    margin: 0;
    padding: 0;
}
`,`@import '../../node_modules/balloon-css/balloon.css';

[data-balloon]:before {
    display: none;
}

[data-balloon]:after {
    padding: 0.3em 0.7em;
    background: rgba(17, 17, 17, 0.7);
}

[data-balloon][data-balloon-pos="up"]:after {
    margin-bottom: 0;
}`,`.dplayer-bezel {
    position: absolute;
    left: 0;
    right: 0;
    top: 0;
    bottom: 0;
    font-size: 22px;
    color: #fff;
    pointer-events: none;
    .dplayer-bezel-icon {
        position: absolute;
        top: 50%;
        left: 50%;
        margin: -26px 0 0 -26px;
        height: 52px;
        width: 52px;
        padding: 12px;
        box-sizing: border-box;
        background: rgba(0, 0, 0, .5);
        border-radius: 50%;
        opacity: 0;
        pointer-events: none;
        &.dplayer-bezel-transition {
            animation: bezel-hide .5s linear;
        }
        @keyframes bezel-hide {
            from {
                opacity: 1;
                transform: scale(1);
            }
            to {
                opacity: 0;
                transform: scale(2);
            }
        }
    }
    .dplayer-danloading {
        position: absolute;
        top: 50%;
        margin-top: -7px;
        width: 100%;
        text-align: center;
        font-size: 14px;
        line-height: 14px;
        animation: my-face 5s infinite ease-in-out;
    }
    .diplayer-loading-icon {
        display: none;
        position: absolute;
        top: 50%;
        left: 50%;
        margin: -18px 0 0 -18px;
        height: 36px;
        width: 36px;
        pointer-events: none;
        .diplayer-loading-hide {
            display: none;
        }
        .diplayer-loading-dot {
            animation: diplayer-loading-dot-fade .8s ease infinite;
            opacity: 0;
            transform-origin: 4px 4px;
            each(range(7), {
                &.diplayer-loading-dot-@{value} {
                    animation-delay: (@value * 0.1s);
                }
            });
        }
        @keyframes diplayer-loading-dot-fade {
            0% {
                opacity: .7;
                transform: scale(1.2, 1.2)
            }
            50% {
                opacity: .25;
                transform: scale(.9, .9)
            }
            to {
                opacity: .25;
                transform: scale(.85, .85)
            }
        }
    }
}`,`.dplayer-notice-list{
    position: absolute;
    bottom: 60px;
    left: 20px;

    .dplayer-notice {
        border-radius: 2px;
        background: rgba(28, 28, 28, 0.9);
        transition: all .3s ease-in-out;
        overflow: hidden;
        color: #fff;
        display: table;
        pointer-events: none;
        animation: showNotice .3s ease 1 forwards;
    }

    .remove-notice{
        animation: removeNotice .3s ease 1 forwards;
    }
}

@keyframes showNotice {
    from {
        padding: 0;
        font-size: 0;
        margin-top: 0;
    }
    to {
        padding: 7px 20px;
        font-size: 14px;
        margin-top: 5px;
    }
}

@keyframes removeNotice {
    0%{
        padding: 7px 20px;
        font-size: 14px;
        margin-top: 5px;
    }
    20%{
        font-size: 12px;
    }
    21%{
        font-size: 0;
        padding: 7px 10px;
    }
    100%{
        padding: 0;
        margin-top: 0;
        font-size: 0;
    }
}
`,`.dplayer-controller-mask {
    background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAADGCAYAAAAT+OqFAAAAdklEQVQoz42QQQ7AIAgEF/T/D+kbq/RWAlnQyyazA4aoAB4FsBSA/bFjuF1EOL7VbrIrBuusmrt4ZZORfb6ehbWdnRHEIiITaEUKa5EJqUakRSaEYBJSCY2dEstQY7AuxahwXFrvZmWl2rh4JZ07z9dLtesfNj5q0FU3A5ObbwAAAABJRU5ErkJggg==) repeat-x bottom;
    height: 98px;
    width: 100%;
    position: absolute;
    bottom: 0;
    transition: all 0.3s ease;
}

.dplayer-controller {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 41px;
    padding: 0 20px;
    user-select: none;
    transition: all 0.3s ease;
    &.dplayer-controller-comment {
        .dplayer-icons {
            display: none;
        }
        .dplayer-icons.dplayer-comment-box {
            display: block;
        }
    }
    .dplayer-bar-wrap {
        padding: 5px 0;
        cursor: pointer;
        position: absolute;
        bottom: 33px;
        width: calc(100% - 40px);
        height: 3px;
        &:hover {
            .dplayer-bar .dplayer-played .dplayer-thumb {
                transform: scale(1);
            }
            .dplayer-highlight {
                display: block;
                width: 8px;
                transform: translateX(-4px);
                top: 4px;
                height: 40%;
            }
        }
        .dplayer-highlight {
            z-index: 12;
            position: absolute;
            top: 5px;
            width: 6px;
            height: 20%;
            border-radius: 6px;
            background-color: #fff;
            text-align: center;
            transform: translateX(-3px);
            transition: all .2s ease-in-out;
            &:hover {
                .dplayer-highlight-text {
                    display: block;
                }
                &~.dplayer-bar-preview {
                    opacity: 0;
                }
                &~.dplayer-bar-time {
                    opacity: 0;
                }
            }
            .dplayer-highlight-text {
                display: none;
                position: absolute;
                left: 50%;
                top: -24px;
                padding: 5px 8px;
                background-color: rgba(0, 0, 0, .62);
                color: #fff;
                border-radius: 4px;
                font-size: 12px;
                white-space: nowrap;
                transform: translateX(-50%);
            }
        }
        .dplayer-bar-preview {
            position: absolute;
            background: #fff;
            pointer-events: none;
            display: none;
            background-size: 16000px 100%;
        }
        .dplayer-bar-preview-canvas {
            position: absolute;
            width: 100%;
            height: 100%;
            z-index: 1;
            pointer-events: none;
        }
        .dplayer-bar-time {
            &.hidden {
                opacity: 0;
            }
            position: absolute;
            left: 0px;
            top: -20px;
            border-radius: 4px;
            padding: 5px 7px;
            background-color: rgba(0, 0, 0, 0.62);
            color: #fff;
            font-size: 12px;
            text-align: center;
            opacity: 1;
            transition: opacity .1s ease-in-out;
            word-wrap: normal;
            word-break: normal;
            z-index: 2;
            pointer-events: none;
        }
        .dplayer-bar {
            position: relative;
            height: 3px;
            width: 100%;
            background: rgba(255, 255, 255, .2);
            cursor: pointer;
            .dplayer-loaded {
                position: absolute;
                left: 0;
                top: 0;
                bottom: 0;
                background: rgba(255, 255, 255, .4);
                height: 3px;
                transition: all 0.5s ease;
                will-change: width;
            }
            .dplayer-played {
                position: absolute;
                left: 0;
                top: 0;
                bottom: 0;
                height: 3px;
                will-change: width;
                .dplayer-thumb {
                    position: absolute;
                    top: 0;
                    right: 5px;
                    margin-top: -4px;
                    margin-right: -10px;
                    height: 11px;
                    width: 11px;
                    border-radius: 50%;
                    cursor: pointer;
                    transition: all .3s ease-in-out;
                    transform: scale(0);
                }
            }
        }
    }
    .dplayer-icons {
        height: 38px;
        position: absolute;
        bottom: 0;
        &.dplayer-comment-box {
            display: none;
            position: absolute;
            transition: all .3s ease-in-out;
            z-index: 2;
            height: 38px;
            bottom: 0;
            left: 20px;
            right: 20px;
            color: #fff;
            .dplayer-icon {
                padding: 7px;
            }
            .dplayer-comment-setting-icon {
                position: absolute;
                left: 0;
                top: 0;
            }
            .dplayer-send-icon {
                position: absolute;
                right: 0;
                top: 0;
            }
            .dplayer-comment-setting-box {
                position: absolute;
                background: rgba(28, 28, 28, 0.9);
                bottom: 41px;
                left: 0;
                box-shadow: 0 0 25px rgba(0, 0, 0, .3);
                border-radius: 4px;
                padding: 10px 10px 16px;
                font-size: 14px;
                width: 204px;
                transition: all .3s ease-in-out;
                transform: scale(0);
                &.dplayer-comment-setting-open {
                    transform: scale(1);
                }
                input[type=radio] {
                    display: none;
                }
                label {
                    cursor: pointer;
                }
                .dplayer-comment-setting-title {
                    font-size: 13px;
                    color: #fff;
                    line-height: 30px;
                }
                .dplayer-comment-setting-type {
                    font-size: 0;
                    .dplayer-comment-setting-title {
                        margin-bottom: 6px;
                    }
                    label {
                        &:nth-child(2) {
                            span {
                                border-radius: 4px 0 0 4px;
                            }
                        }
                        &:nth-child(4) {
                            span {
                                border-radius: 0 4px 4px 0;
                            }
                        }
                    }
                    span {
                        width: 33%;
                        padding: 4px 6px;
                        line-height: 16px;
                        display: inline-block;
                        font-size: 12px;
                        color: #fff;
                        border: 1px solid #fff;
                        margin-right: -1px;
                        box-sizing: border-box;
                        text-align: center;
                        cursor: pointer;
                    }
                    input:checked+span {
                        background: #E4E4E6;
                        color: #1c1c1c;
                    }
                }
                .dplayer-comment-setting-color {
                    font-size: 0;
                    label {
                        font-size: 0;
                        padding: 6px;
                        display: inline-block;
                    }
                    span {
                        width: 22px;
                        height: 22px;
                        display: inline-block;
                        border-radius: 50%;
                        box-sizing: border-box;
                        cursor: pointer;
                        &:hover {
                            animation: my-face 5s infinite ease-in-out;
                        }
                    }
                }
            }
            .dplayer-comment-input {
                outline: none;
                border: none;
                padding: 8px 31px;
                font-size: 14px;
                line-height: 18px;
                text-align: center;
                border-radius: 4px;
                background: none;
                margin: 0;
                height: 100%;
                box-sizing: border-box;
                width: 100%;
                color: #fff;
                &::placeholder {
                    color: #fff;
                    opacity: 0.8;
                }
                &::-ms-clear {
                    display: none;
                }
            }
        }
        &.dplayer-icons-left {
            .dplayer-icon {
                padding: 7px;
            }
        }
        &.dplayer-icons-right {
            right: 20px;
            .dplayer-icon {
                padding: 8px;
            }
        }
        .dplayer-time,
        .dplayer-live-badge {
            line-height: 38px;
            color: #eee;
            text-shadow: 0 0 2px rgba(0, 0, 0, .5);
            vertical-align: middle;
            font-size: 13px;
            cursor: default;
        }
        .dplayer-live-dot {
            display: inline-block;
            width: 6px;
            height: 6px;
            vertical-align: 4%;
            margin-right: 5px;
            content: '';
            border-radius: 6px;
        }
        .dplayer-icon {
            width: 40px;
            height: 100%;
            border: none;
            background-color: transparent;
            outline: none;
            cursor: pointer;
            vertical-align: middle;
            box-sizing: border-box;
            display: inline-block;
            .dplayer-icon-content {
                transition: all .2s ease-in-out;
                opacity: .8;
            }
            &:hover {
                .dplayer-icon-content {
                    opacity: 1;
                }
            }
            &.dplayer-quality-icon {
                color: #fff;
                width: auto;
                line-height: 22px;
                font-size: 14px;
            }
            &.dplayer-comment-icon {
                padding: 10px 9px 9px;
            }
            &.dplayer-setting-icon {
                padding-top: 8.5px;
            }
            &.dplayer-volume-icon {
                width: 43px;
            }
        }
        .dplayer-volume {
            position: relative;
            display: inline-block;
            cursor: pointer;
            height: 100%;
            &:hover {
                .dplayer-volume-bar-wrap .dplayer-volume-bar {
                    width: 45px;
                }
                .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner .dplayer-thumb {
                    transform: scale(1);
                }
            }
            &.dplayer-volume-active {
                .dplayer-volume-bar-wrap .dplayer-volume-bar {
                    width: 45px;
                }
                .dplayer-volume-bar-wrap .dplayer-volume-bar .dplayer-volume-bar-inner .dplayer-thumb {
                    transform: scale(1);
                }
            }
            .dplayer-volume-bar-wrap {
                display: inline-block;
                margin: 0 10px 0 -5px;
                vertical-align: middle;
                height: 100%;
                .dplayer-volume-bar {
                    position: relative;
                    top: 17px;
                    width: 0;
                    height: 3px;
                    background: #aaa;
                    transition: all 0.3s ease-in-out;
                    .dplayer-volume-bar-inner {
                        position: absolute;
                        bottom: 0;
                        left: 0;
                        height: 100%;
                        transition: all 0.1s ease;
                        will-change: width;
                        .dplayer-thumb {
                            position: absolute;
                            top: 0;
                            right: 5px;
                            margin-top: -4px;
                            margin-right: -10px;
                            height: 11px;
                            width: 11px;
                            border-radius: 50%;
                            cursor: pointer;
                            transition: all .3s ease-in-out;
                            transform: scale(0);
                        }
                    }
                }
            }
        }
        .dplayer-subtitle-btn {
            display: inline-block;
            height: 100%;
        }
        .dplayer-subtitles {
            display: inline-block;
            height: 100%;
            .dplayer-subtitles-box {
                position: absolute;
                right: 0;
                bottom: 50px;
                transform: scale(0);
                width: fit-content;
                max-width: 240px;
                min-width: 120px;
                border-radius: 2px;
                background: rgba(28, 28, 28, 0.9);
                padding: 7px 0;
                transition: all .3s ease-in-out;
                overflow: auto;
                z-index: 2;
                &.dplayer-subtitles-panel {
                    display: block;
                }
                &.dplayer-subtitles-box-open {
                    transform: scale(1);
                }
            }
            .dplayer-subtitles-item {
                height: 30px;
                padding: 5px 10px;
                box-sizing: border-box;
                cursor: pointer;
                position: relative;
                &:hover {
                    background-color: rgba(255, 255, 255, .1);
                }
            }
        }
        .dplayer-setting {
            display: inline-block;
            height: 100%;
            .dplayer-setting-box {
                position: absolute;
                right: 0;
                bottom: 50px;
                transform: scale(0);
                width: 150px;
                border-radius: 2px;
                background: rgba(28, 28, 28, 0.9);
                padding: 7px 0;
                transition: all .3s ease-in-out;
                overflow: hidden;
                z-index: 2;
                &>div {
                    display: none;
                    &.dplayer-setting-origin-panel {
                        display: block;
                    }
                }
                &.dplayer-setting-box-open {
                    transform: scale(1);
                }
                &.dplayer-setting-box-narrow {
                    width: 70px;
                    text-align: center;
                }
                &.dplayer-setting-box-speed {
                    .dplayer-setting-origin-panel {
                        display: none;
                    }
                    .dplayer-setting-speed-panel {
                        display: block;
                    }
                }
            }
            .dplayer-setting-item,
            .dplayer-setting-speed-item {
                height: 30px;
                padding: 5px 10px;
                box-sizing: border-box;
                cursor: pointer;
                position: relative;
                &:hover {
                    background-color: rgba(255, 255, 255, .1);
                }
            }
            .dplayer-setting-danmaku {
                padding: 5px 0;
                .dplayer-label {
                    padding: 0 10px;
                    display: inline;
                }
                &:hover {
                    .dplayer-label {
                        display: none;
                    }
                    .dplayer-danmaku-bar-wrap {
                        display: inline-block;
                    }
                }
                &.dplayer-setting-danmaku-active {
                    .dplayer-label {
                        display: none;
                    }
                    .dplayer-danmaku-bar-wrap {
                        display: inline-block;
                    }
                }
                .dplayer-danmaku-bar-wrap {
                    padding: 0 10px;
                    box-sizing: border-box;
                    display: none;
                    vertical-align: middle;
                    height: 100%;
                    width: 100%;
                    .dplayer-danmaku-bar {
                        position: relative;
                        top: 8.5px;
                        width: 100%;
                        height: 3px;
                        background: #fff;
                        transition: all 0.3s ease-in-out;
                        .dplayer-danmaku-bar-inner {
                            position: absolute;
                            bottom: 0;
                            left: 0;
                            height: 100%;
                            transition: all 0.1s ease;
                            background: #aaa;
                            will-change: width;
                            .dplayer-thumb {
                                position: absolute;
                                top: 0;
                                right: 5px;
                                margin-top: -4px;
                                margin-right: -10px;
                                height: 11px;
                                width: 11px;
                                border-radius: 50%;
                                cursor: pointer;
                                transition: all .3s ease-in-out;
                                background: #aaa;
                            }
                        }
                    }
                }
            }
        }
        .dplayer-full {
            display: inline-block;
            height: 100%;
            position: relative;
            &:hover {
                .dplayer-full-in-icon {
                    display: block;
                }
            }
            .dplayer-full-in-icon {
                position: absolute;
                top: -30px;
                z-index: 1;
                display: none;
            }
        }
        .dplayer-quality {
            position: relative;
            display: inline-block;
            height: 100%;
            z-index: 2;
            &:hover {
                .dplayer-quality-list {
                    display: block;
                }
                .dplayer-quality-mask {
                    display: block;
                }
            }
            .dplayer-quality-mask {
                display: none;
                position: absolute;
                bottom: 38px;
                left: -18px;
                width: 80px;
                padding-bottom: 12px;
            }
            .dplayer-quality-list {
                display: none;
                font-size: 12px;
                width: 80px;
                border-radius: 2px;
                background: rgba(28, 28, 28, 0.9);
                padding: 5px 0;
                transition: all .3s ease-in-out;
                overflow: hidden;
                color: #fff;
                text-align: center;
            }
            .dplayer-quality-item {
                height: 25px;
                box-sizing: border-box;
                cursor: pointer;
                line-height: 25px;
                &:hover {
                    background-color: rgba(255, 255, 255, .1);
                }
            }
        }
        .dplayer-comment {
            display: inline-block;
            height: 100%;
        }
        .dplayer-label {
            color: #eee;
            font-size: 13px;
            display: inline-block;
            vertical-align: middle;
            white-space: nowrap;
        }
        .dplayer-toggle {
            width: 32px;
            height: 20px;
            text-align: center;
            font-size: 0;
            vertical-align: middle;
            position: absolute;
            top: 5px;
            right: 10px;
            input {
                max-height: 0;
                max-width: 0;
                display: none;
            }
            input+label {
                display: inline-block;
                position: relative;
                box-shadow: rgb(223, 223, 223) 0 0 0 0 inset;
                border: 1px solid rgb(223, 223, 223);
                height: 20px;
                width: 32px;
                border-radius: 10px;
                box-sizing: border-box;
                cursor: pointer;
                transition: .2s ease-in-out;
            }
            input+label:before {
                content: "";
                position: absolute;
                display: block;
                height: 18px;
                width: 18px;
                top: 0;
                left: 0;
                border-radius: 15px;
                transition: .2s ease-in-out;
            }
            input+label:after {
                content: "";
                position: absolute;
                display: block;
                left: 0;
                top: 0;
                border-radius: 15px;
                background: #fff;
                transition: .2s ease-in-out;
                box-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
                height: 18px;
                width: 18px;
            }
            input:checked+label {
                border-color: rgba(255, 255, 255, 0.5);
            }
            input:checked+label:before {
                width: 30px;
                background: rgba(255, 255, 255, 0.5);
            }
            input:checked+label:after {
                left: 12px;
            }
        }
    }
}

.dplayer-mobile-play {
    display: none;
    width: 50px;
    height: 50px;
    border: none;
    background-color: transparent;
    outline: none;
    cursor: pointer;
    box-sizing: border-box;
    position: absolute;
    bottom: 0;
    opacity: 0.8;
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
}`,`.dplayer-danmaku {
    position: absolute;
    left: 0;
    right: 0;
    top: 0;
    bottom: 0;
    font-size: 22px;
    color: #fff;
    .dplayer-danmaku-item {
        display: inline-block;
        pointer-events: none;
        user-select: none;
        cursor: default;
        white-space: nowrap;
        text-shadow: .5px .5px .5px rgba(0, 0, 0, .5);
        &--demo {
            position: absolute;
            visibility: hidden;
        }
    }
    .dplayer-danmaku-right {
        position: absolute;
        right: 0;
        transform: translateX(100%);
        &.dplayer-danmaku-move {
            will-change: transform;
            animation-name: 'danmaku';
            animation-timing-function: linear;
            animation-play-state: paused;
        }
    }
    @keyframes danmaku {
        from {
            transform: translateX(100%);
        }
    }
    .dplayer-danmaku-top,
    .dplayer-danmaku-bottom {
        position: absolute;
        width: 100%;
        text-align: center;
        visibility: hidden;
        &.dplayer-danmaku-move {
            will-change: visibility;
            animation-name: 'danmaku-center';
            animation-timing-function: linear;
            animation-play-state: paused;
        }
    }
    @keyframes danmaku-center {
        from {
            visibility: visible;
        }
        to {
            visibility: visible;
        }
    }
}`,`.dplayer-logo {
    pointer-events: none;
    position: absolute;
    left: 20px;
    top: 20px;
    max-width: 50px;
    max-height: 50px;
    img {
        max-width: 100%;
        max-height: 100%;
        background: none;
    }
}`,`.dplayer-menu {
    position: absolute;
    width: 170px;
    border-radius: 2px;
    background: rgba(28, 28, 28, 0.85);
    padding: 5px 0;
    overflow: hidden;
    z-index: 3;
    display: none;
    &.dplayer-menu-show {
        display: block;
    }
    .dplayer-menu-item {
        height: 30px;
        box-sizing: border-box;
        cursor: pointer;
        &:hover {
            background-color: rgba(255, 255, 255, .1);
        }
        a {
            display: inline-block;
            padding: 0 10px;
            line-height: 30px;
            color: #eee;
            font-size: 13px;
            display: inline-block;
            vertical-align: middle;
            width: 100%;
            box-sizing: border-box;
            white-space: nowrap;
            text-overflow: ellipsis;
            overflow: hidden;
            &:hover {
                text-decoration: none;
            }
        }
    }
}`,`.dplayer-subtitle {
    position: absolute;
    bottom: 40px;
    width: 90%;
    left: 5%;
    text-align: center;
    color: #fff;
    text-shadow: 0.5px 0.5px 0.5px rgba(0, 0, 0, 0.5);
    font-size: 20px;
    &.dplayer-subtitle-hide {
        display: none;
    }
}`,`.dplayer-mask {
    position: absolute;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
    z-index: 1;
    display: none;
    &.dplayer-mask-show {
        display: block;
    }
}

.dplayer-video-wrap {
    position: relative;
    background: #000;
    font-size: 0;
    width: 100%;
    height: 100%;
    .dplayer-video {
        width: 100%;
        height: 100%;
        display: none;
    }
    .dplayer-video-current {
        display: block;
    }
    .dplayer-video-prepare {
        display: none;
    }
}`,`.dplayer-info-panel {
    position: absolute;
    top: 10px;
    left: 10px;
    width: 400px;
    background: rgba(28, 28, 28, 0.8);
    padding: 10px;
    color: #fff;
    font-size: 12px;
    border-radius: 2px;

    &-hide {
        display: none;
    }

    .dplayer-info-panel-close {
        cursor: pointer;
        position: absolute;
        right: 10px;
        top: 10px;
    }

    .dplayer-info-panel-item {
        & > span {
            display: inline-block;
            vertical-align: middle;
            line-height: 15px;
            white-space: nowrap;
            text-overflow: ellipsis;
            overflow: hidden;
        }
    }

    .dplayer-info-panel-item-title {
        width: 100px;
        text-align: right;
        margin-right: 10px;
    }
    
    .dplayer-info-panel-item-data {
        width: 260px;
    }
}`],sourceRoot:""}]);const R=S},856:o=>{var a=[];function l(d){for(var f=-1,m=0;m<a.length;m++)if(a[m].identifier===d){f=m;break}return f}function c(d,f){for(var m={},g=[],v=0;v<d.length;v++){var x=d[v],S=f.base?x[0]+f.base:x[0],C=m[S]||0,R="".concat(S," ").concat(C);m[S]=C+1;var k=l(R),I={css:x[1],media:x[2],sourceMap:x[3],supports:x[4],layer:x[5]};if(k!==-1)a[k].references++,a[k].updater(I);else{var F=u(I,f);f.byIndex=v,a.splice(v,0,{identifier:R,updater:F,references:1})}g.push(R)}return g}function u(d,f){var m=f.domAPI(f);return m.update(d),function(g){if(g){if(g.css===d.css&&g.media===d.media&&g.sourceMap===d.sourceMap&&g.supports===d.supports&&g.layer===d.layer)return;m.update(d=g)}else m.remove()}}o.exports=function(d,f){var m=c(d=d||[],f=f||{});return function(g){g=g||[];for(var v=0;v<m.length;v++){var x=l(m[v]);a[x].references--}for(var S=c(g,f),C=0;C<m.length;C++){var R=l(m[C]);a[R].references===0&&(a[R].updater(),a.splice(R,1))}m=S}}},370:o=>{var a={};o.exports=function(l,c){var u=function(d){if(a[d]===void 0){var f=document.querySelector(d);if(window.HTMLIFrameElement&&f instanceof window.HTMLIFrameElement)try{f=f.contentDocument.head}catch{f=null}a[d]=f}return a[d]}(l);if(!u)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");u.appendChild(c)}},278:o=>{o.exports=function(a){var l=document.createElement("style");return a.setAttributes(l,a.attributes),a.insert(l,a.options),l}},458:(o,a,l)=>{o.exports=function(c){var u=l.nc;u&&c.setAttribute("nonce",u)}},470:o=>{o.exports=function(a){var l=a.insertStyleElement(a);return{update:function(c){(function(u,d,f){var m="";f.supports&&(m+="@supports (".concat(f.supports,") {")),f.media&&(m+="@media ".concat(f.media," {"));var g=f.layer!==void 0;g&&(m+="@layer".concat(f.layer.length>0?" ".concat(f.layer):""," {")),m+=f.css,g&&(m+="}"),f.media&&(m+="}"),f.supports&&(m+="}");var v=f.sourceMap;v&&typeof btoa<"u"&&(m+=`
/*# sourceMappingURL=data:application/json;base64,`.concat(btoa(unescape(encodeURIComponent(JSON.stringify(v))))," */")),d.styleTagTransform(m,u,d.options)})(l,a,c)},remove:function(){(function(c){if(c.parentNode===null)return!1;c.parentNode.removeChild(c)})(l)}}}},488:o=>{o.exports=function(a,l){if(l.styleSheet)l.styleSheet.cssText=a;else{for(;l.firstChild;)l.removeChild(l.firstChild);l.appendChild(document.createTextNode(a))}}},251:o=>{o.exports='<svg viewBox="0 0 288 288" xmlns="http://www.w3.org/2000/svg"><path d="M288 90v96c0 20-16 36-36 36h-10c-16 0-16-24 0-24h10c7 0 12-5 12-12V90c0-7-5-12-12-12H36c-7 0-12 5-12 12v96c0 7 5 12 12 12h10c16 0 16 24 0 24H36c-20 0-36-16-36-36V90c0-20 16-36 36-36h216c20 0 36 16 36 36zm-120 62l48 68c14 20 1 38-20 38H92c-21 0-34-18-20-38l48-68c13-18 35-18 48 0z"></path></svg>'},113:o=>{o.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M16 23c-3.309 0-6-2.691-6-6s2.691-6 6-6 6 2.691 6 6-2.691 6-6 6zM16 13c-2.206 0-4 1.794-4 4s1.794 4 4 4c2.206 0 4-1.794 4-4s-1.794-4-4-4zM27 28h-22c-1.654 0-3-1.346-3-3v-16c0-1.654 1.346-3 3-3h3c0.552 0 1 0.448 1 1s-0.448 1-1 1h-3c-0.551 0-1 0.449-1 1v16c0 0.552 0.449 1 1 1h22c0.552 0 1-0.448 1-1v-16c0-0.551-0.448-1-1-1h-11c-0.552 0-1-0.448-1-1s0.448-1 1-1h11c1.654 0 3 1.346 3 3v16c0 1.654-1.346 3-3 3zM24 10.5c0 0.828 0.672 1.5 1.5 1.5s1.5-0.672 1.5-1.5c0-0.828-0.672-1.5-1.5-1.5s-1.5 0.672-1.5 1.5zM15 4c0 0.552-0.448 1-1 1h-4c-0.552 0-1-0.448-1-1v0c0-0.552 0.448-1 1-1h4c0.552 0 1 0.448 1 1v0z"></path></svg>'},193:o=>{o.exports='<svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="chromecast" class="svg-inline--fa fa-chromecast fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M447.8,64H64c-23.6,0-42.7,19.1-42.7,42.7v63.9H64v-63.9h383.8v298.6H298.6V448H448c23.6,0,42.7-19.1,42.7-42.7V106.7 C490.7,83.1,471.4,64,447.8,64z M21.3,383.6L21.3,383.6l0,63.9h63.9C85.2,412.2,56.6,383.6,21.3,383.6L21.3,383.6z M21.3,298.6V341 c58.9,0,106.6,48.1,106.6,107h42.7C170.7,365.6,103.7,298.7,21.3,298.6z M213.4,448h42.7c-0.5-129.5-105.3-234.3-234.8-234.6l0,42.4 C127.3,255.6,213.3,342,213.4,448z"></path></svg>'},338:o=>{o.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M27.090 0.131h-22.731c-2.354 0-4.262 1.839-4.262 4.109v16.401c0 2.269 1.908 4.109 4.262 4.109h4.262v-2.706h8.469l-8.853 8.135 1.579 1.451 7.487-6.88h9.787c2.353 0 4.262-1.84 4.262-4.109v-16.401c0-2.27-1.909-4.109-4.262-4.109v0zM28.511 19.304c0 1.512-1.272 2.738-2.841 2.738h-8.425l-0.076-0.070-0.076 0.070h-11.311c-1.569 0-2.841-1.226-2.841-2.738v-13.696c0-1.513 1.272-2.739 2.841-2.739h19.889c1.569 0 2.841-0.142 2.841 1.37v15.064z"></path></svg>'},807:o=>{o.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M27.128 0.38h-22.553c-2.336 0-4.229 1.825-4.229 4.076v16.273c0 2.251 1.893 4.076 4.229 4.076h4.229v-2.685h8.403l-8.784 8.072 1.566 1.44 7.429-6.827h9.71c2.335 0 4.229-1.825 4.229-4.076v-16.273c0-2.252-1.894-4.076-4.229-4.076zM28.538 19.403c0 1.5-1.262 2.717-2.819 2.717h-8.36l-0.076-0.070-0.076 0.070h-11.223c-1.557 0-2.819-1.217-2.819-2.717v-13.589c0-1.501 1.262-2.718 2.819-2.718h19.734c1.557 0 2.819-0.141 2.819 1.359v14.947zM9.206 10.557c-1.222 0-2.215 0.911-2.215 2.036s0.992 2.035 2.215 2.035c1.224 0 2.216-0.911 2.216-2.035s-0.992-2.036-2.216-2.036zM22.496 10.557c-1.224 0-2.215 0.911-2.215 2.036s0.991 2.035 2.215 2.035c1.224 0 2.215-0.911 2.215-2.035s-0.991-2.036-2.215-2.036zM15.852 10.557c-1.224 0-2.215 0.911-2.215 2.036s0.991 2.035 2.215 2.035c1.222 0 2.215-0.911 2.215-2.035s-0.992-2.036-2.215-2.036z"></path></svg>'},300:o=>{o.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 33"><path d="M24.965 24.38h-18.132c-1.366 0-2.478-1.113-2.478-2.478v-11.806c0-1.364 1.111-2.478 2.478-2.478h18.132c1.366 0 2.478 1.113 2.478 2.478v11.806c0 1.364-1.11 2.478-2.478 2.478zM6.833 10.097v11.806h18.134l-0.002-11.806h-18.132zM2.478 28.928h5.952c0.684 0 1.238-0.554 1.238-1.239 0-0.684-0.554-1.238-1.238-1.238h-5.952v-5.802c0-0.684-0.554-1.239-1.238-1.239s-1.239 0.556-1.239 1.239v5.802c0 1.365 1.111 2.478 2.478 2.478zM30.761 19.412c-0.684 0-1.238 0.554-1.238 1.238v5.801h-5.951c-0.686 0-1.239 0.554-1.239 1.238 0 0.686 0.554 1.239 1.239 1.239h5.951c1.366 0 2.478-1.111 2.478-2.478v-5.801c0-0.683-0.554-1.238-1.239-1.238zM0 5.55v5.802c0 0.683 0.554 1.238 1.238 1.238s1.238-0.555 1.238-1.238v-5.802h5.952c0.684 0 1.238-0.554 1.238-1.238s-0.554-1.238-1.238-1.238h-5.951c-1.366-0.001-2.478 1.111-2.478 2.476zM32 11.35v-5.801c0-1.365-1.11-2.478-2.478-2.478h-5.951c-0.686 0-1.239 0.554-1.239 1.238s0.554 1.238 1.239 1.238h5.951v5.801c0 0.683 0.554 1.237 1.238 1.237 0.686 0.002 1.239-0.553 1.239-1.236z"></path></svg>'},574:o=>{o.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 33"><path d="M6.667 28h-5.333c-0.8 0-1.333-0.533-1.333-1.333v-5.333c0-0.8 0.533-1.333 1.333-1.333s1.333 0.533 1.333 1.333v4h4c0.8 0 1.333 0.533 1.333 1.333s-0.533 1.333-1.333 1.333zM30.667 28h-5.333c-0.8 0-1.333-0.533-1.333-1.333s0.533-1.333 1.333-1.333h4v-4c0-0.8 0.533-1.333 1.333-1.333s1.333 0.533 1.333 1.333v5.333c0 0.8-0.533 1.333-1.333 1.333zM30.667 12c-0.8 0-1.333-0.533-1.333-1.333v-4h-4c-0.8 0-1.333-0.533-1.333-1.333s0.533-1.333 1.333-1.333h5.333c0.8 0 1.333 0.533 1.333 1.333v5.333c0 0.8-0.533 1.333-1.333 1.333zM1.333 12c-0.8 0-1.333-0.533-1.333-1.333v-5.333c0-0.8 0.533-1.333 1.333-1.333h5.333c0.8 0 1.333 0.533 1.333 1.333s-0.533 1.333-1.333 1.333h-4v4c0 0.8-0.533 1.333-1.333 1.333z"></path></svg>'},182:o=>{o.exports='<svg version="1.1" viewBox="0 0 22 22"><svg x="7" y="1"><circle class="diplayer-loading-dot diplayer-loading-dot-0" cx="4" cy="4" r="2"></circle></svg><svg x="11" y="3"><circle class="diplayer-loading-dot diplayer-loading-dot-1" cx="4" cy="4" r="2"></circle></svg><svg x="13" y="7"><circle class="diplayer-loading-dot diplayer-loading-dot-2" cx="4" cy="4" r="2"></circle></svg><svg x="11" y="11"><circle class="diplayer-loading-dot diplayer-loading-dot-3" cx="4" cy="4" r="2"></circle></svg><svg x="7" y="13"><circle class="diplayer-loading-dot diplayer-loading-dot-4" cx="4" cy="4" r="2"></circle></svg><svg x="3" y="11"><circle class="diplayer-loading-dot diplayer-loading-dot-5" cx="4" cy="4" r="2"></circle></svg><svg x="1" y="7"><circle class="diplayer-loading-dot diplayer-loading-dot-6" cx="4" cy="4" r="2"></circle></svg><svg x="3" y="3"><circle class="diplayer-loading-dot diplayer-loading-dot-7" cx="4" cy="4" r="2"></circle></svg></svg>'},965:o=>{o.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M19.357 2.88c1.749 0 3.366 0.316 4.851 0.946 1.485 0.632 2.768 1.474 3.845 2.533s1.922 2.279 2.532 3.661c0.611 1.383 0.915 2.829 0.915 4.334 0 1.425-0.304 2.847-0.915 4.271-0.611 1.425-1.587 2.767-2.928 4.028-0.855 0.813-1.811 1.607-2.869 2.38s-2.136 1.465-3.233 2.075c-1.099 0.61-2.198 1.098-3.296 1.465-1.098 0.366-2.115 0.549-3.051 0.549-1.343 0-2.441-0.438-3.296-1.311-0.854-0.876-1.281-2.41-1.281-4.608 0-0.366 0.020-0.773 0.060-1.221s0.062-0.895 0.062-1.343c0-0.773-0.183-1.353-0.55-1.738-0.366-0.387-0.793-0.58-1.281-0.58-0.652 0-1.21 0.295-1.678 0.886s-0.926 1.23-1.373 1.921c-0.447 0.693-0.905 1.334-1.372 1.923s-1.028 0.886-1.679 0.886c-0.529 0-1.048-0.427-1.556-1.282s-0.763-2.259-0.763-4.212c0-2.197 0.529-4.241 1.587-6.133s2.462-3.529 4.21-4.912c1.75-1.383 3.762-2.471 6.041-3.264 2.277-0.796 4.617-1.212 7.018-1.253zM7.334 15.817c0.569 0 1.047-0.204 1.434-0.611s0.579-0.875 0.579-1.404c0-0.569-0.193-1.047-0.579-1.434s-0.864-0.579-1.434-0.579c-0.529 0-0.987 0.193-1.373 0.579s-0.58 0.864-0.58 1.434c0 0.53 0.194 0.998 0.58 1.404 0.388 0.407 0.845 0.611 1.373 0.611zM12.216 11.79c0.691 0 1.292-0.254 1.8-0.763s0.762-1.107 0.762-1.8c0-0.732-0.255-1.343-0.762-1.831-0.509-0.489-1.109-0.732-1.8-0.732-0.732 0-1.342 0.244-1.831 0.732-0.488 0.488-0.732 1.098-0.732 1.831 0 0.693 0.244 1.292 0.732 1.8s1.099 0.763 1.831 0.763zM16.366 25.947c0.692 0 1.282-0.214 1.77-0.64s0.732-0.987 0.732-1.678-0.244-1.261-0.732-1.709c-0.489-0.448-1.078-0.671-1.77-0.671-0.65 0-1.21 0.223-1.678 0.671s-0.702 1.018-0.702 1.709c0 0.692 0.234 1.25 0.702 1.678s1.027 0.64 1.678 0.64zM19.113 9.592c0.651 0 1.129-0.203 1.433-0.611 0.305-0.406 0.459-0.874 0.459-1.404 0-0.488-0.154-0.947-0.459-1.373-0.304-0.427-0.782-0.641-1.433-0.641-0.529 0-1.008 0.193-1.434 0.58s-0.64 0.865-0.64 1.434c0 0.571 0.213 1.049 0.64 1.434 0.427 0.389 0.905 0.581 1.434 0.581zM24.848 12.826c0.57 0 1.067-0.213 1.495-0.64 0.427-0.427 0.64-0.947 0.64-1.556 0-0.57-0.214-1.068-0.64-1.495-0.428-0.427-0.927-0.64-1.495-0.64-0.611 0-1.129 0.213-1.555 0.64-0.428 0.427-0.642 0.926-0.642 1.495 0 0.611 0.213 1.129 0.642 1.556s0.947 0.64 1.555 0.64z"></path></svg>'},74:o=>{o.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 17 32"><path d="M14.080 4.8q2.88 0 2.88 2.048v18.24q0 2.112-2.88 2.112t-2.88-2.112v-18.24q0-2.048 2.88-2.048zM2.88 4.8q2.88 0 2.88 2.048v18.24q0 2.112-2.88 2.112t-2.88-2.112v-18.24q0-2.048 2.88-2.048z"></path></svg>'},730:o=>{o.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 16 32"><path d="M15.552 15.168q0.448 0.32 0.448 0.832 0 0.448-0.448 0.768l-13.696 8.512q-0.768 0.512-1.312 0.192t-0.544-1.28v-16.448q0-0.96 0.544-1.28t1.312 0.192z"></path></svg>'},428:o=>{o.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M22 16l-10.105-10.6-1.895 1.987 8.211 8.613-8.211 8.612 1.895 1.988 8.211-8.613z"></path></svg>'},254:o=>{o.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M13.725 30l3.9-5.325-3.9-1.125v6.45zM0 17.5l11.050 3.35 13.6-11.55-10.55 12.425 11.8 3.65 6.1-23.375-32 15.5z"></path></svg>'},934:o=>{o.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 28"><path d="M28.633 17.104c0.035 0.21 0.026 0.463-0.026 0.76s-0.14 0.598-0.262 0.904c-0.122 0.306-0.271 0.581-0.445 0.825s-0.367 0.419-0.576 0.524c-0.209 0.105-0.393 0.157-0.55 0.157s-0.332-0.035-0.524-0.105c-0.175-0.052-0.393-0.1-0.655-0.144s-0.528-0.052-0.799-0.026c-0.271 0.026-0.541 0.083-0.812 0.17s-0.502 0.236-0.694 0.445c-0.419 0.437-0.664 0.934-0.734 1.493s0.009 1.092 0.236 1.598c0.175 0.349 0.148 0.699-0.079 1.048-0.105 0.14-0.271 0.284-0.498 0.432s-0.476 0.284-0.747 0.406-0.555 0.218-0.851 0.288c-0.297 0.070-0.559 0.105-0.786 0.105-0.157 0-0.306-0.061-0.445-0.183s-0.236-0.253-0.288-0.393h-0.026c-0.192-0.541-0.52-1.009-0.982-1.402s-1-0.589-1.611-0.589c-0.594 0-1.131 0.197-1.611 0.589s-0.816 0.851-1.009 1.375c-0.087 0.21-0.218 0.362-0.393 0.458s-0.367 0.144-0.576 0.144c-0.244 0-0.52-0.044-0.825-0.131s-0.611-0.197-0.917-0.327c-0.306-0.131-0.581-0.284-0.825-0.458s-0.428-0.349-0.55-0.524c-0.087-0.122-0.135-0.266-0.144-0.432s0.057-0.397 0.197-0.694c0.192-0.402 0.266-0.86 0.223-1.375s-0.266-0.991-0.668-1.428c-0.244-0.262-0.541-0.432-0.891-0.511s-0.681-0.109-0.995-0.092c-0.367 0.017-0.742 0.087-1.127 0.21-0.244 0.070-0.489 0.052-0.734-0.052-0.192-0.070-0.371-0.231-0.537-0.485s-0.314-0.533-0.445-0.838c-0.131-0.306-0.231-0.62-0.301-0.943s-0.087-0.59-0.052-0.799c0.052-0.384 0.227-0.629 0.524-0.734 0.524-0.21 0.995-0.555 1.415-1.035s0.629-1.017 0.629-1.611c0-0.611-0.21-1.144-0.629-1.598s-0.891-0.786-1.415-0.996c-0.157-0.052-0.288-0.179-0.393-0.38s-0.157-0.406-0.157-0.616c0-0.227 0.035-0.48 0.105-0.76s0.162-0.55 0.275-0.812 0.244-0.502 0.393-0.72c0.148-0.218 0.31-0.38 0.485-0.485 0.14-0.087 0.275-0.122 0.406-0.105s0.275 0.052 0.432 0.105c0.524 0.21 1.070 0.275 1.637 0.197s1.070-0.327 1.506-0.747c0.21-0.209 0.362-0.467 0.458-0.773s0.157-0.607 0.183-0.904c0.026-0.297 0.026-0.568 0-0.812s-0.048-0.419-0.065-0.524c-0.035-0.105-0.066-0.227-0.092-0.367s-0.013-0.262 0.039-0.367c0.105-0.244 0.293-0.458 0.563-0.642s0.563-0.336 0.878-0.458c0.314-0.122 0.62-0.214 0.917-0.275s0.533-0.092 0.707-0.092c0.227 0 0.406 0.074 0.537 0.223s0.223 0.301 0.275 0.458c0.192 0.471 0.507 0.886 0.943 1.244s0.952 0.537 1.546 0.537c0.611 0 1.153-0.17 1.624-0.511s0.803-0.773 0.996-1.297c0.070-0.14 0.179-0.284 0.327-0.432s0.301-0.223 0.458-0.223c0.244 0 0.511 0.035 0.799 0.105s0.572 0.166 0.851 0.288c0.279 0.122 0.537 0.279 0.773 0.472s0.423 0.402 0.563 0.629c0.087 0.14 0.113 0.293 0.079 0.458s-0.070 0.284-0.105 0.354c-0.227 0.506-0.297 1.039-0.21 1.598s0.341 1.048 0.76 1.467c0.419 0.419 0.934 0.651 1.546 0.694s1.179-0.057 1.703-0.301c0.14-0.087 0.31-0.122 0.511-0.105s0.371 0.096 0.511 0.236c0.262 0.244 0.493 0.616 0.694 1.113s0.336 1 0.406 1.506c0.035 0.297-0.013 0.528-0.144 0.694s-0.266 0.275-0.406 0.327c-0.542 0.192-1.004 0.528-1.388 1.009s-0.576 1.026-0.576 1.637c0 0.594 0.162 1.113 0.485 1.559s0.747 0.764 1.27 0.956c0.122 0.070 0.227 0.14 0.314 0.21 0.192 0.157 0.323 0.358 0.393 0.602v0zM16.451 19.462c0.786 0 1.528-0.149 2.227-0.445s1.305-0.707 1.821-1.231c0.515-0.524 0.921-1.131 1.218-1.821s0.445-1.428 0.445-2.214c0-0.786-0.148-1.524-0.445-2.214s-0.703-1.292-1.218-1.808c-0.515-0.515-1.122-0.921-1.821-1.218s-1.441-0.445-2.227-0.445c-0.786 0-1.524 0.148-2.214 0.445s-1.292 0.703-1.808 1.218c-0.515 0.515-0.921 1.118-1.218 1.808s-0.445 1.428-0.445 2.214c0 0.786 0.149 1.524 0.445 2.214s0.703 1.297 1.218 1.821c0.515 0.524 1.118 0.934 1.808 1.231s1.428 0.445 2.214 0.445v0z"></path></svg>'},410:o=>{o.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M26.667 5.333h-21.333c-0 0-0.001 0-0.001 0-1.472 0-2.666 1.194-2.666 2.666 0 0 0 0.001 0 0.001v-0 16c0 0 0 0.001 0 0.001 0 1.472 1.194 2.666 2.666 2.666 0 0 0.001 0 0.001 0h21.333c0 0 0.001 0 0.001 0 1.472 0 2.666-1.194 2.666-2.666 0-0 0-0.001 0-0.001v0-16c0-0 0-0.001 0-0.001 0-1.472-1.194-2.666-2.666-2.666-0 0-0.001 0-0.001 0h0zM5.333 16h5.333v2.667h-5.333v-2.667zM18.667 24h-13.333v-2.667h13.333v2.667zM26.667 24h-5.333v-2.667h5.333v2.667zM26.667 18.667h-13.333v-2.667h13.333v2.667z"></path></svg>'},644:o=>{o.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 21 32"><path d="M13.728 6.272v19.456q0 0.448-0.352 0.8t-0.8 0.32-0.8-0.32l-5.952-5.952h-4.672q-0.48 0-0.8-0.352t-0.352-0.8v-6.848q0-0.48 0.352-0.8t0.8-0.352h4.672l5.952-5.952q0.32-0.32 0.8-0.32t0.8 0.32 0.352 0.8zM20.576 16q0 1.344-0.768 2.528t-2.016 1.664q-0.16 0.096-0.448 0.096-0.448 0-0.8-0.32t-0.32-0.832q0-0.384 0.192-0.64t0.544-0.448 0.608-0.384 0.512-0.64 0.192-1.024-0.192-1.024-0.512-0.64-0.608-0.384-0.544-0.448-0.192-0.64q0-0.48 0.32-0.832t0.8-0.32q0.288 0 0.448 0.096 1.248 0.48 2.016 1.664t0.768 2.528z"></path></svg>'},324:o=>{o.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 21 32"><path d="M13.728 6.272v19.456q0 0.448-0.352 0.8t-0.8 0.32-0.8-0.32l-5.952-5.952h-4.672q-0.48 0-0.8-0.352t-0.352-0.8v-6.848q0-0.48 0.352-0.8t0.8-0.352h4.672l5.952-5.952q0.32-0.32 0.8-0.32t0.8 0.32 0.352 0.8z"></path></svg>'},437:o=>{o.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 21 32"><path d="M13.728 6.272v19.456q0 0.448-0.352 0.8t-0.8 0.32-0.8-0.32l-5.952-5.952h-4.672q-0.48 0-0.8-0.352t-0.352-0.8v-6.848q0-0.48 0.352-0.8t0.8-0.352h4.672l5.952-5.952q0.32-0.32 0.8-0.32t0.8 0.32 0.352 0.8zM20.576 16q0 1.344-0.768 2.528t-2.016 1.664q-0.16 0.096-0.448 0.096-0.448 0-0.8-0.32t-0.32-0.832q0-0.384 0.192-0.64t0.544-0.448 0.608-0.384 0.512-0.64 0.192-1.024-0.192-1.024-0.512-0.64-0.608-0.384-0.544-0.448-0.192-0.64q0-0.48 0.32-0.832t0.8-0.32q0.288 0 0.448 0.096 1.248 0.48 2.016 1.664t0.768 2.528zM25.152 16q0 2.72-1.536 5.056t-4 3.36q-0.256 0.096-0.448 0.096-0.48 0-0.832-0.352t-0.32-0.8q0-0.704 0.672-1.056 1.024-0.512 1.376-0.8 1.312-0.96 2.048-2.4t0.736-3.104-0.736-3.104-2.048-2.4q-0.352-0.288-1.376-0.8-0.672-0.352-0.672-1.056 0-0.448 0.32-0.8t0.8-0.352q0.224 0 0.48 0.096 2.496 1.056 4 3.36t1.536 5.056z"></path></svg>'},897:(o,a,l)=>{var c=typeof self<"u"?self:typeof window<"u"?window:l.g!==void 0?l.g:{},u=Object.create(c),d=/["&'<>]/;function f(m){return typeof m!="string"&&(m=m==null?"":typeof m=="function"?f(m.call(m)):JSON.stringify(m)),m}u.$escape=function(m){return function(g){var v=""+g,x=d.exec(v);if(!x)return g;var S="",C=void 0,R=void 0,k=void 0;for(C=x.index,R=0;C<v.length;C++){switch(v.charCodeAt(C)){case 34:k="&#34;";break;case 38:k="&#38;";break;case 39:k="&#39;";break;case 60:k="&#60;";break;case 62:k="&#62;";break;default:continue}R!==C&&(S+=v.substring(R,C)),R=C+1,S+=k}return R!==C?S+v.substring(R,C):S}(f(m))},u.$each=function(m,g){if(Array.isArray(m))for(var v=0,x=m.length;v<x;v++)g(m[v],v);else for(var S in m)g(m[S],S)},o.exports=u},471:(o,a,l)=>{o.exports=l(897)},352:o=>{o.exports=function(a){var l=[];return l.toString=function(){return this.map(function(c){var u="",d=c[5]!==void 0;return c[4]&&(u+="@supports (".concat(c[4],") {")),c[2]&&(u+="@media ".concat(c[2]," {")),d&&(u+="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {")),u+=a(c),d&&(u+="}"),c[2]&&(u+="}"),c[4]&&(u+="}"),u}).join("")},l.i=function(c,u,d,f,m){typeof c=="string"&&(c=[[null,c,void 0]]);var g={};if(d)for(var v=0;v<this.length;v++){var x=this[v][0];x!=null&&(g[x]=!0)}for(var S=0;S<c.length;S++){var C=[].concat(c[S]);d&&g[C[0]]||(m!==void 0&&(C[5]===void 0||(C[1]="@layer".concat(C[5].length>0?" ".concat(C[5]):""," {").concat(C[1],"}")),C[5]=m),u&&(C[2]&&(C[1]="@media ".concat(C[2]," {").concat(C[1],"}")),C[2]=u),f&&(C[4]?(C[1]="@supports (".concat(C[4],") {").concat(C[1],"}"),C[4]=f):C[4]="".concat(f)),l.push(C))}},l}},80:o=>{o.exports=function(a,l){return l||(l={}),a&&(a=String(a.__esModule?a.default:a),/^['"].*['"]$/.test(a)&&(a=a.slice(1,-1)),l.hash&&(a+=l.hash),/["'() \t\n]|(%20)/.test(a)||l.needQuotes?'"'.concat(a.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):a)}},415:o=>{o.exports=function(a){var l=a[1],c=a[3];if(!c)return l;if(typeof btoa=="function"){var u=btoa(unescape(encodeURIComponent(JSON.stringify(c)))),d="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(u),f="/*# ".concat(d," */");return[l].concat([f]).join(`
`)}return[l].join(`
`)}},937:o=>{function a(l){return a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(c){return typeof c}:function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},a(l)}o.exports=(typeof self>"u"?"undefined":a(self))=="object"?self.FormData:window.FormData},831:o=>{o.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAADGCAYAAAAT+OqFAAAAdklEQVQoz42QQQ7AIAgEF/T/D+kbq/RWAlnQyyazA4aoAB4FsBSA/bFjuF1EOL7VbrIrBuusmrt4ZZORfb6ehbWdnRHEIiITaEUKa5EJqUakRSaEYBJSCY2dEstQY7AuxahwXFrvZmWl2rh4JZ07z9dLtesfNj5q0FU3A5ObbwAAAABJRU5ErkJggg=="}},r={};function i(o){var a=r[o];if(a!==void 0)return a.exports;var l=r[o]={id:o,exports:{}};return t[o](l,l.exports,i),l.exports}i.m=t,i.n=o=>{var a=o&&o.__esModule?()=>o.default:()=>o;return i.d(a,{a}),a},i.d=(o,a)=>{for(var l in a)i.o(a,l)&&!i.o(o,l)&&Object.defineProperty(o,l,{enumerable:!0,get:a[l]})},i.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),i.o=(o,a)=>Object.prototype.hasOwnProperty.call(o,a),i.b=document.baseURI||self.location.href,i.nc=void 0;var s={};return(()=>{i.d(s,{default:()=>Vi});var o=i(856),a=i.n(o),l=i(470),c=i.n(l),u=i(370),d=i.n(u),f=i(458),m=i.n(f),g=i(278),v=i.n(g),x=i(488),S=i.n(x),C=i(685),R={};R.styleTagTransform=S(),R.setAttributes=m(),R.insert=d().bind(null,"head"),R.domAPI=c(),R.insertStyleElement=v(),a()(C.Z,R),C.Z&&C.Z.locals&&C.Z.locals;function k(A){return k=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},k(A)}function I(A,b){this.name="AggregateError",this.errors=A,this.message=b||""}I.prototype=Error.prototype;function F(A){return F=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},F(A)}var N=setTimeout;function U(A){return!!(A&&A.length!==void 0)}function M(){}function B(A){if(!(this instanceof B))throw new TypeError("Promises must be constructed via new");if(typeof A!="function")throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],Z(A,this)}function H(A,b){for(;A._state===3;)A=A._value;A._state!==0?(A._handled=!0,B._immediateFn(function(){var T=A._state===1?b.onFulfilled:b.onRejected;if(T!==null){var y;try{y=T(A._value)}catch(E){return void Y(b.promise,E)}K(b.promise,y)}else(A._state===1?K:Y)(b.promise,A._value)})):A._deferreds.push(b)}function K(A,b){try{if(b===A)throw new TypeError("A promise cannot be resolved with itself.");if(b&&(F(b)==="object"||typeof b=="function")){var T=b.then;if(b instanceof B)return A._state=3,A._value=b,void oe(A);if(typeof T=="function")return void Z((y=T,E=b,function(){y.apply(E,arguments)}),A)}A._state=1,A._value=b,oe(A)}catch(_){Y(A,_)}var y,E}function Y(A,b){A._state=2,A._value=b,oe(A)}function oe(A){A._state===2&&A._deferreds.length===0&&B._immediateFn(function(){A._handled||B._unhandledRejectionFn(A._value)});for(var b=0,T=A._deferreds.length;b<T;b++)H(A,A._deferreds[b]);A._deferreds=null}function ue(A,b,T){this.onFulfilled=typeof A=="function"?A:null,this.onRejected=typeof b=="function"?b:null,this.promise=T}function Z(A,b){var T=!1;try{A(function(y){T||(T=!0,K(b,y))},function(y){T||(T=!0,Y(b,y))})}catch(y){if(T)return;T=!0,Y(b,y)}}B.prototype.catch=function(A){return this.then(null,A)},B.prototype.then=function(A,b){var T=new this.constructor(M);return H(this,new ue(A,b,T)),T},B.prototype.finally=function(A){var b=this.constructor;return this.then(function(T){return b.resolve(A()).then(function(){return T})},function(T){return b.resolve(A()).then(function(){return b.reject(T)})})},B.all=function(A){return new B(function(b,T){if(!U(A))return T(new TypeError("Promise.all accepts an array"));var y=Array.prototype.slice.call(A);if(y.length===0)return b([]);var E=y.length;function _(L,P){try{if(P&&(F(P)==="object"||typeof P=="function")){var V=P.then;if(typeof V=="function")return void V.call(P,function(z){_(L,z)},T)}y[L]=P,--E==0&&b(y)}catch(z){T(z)}}for(var w=0;w<y.length;w++)_(w,y[w])})},B.any=function(A){var b=this;return new b(function(T,y){if(!A||A.length===void 0)return y(new TypeError("Promise.any accepts an array"));var E=Array.prototype.slice.call(A);if(E.length===0)return y();for(var _=[],w=0;w<E.length;w++)try{b.resolve(E[w]).then(T).catch(function(L){_.push(L),_.length===E.length&&y(new I(_,"All promises were rejected"))})}catch(L){y(L)}})},B.allSettled=function(A){return new this(function(b,T){if(!A||A.length===void 0)return T(new TypeError(k(A)+" "+A+" is not iterable(cannot read property Symbol(Symbol.iterator))"));var y=Array.prototype.slice.call(A);if(y.length===0)return b([]);var E=y.length;function _(L,P){if(P&&(k(P)==="object"||typeof P=="function")){var V=P.then;if(typeof V=="function")return void V.call(P,function(z){_(L,z)},function(z){y[L]={status:"rejected",reason:z},--E==0&&b(y)})}y[L]={status:"fulfilled",value:P},--E==0&&b(y)}for(var w=0;w<y.length;w++)_(w,y[w])})},B.resolve=function(A){return A&&F(A)==="object"&&A.constructor===B?A:new B(function(b){b(A)})},B.reject=function(A){return new B(function(b,T){T(A)})},B.race=function(A){return new B(function(b,T){if(!U(A))return T(new TypeError("Promise.race accepts an array"));for(var y=0,E=A.length;y<E;y++)B.resolve(A[y]).then(b,T)})},B._immediateFn=typeof setImmediate=="function"&&function(A){setImmediate(A)}||function(A){N(A,0)},B._unhandledRejectionFn=function(A){typeof console<"u"&&console&&console.warn("Possible Unhandled Promise Rejection:",A)};const Ae=B;var ye=/mobile/i.test(window.navigator.userAgent);const $={secondToTime:function(A){if((A=A||0)===0||A===1/0||A.toString()==="NaN")return"00:00";var b=Math.floor(A/3600),T=Math.floor((A-3600*b)/60),y=Math.floor(A-3600*b-60*T);return(b>0?[b,T,y]:[T,y]).map(function(E){return E<10?"0"+E:""+E}).join(":")},getElementViewLeft:function(A){var b=A.offsetLeft,T=A.offsetParent,y=document.body.scrollLeft+document.documentElement.scrollLeft;if(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement)for(;T!==null&&T!==A;)b+=T.offsetLeft,T=T.offsetParent;else for(;T!==null;)b+=T.offsetLeft,T=T.offsetParent;return b-y},getBoundingClientRectViewLeft:function(A){var b=window.scrollY||window.pageYOffset||document.body.scrollTop+(document.documentElement&&document.documentElement.scrollTop||0);if(A.getBoundingClientRect){if(typeof this.getBoundingClientRectViewLeft.offset!="number"){var T=document.createElement("div");T.style.cssText="position:absolute;top:0;left:0;",document.body.appendChild(T),this.getBoundingClientRectViewLeft.offset=-T.getBoundingClientRect().top-b,document.body.removeChild(T),T=null}var y=A.getBoundingClientRect(),E=this.getBoundingClientRectViewLeft.offset;return y.left+E}return this.getElementViewLeft(A)},getScrollPosition:function(){return{left:window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0,top:window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0}},setScrollPosition:function(A){var b=A.left,T=b===void 0?0:b,y=A.top,E=y===void 0?0:y;this.isFirefox?(document.documentElement.scrollLeft=T,document.documentElement.scrollTop=E):window.scrollTo(T,E)},isMobile:ye,isFirefox:/firefox/i.test(window.navigator.userAgent),isChrome:/chrome/i.test(window.navigator.userAgent),isSafari:/safari/i.test(window.navigator.userAgent),storage:{set:function(A,b){localStorage.setItem(A,b)},get:function(A){return localStorage.getItem(A)}},nameMap:{dragStart:ye?"touchstart":"mousedown",dragMove:ye?"touchmove":"mousemove",dragEnd:ye?"touchend":"mouseup"},color2Number:function(A){return A[0]==="#"&&(A=A.substr(1)),A.length===3&&(A="".concat(A[0]).concat(A[0]).concat(A[1]).concat(A[1]).concat(A[2]).concat(A[2])),parseInt(A,16)+0&16777215},number2Color:function(A){return"#"+("00000"+A.toString(16)).slice(-6)},number2Type:function(A){switch(A){case 0:default:return"right";case 1:return"top";case 2:return"bottom"}}};function W(A,b){return function(){return A.apply(b,arguments)}}function J(A){return J=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},J(A)}var ne,ve=Object.prototype.toString,Re=Object.getPrototypeOf,Le=(ne=Object.create(null),function(A){var b=ve.call(A);return ne[b]||(ne[b]=b.slice(8,-1).toLowerCase())}),Ce=function(A){return A=A.toLowerCase(),function(b){return Le(b)===A}},j=function(A){return function(b){return J(b)===A}},ae=Array.isArray,ie=j("undefined"),Ee=Ce("ArrayBuffer"),Pe=j("string"),De=j("function"),D=j("number"),O=function(A){return A!==null&&J(A)==="object"},G=function(A){if(Le(A)!=="object")return!1;var b=Re(A);return!(b!==null&&b!==Object.prototype&&Object.getPrototypeOf(b)!==null||Symbol.toStringTag in A||Symbol.iterator in A)},X=Ce("Date"),Q=Ce("File"),ee=Ce("Blob"),he=Ce("FileList"),de=Ce("URLSearchParams");function se(A,b){var T,y,E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},_=E.allOwnKeys,w=_!==void 0&&_;if(A!=null)if(J(A)!=="object"&&(A=[A]),ae(A))for(T=0,y=A.length;T<y;T++)b.call(null,A[T],T,A);else{var L,P=w?Object.getOwnPropertyNames(A):Object.keys(A),V=P.length;for(T=0;T<V;T++)L=P[T],b.call(null,A[L],L,A)}}function te(A,b){b=b.toLowerCase();for(var T,y=Object.keys(A),E=y.length;E-- >0;)if(b===(T=y[E]).toLowerCase())return T;return null}var _e,me,xe=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:commonjsGlobal,Se=function(A){return!ie(A)&&A!==xe},ke=(_e=typeof Uint8Array<"u"&&Re(Uint8Array),function(A){return _e&&A instanceof _e}),Oe=Ce("HTMLFormElement"),Ie=(me=Object.prototype.hasOwnProperty,function(A,b){return me.call(A,b)}),Ge=Ce("RegExp"),Ue=function(A,b){var T=Object.getOwnPropertyDescriptors(A),y={};se(T,function(E,_){b(E,_,A)!==!1&&(y[_]=E)}),Object.defineProperties(A,y)};const q={isArray:ae,isArrayBuffer:Ee,isBuffer:function(A){return A!==null&&!ie(A)&&A.constructor!==null&&!ie(A.constructor)&&De(A.constructor.isBuffer)&&A.constructor.isBuffer(A)},isFormData:function(A){var b="[object FormData]";return A&&(typeof FormData=="function"&&A instanceof FormData||ve.call(A)===b||De(A.toString)&&A.toString()===b)},isArrayBufferView:function(A){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(A):A&&A.buffer&&Ee(A.buffer)},isString:Pe,isNumber:D,isBoolean:function(A){return A===!0||A===!1},isObject:O,isPlainObject:G,isUndefined:ie,isDate:X,isFile:Q,isBlob:ee,isRegExp:Ge,isFunction:De,isStream:function(A){return O(A)&&De(A.pipe)},isURLSearchParams:de,isTypedArray:ke,isFileList:he,forEach:se,merge:function A(){for(var b=Se(this)&&this||{},T=b.caseless,y={},E=function(L,P){var V=T&&te(y,P)||P;G(y[V])&&G(L)?y[V]=A(y[V],L):G(L)?y[V]=A({},L):ae(L)?y[V]=L.slice():y[V]=L},_=0,w=arguments.length;_<w;_++)arguments[_]&&se(arguments[_],E);return y},extend:function(A,b,T){var y=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},E=y.allOwnKeys;return se(b,function(_,w){T&&De(_)?A[w]=W(_,T):A[w]=_},{allOwnKeys:E}),A},trim:function(A){return A.trim?A.trim():A.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},stripBOM:function(A){return A.charCodeAt(0)===65279&&(A=A.slice(1)),A},inherits:function(A,b,T,y){A.prototype=Object.create(b.prototype,y),A.prototype.constructor=A,Object.defineProperty(A,"super",{value:b.prototype}),T&&Object.assign(A.prototype,T)},toFlatObject:function(A,b,T,y){var E,_,w,L={};if(b=b||{},A==null)return b;do{for(_=(E=Object.getOwnPropertyNames(A)).length;_-- >0;)w=E[_],y&&!y(w,A,b)||L[w]||(b[w]=A[w],L[w]=!0);A=T!==!1&&Re(A)}while(A&&(!T||T(A,b))&&A!==Object.prototype);return b},kindOf:Le,kindOfTest:Ce,endsWith:function(A,b,T){A=String(A),(T===void 0||T>A.length)&&(T=A.length),T-=b.length;var y=A.indexOf(b,T);return y!==-1&&y===T},toArray:function(A){if(!A)return null;if(ae(A))return A;var b=A.length;if(!D(b))return null;for(var T=new Array(b);b-- >0;)T[b]=A[b];return T},forEachEntry:function(A,b){for(var T,y=(A&&A[Symbol.iterator]).call(A);(T=y.next())&&!T.done;){var E=T.value;b.call(A,E[0],E[1])}},matchAll:function(A,b){for(var T,y=[];(T=A.exec(b))!==null;)y.push(T);return y},isHTMLForm:Oe,hasOwnProperty:Ie,hasOwnProp:Ie,reduceDescriptors:Ue,freezeMethods:function(A){Ue(A,function(b,T){if(De(A)&&["arguments","caller","callee"].indexOf(T)!==-1)return!1;var y=A[T];De(y)&&(b.enumerable=!1,"writable"in b?b.writable=!1:b.set||(b.set=function(){throw Error("Can not rewrite read-only method '"+T+"'")}))})},toObjectSet:function(A,b){var T={},y=function(E){E.forEach(function(_){T[_]=!0})};return ae(A)?y(A):y(String(A).split(b)),T},toCamelCase:function(A){return A.toLowerCase().replace(/[_-\s]([a-z\d])(\w*)/g,function(b,T,y){return T.toUpperCase()+y})},noop:function(){},toFiniteNumber:function(A,b){return A=+A,Number.isFinite(A)?A:b},findKey:te,global:xe,isContextDefined:Se,toJSONObject:function(A){var b=new Array(10);return function T(y,E){if(O(y)){if(b.indexOf(y)>=0)return;if(!("toJSON"in y)){b[E]=y;var _=ae(y)?[]:{};return se(y,function(w,L){var P=T(w,E+1);!ie(P)&&(_[L]=P)}),b[E]=void 0,_}}return y}(A,0)}};function Me(A,b,T,y,E){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=A,this.name="AxiosError",b&&(this.code=b),T&&(this.config=T),y&&(this.request=y),E&&(this.response=E)}q.inherits(Me,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:q.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var Xe=Me.prototype,ut={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(function(A){ut[A]={value:A}}),Object.defineProperties(Me,ut),Object.defineProperty(Xe,"isAxiosError",{value:!0}),Me.from=function(A,b,T,y,E,_){var w=Object.create(Xe);return q.toFlatObject(A,w,function(L){return L!==Error.prototype},function(L){return L!=="isAxiosError"}),Me.call(w,A.message,b,T,y,E),w.cause=A,w.name=A.name,_&&Object.assign(w,_),w};const we=Me,je=i(937);function rt(A){return rt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},rt(A)}function Kt(A){return q.isPlainObject(A)||q.isArray(A)}function sn(A){return q.endsWith(A,"[]")?A.slice(0,-2):A}function on(A,b,T){return A?A.concat(b).map(function(y,E){return y=sn(y),!T&&E?"["+y+"]":y}).join(T?".":""):b}var Un=q.toFlatObject(q,{},null,function(A){return/^is[A-Z]/.test(A)});const Nt=function(A,b,T){if(!q.isObject(A))throw new TypeError("target must be an object");b=b||new(je||FormData);var y,E=(T=q.toFlatObject(T,{metaTokens:!0,dots:!1,indexes:!1},!1,function(ge,pe){return!q.isUndefined(pe[ge])})).metaTokens,_=T.visitor||z,w=T.dots,L=T.indexes,P=(T.Blob||typeof Blob<"u"&&Blob)&&(y=b)&&q.isFunction(y.append)&&y[Symbol.toStringTag]==="FormData"&&y[Symbol.iterator];if(!q.isFunction(_))throw new TypeError("visitor must be a function");function V(ge){if(ge===null)return"";if(q.isDate(ge))return ge.toISOString();if(!P&&q.isBlob(ge))throw new we("Blob is not supported. Use a Buffer instead.");return q.isArrayBuffer(ge)||q.isTypedArray(ge)?P&&typeof Blob=="function"?new Blob([ge]):Buffer.from(ge):ge}function z(ge,pe,ce){var be=ge;if(ge&&!ce&&rt(ge)==="object"){if(q.endsWith(pe,"{}"))pe=E?pe:pe.slice(0,-2),ge=JSON.stringify(ge);else if(q.isArray(ge)&&function(Te){return q.isArray(Te)&&!Te.some(Kt)}(ge)||q.isFileList(ge)||q.endsWith(pe,"[]")&&(be=q.toArray(ge)))return pe=sn(pe),be.forEach(function(Te,Ve){!q.isUndefined(Te)&&Te!==null&&b.append(L===!0?on([pe],Ve,w):L===null?pe:pe+"[]",V(Te))}),!1}return!!Kt(ge)||(b.append(on(ce,pe,w),V(ge)),!1)}var le=[],fe=Object.assign(Un,{defaultVisitor:z,convertValue:V,isVisitable:Kt});if(!q.isObject(A))throw new TypeError("data must be an object");return function ge(pe,ce){if(!q.isUndefined(pe)){if(le.indexOf(pe)!==-1)throw Error("Circular reference detected in "+ce.join("."));le.push(pe),q.forEach(pe,function(be,Te){(!(q.isUndefined(be)||be===null)&&_.call(b,be,q.isString(Te)?Te.trim():Te,ce,fe))===!0&&ge(be,ce?ce.concat(Te):[Te])}),le.pop()}}(A),b};function an(A){var b={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(A).replace(/[!'()~]|%20|%00/g,function(T){return b[T]})}function ln(A,b){this._pairs=[],A&&Nt(A,this,b)}var cn=ln.prototype;cn.append=function(A,b){this._pairs.push([A,b])},cn.toString=function(A){var b=A?function(T){return A.call(this,T,an)}:an;return this._pairs.map(function(T){return b(T[0])+"="+b(T[1])},"").join("&")};const un=ln;function $n(A){return encodeURIComponent(A).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function dn(A,b,T){if(!b)return A;var y,E=T&&T.encode||$n,_=T&&T.serialize;if(y=_?_(b,T):q.isURLSearchParams(b)?b.toString():new un(b,T).toString(E)){var w=A.indexOf("#");w!==-1&&(A=A.slice(0,w)),A+=(A.indexOf("?")===-1?"?":"&")+y}return A}function ht(A){return ht=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},ht(A)}function Vn(A,b){for(var T=0;T<b.length;T++){var y=b[T];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(A,(E=function(_,w){if(ht(_)!=="object"||_===null)return _;var L=_[Symbol.toPrimitive];if(L!==void 0){var P=L.call(_,"string");if(ht(P)!=="object")return P;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(_)}(y.key),ht(E)==="symbol"?E:String(E)),y)}var E}var Hn=function(){function A(){(function(y,E){if(!(y instanceof E))throw new TypeError("Cannot call a class as a function")})(this,A),this.handlers=[]}var b,T;return b=A,T=[{key:"use",value:function(y,E,_){return this.handlers.push({fulfilled:y,rejected:E,synchronous:!!_&&_.synchronous,runWhen:_?_.runWhen:null}),this.handlers.length-1}},{key:"eject",value:function(y){this.handlers[y]&&(this.handlers[y]=null)}},{key:"clear",value:function(){this.handlers&&(this.handlers=[])}},{key:"forEach",value:function(y){q.forEach(this.handlers,function(E){E!==null&&y(E)})}}],T&&Vn(b.prototype,T),Object.defineProperty(b,"prototype",{writable:!1}),A}();const hn=Hn,fn={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Gn=typeof URLSearchParams<"u"?URLSearchParams:un,Kn=FormData;var jt,jn=(typeof navigator>"u"||(jt=navigator.product)!=="ReactNative"&&jt!=="NativeScript"&&jt!=="NS")&&typeof window<"u"&&typeof document<"u",zn=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function";const qe={isBrowser:!0,classes:{URLSearchParams:Gn,FormData:Kn,Blob},isStandardBrowserEnv:jn,isStandardBrowserWebWorkerEnv:zn,protocols:["http","https","file","blob","url","data"]},pn=function(A){function b(y,E,_,w){var L=y[w++],P=Number.isFinite(+L),V=w>=y.length;return L=!L&&q.isArray(_)?_.length:L,V?(q.hasOwnProp(_,L)?_[L]=[_[L],E]:_[L]=E,!P):(_[L]&&q.isObject(_[L])||(_[L]=[]),b(y,E,_[L],w)&&q.isArray(_[L])&&(_[L]=function(z){var le,fe,ge={},pe=Object.keys(z),ce=pe.length;for(le=0;le<ce;le++)ge[fe=pe[le]]=z[fe];return ge}(_[L])),!P)}if(q.isFormData(A)&&q.isFunction(A.entries)){var T={};return q.forEachEntry(A,function(y,E){b(function(_){return q.matchAll(/\w+|\[(\w*)]/g,_).map(function(w){return w[0]==="[]"?"":w[1]||w[0]})}(y),E,T,0)}),T}return null};var Wn={"Content-Type":void 0},Bt={transitional:fn,adapter:["xhr","http"],transformRequest:[function(A,b){var T,y=b.getContentType()||"",E=y.indexOf("application/json")>-1,_=q.isObject(A);if(_&&q.isHTMLForm(A)&&(A=new FormData(A)),q.isFormData(A))return E&&E?JSON.stringify(pn(A)):A;if(q.isArrayBuffer(A)||q.isBuffer(A)||q.isStream(A)||q.isFile(A)||q.isBlob(A))return A;if(q.isArrayBufferView(A))return A.buffer;if(q.isURLSearchParams(A))return b.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),A.toString();if(_){if(y.indexOf("application/x-www-form-urlencoded")>-1)return function(L,P){return Nt(L,new qe.classes.URLSearchParams,Object.assign({visitor:function(V,z,le,fe){return qe.isNode&&q.isBuffer(V)?(this.append(z,V.toString("base64")),!1):fe.defaultVisitor.apply(this,arguments)}},P))}(A,this.formSerializer).toString();if((T=q.isFileList(A))||y.indexOf("multipart/form-data")>-1){var w=this.env&&this.env.FormData;return Nt(T?{"files[]":A}:A,w&&new w,this.formSerializer)}}return _||E?(b.setContentType("application/json",!1),function(L,P,V){if(q.isString(L))try{return(0,JSON.parse)(L),q.trim(L)}catch(z){if(z.name!=="SyntaxError")throw z}return(0,JSON.stringify)(L)}(A)):A}],transformResponse:[function(A){var b=this.transitional||Bt.transitional,T=b&&b.forcedJSONParsing,y=this.responseType==="json";if(A&&q.isString(A)&&(T&&!this.responseType||y)){var E=!(b&&b.silentJSONParsing)&&y;try{return JSON.parse(A)}catch(_){if(E)throw _.name==="SyntaxError"?we.from(_,we.ERR_BAD_RESPONSE,this,null,this.response):_}}return A}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:qe.classes.FormData,Blob:qe.classes.Blob},validateStatus:function(A){return A>=200&&A<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};q.forEach(["delete","get","head"],function(A){Bt.headers[A]={}}),q.forEach(["post","put","patch"],function(A){Bt.headers[A]=q.merge(Wn)});const zt=Bt;var qn=q.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]);function ft(A){return ft=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},ft(A)}function mn(A,b){(b==null||b>A.length)&&(b=A.length);for(var T=0,y=new Array(b);T<b;T++)y[T]=A[T];return y}function gn(A,b){for(var T=0;T<b.length;T++){var y=b[T];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(A,(E=function(_,w){if(ft(_)!=="object"||_===null)return _;var L=_[Symbol.toPrimitive];if(L!==void 0){var P=L.call(_,"string");if(ft(P)!=="object")return P;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(_)}(y.key),ft(E)==="symbol"?E:String(E)),y)}var E}var yn=Symbol("internals");function pt(A){return A&&String(A).trim().toLowerCase()}function Mt(A){return A===!1||A==null?A:q.isArray(A)?A.map(Mt):String(A)}function An(A,b,T,y){return q.isFunction(y)?y.call(this,b,T):q.isString(b)?q.isString(y)?b.indexOf(y)!==-1:q.isRegExp(y)?y.test(b):void 0:void 0}var Ft=function(A,b){function T(w){(function(L,P){if(!(L instanceof P))throw new TypeError("Cannot call a class as a function")})(this,T),w&&this.set(w)}var y,E,_;return y=T,E=[{key:"set",value:function(w,L,P){var V=this;function z(Te,Ve,Be){var Ne=pt(Ve);if(!Ne)throw new Error("header name must be a non-empty string");var et=q.findKey(V,Ne);(!et||V[et]===void 0||Be===!0||Be===void 0&&V[et]!==!1)&&(V[et||Ve]=Mt(Te))}var le,fe,ge,pe,ce,be=function(Te,Ve){return q.forEach(Te,function(Be,Ne){return z(Be,Ne,Ve)})};return q.isPlainObject(w)||w instanceof this.constructor?be(w,L):q.isString(w)&&(w=w.trim())&&!/^[-_a-zA-Z]+$/.test(w.trim())?be((ce={},(le=w)&&le.split(`
`).forEach(function(Te){pe=Te.indexOf(":"),fe=Te.substring(0,pe).trim().toLowerCase(),ge=Te.substring(pe+1).trim(),!fe||ce[fe]&&qn[fe]||(fe==="set-cookie"?ce[fe]?ce[fe].push(ge):ce[fe]=[ge]:ce[fe]=ce[fe]?ce[fe]+", "+ge:ge)}),ce),L):w!=null&&z(L,w,P),this}},{key:"get",value:function(w,L){if(w=pt(w)){var P=q.findKey(this,w);if(P){var V=this[P];if(!L)return V;if(L===!0)return function(z){for(var le,fe=Object.create(null),ge=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;le=ge.exec(z);)fe[le[1]]=le[2];return fe}(V);if(q.isFunction(L))return L.call(this,V,P);if(q.isRegExp(L))return L.exec(V);throw new TypeError("parser must be boolean|regexp|function")}}}},{key:"has",value:function(w,L){if(w=pt(w)){var P=q.findKey(this,w);return!(!P||L&&!An(0,this[P],P,L))}return!1}},{key:"delete",value:function(w,L){var P=this,V=!1;function z(le){if(le=pt(le)){var fe=q.findKey(P,le);!fe||L&&!An(0,P[fe],fe,L)||(delete P[fe],V=!0)}}return q.isArray(w)?w.forEach(z):z(w),V}},{key:"clear",value:function(){return Object.keys(this).forEach(this.delete.bind(this))}},{key:"normalize",value:function(w){var L=this,P={};return q.forEach(this,function(V,z){var le=q.findKey(P,z);if(le)return L[le]=Mt(V),void delete L[z];var fe=w?function(ge){return ge.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,function(pe,ce,be){return ce.toUpperCase()+be})}(z):String(z).trim();fe!==z&&delete L[z],L[fe]=Mt(V),P[fe]=!0}),this}},{key:"concat",value:function(){for(var w,L=arguments.length,P=new Array(L),V=0;V<L;V++)P[V]=arguments[V];return(w=this.constructor).concat.apply(w,[this].concat(P))}},{key:"toJSON",value:function(w){var L=Object.create(null);return q.forEach(this,function(P,V){P!=null&&P!==!1&&(L[V]=w&&q.isArray(P)?P.join(", "):P)}),L}},{key:Symbol.iterator,value:function(){return Object.entries(this.toJSON())[Symbol.iterator]()}},{key:"toString",value:function(){return Object.entries(this.toJSON()).map(function(w){var L,P,V=(P=2,function(z){if(Array.isArray(z))return z}(L=w)||function(z,le){var fe=z==null?null:typeof Symbol<"u"&&z[Symbol.iterator]||z["@@iterator"];if(fe!=null){var ge,pe,ce,be,Te=[],Ve=!0,Be=!1;try{if(ce=(fe=fe.call(z)).next,le===0){if(Object(fe)!==fe)return;Ve=!1}else for(;!(Ve=(ge=ce.call(fe)).done)&&(Te.push(ge.value),Te.length!==le);Ve=!0);}catch(Ne){Be=!0,pe=Ne}finally{try{if(!Ve&&fe.return!=null&&(be=fe.return(),Object(be)!==be))return}finally{if(Be)throw pe}}return Te}}(L,P)||function(z,le){if(z){if(typeof z=="string")return mn(z,le);var fe=Object.prototype.toString.call(z).slice(8,-1);return fe==="Object"&&z.constructor&&(fe=z.constructor.name),fe==="Map"||fe==="Set"?Array.from(z):fe==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(fe)?mn(z,le):void 0}}(L,P)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}());return V[0]+": "+V[1]}).join(`
`)}},{key:Symbol.toStringTag,get:function(){return"AxiosHeaders"}}],_=[{key:"from",value:function(w){return w instanceof this?w:new this(w)}},{key:"concat",value:function(w){for(var L=new this(w),P=arguments.length,V=new Array(P>1?P-1:0),z=1;z<P;z++)V[z-1]=arguments[z];return V.forEach(function(le){return L.set(le)}),L}},{key:"accessor",value:function(w){var L=(this[yn]=this[yn]={accessors:{}}).accessors,P=this.prototype;function V(z){var le=pt(z);L[le]||(function(fe,ge){var pe=q.toCamelCase(" "+ge);["get","set","has"].forEach(function(ce){Object.defineProperty(fe,ce+pe,{value:function(be,Te,Ve){return this[ce].call(this,ge,be,Te,Ve)},configurable:!0})})}(P,z),L[le]=!0)}return q.isArray(w)?w.forEach(V):V(w),this}}],E&&gn(y.prototype,E),_&&gn(y,_),Object.defineProperty(y,"prototype",{writable:!1}),T}();Ft.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent"]),q.freezeMethods(Ft.prototype),q.freezeMethods(Ft);const Qe=Ft;function Wt(A,b){var T=this||zt,y=b||T,E=Qe.from(y.headers),_=y.data;return q.forEach(A,function(w){_=w.call(T,_,E.normalize(),b?b.status:void 0)}),E.normalize(),_}function vn(A){return!(!A||!A.__CANCEL__)}function bn(A,b,T){we.call(this,A??"canceled",we.ERR_CANCELED,b,T),this.name="CanceledError"}q.inherits(bn,we,{__CANCEL__:!0});const Ut=bn,Yn=qe.isStandardBrowserEnv?{write:function(A,b,T,y,E,_){var w=[];w.push(A+"="+encodeURIComponent(b)),q.isNumber(T)&&w.push("expires="+new Date(T).toGMTString()),q.isString(y)&&w.push("path="+y),q.isString(E)&&w.push("domain="+E),_===!0&&w.push("secure"),document.cookie=w.join("; ")},read:function(A){var b=document.cookie.match(new RegExp("(^|;\\s*)("+A+")=([^;]*)"));return b?decodeURIComponent(b[3]):null},remove:function(A){this.write(A,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}};function En(A,b){return A&&!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(b)?function(T,y){return y?T.replace(/\/+$/,"")+"/"+y.replace(/^\/+/,""):T}(A,b):b}const Qn=qe.isStandardBrowserEnv?function(){var A,b=/(msie|trident)/i.test(navigator.userAgent),T=document.createElement("a");function y(E){var _=E;return b&&(T.setAttribute("href",_),_=T.href),T.setAttribute("href",_),{href:T.href,protocol:T.protocol?T.protocol.replace(/:$/,""):"",host:T.host,search:T.search?T.search.replace(/^\?/,""):"",hash:T.hash?T.hash.replace(/^#/,""):"",hostname:T.hostname,port:T.port,pathname:T.pathname.charAt(0)==="/"?T.pathname:"/"+T.pathname}}return A=y(window.location.href),function(E){var _=q.isString(E)?y(E):E;return _.protocol===A.protocol&&_.host===A.host}}():function(){return!0};function xn(A,b){var T=0,y=function(E,_){E=E||10;var w,L=new Array(E),P=new Array(E),V=0,z=0;return _=_!==void 0?_:1e3,function(le){var fe=Date.now(),ge=P[z];w||(w=fe),L[V]=le,P[V]=fe;for(var pe=z,ce=0;pe!==V;)ce+=L[pe++],pe%=E;if((V=(V+1)%E)===z&&(z=(z+1)%E),!(fe-w<_)){var be=ge&&fe-ge;return be?Math.round(1e3*ce/be):void 0}}}(50,250);return function(E){var _=E.loaded,w=E.lengthComputable?E.total:void 0,L=_-T,P=y(L);T=_;var V={loaded:_,total:w,progress:w?_/w:void 0,bytes:L,rate:P||void 0,estimated:P&&w&&_<=w?(w-_)/P:void 0,event:E};V[b?"download":"upload"]=!0,A(V)}}var qt={http:null,xhr:typeof XMLHttpRequest<"u"&&function(A){return new Promise(function(b,T){var y,E=A.data,_=Qe.from(A.headers).normalize(),w=A.responseType;function L(){A.cancelToken&&A.cancelToken.unsubscribe(y),A.signal&&A.signal.removeEventListener("abort",y)}q.isFormData(E)&&(qe.isStandardBrowserEnv||qe.isStandardBrowserWebWorkerEnv)&&_.setContentType(!1);var P=new XMLHttpRequest;if(A.auth){var V=A.auth.username||"",z=A.auth.password?unescape(encodeURIComponent(A.auth.password)):"";_.set("Authorization","Basic "+btoa(V+":"+z))}var le=En(A.baseURL,A.url);function fe(){if(P){var be=Qe.from("getAllResponseHeaders"in P&&P.getAllResponseHeaders());(function(Te,Ve,Be){var Ne=Be.config.validateStatus;Be.status&&Ne&&!Ne(Be.status)?Ve(new we("Request failed with status code "+Be.status,[we.ERR_BAD_REQUEST,we.ERR_BAD_RESPONSE][Math.floor(Be.status/100)-4],Be.config,Be.request,Be)):Te(Be)})(function(Te){b(Te),L()},function(Te){T(Te),L()},{data:w&&w!=="text"&&w!=="json"?P.response:P.responseText,status:P.status,statusText:P.statusText,headers:be,config:A,request:P}),P=null}}if(P.open(A.method.toUpperCase(),dn(le,A.params,A.paramsSerializer),!0),P.timeout=A.timeout,"onloadend"in P?P.onloadend=fe:P.onreadystatechange=function(){P&&P.readyState===4&&(P.status!==0||P.responseURL&&P.responseURL.indexOf("file:")===0)&&setTimeout(fe)},P.onabort=function(){P&&(T(new we("Request aborted",we.ECONNABORTED,A,P)),P=null)},P.onerror=function(){T(new we("Network Error",we.ERR_NETWORK,A,P)),P=null},P.ontimeout=function(){var be=A.timeout?"timeout of "+A.timeout+"ms exceeded":"timeout exceeded",Te=A.transitional||fn;A.timeoutErrorMessage&&(be=A.timeoutErrorMessage),T(new we(be,Te.clarifyTimeoutError?we.ETIMEDOUT:we.ECONNABORTED,A,P)),P=null},qe.isStandardBrowserEnv){var ge=(A.withCredentials||Qn(le))&&A.xsrfCookieName&&Yn.read(A.xsrfCookieName);ge&&_.set(A.xsrfHeaderName,ge)}E===void 0&&_.setContentType(null),"setRequestHeader"in P&&q.forEach(_.toJSON(),function(be,Te){P.setRequestHeader(Te,be)}),q.isUndefined(A.withCredentials)||(P.withCredentials=!!A.withCredentials),w&&w!=="json"&&(P.responseType=A.responseType),typeof A.onDownloadProgress=="function"&&P.addEventListener("progress",xn(A.onDownloadProgress,!0)),typeof A.onUploadProgress=="function"&&P.upload&&P.upload.addEventListener("progress",xn(A.onUploadProgress)),(A.cancelToken||A.signal)&&(y=function(be){P&&(T(!be||be.type?new Ut(null,A,P):be),P.abort(),P=null)},A.cancelToken&&A.cancelToken.subscribe(y),A.signal&&(A.signal.aborted?y():A.signal.addEventListener("abort",y)));var pe,ce=(pe=/^([-+\w]{1,25})(:?\/\/|:)/.exec(le))&&pe[1]||"";ce&&qe.protocols.indexOf(ce)===-1?T(new we("Unsupported protocol "+ce+":",we.ERR_BAD_REQUEST,A)):P.send(E||null)})}};q.forEach(qt,function(A,b){if(A){try{Object.defineProperty(A,"name",{value:b})}catch{}Object.defineProperty(A,"adapterName",{value:b})}});function Yt(A){if(A.cancelToken&&A.cancelToken.throwIfRequested(),A.signal&&A.signal.aborted)throw new Ut(null,A)}function _n(A){return Yt(A),A.headers=Qe.from(A.headers),A.data=Wt.call(A,A.transformRequest),["post","put","patch"].indexOf(A.method)!==-1&&A.headers.setContentType("application/x-www-form-urlencoded",!1),function(b){for(var T,y,E=(b=q.isArray(b)?b:[b]).length,_=0;_<E&&(T=b[_],!(y=q.isString(T)?qt[T.toLowerCase()]:T));_++);if(!y)throw y===!1?new we("Adapter ".concat(T," is not supported by the environment"),"ERR_NOT_SUPPORT"):new Error(q.hasOwnProp(qt,T)?"Adapter '".concat(T,"' is not available in the build"):"Unknown adapter '".concat(T,"'"));if(!q.isFunction(y))throw new TypeError("adapter is not a function");return y}(A.adapter||zt.adapter)(A).then(function(b){return Yt(A),b.data=Wt.call(A,A.transformResponse,b),b.headers=Qe.from(b.headers),b},function(b){return vn(b)||(Yt(A),b&&b.response&&(b.response.data=Wt.call(A,A.transformResponse,b.response),b.response.headers=Qe.from(b.response.headers))),Promise.reject(b)})}var Sn=function(A){return A instanceof Qe?A.toJSON():A};function it(A,b){b=b||{};var T={};function y(V,z,le){return q.isPlainObject(V)&&q.isPlainObject(z)?q.merge.call({caseless:le},V,z):q.isPlainObject(z)?q.merge({},z):q.isArray(z)?z.slice():z}function E(V,z,le){return q.isUndefined(z)?q.isUndefined(V)?void 0:y(void 0,V,le):y(V,z,le)}function _(V,z){if(!q.isUndefined(z))return y(void 0,z)}function w(V,z){return q.isUndefined(z)?q.isUndefined(V)?void 0:y(void 0,V):y(void 0,z)}function L(V,z,le){return le in b?y(V,z):le in A?y(void 0,V):void 0}var P={url:_,method:_,data:_,baseURL:w,transformRequest:w,transformResponse:w,paramsSerializer:w,timeout:w,timeoutMessage:w,withCredentials:w,adapter:w,responseType:w,xsrfCookieName:w,xsrfHeaderName:w,onUploadProgress:w,onDownloadProgress:w,decompress:w,maxContentLength:w,maxBodyLength:w,beforeRedirect:w,transport:w,httpAgent:w,httpsAgent:w,cancelToken:w,socketPath:w,responseEncoding:w,validateStatus:L,headers:function(V,z){return E(Sn(V),Sn(z),!0)}};return q.forEach(Object.keys(A).concat(Object.keys(b)),function(V){var z=P[V]||E,le=z(A[V],b[V],V);q.isUndefined(le)&&z!==L||(T[V]=le)}),T}function $t(A){return $t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},$t(A)}var Qt={};["object","boolean","number","function","string","symbol"].forEach(function(A,b){Qt[A]=function(T){return $t(T)===A||"a"+(b<1?"n ":" ")+A}});var Tn={};Qt.transitional=function(A,b,T){function y(E,_){return"[Axios v1.2.3] Transitional option '"+E+"'"+_+(T?". "+T:"")}return function(E,_,w){if(A===!1)throw new we(y(_," has been removed"+(b?" in "+b:"")),we.ERR_DEPRECATED);return b&&!Tn[_]&&(Tn[_]=!0,console.warn(y(_," has been deprecated since v"+b+" and will be removed in the near future"))),!A||A(E,_,w)}};const Xt={assertOptions:function(A,b,T){if($t(A)!=="object")throw new we("options must be an object",we.ERR_BAD_OPTION_VALUE);for(var y=Object.keys(A),E=y.length;E-- >0;){var _=y[E],w=b[_];if(w){var L=A[_],P=L===void 0||w(L,_,A);if(P!==!0)throw new we("option "+_+" must be "+P,we.ERR_BAD_OPTION_VALUE)}else if(T!==!0)throw new we("Unknown option "+_,we.ERR_BAD_OPTION)}},validators:Qt};function mt(A){return mt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},mt(A)}function Xn(A,b){for(var T=0;T<b.length;T++){var y=b[T];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(A,(E=function(_,w){if(mt(_)!=="object"||_===null)return _;var L=_[Symbol.toPrimitive];if(L!==void 0){var P=L.call(_,"string");if(mt(P)!=="object")return P;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(_)}(y.key),mt(E)==="symbol"?E:String(E)),y)}var E}var Je=Xt.validators,Vt=function(){function A(y){(function(E,_){if(!(E instanceof _))throw new TypeError("Cannot call a class as a function")})(this,A),this.defaults=y,this.interceptors={request:new hn,response:new hn}}var b,T;return b=A,(T=[{key:"request",value:function(y,E){typeof y=="string"?(E=E||{}).url=y:E=y||{};var _,w=E=it(this.defaults,E),L=w.transitional,P=w.paramsSerializer,V=w.headers;L!==void 0&&Xt.assertOptions(L,{silentJSONParsing:Je.transitional(Je.boolean),forcedJSONParsing:Je.transitional(Je.boolean),clarifyTimeoutError:Je.transitional(Je.boolean)},!1),P!==void 0&&Xt.assertOptions(P,{encode:Je.function,serialize:Je.function},!0),E.method=(E.method||this.defaults.method||"get").toLowerCase(),(_=V&&q.merge(V.common,V[E.method]))&&q.forEach(["delete","get","head","post","put","patch","common"],function(Ne){delete V[Ne]}),E.headers=Qe.concat(_,V);var z=[],le=!0;this.interceptors.request.forEach(function(Ne){typeof Ne.runWhen=="function"&&Ne.runWhen(E)===!1||(le=le&&Ne.synchronous,z.unshift(Ne.fulfilled,Ne.rejected))});var fe,ge=[];this.interceptors.response.forEach(function(Ne){ge.push(Ne.fulfilled,Ne.rejected)});var pe,ce=0;if(!le){var be=[_n.bind(this),void 0];for(be.unshift.apply(be,z),be.push.apply(be,ge),pe=be.length,fe=Promise.resolve(E);ce<pe;)fe=fe.then(be[ce++],be[ce++]);return fe}pe=z.length;var Te=E;for(ce=0;ce<pe;){var Ve=z[ce++],Be=z[ce++];try{Te=Ve(Te)}catch(Ne){Be.call(this,Ne);break}}try{fe=_n.call(this,Te)}catch(Ne){return Promise.reject(Ne)}for(ce=0,pe=ge.length;ce<pe;)fe=fe.then(ge[ce++],ge[ce++]);return fe}},{key:"getUri",value:function(y){return dn(En((y=it(this.defaults,y)).baseURL,y.url),y.params,y.paramsSerializer)}}])&&Xn(b.prototype,T),Object.defineProperty(b,"prototype",{writable:!1}),A}();q.forEach(["delete","get","head","options"],function(A){Vt.prototype[A]=function(b,T){return this.request(it(T||{},{method:A,url:b,data:(T||{}).data}))}}),q.forEach(["post","put","patch"],function(A){function b(T){return function(y,E,_){return this.request(it(_||{},{method:A,headers:T?{"Content-Type":"multipart/form-data"}:{},url:y,data:E}))}}Vt.prototype[A]=b(),Vt.prototype[A+"Form"]=b(!0)});const Ht=Vt;function gt(A){return gt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},gt(A)}function Cn(A,b){for(var T=0;T<b.length;T++){var y=b[T];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(A,(E=function(_,w){if(gt(_)!=="object"||_===null)return _;var L=_[Symbol.toPrimitive];if(L!==void 0){var P=L.call(_,"string");if(gt(P)!=="object")return P;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(_)}(y.key),gt(E)==="symbol"?E:String(E)),y)}var E}var Jn=function(){function A(E){if(function(L,P){if(!(L instanceof P))throw new TypeError("Cannot call a class as a function")}(this,A),typeof E!="function")throw new TypeError("executor must be a function.");var _;this.promise=new Promise(function(L){_=L});var w=this;this.promise.then(function(L){if(w._listeners){for(var P=w._listeners.length;P-- >0;)w._listeners[P](L);w._listeners=null}}),this.promise.then=function(L){var P,V=new Promise(function(z){w.subscribe(z),P=z}).then(L);return V.cancel=function(){w.unsubscribe(P)},V},E(function(L,P,V){w.reason||(w.reason=new Ut(L,P,V),_(w.reason))})}var b,T,y;return b=A,T=[{key:"throwIfRequested",value:function(){if(this.reason)throw this.reason}},{key:"subscribe",value:function(E){this.reason?E(this.reason):this._listeners?this._listeners.push(E):this._listeners=[E]}},{key:"unsubscribe",value:function(E){if(this._listeners){var _=this._listeners.indexOf(E);_!==-1&&this._listeners.splice(_,1)}}}],y=[{key:"source",value:function(){var E;return{token:new A(function(_){E=_}),cancel:E}}}],T&&Cn(b.prototype,T),y&&Cn(b,y),Object.defineProperty(b,"prototype",{writable:!1}),A}();const Zn=Jn;function wn(A,b){(b==null||b>A.length)&&(b=A.length);for(var T=0,y=new Array(b);T<b;T++)y[T]=A[T];return y}var Jt={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Jt).forEach(function(A){var b,T,y=(T=2,function(w){if(Array.isArray(w))return w}(b=A)||function(w,L){var P=w==null?null:typeof Symbol<"u"&&w[Symbol.iterator]||w["@@iterator"];if(P!=null){var V,z,le,fe,ge=[],pe=!0,ce=!1;try{if(le=(P=P.call(w)).next,L===0){if(Object(P)!==P)return;pe=!1}else for(;!(pe=(V=le.call(P)).done)&&(ge.push(V.value),ge.length!==L);pe=!0);}catch(be){ce=!0,z=be}finally{try{if(!pe&&P.return!=null&&(fe=P.return(),Object(fe)!==fe))return}finally{if(ce)throw z}}return ge}}(b,T)||function(w,L){if(w){if(typeof w=="string")return wn(w,L);var P=Object.prototype.toString.call(w).slice(8,-1);return P==="Object"&&w.constructor&&(P=w.constructor.name),P==="Map"||P==="Set"?Array.from(w):P==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(P)?wn(w,L):void 0}}(b,T)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()),E=y[0],_=y[1];Jt[_]=E});const er=Jt;var $e=function A(b){var T=new Ht(b),y=W(Ht.prototype.request,T);return q.extend(y,Ht.prototype,T,{allOwnKeys:!0}),q.extend(y,T,null,{allOwnKeys:!0}),y.create=function(E){return A(it(b,E))},y}(zt);$e.Axios=Ht,$e.CanceledError=Ut,$e.CancelToken=Zn,$e.isCancel=vn,$e.VERSION="1.2.3",$e.toFormData=Nt,$e.AxiosError=we,$e.Cancel=$e.CanceledError,$e.all=function(A){return Promise.all(A)},$e.spread=function(A){return function(b){return A.apply(null,b)}},$e.isAxiosError=function(A){return q.isObject(A)&&A.isAxiosError===!0},$e.mergeConfig=it,$e.AxiosHeaders=Qe,$e.formToJSON=function(A){return pn(q.isHTMLForm(A)?new FormData(A):A)},$e.HttpStatusCode=er,$e.default=$e;const Rn=$e,nr={send:function(A){Rn.post(A.url,A.data).then(function(b){var T=b.data;T&&T.code===0?A.success&&A.success(T):A.error&&A.error(T&&T.msg)}).catch(function(b){console.error(b),A.error&&A.error()})},read:function(A){Rn.get(A.url).then(function(b){var T=b.data;T&&T.code===0?A.success&&A.success(T.data.map(function(y){return{time:y[0],type:y[1],color:y[2],author:y[3],text:y[4]}})):A.error&&A.error(T&&T.msg)}).catch(function(b){console.error(b),A.error&&A.error()})}};function Zt(A){return Zt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},Zt(A)}function rr(A){var b=this;this.lang=A,this.fallbackLang=this.lang.includes("-")?this.lang.split("-")[0]:this.lang,this.tran=function(T){return T=T.toLowerCase(),st[b.lang]&&st[b.lang][T]?st[b.lang][T]:st[b.fallbackLang]&&st[b.fallbackLang][T]?st[b.fallbackLang][T]:en[T]?en[T]:T}}var en={"danmaku-loading":"Danmaku is loading",top:"Top",bottom:"Bottom",rolling:"Rolling","input-danmaku-enter":"Input danmaku, hit Enter","about-author":"About author","dplayer-feedback":"DPlayer feedback","about-dplayer":"About DPlayer",loop:"Loop",speed:"Speed","opacity-danmaku":"Opacity for danmaku",normal:"Normal","please-input-danmaku":"Please input danmaku content!","set-danmaku-color":"Set danmaku color","set-danmaku-type":"Set danmaku type","show-danmaku":"Show danmaku","video-failed":"Video load failed","danmaku-failed":"Danmaku load failed","danmaku-send-failed":"Danmaku send failed","switching-quality":"Switching to %q quality","switched-quality":"Switched to %q quality",ff:"FF %s s",rew:"REW %s s","unlimited-danmaku":"Unlimited danmaku","send-danmaku":"Send danmaku",setting:"Setting",fullscreen:"Full screen","web-fullscreen":"Web full screen",send:"Send",screenshot:"Screenshot",airplay:"AirPlay",chromecast:"ChromeCast",subtitle:"Subtitle",off:"Off","show-subs":"Show subtitle","hide-subs":"Hide subtitle",volume:"Volume",live:"Live","video-info":"Video info"},st={en,"zh-cn":{"danmaku-loading":"弹幕加载中",top:"顶部",bottom:"底部",rolling:"滚动","input-danmaku-enter":"输入弹幕，回车发送","about-author":"关于作者","dplayer-feedback":"播放器意见反馈","about-dplayer":"关于 DPlayer 播放器",loop:"洗脑循环",speed:"速度","opacity-danmaku":"弹幕透明度",normal:"正常","please-input-danmaku":"要输入弹幕内容啊喂！","set-danmaku-color":"设置弹幕颜色","set-danmaku-type":"设置弹幕类型","show-danmaku":"显示弹幕","video-failed":"视频加载失败","danmaku-failed":"弹幕加载失败","danmaku-send-failed":"弹幕发送失败","switching-quality":"正在切换至 %q 画质","switched-quality":"已经切换至 %q 画质",ff:"快进 %s 秒",rew:"快退 %s 秒","unlimited-danmaku":"海量弹幕","send-danmaku":"发送弹幕",setting:"设置",fullscreen:"全屏","web-fullscreen":"页面全屏",send:"发送",screenshot:"截图",airplay:"无线投屏",chromecast:"ChromeCast",subtitle:"字幕",off:"关闭","show-subs":"显示字幕","hide-subs":"隐藏字幕",volume:"音量",live:"直播","video-info":"视频统计信息"},"zh-tw":{"danmaku-loading":"彈幕載入中",top:"頂部",bottom:"底部",rolling:"滾動","input-danmaku-enter":"輸入彈幕，Enter 發送","about-author":"關於作者","dplayer-feedback":"播放器意見回饋","about-dplayer":"關於 DPlayer 播放器",loop:"循環播放",speed:"速度","opacity-danmaku":"彈幕透明度",normal:"正常","please-input-danmaku":"請輸入彈幕內容啊！","set-danmaku-color":"設定彈幕顏色","set-danmaku-type":"設定彈幕類型","show-danmaku":"顯示彈幕","video-failed":"影片載入失敗","danmaku-failed":"彈幕載入失敗","danmaku-send-failed":"彈幕發送失敗","switching-quality":"正在切換至 %q 畫質","switched-quality":"已經切換至 %q 畫質",ff:"快進 %s 秒",rew:"快退 %s 秒","unlimited-danmaku":"巨量彈幕","send-danmaku":"發送彈幕",setting:"設定",fullscreen:"全螢幕","web-fullscreen":"頁面全螢幕",send:"發送",screenshot:"截圖",airplay:"無線投屏",chromecast:"ChromeCast",subtitle:"字幕",off:"關閉","show-subs":"顯示字幕","hide-subs":"隱藏字幕",volume:"音量",live:"直播","video-info":"影片統計訊息"},"ko-kr":{"danmaku-loading":"Danmaku를 불러오는 중입니다.",top:"Top",bottom:"Bottom",rolling:"Rolling","input-danmaku-enter":"Danmaku를 입력하고 Enter를 누르세요.","about-author":"만든이","dplayer-feedback":"피드백 보내기","about-dplayer":"DPlayer 정보",loop:"반복",speed:"배속","opacity-danmaku":"Danmaku 불투명도",normal:"표준","please-input-danmaku":"Danmaku를 입력하세요!","set-danmaku-color":"Danmaku 색상","set-danmaku-type":"Danmaku 설정","show-danmaku":"Danmaku 표시","video-failed":"비디오를 불러오지 못했습니다.","danmaku-failed":"Danmaku를 불러오지 못했습니다.","danmaku-send-failed":"Danmaku 전송에 실패했습니다.","Switching to":"","Switched to":"","switching-quality":"전환 %q 화질","switched-quality":"전환 됨 %q 화질",ff:"앞으로 %s 초",rew:"뒤로 %s 초","unlimited-danmaku":"끝없는 Danmaku","send-danmaku":"Danmaku 보내기",setting:"설정",fullscreen:"전체 화면","web-fullscreen":"웹 내 전체화면",send:"보내기",screenshot:"화면 캡쳐",airplay:"에어플레이",chromecast:"ChromeCast",subtitle:"부제",off:"끄다","show-subs":"자막 보이기","hide-subs":"자막 숨기기",Volume:"볼륨",live:"생방송","video-info":"비디오 정보"},de:{"danmaku-loading":"Danmaku lädt...",top:"Oben",bottom:"Unten",rolling:"Rollend","input-danmaku-enter":"Drücke Enter nach dem Einfügen vom Danmaku","about-author":"Über den Autor","dplayer-feedback":"DPlayer Feedback","about-dplayer":"Über DPlayer",loop:"Wiederholen",speed:"Geschwindigkeit","opacity-danmaku":"Transparenz für Danmaku",normal:"Normal","please-input-danmaku":"Bitte Danmaku Inhalt eingeben!","set-danmaku-color":"Danmaku Farbe festlegen","set-danmaku-type":"Danmaku Typ festlegen","show-danmaku":"Zeige Danmaku","video-failed":"Das Video konnte nicht geladen werden","danmaku-failed":"Danmaku konnte nicht geladen werden","danmaku-send-failed":"Das senden von Danmaku ist fehgeschlagen","switching-quality":"Wechsle zur %q Qualität","switched-quality":"Zur %q Qualität gewechselt",ff:"%s s Vorwärts",rew:"%s s Zurück","unlimited-danmaku":"Unlimitiertes Danmaku","send-danmaku":"Sende Danmaku",setting:"Einstellungen",fullscreen:"Vollbild","web-fullscreen":"Browser Vollbild",send:"Senden",screenshot:"Screenshot",airplay:"AirPlay","show-subs":"Zeige Untertitel",chromecast:"ChromeCast",subtitle:"Untertitel",off:"Schließung","hide-subs":"Verstecke Untertitel",volume:"Lautstärke",live:"Live","video-info":"Video Info"}},ir=i(730),sr=i.n(ir),or=i(74),ar=i.n(or),lr=i(437),cr=i.n(lr),ur=i(644),dr=i.n(ur),hr=i(324),fr=i.n(hr),pr=i(574),mr=i.n(pr),gr=i(300),yr=i.n(gr),Ar=i(934),vr=i.n(Ar),br=i(428),Er=i.n(br),xr=i(807),_r=i.n(xr),Sr=i(338),Tr=i.n(Sr),Cr=i(254),wr=i.n(Cr),Rr=i(965),kr=i.n(Rr),Ir=i(113),Lr=i.n(Ir),Pr=i(251),Dr=i.n(Pr),Or=i(410),Nr=i.n(Or),Br=i(182),Mr=i.n(Br),Fr=i(193),Ur=i.n(Fr);const We={play:sr(),pause:ar(),volumeUp:cr(),volumeDown:dr(),volumeOff:fr(),full:mr(),fullWeb:yr(),setting:vr(),right:Er(),comment:_r(),commentOff:Tr(),send:wr(),pallette:kr(),camera:Lr(),subtitle:Nr(),loading:Mr(),airplay:Dr(),chromecast:Ur()};var $r=i(916),Vr=i.n($r);function yt(A){return yt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},yt(A)}function kn(A,b){for(var T=0;T<b.length;T++){var y=b[T];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(A,(E=function(_,w){if(yt(_)!=="object"||_===null)return _;var L=_[Symbol.toPrimitive];if(L!==void 0){var P=L.call(_,"string");if(yt(P)!=="object")return P;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(_)}(y.key),yt(E)==="symbol"?E:String(E)),y)}var E}var Hr=function(){function A(E){(function(_,w){if(!(_ instanceof w))throw new TypeError("Cannot call a class as a function")})(this,A),this.container=E.container,this.options=E.options,this.index=E.index,this.tran=E.tran,this.init()}var b,T,y;return b=A,y=[{key:"NewNotice",value:function(E,_,w){var L=document.createElement("div");return L.classList.add("dplayer-notice"),L.style.opacity=_,L.innerText=E,w&&(L.id="dplayer-notice-".concat(w)),L}}],(T=[{key:"init",value:function(){this.container.innerHTML=Vr()({options:this.options,index:this.index,tran:this.tran,icons:We,mobile:$.isMobile,video:{current:!0,pic:this.options.video.pic,screenshot:this.options.screenshot,airplay:!(!$.isSafari||$.isChrome)&&this.options.airplay,chromecast:this.options.chromecast,preload:this.options.preload,url:this.options.video.url,subtitle:this.options.subtitle}}),this.volumeBar=this.container.querySelector(".dplayer-volume-bar-inner"),this.volumeBarWrap=this.container.querySelector(".dplayer-volume-bar"),this.volumeBarWrapWrap=this.container.querySelector(".dplayer-volume-bar-wrap"),this.volumeButton=this.container.querySelector(".dplayer-volume"),this.volumeButtonIcon=this.container.querySelector(".dplayer-volume-icon"),this.volumeIcon=this.container.querySelector(".dplayer-volume-icon .dplayer-icon-content"),this.playedBar=this.container.querySelector(".dplayer-played"),this.loadedBar=this.container.querySelector(".dplayer-loaded"),this.playedBarWrap=this.container.querySelector(".dplayer-bar-wrap"),this.playedBarTime=this.container.querySelector(".dplayer-bar-time"),this.danmaku=this.container.querySelector(".dplayer-danmaku"),this.danmakuLoading=this.container.querySelector(".dplayer-danloading"),this.video=this.container.querySelector(".dplayer-video-current"),this.bezel=this.container.querySelector(".dplayer-bezel-icon"),this.playButton=this.container.querySelector(".dplayer-play-icon"),this.mobilePlayButton=this.container.querySelector(".dplayer-mobile-play"),this.videoWrap=this.container.querySelector(".dplayer-video-wrap"),this.controllerMask=this.container.querySelector(".dplayer-controller-mask"),this.ptime=this.container.querySelector(".dplayer-ptime"),this.settingButton=this.container.querySelector(".dplayer-setting-icon"),this.settingBox=this.container.querySelector(".dplayer-setting-box"),this.mask=this.container.querySelector(".dplayer-mask"),this.loop=this.container.querySelector(".dplayer-setting-loop"),this.loopToggle=this.container.querySelector(".dplayer-setting-loop .dplayer-toggle-setting-input"),this.showDanmaku=this.container.querySelector(".dplayer-setting-showdan"),this.showDanmakuToggle=this.container.querySelector(".dplayer-showdan-setting-input"),this.unlimitDanmaku=this.container.querySelector(".dplayer-setting-danunlimit"),this.unlimitDanmakuToggle=this.container.querySelector(".dplayer-danunlimit-setting-input"),this.speed=this.container.querySelector(".dplayer-setting-speed"),this.speedItem=this.container.querySelectorAll(".dplayer-setting-speed-item"),this.danmakuOpacityBar=this.container.querySelector(".dplayer-danmaku-bar-inner"),this.danmakuOpacityBarWrap=this.container.querySelector(".dplayer-danmaku-bar"),this.danmakuOpacityBarWrapWrap=this.container.querySelector(".dplayer-danmaku-bar-wrap"),this.danmakuOpacityBox=this.container.querySelector(".dplayer-setting-danmaku"),this.dtime=this.container.querySelector(".dplayer-dtime"),this.controller=this.container.querySelector(".dplayer-controller"),this.commentInput=this.container.querySelector(".dplayer-comment-input"),this.commentButton=this.container.querySelector(".dplayer-comment-icon"),this.commentSettingBox=this.container.querySelector(".dplayer-comment-setting-box"),this.commentSettingButton=this.container.querySelector(".dplayer-comment-setting-icon"),this.commentSettingFill=this.container.querySelector(".dplayer-comment-setting-icon path"),this.commentSendButton=this.container.querySelector(".dplayer-send-icon"),this.commentSendFill=this.container.querySelector(".dplayer-send-icon path"),this.commentColorSettingBox=this.container.querySelector(".dplayer-comment-setting-color"),this.browserFullButton=this.container.querySelector(".dplayer-full-icon"),this.webFullButton=this.container.querySelector(".dplayer-full-in-icon"),this.menu=this.container.querySelector(".dplayer-menu"),this.menuItem=this.container.querySelectorAll(".dplayer-menu-item"),this.qualityList=this.container.querySelector(".dplayer-quality-list"),this.camareButton=this.container.querySelector(".dplayer-camera-icon"),this.airplayButton=this.container.querySelector(".dplayer-airplay-icon"),this.chromecastButton=this.container.querySelector(".dplayer-chromecast-icon"),this.subtitleButton=this.container.querySelector(".dplayer-subtitle-icon"),this.subtitleButtonInner=this.container.querySelector(".dplayer-subtitle-icon .dplayer-icon-content"),this.subtitlesButton=this.container.querySelector(".dplayer-subtitles-icon"),this.subtitlesBox=this.container.querySelector(".dplayer-subtitles-box"),this.subtitlesItem=this.container.querySelectorAll(".dplayer-subtitles-item"),this.subtitle=this.container.querySelector(".dplayer-subtitle"),this.subtrack=this.container.querySelector(".dplayer-subtrack"),this.qualityButton=this.container.querySelector(".dplayer-quality-icon"),this.barPreview=this.container.querySelector(".dplayer-bar-preview"),this.barWrap=this.container.querySelector(".dplayer-bar-wrap"),this.noticeList=this.container.querySelector(".dplayer-notice-list"),this.infoPanel=this.container.querySelector(".dplayer-info-panel"),this.infoPanelClose=this.container.querySelector(".dplayer-info-panel-close"),this.infoVersion=this.container.querySelector(".dplayer-info-panel-item-version .dplayer-info-panel-item-data"),this.infoFPS=this.container.querySelector(".dplayer-info-panel-item-fps .dplayer-info-panel-item-data"),this.infoType=this.container.querySelector(".dplayer-info-panel-item-type .dplayer-info-panel-item-data"),this.infoUrl=this.container.querySelector(".dplayer-info-panel-item-url .dplayer-info-panel-item-data"),this.infoResolution=this.container.querySelector(".dplayer-info-panel-item-resolution .dplayer-info-panel-item-data"),this.infoDuration=this.container.querySelector(".dplayer-info-panel-item-duration .dplayer-info-panel-item-data"),this.infoDanmakuId=this.container.querySelector(".dplayer-info-panel-item-danmaku-id .dplayer-info-panel-item-data"),this.infoDanmakuApi=this.container.querySelector(".dplayer-info-panel-item-danmaku-api .dplayer-info-panel-item-data"),this.infoDanmakuAmount=this.container.querySelector(".dplayer-info-panel-item-danmaku-amount .dplayer-info-panel-item-data")}}])&&kn(b.prototype,T),y&&kn(b,y),Object.defineProperty(b,"prototype",{writable:!1}),A}();const In=Hr;function ot(A){return ot=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},ot(A)}function Gr(A,b){for(var T=0;T<b.length;T++){var y=b[T];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(A,(E=function(_,w){if(ot(_)!=="object"||_===null)return _;var L=_[Symbol.toPrimitive];if(L!==void 0){var P=L.call(_,"string");if(ot(P)!=="object")return P;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(_)}(y.key),ot(E)==="symbol"?E:String(E)),y)}var E}var Kr=function(){function A(y){(function(E,_){if(!(E instanceof _))throw new TypeError("Cannot call a class as a function")})(this,A),this.options=y,this.player=this.options.player,this.container=this.options.container,this.danTunnel={right:{},top:{},bottom:{}},this.danIndex=0,this.dan=[],this.showing=!0,this._opacity=this.options.opacity,this.events=this.options.events,this.unlimited=this.options.unlimited,this._measure(""),this.load()}var b,T;return b=A,T=[{key:"load",value:function(){var y,E=this;y=this.options.api.maximum?"".concat(this.options.api.address,"v3/?id=").concat(this.options.api.id,"&max=").concat(this.options.api.maximum):"".concat(this.options.api.address,"v3/?id=").concat(this.options.api.id);var _=(this.options.api.addition||[]).slice(0);_.push(y),this.events&&this.events.trigger("danmaku_load_start",_),this._readAllEndpoints(_,function(w){E.dan=[].concat.apply([],w).sort(function(L,P){return L.time-P.time}),window.requestAnimationFrame(function(){E.frame()}),E.options.callback(),E.events&&E.events.trigger("danmaku_load_end")})}},{key:"reload",value:function(y){this.options.api=y,this.dan=[],this.clear(),this.load()}},{key:"_readAllEndpoints",value:function(y,E){for(var _=this,w=[],L=0,P=function(z){_.options.apiBackend.read({url:y[z],success:function(le){w[z]=le,++L===y.length&&E(w)},error:function(le){_.options.error(le||_.options.tran("danmaku-failed")),w[z]=[],++L===y.length&&E(w)}})},V=0;V<y.length;++V)P(V)}},{key:"send",value:function(y,E){var _=this,w={token:this.options.api.token,id:this.options.api.id,author:this.options.api.user,time:this.options.time(),text:y.text,color:y.color,type:y.type};this.options.apiBackend.send({url:this.options.api.address+"v3/",data:w,success:E,error:function(P){_.options.error(P||_.options.tran("danmaku-failed"))}}),this.dan.splice(this.danIndex,0,w),this.danIndex++;var L={text:this.htmlEncode(w.text),color:w.color,type:w.type,border:"2px solid ".concat(this.options.borderColor)};this.draw(L),this.events&&this.events.trigger("danmaku_send",w)}},{key:"frame",value:function(){var y=this;if(this.dan.length&&!this.paused&&this.showing){for(var E=this.dan[this.danIndex],_=[];E&&this.options.time()>parseFloat(E.time);)_.push(E),E=this.dan[++this.danIndex];this.draw(_)}window.requestAnimationFrame(function(){y.frame()})}},{key:"opacity",value:function(y){if(y!==void 0){for(var E=this.container.getElementsByClassName("dplayer-danmaku-item"),_=0;_<E.length;_++)E[_].style.opacity=y;this._opacity=y,this.events&&this.events.trigger("danmaku_opacity",this._opacity)}return this._opacity}},{key:"draw",value:function(y){var E=this;if(this.showing){var _=this.options.height,w=this.container.offsetWidth,L=this.container.offsetHeight,P=parseInt(L/_),V=function(ce){var be=ce.offsetWidth||parseInt(ce.style.width),Te=ce.getBoundingClientRect().right||E.container.getBoundingClientRect().right+be;return E.container.getBoundingClientRect().right-Te},z=function(ce){return(w+ce)/5},le=function(ce,be,Te){for(var Ve=w/z(Te),Be=function(nt){var lt=E.danTunnel[be][nt+""];if(!lt||!lt.length)return E.danTunnel[be][nt+""]=[ce],ce.addEventListener("animationend",function(){E.danTunnel[be][nt+""].splice(0,1)}),{v:nt%P};if(be!=="right")return"continue";for(var Ot=0;Ot<lt.length;Ot++){var Bn=V(lt[Ot])-10;if(Bn<=w-Ve*z(parseInt(lt[Ot].style.width))||Bn<=0)break;if(Ot===lt.length-1)return E.danTunnel[be][nt+""].push(ce),ce.addEventListener("animationend",function(){E.danTunnel[be][nt+""].splice(0,1)}),{v:nt%P}}},Ne=0;E.unlimited||Ne<P;Ne++){var et=Be(Ne);if(et!=="continue"&&ot(et)==="object")return et.v}return-1};Object.prototype.toString.call(y)!=="[object Array]"&&(y=[y]);for(var fe=document.createDocumentFragment(),ge=function(){y[pe].type=$.number2Type(y[pe].type),y[pe].color||(y[pe].color=16777215);var ce=document.createElement("div");ce.classList.add("dplayer-danmaku-item"),ce.classList.add("dplayer-danmaku-".concat(y[pe].type)),y[pe].border?ce.innerHTML='<span style="border:'.concat(y[pe].border,'">').concat(y[pe].text,"</span>"):ce.innerHTML=y[pe].text,ce.style.opacity=E._opacity,ce.style.color=$.number2Color(y[pe].color),ce.addEventListener("animationend",function(){E.container.removeChild(ce)});var be,Te=E._measure(y[pe].text);switch(y[pe].type){case"right":(be=le(ce,y[pe].type,Te))>=0&&(ce.style.width=Te+1+"px",ce.style.top=_*be+"px",ce.style.transform="translateX(-".concat(w,"px)"));break;case"top":(be=le(ce,y[pe].type))>=0&&(ce.style.top=_*be+"px");break;case"bottom":(be=le(ce,y[pe].type))>=0&&(ce.style.bottom=_*be+"px");break;default:console.error("Can't handled danmaku type: ".concat(y[pe].type))}be>=0&&(ce.classList.add("dplayer-danmaku-move"),ce.style.animationDuration=E._danAnimation(y[pe].type),fe.appendChild(ce))},pe=0;pe<y.length;pe++)ge();return this.container.appendChild(fe),fe}}},{key:"play",value:function(){this.paused=!1}},{key:"pause",value:function(){this.paused=!0}},{key:"_measure",value:function(y){if(!this.context){var E=getComputedStyle(this.container.getElementsByClassName("dplayer-danmaku-item")[0],null);this.context=document.createElement("canvas").getContext("2d"),this.context.font=E.getPropertyValue("font")}return this.context.measureText(y).width}},{key:"seek",value:function(){this.clear();for(var y=0;y<this.dan.length;y++){if(this.dan[y].time>=this.options.time()){this.danIndex=y;break}this.danIndex=this.dan.length}}},{key:"clear",value:function(){this.danTunnel={right:{},top:{},bottom:{}},this.danIndex=0,this.options.container.innerHTML="",this.events&&this.events.trigger("danmaku_clear")}},{key:"htmlEncode",value:function(y){return y.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2f;")}},{key:"resize",value:function(){for(var y=this.container.offsetWidth,E=this.container.getElementsByClassName("dplayer-danmaku-item"),_=0;_<E.length;_++)E[_].style.transform="translateX(-".concat(y,"px)")}},{key:"hide",value:function(){this.showing=!1,this.pause(),this.clear(),this.events&&this.events.trigger("danmaku_hide")}},{key:"show",value:function(){this.seek(),this.showing=!0,this.play(),this.events&&this.events.trigger("danmaku_show")}},{key:"unlimit",value:function(y){this.unlimited=y}},{key:"speed",value:function(y){this.options.api.speedRate=y}},{key:"_danAnimation",value:function(y){var E=this.options.api.speedRate||1,_=!!this.player.fullScreen.isFullScreen();return{top:"".concat((_?6:4)/E,"s"),right:"".concat((_?8:5)/E,"s"),bottom:"".concat((_?6:4)/E,"s")}[y]}}],T&&Gr(b.prototype,T),Object.defineProperty(b,"prototype",{writable:!1}),A}();const jr=Kr;function At(A){return At=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},At(A)}function zr(A,b){for(var T=0;T<b.length;T++){var y=b[T];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(A,(E=function(_,w){if(At(_)!=="object"||_===null)return _;var L=_[Symbol.toPrimitive];if(L!==void 0){var P=L.call(_,"string");if(At(P)!=="object")return P;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(_)}(y.key),At(E)==="symbol"?E:String(E)),y)}var E}const Wr=function(){function A(){(function(y,E){if(!(y instanceof E))throw new TypeError("Cannot call a class as a function")})(this,A),this.events={},this.videoEvents=["abort","canplay","canplaythrough","durationchange","emptied","ended","error","loadeddata","loadedmetadata","loadstart","mozaudioavailable","pause","play","playing","progress","ratechange","seeked","seeking","stalled","suspend","timeupdate","volumechange","waiting"],this.playerEvents=["screenshot","thumbnails_show","thumbnails_hide","danmaku_show","danmaku_hide","danmaku_clear","danmaku_loaded","danmaku_send","danmaku_opacity","contextmenu_show","contextmenu_hide","notice_show","notice_hide","quality_start","quality_end","destroy","resize","fullscreen","fullscreen_cancel","webfullscreen","webfullscreen_cancel","subtitle_show","subtitle_hide","subtitle_change"]}var b,T;return b=A,(T=[{key:"on",value:function(y,E){this.type(y)&&typeof E=="function"&&(this.events[y]||(this.events[y]=[]),this.events[y].push(E))}},{key:"trigger",value:function(y,E){if(this.events[y]&&this.events[y].length)for(var _=0;_<this.events[y].length;_++)this.events[y][_](E)}},{key:"type",value:function(y){return this.playerEvents.indexOf(y)!==-1?"player":this.videoEvents.indexOf(y)!==-1?"video":(console.error("Unknown event name: ".concat(y)),null)}}])&&zr(b.prototype,T),Object.defineProperty(b,"prototype",{writable:!1}),A}();function vt(A){return vt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},vt(A)}function qr(A,b){for(var T=0;T<b.length;T++){var y=b[T];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(A,(E=function(_,w){if(vt(_)!=="object"||_===null)return _;var L=_[Symbol.toPrimitive];if(L!==void 0){var P=L.call(_,"string");if(vt(P)!=="object")return P;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(_)}(y.key),vt(E)==="symbol"?E:String(E)),y)}var E}var Yr=function(){function A(y){var E=this;(function(_,w){if(!(_ instanceof w))throw new TypeError("Cannot call a class as a function")})(this,A),this.player=y,this.lastScrollPosition={left:0,top:0},this.player.events.on("webfullscreen",function(){E.player.resize()}),this.player.events.on("webfullscreen_cancel",function(){E.player.resize(),$.setScrollPosition(E.lastScrollPosition)}),this.fullscreenchange=function(){E.player.resize(),E.isFullScreen("browser")?E.player.events.trigger("fullscreen"):($.setScrollPosition(E.lastScrollPosition),E.player.events.trigger("fullscreen_cancel"))},this.docfullscreenchange=function(){var _=document.fullscreenElement||document.mozFullScreenElement||document.msFullscreenElement;_&&_!==E.player.container||(E.player.resize(),_?E.player.events.trigger("fullscreen"):($.setScrollPosition(E.lastScrollPosition),E.player.events.trigger("fullscreen_cancel")))},/Firefox/.test(navigator.userAgent)?(document.addEventListener("mozfullscreenchange",this.docfullscreenchange),document.addEventListener("fullscreenchange",this.docfullscreenchange)):(this.player.container.addEventListener("fullscreenchange",this.fullscreenchange),this.player.container.addEventListener("webkitfullscreenchange",this.fullscreenchange),document.addEventListener("msfullscreenchange",this.docfullscreenchange),document.addEventListener("MSFullscreenChange",this.docfullscreenchange))}var b,T;return b=A,T=[{key:"isFullScreen",value:function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"browser";switch(y){case"browser":return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement;case"web":return this.player.container.classList.contains("dplayer-fulled")}}},{key:"request",value:function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"browser",E=y==="browser"?"web":"browser",_=this.isFullScreen(E);switch(_||(this.lastScrollPosition=$.getScrollPosition()),y){case"browser":this.player.container.requestFullscreen?this.player.container.requestFullscreen():this.player.container.mozRequestFullScreen?this.player.container.mozRequestFullScreen():this.player.container.webkitRequestFullscreen?this.player.container.webkitRequestFullscreen():this.player.video.webkitEnterFullscreen?this.player.video.webkitEnterFullscreen():this.player.video.webkitEnterFullScreen?this.player.video.webkitEnterFullScreen():this.player.container.msRequestFullscreen&&this.player.container.msRequestFullscreen();break;case"web":this.player.container.classList.add("dplayer-fulled"),document.body.classList.add("dplayer-web-fullscreen-fix"),this.player.events.trigger("webfullscreen")}_&&this.cancel(E)}},{key:"cancel",value:function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"browser";switch(y){case"browser":document.cancelFullScreen?document.cancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.webkitCancelFullscreen?document.webkitCancelFullscreen():document.msCancelFullScreen?document.msCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen();break;case"web":this.player.container.classList.remove("dplayer-fulled"),document.body.classList.remove("dplayer-web-fullscreen-fix"),this.player.events.trigger("webfullscreen_cancel")}}},{key:"toggle",value:function(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"browser";this.isFullScreen(y)?this.cancel(y):this.request(y)}},{key:"destroy",value:function(){/Firefox/.test(navigator.userAgent)?(document.removeEventListener("mozfullscreenchange",this.docfullscreenchange),document.removeEventListener("fullscreenchange",this.docfullscreenchange)):(this.player.container.removeEventListener("fullscreenchange",this.fullscreenchange),this.player.container.removeEventListener("webkitfullscreenchange",this.fullscreenchange),document.removeEventListener("msfullscreenchange",this.docfullscreenchange),document.removeEventListener("MSFullscreenChange",this.docfullscreenchange))}}],T&&qr(b.prototype,T),Object.defineProperty(b,"prototype",{writable:!1}),A}();const Qr=Yr;function bt(A){return bt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},bt(A)}function Xr(A,b){for(var T=0;T<b.length;T++){var y=b[T];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(A,(E=function(_,w){if(bt(_)!=="object"||_===null)return _;var L=_[Symbol.toPrimitive];if(L!==void 0){var P=L.call(_,"string");if(bt(P)!=="object")return P;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(_)}(y.key),bt(E)==="symbol"?E:String(E)),y)}var E}var Jr=function(){function A(y){(function(E,_){if(!(E instanceof _))throw new TypeError("Cannot call a class as a function")})(this,A),this.storageName={opacity:"dplayer-danmaku-opacity",volume:"dplayer-volume",unlimited:"dplayer-danmaku-unlimited",danmaku:"dplayer-danmaku-show",subtitle:"dplayer-subtitle-show"},this.default={opacity:.7,volume:y.options.hasOwnProperty("volume")?y.options.volume:.7,unlimited:(y.options.danmaku&&y.options.danmaku.unlimited?1:0)||0,danmaku:1,subtitle:1},this.data={},this.init()}var b,T;return b=A,(T=[{key:"init",value:function(){for(var y in this.storageName){var E=this.storageName[y];this.data[y]=parseFloat($.storage.get(E)||this.default[y])}}},{key:"get",value:function(y){return this.data[y]}},{key:"set",value:function(y,E){this.data[y]=E,$.storage.set(this.storageName[y],E)}}])&&Xr(b.prototype,T),Object.defineProperty(b,"prototype",{writable:!1}),A}();const Zr=Jr;function Et(A){return Et=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},Et(A)}function ei(A,b){for(var T=0;T<b.length;T++){var y=b[T];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(A,(E=function(_,w){if(Et(_)!=="object"||_===null)return _;var L=_[Symbol.toPrimitive];if(L!==void 0){var P=L.call(_,"string");if(Et(P)!=="object")return P;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(_)}(y.key),Et(E)==="symbol"?E:String(E)),y)}var E}var ti=function(){function A(y,E,_,w){(function(L,P){if(!(L instanceof P))throw new TypeError("Cannot call a class as a function")})(this,A),this.container=y,this.video=E,this.options=_,this.events=w,this.init()}var b,T;return b=A,T=[{key:"init",value:function(){var y=this;if(this.container.style.fontSize=this.options.fontSize,this.container.style.bottom=this.options.bottom,this.container.style.color=this.options.color,this.video.textTracks&&this.video.textTracks[0]){var E=this.video.textTracks[0];E.oncuechange=function(){var _=E.activeCues[E.activeCues.length-1];if(y.container.innerHTML="",_){var w=document.createElement("div");w.appendChild(_.getCueAsHTML());var L=w.innerHTML.split(/\r?\n/).map(function(P){return"<p>".concat(P,"</p>")}).join("");y.container.innerHTML=L}y.events.trigger("subtitle_change")}}}},{key:"show",value:function(){this.container.classList.remove("dplayer-subtitle-hide"),this.events.trigger("subtitle_show")}},{key:"hide",value:function(){this.container.classList.add("dplayer-subtitle-hide"),this.events.trigger("subtitle_hide")}},{key:"toggle",value:function(){this.container.classList.contains("dplayer-subtitle-hide")?this.show():this.hide()}}],T&&ei(b.prototype,T),Object.defineProperty(b,"prototype",{writable:!1}),A}();const ni=ti;function xt(A){return xt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},xt(A)}function ri(A,b){for(var T=0;T<b.length;T++){var y=b[T];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(A,(E=function(_,w){if(xt(_)!=="object"||_===null)return _;var L=_[Symbol.toPrimitive];if(L!==void 0){var P=L.call(_,"string");if(xt(P)!=="object")return P;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(_)}(y.key),xt(E)==="symbol"?E:String(E)),y)}var E}var ii=function(){function A(y){var E=this;(function(P,V){if(!(P instanceof V))throw new TypeError("Cannot call a class as a function")})(this,A),this.player=y,this.player.template.mask.addEventListener("click",function(){E.hide()}),this.player.template.subtitlesButton.addEventListener("click",function(){E.adaptiveHeight(),E.show()});for(var _=this.player.template.subtitlesItem.length-1,w=function(P){E.player.template.subtitlesItem[P].addEventListener("click",function(){E.hide(),E.player.options.subtitle.index!==P&&(E.player.template.subtitle.innerHTML="<p></p>",E.player.template.subtrack.src=E.player.template.subtitlesItem[P].dataset.subtitle,E.player.options.subtitle.index=P,E.player.template.subtitle.classList.contains("dplayer-subtitle-hide")&&E.subContainerShow())})},L=0;L<_;L++)w(L);this.player.template.subtitlesItem[_].addEventListener("click",function(){E.hide(),E.player.options.subtitle.index!==_&&(E.player.template.subtitle.innerHTML="<p></p>",E.player.template.subtrack.src="",E.player.options.subtitle.index=_,E.subContainerHide())})}var b,T;return b=A,(T=[{key:"subContainerShow",value:function(){this.player.template.subtitle.classList.remove("dplayer-subtitle-hide"),this.player.events.trigger("subtitle_show")}},{key:"subContainerHide",value:function(){this.player.template.subtitle.classList.add("dplayer-subtitle-hide"),this.player.events.trigger("subtitle_hide")}},{key:"hide",value:function(){this.player.template.subtitlesBox.classList.remove("dplayer-subtitles-box-open"),this.player.template.mask.classList.remove("dplayer-mask-show"),this.player.controller.disableAutoHide=!1}},{key:"show",value:function(){this.player.template.subtitlesBox.classList.add("dplayer-subtitles-box-open"),this.player.template.mask.classList.add("dplayer-mask-show"),this.player.controller.disableAutoHide=!0}},{key:"adaptiveHeight",value:function(){var y=30*this.player.template.subtitlesItem.length+14,E=.8*this.player.template.videoWrap.offsetHeight;y>=E-50?(this.player.template.subtitlesBox.style.bottom="8px",this.player.template.subtitlesBox.style["max-height"]=E-8+"px"):(this.player.template.subtitlesBox.style.bottom="50px",this.player.template.subtitlesBox.style["max-height"]=E-50+"px")}}])&&ri(b.prototype,T),Object.defineProperty(b,"prototype",{writable:!1}),A}();const si=ii;function _t(A){return _t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},_t(A)}function oi(A,b){for(var T=0;T<b.length;T++){var y=b[T];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(A,(E=function(_,w){if(_t(_)!=="object"||_===null)return _;var L=_[Symbol.toPrimitive];if(L!==void 0){var P=L.call(_,"string");if(_t(P)!=="object")return P;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(_)}(y.key),_t(E)==="symbol"?E:String(E)),y)}var E}var ai=function(){function A(y){(function(E,_){if(!(E instanceof _))throw new TypeError("Cannot call a class as a function")})(this,A),this.elements={},this.elements.volume=y.volumeBar,this.elements.played=y.playedBar,this.elements.loaded=y.loadedBar,this.elements.danmaku=y.danmakuOpacityBar}var b,T;return b=A,(T=[{key:"set",value:function(y,E,_){E=Math.max(E,0),E=Math.min(E,1),this.elements[y].style[_]=100*E+"%"}},{key:"get",value:function(y){return parseFloat(this.elements[y].style.width)/100}}])&&oi(b.prototype,T),Object.defineProperty(b,"prototype",{writable:!1}),A}();const ci=ai;function St(A){return St=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},St(A)}function ui(A,b){for(var T=0;T<b.length;T++){var y=b[T];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(A,(E=function(_,w){if(St(_)!=="object"||_===null)return _;var L=_[Symbol.toPrimitive];if(L!==void 0){var P=L.call(_,"string");if(St(P)!=="object")return P;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(_)}(y.key),St(E)==="symbol"?E:String(E)),y)}var E}var di=function(){function A(y){(function(E,_){if(!(E instanceof _))throw new TypeError("Cannot call a class as a function")})(this,A),this.player=y,window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(E){window.setTimeout(E,1e3/60)},this.types=["loading","info","fps"],this.init()}var b,T;return b=A,(T=[{key:"init",value:function(){var y=this;this.types.map(function(E){return E!=="fps"&&y["init".concat(E,"Checker")](),E})}},{key:"initloadingChecker",value:function(){var y=this,E=0,_=0,w=!1;this.loadingChecker=setInterval(function(){y.enableloadingChecker&&(_=y.player.video.currentTime,w||_!==E||y.player.video.paused||(y.player.container.classList.add("dplayer-loading"),w=!0),w&&_>E&&!y.player.video.paused&&(y.player.container.classList.remove("dplayer-loading"),w=!1),E=_)},100)}},{key:"initfpsChecker",value:function(){var y=this;window.requestAnimationFrame(function(){if(y.enablefpsChecker)if(y.initfpsChecker(),y.fpsStart){y.fpsIndex++;var E=new Date;E-y.fpsStart>1e3&&(y.player.infoPanel.fps(y.fpsIndex/(E-y.fpsStart)*1e3),y.fpsStart=new Date,y.fpsIndex=0)}else y.fpsStart=new Date,y.fpsIndex=0;else y.fpsStart=0,y.fpsIndex=0})}},{key:"initinfoChecker",value:function(){var y=this;this.infoChecker=setInterval(function(){y.enableinfoChecker&&y.player.infoPanel.update()},1e3)}},{key:"enable",value:function(y){this["enable".concat(y,"Checker")]=!0,y==="fps"&&this.initfpsChecker()}},{key:"disable",value:function(y){this["enable".concat(y,"Checker")]=!1}},{key:"destroy",value:function(){var y=this;this.types.map(function(E){return y["enable".concat(E,"Checker")]=!1,y["".concat(E,"Checker")]&&clearInterval(y["".concat(E,"Checker")]),E})}}])&&ui(b.prototype,T),Object.defineProperty(b,"prototype",{writable:!1}),A}();const hi=di;function Tt(A){return Tt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},Tt(A)}function fi(A,b){for(var T=0;T<b.length;T++){var y=b[T];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(A,(E=function(_,w){if(Tt(_)!=="object"||_===null)return _;var L=_[Symbol.toPrimitive];if(L!==void 0){var P=L.call(_,"string");if(Tt(P)!=="object")return P;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(_)}(y.key),Tt(E)==="symbol"?E:String(E)),y)}var E}const pi=function(){function A(y){var E=this;(function(_,w){if(!(_ instanceof w))throw new TypeError("Cannot call a class as a function")})(this,A),this.container=y,this.container.addEventListener("animationend",function(){E.container.classList.remove("dplayer-bezel-transition")})}var b,T;return b=A,(T=[{key:"switch",value:function(y){this.container.innerHTML=y,this.container.classList.add("dplayer-bezel-transition")}}])&&fi(b.prototype,T),Object.defineProperty(b,"prototype",{writable:!1}),A}();function Ct(A){return Ct=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},Ct(A)}function mi(A,b){for(var T=0;T<b.length;T++){var y=b[T];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(A,(E=function(_,w){if(Ct(_)!=="object"||_===null)return _;var L=_[Symbol.toPrimitive];if(L!==void 0){var P=L.call(_,"string");if(Ct(P)!=="object")return P;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(_)}(y.key),Ct(E)==="symbol"?E:String(E)),y)}var E}var gi=function(){function A(y){(function(E,_){if(!(E instanceof _))throw new TypeError("Cannot call a class as a function")})(this,A),this.container=y.container,this.barWidth=y.barWidth,this.container.style.backgroundImage="url('".concat(y.url,"')"),this.events=y.events}var b,T;return b=A,(T=[{key:"resize",value:function(y,E,_){this.container.style.width="".concat(y,"px"),this.container.style.height="".concat(E,"px"),this.container.style.top="".concat(2-E,"px"),this.barWidth=_}},{key:"show",value:function(){this.container.style.display="block",this.events&&this.events.trigger("thumbnails_show")}},{key:"move",value:function(y){this.container.style.backgroundPosition="-".concat(160*(Math.ceil(y/this.barWidth*100)-1),"px 0"),this.container.style.left="".concat(Math.min(Math.max(y-this.container.offsetWidth/2,-10),this.barWidth-150),"px")}},{key:"hide",value:function(){this.container.style.display="none",this.events&&this.events.trigger("thumbnails_hide")}}])&&mi(b.prototype,T),Object.defineProperty(b,"prototype",{writable:!1}),A}();const yi=gi;function wt(A){return wt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},wt(A)}function Ai(A,b){for(var T=0;T<b.length;T++){var y=b[T];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(A,(E=function(_,w){if(wt(_)!=="object"||_===null)return _;var L=_[Symbol.toPrimitive];if(L!==void 0){var P=L.call(_,"string");if(wt(P)!=="object")return P;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(_)}(y.key),wt(E)==="symbol"?E:String(E)),y)}var E}var Ze,Ln=!0,tn=!1,vi=function(){function A(y){(function(E,_){if(!(E instanceof _))throw new TypeError("Cannot call a class as a function")})(this,A),this.player=y,this.autoHideTimer=0,$.isMobile||(this.setAutoHideHandler=this.setAutoHide.bind(this),this.player.container.addEventListener("mousemove",this.setAutoHideHandler),this.player.container.addEventListener("click",this.setAutoHideHandler),this.player.on("play",this.setAutoHideHandler),this.player.on("pause",this.setAutoHideHandler)),this.initPlayButton(),this.initThumbnails(),this.initPlayedBar(),this.initFullButton(),this.initQualityButton(),this.initScreenshotButton(),this.player.options.subtitle&&typeof this.player.options.subtitle.url=="string"&&this.initSubtitleButton(),this.initHighlights(),this.initAirplayButton(),this.initChromecastButton(),$.isMobile||this.initVolumeButton()}var b,T;return b=A,(T=[{key:"initPlayButton",value:function(){var y=this;this.player.template.playButton.addEventListener("click",function(){y.player.toggle()}),this.player.template.mobilePlayButton.addEventListener("click",function(){y.player.toggle()}),$.isMobile?(this.player.template.videoWrap.addEventListener("click",function(){y.toggle()}),this.player.template.controllerMask.addEventListener("click",function(){y.toggle()})):this.player.options.preventClickToggle||(this.player.template.videoWrap.addEventListener("click",function(){y.player.toggle()}),this.player.template.controllerMask.addEventListener("click",function(){y.player.toggle()}))}},{key:"initHighlights",value:function(){var y=this;this.player.on("durationchange",function(){if(y.player.video.duration!==1&&y.player.video.duration!==1/0&&y.player.options.highlight){var E=y.player.template.playedBarWrap.querySelectorAll(".dplayer-highlight");[].slice.call(E,0).forEach(function(L){y.player.template.playedBarWrap.removeChild(L)});for(var _=0;_<y.player.options.highlight.length;_++)if(y.player.options.highlight[_].text&&y.player.options.highlight[_].time){var w=document.createElement("div");w.classList.add("dplayer-highlight"),w.style.left=y.player.options.highlight[_].time/y.player.video.duration*100+"%",w.innerHTML='<span class="dplayer-highlight-text">'+y.player.options.highlight[_].text+"</span>",y.player.template.playedBarWrap.insertBefore(w,y.player.template.playedBarTime)}}})}},{key:"initThumbnails",value:function(){var y=this;this.player.options.video.thumbnails&&(this.thumbnails=new yi({container:this.player.template.barPreview,barWidth:this.player.template.barWrap.offsetWidth,url:this.player.options.video.thumbnails,events:this.player.events}),this.player.on("loadedmetadata",function(){y.thumbnails.resize(160,y.player.video.videoHeight/y.player.video.videoWidth*160,y.player.template.barWrap.offsetWidth)}))}},{key:"initPlayedBar",value:function(){var y=this,E=function(w){var L=((w.clientX||w.changedTouches[0].clientX)-$.getBoundingClientRectViewLeft(y.player.template.playedBarWrap))/y.player.template.playedBarWrap.clientWidth;L=Math.max(L,0),L=Math.min(L,1),y.player.bar.set("played",L,"width"),y.player.template.ptime.innerHTML=$.secondToTime(L*y.player.video.duration)},_=function w(L){document.removeEventListener($.nameMap.dragEnd,w),document.removeEventListener($.nameMap.dragMove,E);var P=((L.clientX||L.changedTouches[0].clientX)-$.getBoundingClientRectViewLeft(y.player.template.playedBarWrap))/y.player.template.playedBarWrap.clientWidth;P=Math.max(P,0),P=Math.min(P,1),y.player.bar.set("played",P,"width"),y.player.seek(y.player.bar.get("played")*y.player.video.duration),y.player.timer.enable("progress")};this.player.template.playedBarWrap.addEventListener($.nameMap.dragStart,function(){y.player.timer.disable("progress"),document.addEventListener($.nameMap.dragMove,E),document.addEventListener($.nameMap.dragEnd,_)}),this.player.template.playedBarWrap.addEventListener($.nameMap.dragMove,function(w){if(y.player.video.duration){var L=y.player.template.playedBarWrap.getBoundingClientRect().left,P=(w.clientX||w.changedTouches[0].clientX)-L;if(P<0||P>y.player.template.playedBarWrap.offsetWidth)return;var V=y.player.video.duration*(P/y.player.template.playedBarWrap.offsetWidth);$.isMobile&&y.thumbnails&&y.thumbnails.show(),y.thumbnails&&y.thumbnails.move(P),y.player.template.playedBarTime.style.left="".concat(P-(V>=3600?25:20),"px"),y.player.template.playedBarTime.innerText=$.secondToTime(V),y.player.template.playedBarTime.classList.remove("hidden")}}),this.player.template.playedBarWrap.addEventListener($.nameMap.dragEnd,function(){$.isMobile&&y.thumbnails&&y.thumbnails.hide()}),$.isMobile||(this.player.template.playedBarWrap.addEventListener("mouseenter",function(){y.player.video.duration&&(y.thumbnails&&y.thumbnails.show(),y.player.template.playedBarTime.classList.remove("hidden"))}),this.player.template.playedBarWrap.addEventListener("mouseleave",function(){y.player.video.duration&&(y.thumbnails&&y.thumbnails.hide(),y.player.template.playedBarTime.classList.add("hidden"))}))}},{key:"initFullButton",value:function(){var y=this;this.player.template.browserFullButton.addEventListener("click",function(){y.player.fullScreen.toggle("browser")}),this.player.template.webFullButton.addEventListener("click",function(){y.player.fullScreen.toggle("web")})}},{key:"initVolumeButton",value:function(){var y=this,E=function(w){var L=w||window.event,P=((L.clientX||L.changedTouches[0].clientX)-$.getBoundingClientRectViewLeft(y.player.template.volumeBarWrap)-5.5)/35;y.player.volume(P)},_=function w(){document.removeEventListener($.nameMap.dragEnd,w),document.removeEventListener($.nameMap.dragMove,E),y.player.template.volumeButton.classList.remove("dplayer-volume-active")};this.player.template.volumeBarWrapWrap.addEventListener("click",function(w){var L=w||window.event,P=((L.clientX||L.changedTouches[0].clientX)-$.getBoundingClientRectViewLeft(y.player.template.volumeBarWrap)-5.5)/35;y.player.volume(P)}),this.player.template.volumeBarWrapWrap.addEventListener($.nameMap.dragStart,function(){document.addEventListener($.nameMap.dragMove,E),document.addEventListener($.nameMap.dragEnd,_),y.player.template.volumeButton.classList.add("dplayer-volume-active")}),this.player.template.volumeButtonIcon.addEventListener("click",function(){y.player.video.muted?(y.player.video.muted=!1,y.player.switchVolumeIcon(),y.player.bar.set("volume",y.player.volume(),"width")):(y.player.video.muted=!0,y.player.template.volumeIcon.innerHTML=We.volumeOff,y.player.bar.set("volume",0,"width"))})}},{key:"initQualityButton",value:function(){var y=this;this.player.options.video.quality&&this.player.template.qualityList.addEventListener("click",function(E){E.target.classList.contains("dplayer-quality-item")&&y.player.switchQuality(E.target.dataset.index)})}},{key:"initScreenshotButton",value:function(){var y=this;this.player.options.screenshot&&this.player.template.camareButton.addEventListener("click",function(){var E,_=document.createElement("canvas");_.width=y.player.video.videoWidth,_.height=y.player.video.videoHeight,_.getContext("2d").drawImage(y.player.video,0,0,_.width,_.height),_.toBlob(function(w){E=URL.createObjectURL(w);var L=document.createElement("a");L.href=E,L.download="DPlayer.png",L.style.display="none",document.body.appendChild(L),L.click(),document.body.removeChild(L),URL.revokeObjectURL(E),y.player.events.trigger("screenshot",E)})})}},{key:"initAirplayButton",value:function(){this.player.options.airplay&&(window.WebKitPlaybackTargetAvailabilityEvent?this.player.video.addEventListener("webkitplaybacktargetavailabilitychanged",(function(y){y.availability==="available"?this.template.airplayButton.disable=!1:this.template.airplayButton.disable=!0,this.template.airplayButton.addEventListener("click",(function(){this.video.webkitShowPlaybackTargetPicker()}).bind(this))}).bind(this.player)):this.player.template.airplayButton.style.display="none")}},{key:"initChromecast",value:function(){var y=window.document.createElement("script");y.setAttribute("type","text/javascript"),y.setAttribute("src","https://www.gstatic.com/cv/js/sender/v1/cast_sender.js?loadCastFramework=1"),window.document.body.appendChild(y),window.__onGCastApiAvailable=function(E){if(E){var _=new(Ze=window.chrome.cast).SessionRequest(Ze.media.DEFAULT_MEDIA_RECEIVER_APP_ID),w=new Ze.ApiConfig(_,function(){},function(L){L===Ze.ReceiverAvailability.AVAILABLE&&console.log("chromecast: ",L)});Ze.initialize(w,function(){})}}}},{key:"initChromecastButton",value:function(){var y=this;if(this.player.options.chromecast){Ln&&(Ln=!1,this.initChromecast());var E=function(w,L){y.currentMedia=L},_=function(w){console.error("Error launching media",w)};this.player.template.chromecastButton.addEventListener("click",function(){tn?(tn=!1,y.currentMedia.stop(),y.session.stop(),y.initChromecast()):(tn=!0,Ze.requestSession(function(w){var L,P,V;y.session=w,L=y.player.options.video.url,P=new Ze.media.MediaInfo(L),V=new Ze.media.LoadRequest(P),y.session?y.session.loadMedia(V,E.bind(y,"loadMedia"),_).play():window.open(L)},function(w){w.code==="cancel"?y.session=void 0:console.error("Error selecting a cast device",w)}))})}}},{key:"initSubtitleButton",value:function(){var y=this;this.player.events.on("subtitle_show",function(){y.player.template.subtitleButton.dataset.balloon=y.player.tran("hide-subs"),y.player.template.subtitleButtonInner.style.opacity="",y.player.user.set("subtitle",1)}),this.player.events.on("subtitle_hide",function(){y.player.template.subtitleButton.dataset.balloon=y.player.tran("show-subs"),y.player.template.subtitleButtonInner.style.opacity="0.4",y.player.user.set("subtitle",0)}),this.player.template.subtitleButton.addEventListener("click",function(){y.player.subtitle.toggle()})}},{key:"setAutoHide",value:function(){var y=this;this.show(),clearTimeout(this.autoHideTimer),this.autoHideTimer=setTimeout(function(){!y.player.video.played.length||y.player.paused||y.disableAutoHide||y.hide()},3e3)}},{key:"show",value:function(){this.player.container.classList.remove("dplayer-hide-controller")}},{key:"hide",value:function(){this.player.container.classList.add("dplayer-hide-controller"),this.player.setting.hide(),this.player.comment&&this.player.comment.hide()}},{key:"isShow",value:function(){return!this.player.container.classList.contains("dplayer-hide-controller")}},{key:"toggle",value:function(){this.isShow()?this.hide():this.show()}},{key:"destroy",value:function(){$.isMobile||(this.player.container.removeEventListener("mousemove",this.setAutoHideHandler),this.player.container.removeEventListener("click",this.setAutoHideHandler)),clearTimeout(this.autoHideTimer)}}])&&Ai(b.prototype,T),Object.defineProperty(b,"prototype",{writable:!1}),A}();const bi=vi;function Rt(A){return Rt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},Rt(A)}function Ei(A,b){for(var T=0;T<b.length;T++){var y=b[T];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(A,(E=function(_,w){if(Rt(_)!=="object"||_===null)return _;var L=_[Symbol.toPrimitive];if(L!==void 0){var P=L.call(_,"string");if(Rt(P)!=="object")return P;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(_)}(y.key),Rt(E)==="symbol"?E:String(E)),y)}var E}var xi=function(){function A(y){var E=this;(function(V,z){if(!(V instanceof z))throw new TypeError("Cannot call a class as a function")})(this,A),this.player=y,this.player.template.mask.addEventListener("click",function(){E.hide()}),this.player.template.settingButton.addEventListener("click",function(){E.show()}),this.loop=this.player.options.loop,this.player.template.loopToggle.checked=this.loop,this.player.template.loop.addEventListener("click",function(){E.player.template.loopToggle.checked=!E.player.template.loopToggle.checked,E.player.template.loopToggle.checked?E.loop=!0:E.loop=!1,E.hide()}),this.showDanmaku=this.player.user.get("danmaku"),this.showDanmaku||this.player.danmaku&&this.player.danmaku.hide(),this.player.template.showDanmakuToggle.checked=this.showDanmaku,this.player.template.showDanmaku.addEventListener("click",function(){E.player.template.showDanmakuToggle.checked=!E.player.template.showDanmakuToggle.checked,E.player.template.showDanmakuToggle.checked?(E.showDanmaku=!0,E.player.danmaku.show()):(E.showDanmaku=!1,E.player.danmaku.hide()),E.player.user.set("danmaku",E.showDanmaku?1:0),E.hide()}),this.unlimitDanmaku=this.player.user.get("unlimited"),this.player.template.unlimitDanmakuToggle.checked=this.unlimitDanmaku,this.player.template.unlimitDanmaku.addEventListener("click",function(){E.player.template.unlimitDanmakuToggle.checked=!E.player.template.unlimitDanmakuToggle.checked,E.player.template.unlimitDanmakuToggle.checked?(E.unlimitDanmaku=!0,E.player.danmaku.unlimit(!0)):(E.unlimitDanmaku=!1,E.player.danmaku.unlimit(!1)),E.player.user.set("unlimited",E.unlimitDanmaku?1:0),E.hide()}),this.player.template.speed.addEventListener("click",function(){E.player.template.settingBox.classList.add("dplayer-setting-box-narrow"),E.player.template.settingBox.classList.add("dplayer-setting-box-speed")});for(var _=function(V){E.player.template.speedItem[V].addEventListener("click",function(){E.player.speed(E.player.template.speedItem[V].dataset.speed),E.hide()})},w=0;w<this.player.template.speedItem.length;w++)_(w);if(this.player.danmaku){this.player.on("danmaku_opacity",function(V){E.player.bar.set("danmaku",V,"width"),E.player.user.set("opacity",V)}),this.player.danmaku.opacity(this.player.user.get("opacity"));var L=function(V){var z=V||window.event,le=((z.clientX||z.changedTouches[0].clientX)-$.getBoundingClientRectViewLeft(E.player.template.danmakuOpacityBarWrap))/130;le=Math.max(le,0),le=Math.min(le,1),E.player.danmaku.opacity(le)},P=function V(){document.removeEventListener($.nameMap.dragEnd,V),document.removeEventListener($.nameMap.dragMove,L),E.player.template.danmakuOpacityBox.classList.remove("dplayer-setting-danmaku-active")};this.player.template.danmakuOpacityBarWrapWrap.addEventListener("click",function(V){var z=V||window.event,le=((z.clientX||z.changedTouches[0].clientX)-$.getBoundingClientRectViewLeft(E.player.template.danmakuOpacityBarWrap))/130;le=Math.max(le,0),le=Math.min(le,1),E.player.danmaku.opacity(le)}),this.player.template.danmakuOpacityBarWrapWrap.addEventListener($.nameMap.dragStart,function(){document.addEventListener($.nameMap.dragMove,L),document.addEventListener($.nameMap.dragEnd,P),E.player.template.danmakuOpacityBox.classList.add("dplayer-setting-danmaku-active")})}}var b,T;return b=A,(T=[{key:"hide",value:function(){var y=this;this.player.template.settingBox.classList.remove("dplayer-setting-box-open"),this.player.template.mask.classList.remove("dplayer-mask-show"),setTimeout(function(){y.player.template.settingBox.classList.remove("dplayer-setting-box-narrow"),y.player.template.settingBox.classList.remove("dplayer-setting-box-speed")},300),this.player.controller.disableAutoHide=!1}},{key:"show",value:function(){this.player.template.settingBox.classList.add("dplayer-setting-box-open"),this.player.template.mask.classList.add("dplayer-mask-show"),this.player.controller.disableAutoHide=!0}}])&&Ei(b.prototype,T),Object.defineProperty(b,"prototype",{writable:!1}),A}();const _i=xi;function kt(A){return kt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},kt(A)}function Si(A,b){for(var T=0;T<b.length;T++){var y=b[T];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(A,(E=function(_,w){if(kt(_)!=="object"||_===null)return _;var L=_[Symbol.toPrimitive];if(L!==void 0){var P=L.call(_,"string");if(kt(P)!=="object")return P;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(_)}(y.key),kt(E)==="symbol"?E:String(E)),y)}var E}var Ti=function(){function A(y){var E=this;(function(_,w){if(!(_ instanceof w))throw new TypeError("Cannot call a class as a function")})(this,A),this.player=y,this.player.template.mask.addEventListener("click",function(){E.hide()}),this.player.template.commentButton.addEventListener("click",function(){E.show()}),this.player.template.commentSettingButton.addEventListener("click",function(){E.toggleSetting()}),this.player.template.commentColorSettingBox.addEventListener("click",function(){if(E.player.template.commentColorSettingBox.querySelector("input:checked+span")){var _=E.player.template.commentColorSettingBox.querySelector("input:checked").value;E.player.template.commentSettingFill.style.fill=_,E.player.template.commentInput.style.color=_,E.player.template.commentSendFill.style.fill=_}}),this.player.template.commentInput.addEventListener("click",function(){E.hideSetting()}),this.player.template.commentInput.addEventListener("keydown",function(_){(_||window.event).keyCode===13&&E.send()}),this.player.template.commentSendButton.addEventListener("click",function(){E.send()})}var b,T;return b=A,(T=[{key:"show",value:function(){this.player.controller.disableAutoHide=!0,this.player.template.controller.classList.add("dplayer-controller-comment"),this.player.template.mask.classList.add("dplayer-mask-show"),this.player.container.classList.add("dplayer-show-controller"),this.player.template.commentInput.focus()}},{key:"hide",value:function(){this.player.template.controller.classList.remove("dplayer-controller-comment"),this.player.template.mask.classList.remove("dplayer-mask-show"),this.player.container.classList.remove("dplayer-show-controller"),this.player.controller.disableAutoHide=!1,this.hideSetting()}},{key:"showSetting",value:function(){this.player.template.commentSettingBox.classList.add("dplayer-comment-setting-open")}},{key:"hideSetting",value:function(){this.player.template.commentSettingBox.classList.remove("dplayer-comment-setting-open")}},{key:"toggleSetting",value:function(){this.player.template.commentSettingBox.classList.contains("dplayer-comment-setting-open")?this.hideSetting():this.showSetting()}},{key:"send",value:function(){var y=this;this.player.template.commentInput.blur(),this.player.template.commentInput.value.replace(/^\s+|\s+$/g,"")?this.player.danmaku.send({text:this.player.template.commentInput.value,color:$.color2Number(this.player.container.querySelector(".dplayer-comment-setting-color input:checked").value),type:parseInt(this.player.container.querySelector(".dplayer-comment-setting-type input:checked").value)},function(){y.player.template.commentInput.value="",y.hide()}):this.player.notice(this.player.tran("please-input-danmaku"))}}])&&Si(b.prototype,T),Object.defineProperty(b,"prototype",{writable:!1}),A}();const Ci=Ti;function It(A){return It=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},It(A)}function wi(A,b){for(var T=0;T<b.length;T++){var y=b[T];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(A,(E=function(_,w){if(It(_)!=="object"||_===null)return _;var L=_[Symbol.toPrimitive];if(L!==void 0){var P=L.call(_,"string");if(It(P)!=="object")return P;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(_)}(y.key),It(E)==="symbol"?E:String(E)),y)}var E}var Ri=function(){function A(y){(function(E,_){if(!(E instanceof _))throw new TypeError("Cannot call a class as a function")})(this,A),this.player=y,this.doHotKeyHandler=this.doHotKey.bind(this),this.cancelFullScreenHandler=this.cancelFullScreen.bind(this),this.player.options.hotkey&&document.addEventListener("keydown",this.doHotKeyHandler),document.addEventListener("keydown",this.cancelFullScreenHandler)}var b,T;return b=A,(T=[{key:"doHotKey",value:function(y){if(this.player.focus){var E=document.activeElement.tagName.toUpperCase(),_=document.activeElement.getAttribute("contenteditable");if(E!=="INPUT"&&E!=="TEXTAREA"&&_!==""&&_!=="true"){var w,L=y||window.event;switch(L.keyCode){case 32:L.preventDefault(),this.player.toggle();break;case 37:if(L.preventDefault(),this.player.options.live)break;this.player.seek(this.player.video.currentTime-5),this.player.controller.setAutoHide();break;case 39:if(L.preventDefault(),this.player.options.live)break;this.player.seek(this.player.video.currentTime+5),this.player.controller.setAutoHide();break;case 38:L.preventDefault(),w=this.player.volume()+.1,this.player.volume(w);break;case 40:L.preventDefault(),w=this.player.volume()-.1,this.player.volume(w)}}}}},{key:"cancelFullScreen",value:function(y){(y||window.event).keyCode===27&&this.player.fullScreen.isFullScreen("web")&&this.player.fullScreen.cancel("web")}},{key:"destroy",value:function(){this.player.options.hotkey&&document.removeEventListener("keydown",this.doHotKeyHandler),document.removeEventListener("keydown",this.cancelFullScreenHandler)}}])&&wi(b.prototype,T),Object.defineProperty(b,"prototype",{writable:!1}),A}();const ki=Ri;function Lt(A){return Lt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},Lt(A)}function Ii(A,b){for(var T=0;T<b.length;T++){var y=b[T];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(A,(E=function(_,w){if(Lt(_)!=="object"||_===null)return _;var L=_[Symbol.toPrimitive];if(L!==void 0){var P=L.call(_,"string");if(Lt(P)!=="object")return P;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(_)}(y.key),Lt(E)==="symbol"?E:String(E)),y)}var E}var Li=function(){function A(y){var E=this;(function(_,w){if(!(_ instanceof w))throw new TypeError("Cannot call a class as a function")})(this,A),this.player=y,this.shown=!1,Array.prototype.slice.call(this.player.template.menuItem).forEach(function(_,w){E.player.options.contextmenu[w].click&&_.addEventListener("click",function(){E.player.options.contextmenu[w].click(E.player),E.hide()})}),this.contextmenuHandler=function(_){if(E.shown)E.hide();else{var w=_||window.event;w.preventDefault();var L=E.player.container.getBoundingClientRect();E.show(w.clientX-L.left,w.clientY-L.top),E.player.template.mask.addEventListener("click",function(){E.hide()})}},this.player.container.addEventListener("contextmenu",this.contextmenuHandler)}var b,T;return b=A,(T=[{key:"show",value:function(y,E){this.player.template.menu.classList.add("dplayer-menu-show");var _=this.player.container.getBoundingClientRect();y+this.player.template.menu.offsetWidth>=_.width?(this.player.template.menu.style.right=_.width-y+"px",this.player.template.menu.style.left="initial"):(this.player.template.menu.style.left=y+"px",this.player.template.menu.style.right="initial"),E+this.player.template.menu.offsetHeight>=_.height?(this.player.template.menu.style.bottom=_.height-E+"px",this.player.template.menu.style.top="initial"):(this.player.template.menu.style.top=E+"px",this.player.template.menu.style.bottom="initial"),this.player.template.mask.classList.add("dplayer-mask-show"),this.shown=!0,this.player.events.trigger("contextmenu_show")}},{key:"hide",value:function(){this.player.template.mask.classList.remove("dplayer-mask-show"),this.player.template.menu.classList.remove("dplayer-menu-show"),this.shown=!1,this.player.events.trigger("contextmenu_hide")}},{key:"destroy",value:function(){this.player.container.removeEventListener("contextmenu",this.contextmenuHandler)}}])&&Ii(b.prototype,T),Object.defineProperty(b,"prototype",{writable:!1}),A}();const Pi=Li;function Pt(A){return Pt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},Pt(A)}function Di(A,b){for(var T=0;T<b.length;T++){var y=b[T];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(A,(E=function(_,w){if(Pt(_)!=="object"||_===null)return _;var L=_[Symbol.toPrimitive];if(L!==void 0){var P=L.call(_,"string");if(Pt(P)!=="object")return P;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(_)}(y.key),Pt(E)==="symbol"?E:String(E)),y)}var E}var Oi=function(){function A(y){var E=this;(function(_,w){if(!(_ instanceof w))throw new TypeError("Cannot call a class as a function")})(this,A),this.container=y.template.infoPanel,this.template=y.template,this.video=y.video,this.player=y,this.template.infoPanelClose.addEventListener("click",function(){E.hide()})}var b,T;return b=A,(T=[{key:"show",value:function(){this.beginTime=Date.now(),this.update(),this.player.timer.enable("info"),this.player.timer.enable("fps"),this.container.classList.remove("dplayer-info-panel-hide")}},{key:"hide",value:function(){this.player.timer.disable("info"),this.player.timer.disable("fps"),this.container.classList.add("dplayer-info-panel-hide")}},{key:"triggle",value:function(){this.container.classList.contains("dplayer-info-panel-hide")?this.show():this.hide()}},{key:"update",value:function(){this.template.infoVersion.innerHTML="v".concat("1.27.1"," ").concat("v1.27.0-12-g4f61091"),this.template.infoType.innerHTML=this.player.type,this.template.infoUrl.innerHTML=this.player.options.video.url,this.template.infoResolution.innerHTML="".concat(this.player.video.videoWidth," x ").concat(this.player.video.videoHeight),this.template.infoDuration.innerHTML=this.player.video.duration,this.player.options.danmaku&&(this.template.infoDanmakuId.innerHTML=this.player.options.danmaku.id,this.template.infoDanmakuApi.innerHTML=this.player.options.danmaku.api,this.template.infoDanmakuAmount.innerHTML=this.player.danmaku.dan.length)}},{key:"fps",value:function(y){this.template.infoFPS.innerHTML="".concat(y.toFixed(1))}}])&&Di(b.prototype,T),Object.defineProperty(b,"prototype",{writable:!1}),A}();const Ni=Oi;var Bi=i(568),Mi=i.n(Bi);function Dt(A){return Dt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},Dt(A)}function Pn(A,b){var T=Object.keys(A);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(A);b&&(y=y.filter(function(E){return Object.getOwnPropertyDescriptor(A,E).enumerable})),T.push.apply(T,y)}return T}function Fi(A,b,T){return(b=On(b))in A?Object.defineProperty(A,b,{value:T,enumerable:!0,configurable:!0,writable:!0}):A[b]=T,A}function Dn(A,b){for(var T=0;T<b.length;T++){var y=b[T];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(A,On(y.key),y)}}function On(A){var b=function(T,y){if(Dt(T)!=="object"||T===null)return T;var E=T[Symbol.toPrimitive];if(E!==void 0){var _=E.call(T,"string");if(Dt(_)!=="object")return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(T)}(A);return Dt(b)==="symbol"?b:String(b)}var Nn=0,at=[],Ui=function(){function A(E){var _=this;(function(w,L){if(!(w instanceof L))throw new TypeError("Cannot call a class as a function")})(this,A),this.options=function(w){var L={container:w.element||document.getElementsByClassName("dplayer")[0],live:!1,autoplay:!1,theme:"#b7daff",loop:!1,lang:(navigator.language||navigator.browserLanguage).toLowerCase(),screenshot:!1,airplay:!0,chromecast:!1,hotkey:!0,preload:"metadata",volume:.7,playbackSpeed:[.5,.75,1,1.25,1.5,2],apiBackend:nr,video:{},contextmenu:[],mutex:!0,pluginOptions:{hls:{},flv:{},dash:{},webtorrent:{}},preventClickToggle:!1};for(var P in L)L.hasOwnProperty(P)&&!w.hasOwnProperty(P)&&(w[P]=L[P]);return w.video&&!w.video.type&&(w.video.type="auto"),Zt(w.danmaku)==="object"&&w.danmaku&&!w.danmaku.user&&(w.danmaku.user="DIYgod"),w.subtitle&&(!w.subtitle.type&&(w.subtitle.type="webvtt"),!w.subtitle.fontSize&&(w.subtitle.fontSize="20px"),!w.subtitle.bottom&&(w.subtitle.bottom="40px"),!w.subtitle.color&&(w.subtitle.color="#fff")),w.video.quality&&(w.video.url=w.video.quality[w.video.defaultQuality].url),w.lang&&(w.lang=w.lang.toLowerCase()),w.contextmenu=w.contextmenu.concat([{key:"video-info",click:function(V){V.infoPanel.triggle()}},{key:"about-author",link:"https://diygod.me"},{text:"DPlayer v".concat("1.27.1"),link:"https://github.com/MoePlayer/DPlayer"}]),w}(function(w){for(var L=1;L<arguments.length;L++){var P=arguments[L]!=null?arguments[L]:{};L%2?Pn(Object(P),!0).forEach(function(V){Fi(w,V,P[V])}):Object.getOwnPropertyDescriptors?Object.defineProperties(w,Object.getOwnPropertyDescriptors(P)):Pn(Object(P)).forEach(function(V){Object.defineProperty(w,V,Object.getOwnPropertyDescriptor(P,V))})}return w}({preload:E.video.type==="webtorrent"?"none":"metadata"},E)),this.options.video.quality&&(this.qualityIndex=this.options.video.defaultQuality,this.quality=this.options.video.quality[this.options.video.defaultQuality]),this.tran=new rr(this.options.lang).tran,this.events=new Wr,this.user=new Zr(this),this.container=this.options.container,this.noticeList={},this.container.classList.add("dplayer"),this.options.danmaku||this.container.classList.add("dplayer-no-danmaku"),this.options.live?this.container.classList.add("dplayer-live"):this.container.classList.remove("dplayer-live"),$.isMobile&&this.container.classList.add("dplayer-mobile"),this.arrow=this.container.offsetWidth<=500,this.arrow&&this.container.classList.add("dplayer-arrow"),this.options.subtitle&&Array.isArray(this.options.subtitle.url)&&(this.options.subtitle.url.push({subtitle:"",lang:"off"}),this.options.subtitle.defaultSubtitle&&(typeof this.options.subtitle.defaultSubtitle=="string"?this.options.subtitle.index=this.options.subtitle.url.findIndex(function(w){return w.lang===_.options.subtitle.defaultSubtitle||w.name===_.options.subtitle.defaultSubtitle}):typeof this.options.subtitle.defaultSubtitle=="number"&&(this.options.subtitle.index=this.options.subtitle.defaultSubtitle)),(this.options.subtitle.index===-1||!this.options.subtitle.index||this.options.subtitle.index>this.options.subtitle.url.length-1)&&(this.options.subtitle.index=this.options.subtitle.url.findIndex(function(w){return w.lang===_.options.lang})),this.options.subtitle.index===-1&&(this.options.subtitle.index=this.options.subtitle.url.length-1)),this.template=new In({container:this.container,options:this.options,index:Nn,tran:this.tran}),this.video=this.template.video,this.bar=new ci(this.template),this.bezel=new pi(this.template.bezel),this.fullScreen=new Qr(this),this.controller=new bi(this),this.options.danmaku&&(this.danmaku=new jr({player:this,container:this.template.danmaku,opacity:this.user.get("opacity"),callback:function(){setTimeout(function(){_.template.danmakuLoading.style.display="none",_.options.autoplay&&_.play()},0)},error:function(w){_.notice(w)},apiBackend:this.options.apiBackend,borderColor:this.options.theme,height:this.arrow?24:30,time:function(){return _.video.currentTime},unlimited:this.user.get("unlimited"),api:{id:this.options.danmaku.id,address:this.options.danmaku.api,token:this.options.danmaku.token,maximum:this.options.danmaku.maximum,addition:this.options.danmaku.addition,user:this.options.danmaku.user,speedRate:this.options.danmaku.speedRate},events:this.events,tran:function(w){return _.tran(w)}}),this.comment=new Ci(this)),this.setting=new _i(this),this.plugins={},this.docClickFun=function(){_.focus=!1},this.containerClickFun=function(){_.focus=!0},document.addEventListener("click",this.docClickFun,!0),this.container.addEventListener("click",this.containerClickFun,!0),this.paused=!0,this.timer=new hi(this),this.hotkey=new ki(this),this.contextmenu=new Pi(this),this.initVideo(this.video,this.quality&&this.quality.type||this.options.video.type),this.infoPanel=new Ni(this),!this.danmaku&&this.options.autoplay&&this.play(),Nn++,at.push(this)}var b,T,y;return b=A,T=[{key:"seek",value:function(E){E=Math.max(E,0),this.video.duration&&(E=Math.min(E,this.video.duration)),this.video.currentTime<E?this.notice("".concat(this.tran("ff").replace("%s",(E-this.video.currentTime).toFixed(0)))):this.video.currentTime>E&&this.notice("".concat(this.tran("rew").replace("%s",(this.video.currentTime-E).toFixed(0)))),this.video.currentTime=E,this.danmaku&&this.danmaku.seek(),this.bar.set("played",E/this.video.duration,"width"),this.template.ptime.innerHTML=$.secondToTime(E)}},{key:"play",value:function(E){var _=this;if(this.paused=!1,this.video.paused&&!$.isMobile&&this.bezel.switch(We.play),this.template.playButton.innerHTML=We.pause,this.template.mobilePlayButton.innerHTML=We.pause,E||Ae.resolve(this.video.play()).catch(function(){_.pause()}).then(function(){}),this.timer.enable("loading"),this.container.classList.remove("dplayer-paused"),this.container.classList.add("dplayer-playing"),this.danmaku&&this.danmaku.play(),this.options.mutex)for(var w=0;w<at.length;w++)this!==at[w]&&at[w].pause()}},{key:"pause",value:function(E){this.paused=!0,this.container.classList.remove("dplayer-loading"),this.video.paused||$.isMobile||this.bezel.switch(We.pause),this.template.playButton.innerHTML=We.play,this.template.mobilePlayButton.innerHTML=We.play,E||this.video.pause(),this.timer.disable("loading"),this.container.classList.remove("dplayer-playing"),this.container.classList.add("dplayer-paused"),this.danmaku&&this.danmaku.pause()}},{key:"switchVolumeIcon",value:function(){this.volume()>=.95?this.template.volumeIcon.innerHTML=We.volumeUp:this.volume()>0?this.template.volumeIcon.innerHTML=We.volumeDown:this.template.volumeIcon.innerHTML=We.volumeOff}},{key:"volume",value:function(E,_,w){if(E=parseFloat(E),!isNaN(E)){E=Math.max(E,0),E=Math.min(E,1),this.bar.set("volume",E,"width");var L="".concat((100*E).toFixed(0),"%");this.template.volumeBarWrapWrap.dataset.balloon=L,_||this.user.set("volume",E),w||this.notice("".concat(this.tran("volume")," ").concat((100*E).toFixed(0),"%"),void 0,void 0,"volume"),this.video.volume=E,this.video.muted&&(this.video.muted=!1),this.switchVolumeIcon()}return this.video.volume}},{key:"toggle",value:function(){this.video.paused?this.play():this.pause()}},{key:"on",value:function(E,_){this.events.on(E,_)}},{key:"switchVideo",value:function(E,_){this.pause(),this.video.poster=E.pic?E.pic:"",this.video.src=E.url,this.initMSE(this.video,E.type||"auto"),_&&(this.template.danmakuLoading.style.display="block",this.bar.set("played",0,"width"),this.bar.set("loaded",0,"width"),this.template.ptime.innerHTML="00:00",this.template.danmaku.innerHTML="",this.danmaku&&this.danmaku.reload({id:_.id,address:_.api,token:_.token,maximum:_.maximum,addition:_.addition,user:_.user}))}},{key:"initMSE",value:function(E,_){var w=this;if(this.type=_,this.options.video.customType&&this.options.video.customType[_])Object.prototype.toString.call(this.options.video.customType[_])==="[object Function]"?this.options.video.customType[_](this.video,this):console.error("Illegal customType: ".concat(_));else switch(this.type==="auto"&&(/m3u8(#|\?|$)/i.exec(E.src)?this.type="hls":/.flv(#|\?|$)/i.exec(E.src)?this.type="flv":/.mpd(#|\?|$)/i.exec(E.src)?this.type="dash":this.type="normal"),this.type==="hls"&&(E.canPlayType("application/x-mpegURL")||E.canPlayType("application/vnd.apple.mpegURL"))&&(this.type="normal"),this.type){case"hls":if(window.Hls)if(window.Hls.isSupported()){var L=this.options.pluginOptions.hls,P=new window.Hls(L);this.plugins.hls=P,P.loadSource(E.src),P.attachMedia(E),this.events.on("destroy",function(){P.destroy(),delete w.plugins.hls})}else this.notice("Error: Hls is not supported.");else this.notice("Error: Can't find Hls.");break;case"flv":if(window.flvjs)if(window.flvjs.isSupported()){var V=window.flvjs.createPlayer(Object.assign(this.options.pluginOptions.flv.mediaDataSource||{},{type:"flv",url:E.src}),this.options.pluginOptions.flv.config);this.plugins.flvjs=V,V.attachMediaElement(E),V.load(),this.events.on("destroy",function(){V.unload(),V.detachMediaElement(),V.destroy(),delete w.plugins.flvjs})}else this.notice("Error: flvjs is not supported.");else this.notice("Error: Can't find flvjs.");break;case"dash":if(window.dashjs){var z=window.dashjs.MediaPlayer().create().initialize(E,E.src,!1),le=this.options.pluginOptions.dash;z.updateSettings(le),this.plugins.dash=z,this.events.on("destroy",function(){window.dashjs.MediaPlayer().reset(),delete w.plugins.dash})}else this.notice("Error: Can't find dashjs.");break;case"webtorrent":if(window.WebTorrent)if(window.WebTorrent.WEBRTC_SUPPORT){this.container.classList.add("dplayer-loading");var fe=this.options.pluginOptions.webtorrent,ge=new window.WebTorrent(fe);this.plugins.webtorrent=ge;var pe=E.src;E.src="",E.preload="metadata",E.addEventListener("durationchange",function(){return w.container.classList.remove("dplayer-loading")},{once:!0}),ge.add(pe,function(ce){ce.files.find(function(be){return be.name.endsWith(".mp4")}).renderTo(w.video,{autoplay:w.options.autoplay,controls:!1})}),this.events.on("destroy",function(){ge.remove(pe),ge.destroy(),delete w.plugins.webtorrent})}else this.notice("Error: Webtorrent is not supported.");else this.notice("Error: Can't find Webtorrent.")}}},{key:"initVideo",value:function(E,_){var w=this;this.initMSE(E,_),this.on("durationchange",function(){E.duration!==1&&E.duration!==1/0&&(w.template.dtime.innerHTML=$.secondToTime(E.duration))}),this.on("progress",function(){var V=E.buffered.length?E.buffered.end(E.buffered.length-1)/E.duration:0;w.bar.set("loaded",V,"width")}),this.on("error",function(){w.video.error&&w.tran&&w.notice&&w.type!=="webtorrent"&&w.notice(w.tran("video-failed"))}),this.on("ended",function(){w.bar.set("played",1,"width"),w.setting.loop?(w.seek(0),w.play()):w.pause(),w.danmaku&&(w.danmaku.danIndex=0)}),this.on("play",function(){w.paused&&w.play(!0)}),this.on("pause",function(){w.paused||w.pause(!0)}),this.on("timeupdate",function(){w.bar.set("played",w.video.currentTime/w.video.duration,"width");var V=$.secondToTime(w.video.currentTime);w.template.ptime.innerHTML!==V&&(w.template.ptime.innerHTML=V)});for(var L=function(V){E.addEventListener(w.events.videoEvents[V],function(z){w.events.trigger(w.events.videoEvents[V],z)})},P=0;P<this.events.videoEvents.length;P++)L(P);this.volume(this.user.get("volume"),!0,!0),this.options.subtitle&&(this.subtitle=new ni(this.template.subtitle,this.video,this.options.subtitle,this.events),Array.isArray(this.options.subtitle.url)&&(this.subtitles=new si(this)),this.user.get("subtitle")||this.subtitle.hide())}},{key:"switchQuality",value:function(E){var _=this;if(E=typeof E=="string"?parseInt(E):E,this.qualityIndex!==E&&!this.switchingQuality){this.prevIndex=this.qualityIndex,this.qualityIndex=E,this.switchingQuality=!0,this.quality=this.options.video.quality[E],this.template.qualityButton.innerHTML=this.quality.name;var w=this.video.paused;this.video.pause();var L=Mi()({current:!1,pic:null,screenshot:this.options.screenshot,preload:"auto",url:this.quality.url,subtitle:this.options.subtitle}),P=new DOMParser().parseFromString(L,"text/html").body.firstChild;this.template.videoWrap.insertBefore(P,this.template.videoWrap.getElementsByTagName("div")[0]),this.prevVideo=this.video,this.video=P,this.initVideo(this.video,this.quality.type||this.options.video.type),this.seek(this.prevVideo.currentTime),this.notice("".concat(this.tran("switching-quality").replace("%q",this.quality.name)),-1,void 0,"switch-quality"),this.events.trigger("quality_start",this.quality),this.on("canplay",function(){if(_.prevVideo){if(_.video.currentTime!==_.prevVideo.currentTime)return void _.seek(_.prevVideo.currentTime);_.template.videoWrap.removeChild(_.prevVideo),_.video.classList.add("dplayer-video-current"),w||_.video.play(),_.prevVideo=null,_.notice("".concat(_.tran("switched-quality").replace("%q",_.quality.name)),void 0,void 0,"switch-quality"),_.switchingQuality=!1,_.events.trigger("quality_end")}}),this.on("error",function(){_.video.error&&_.prevVideo&&(_.template.videoWrap.removeChild(_.video),_.video=_.prevVideo,w||_.video.play(),_.qualityIndex=_.prevIndex,_.quality=_.options.video.quality[_.qualityIndex],_.noticeTime=setTimeout(function(){_.template.notice.style.opacity=0,_.events.trigger("notice_hide")},3e3),_.prevVideo=null,_.switchingQuality=!1)})}}},{key:"notice",value:function(E){var _,w,L,P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2e3,V=arguments.length>2&&arguments[2]!==void 0?arguments[2]:.8,z=arguments.length>3?arguments[3]:void 0;if(z&&((_=document.getElementById("dplayer-notice-".concat(z)))&&(_.innerHTML=E),this.noticeList[z]&&(clearTimeout(this.noticeList[z]),this.noticeList[z]=null)),!_){var le=In.NewNotice(E,V,z);this.template.noticeList.appendChild(le),_=le}this.events.trigger("notice_show",_),P>0&&(this.noticeList[z]=setTimeout((w=_,L=this,function(){w.addEventListener("animationend",function(){L.template.noticeList.removeChild(w)}),w.classList.add("remove-notice"),L.events.trigger("notice_hide"),L.noticeList[z]=null}),P))}},{key:"resize",value:function(){this.danmaku&&this.danmaku.resize(),this.controller.thumbnails&&this.controller.thumbnails.resize(160,this.video.videoHeight/this.video.videoWidth*160,this.template.barWrap.offsetWidth),this.events.trigger("resize")}},{key:"speed",value:function(E){this.video.playbackRate=E}},{key:"destroy",value:function(){at.splice(at.indexOf(this),1),this.pause(),document.removeEventListener("click",this.docClickFun,!0),this.container.removeEventListener("click",this.containerClickFun,!0),this.fullScreen.destroy(),this.hotkey.destroy(),this.contextmenu.destroy(),this.controller.destroy(),this.timer.destroy(),this.video.src="",this.container.innerHTML="",this.events.trigger("destroy")}}],y=[{key:"version",get:function(){return"1.27.1"}}],T&&Dn(b.prototype,T),y&&Dn(b,y),Object.defineProperty(b,"prototype",{writable:!1}),A}();const $i=Ui;console.log(`
`.concat(" %c DPlayer v","1.27.1"," ").concat("v1.27.0-12-g4f61091"," %c https://dplayer.diygod.dev ",`
`,`
`),"color: #fadfa3; background: #030307; padding:5px 0;","background: #fadfa3; padding:5px 0;");const Vi=$i})(),s.default})())})(DPlayer_min);var DPlayer_minExports=DPlayer_min.exports;const DPlayer=getDefaultExportFromCjs$1(DPlayer_minExports);function getDefaultExportFromCjs(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var urlToolkit={exports:{}};(function(n,e){(function(t){var r=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,i=/^(?=([^\/?#]*))\1([^]*)$/,s=/(?:\/|^)\.(?=\/)/g,o=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,a={buildAbsoluteURL:function(l,c,u){if(u=u||{},l=l.trim(),c=c.trim(),!c){if(!u.alwaysNormalize)return l;var d=a.parseURL(l);if(!d)throw new Error("Error trying to parse base URL.");return d.path=a.normalizePath(d.path),a.buildURLFromParts(d)}var f=a.parseURL(c);if(!f)throw new Error("Error trying to parse relative URL.");if(f.scheme)return u.alwaysNormalize?(f.path=a.normalizePath(f.path),a.buildURLFromParts(f)):c;var m=a.parseURL(l);if(!m)throw new Error("Error trying to parse base URL.");if(!m.netLoc&&m.path&&m.path[0]!=="/"){var g=i.exec(m.path);m.netLoc=g[1],m.path=g[2]}m.netLoc&&!m.path&&(m.path="/");var v={scheme:m.scheme,netLoc:f.netLoc,path:null,params:f.params,query:f.query,fragment:f.fragment};if(!f.netLoc&&(v.netLoc=m.netLoc,f.path[0]!=="/"))if(!f.path)v.path=m.path,f.params||(v.params=m.params,f.query||(v.query=m.query));else{var x=m.path,S=x.substring(0,x.lastIndexOf("/")+1)+f.path;v.path=a.normalizePath(S)}return v.path===null&&(v.path=u.alwaysNormalize?a.normalizePath(f.path):f.path),a.buildURLFromParts(v)},parseURL:function(l){var c=r.exec(l);return c?{scheme:c[1]||"",netLoc:c[2]||"",path:c[3]||"",params:c[4]||"",query:c[5]||"",fragment:c[6]||""}:null},normalizePath:function(l){for(l=l.split("").reverse().join("").replace(s,"");l.length!==(l=l.replace(o,"")).length;);return l.split("").reverse().join("")},buildURLFromParts:function(l){return l.scheme+l.netLoc+l.path+l.params+l.query+l.fragment}};n.exports=a})()})(urlToolkit);var urlToolkitExports=urlToolkit.exports;function ownKeys(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function _objectSpread2(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function _toPrimitive(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function _toPropertyKey(n){var e=_toPrimitive(n,"string");return typeof e=="symbol"?e:String(e)}function _defineProperty(n,e,t){return e=_toPropertyKey(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function _extends(){return _extends=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},_extends.apply(this,arguments)}const isFiniteNumber=Number.isFinite||function(n){return typeof n=="number"&&isFinite(n)},isSafeInteger=Number.isSafeInteger||function(n){return typeof n=="number"&&Math.abs(n)<=MAX_SAFE_INTEGER},MAX_SAFE_INTEGER=Number.MAX_SAFE_INTEGER||9007199254740991;let Events=function(n){return n.MEDIA_ATTACHING="hlsMediaAttaching",n.MEDIA_ATTACHED="hlsMediaAttached",n.MEDIA_DETACHING="hlsMediaDetaching",n.MEDIA_DETACHED="hlsMediaDetached",n.BUFFER_RESET="hlsBufferReset",n.BUFFER_CODECS="hlsBufferCodecs",n.BUFFER_CREATED="hlsBufferCreated",n.BUFFER_APPENDING="hlsBufferAppending",n.BUFFER_APPENDED="hlsBufferAppended",n.BUFFER_EOS="hlsBufferEos",n.BUFFER_FLUSHING="hlsBufferFlushing",n.BUFFER_FLUSHED="hlsBufferFlushed",n.MANIFEST_LOADING="hlsManifestLoading",n.MANIFEST_LOADED="hlsManifestLoaded",n.MANIFEST_PARSED="hlsManifestParsed",n.LEVEL_SWITCHING="hlsLevelSwitching",n.LEVEL_SWITCHED="hlsLevelSwitched",n.LEVEL_LOADING="hlsLevelLoading",n.LEVEL_LOADED="hlsLevelLoaded",n.LEVEL_UPDATED="hlsLevelUpdated",n.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",n.LEVELS_UPDATED="hlsLevelsUpdated",n.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",n.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",n.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",n.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",n.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",n.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",n.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",n.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",n.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",n.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",n.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",n.CUES_PARSED="hlsCuesParsed",n.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",n.INIT_PTS_FOUND="hlsInitPtsFound",n.FRAG_LOADING="hlsFragLoading",n.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",n.FRAG_LOADED="hlsFragLoaded",n.FRAG_DECRYPTED="hlsFragDecrypted",n.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",n.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",n.FRAG_PARSING_METADATA="hlsFragParsingMetadata",n.FRAG_PARSED="hlsFragParsed",n.FRAG_BUFFERED="hlsFragBuffered",n.FRAG_CHANGED="hlsFragChanged",n.FPS_DROP="hlsFpsDrop",n.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",n.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",n.ERROR="hlsError",n.DESTROYING="hlsDestroying",n.KEY_LOADING="hlsKeyLoading",n.KEY_LOADED="hlsKeyLoaded",n.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",n.BACK_BUFFER_REACHED="hlsBackBufferReached",n.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",n}({}),ErrorTypes=function(n){return n.NETWORK_ERROR="networkError",n.MEDIA_ERROR="mediaError",n.KEY_SYSTEM_ERROR="keySystemError",n.MUX_ERROR="muxError",n.OTHER_ERROR="otherError",n}({}),ErrorDetails=function(n){return n.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",n.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",n.KEY_SYSTEM_NO_SESSION="keySystemNoSession",n.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",n.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",n.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",n.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",n.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",n.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",n.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",n.MANIFEST_LOAD_ERROR="manifestLoadError",n.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",n.MANIFEST_PARSING_ERROR="manifestParsingError",n.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",n.LEVEL_EMPTY_ERROR="levelEmptyError",n.LEVEL_LOAD_ERROR="levelLoadError",n.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",n.LEVEL_PARSING_ERROR="levelParsingError",n.LEVEL_SWITCH_ERROR="levelSwitchError",n.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",n.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",n.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",n.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",n.FRAG_LOAD_ERROR="fragLoadError",n.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",n.FRAG_DECRYPT_ERROR="fragDecryptError",n.FRAG_PARSING_ERROR="fragParsingError",n.FRAG_GAP="fragGap",n.REMUX_ALLOC_ERROR="remuxAllocError",n.KEY_LOAD_ERROR="keyLoadError",n.KEY_LOAD_TIMEOUT="keyLoadTimeOut",n.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",n.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",n.BUFFER_APPEND_ERROR="bufferAppendError",n.BUFFER_APPENDING_ERROR="bufferAppendingError",n.BUFFER_STALLED_ERROR="bufferStalledError",n.BUFFER_FULL_ERROR="bufferFullError",n.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",n.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",n.INTERNAL_EXCEPTION="internalException",n.INTERNAL_ABORTED="aborted",n.UNKNOWN="unknown",n}({});const noop=function n(){},fakeLogger={trace:noop,debug:noop,log:noop,warn:noop,info:noop,error:noop};let exportedLogger=fakeLogger;function consolePrintFn(n){const e=self.console[n];return e?e.bind(self.console,`[${n}] >`):noop}function exportLoggerFunctions(n,...e){e.forEach(function(t){exportedLogger[t]=n[t]?n[t].bind(n):consolePrintFn(t)})}function enableLogs(n,e){if(typeof console=="object"&&n===!0||typeof n=="object"){exportLoggerFunctions(n,"debug","log","info","warn","error");try{exportedLogger.log(`Debug logs enabled for "${e}" in hls.js version 1.5.17`)}catch{exportedLogger=fakeLogger}}else exportedLogger=fakeLogger}const logger=exportedLogger,DECIMAL_RESOLUTION_REGEX=/^(\d+)x(\d+)$/,ATTR_LIST_REGEX=/(.+?)=(".*?"|.*?)(?:,|$)/g;class AttrList{constructor(e){typeof e=="string"&&(e=AttrList.parseAttrList(e)),_extends(this,e)}get clientAttrs(){return Object.keys(this).filter(e=>e.substring(0,2)==="X-")}decimalInteger(e){const t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(t.length&1?"0":"")+t;const r=new Uint8Array(t.length/2);for(let i=0;i<t.length/2;i++)r[i]=parseInt(t.slice(i*2,i*2+2),16);return r}else return null}hexadecimalIntegerAsNumber(e){const t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){const r=this[e];return r?parseFloat(r):t}enumeratedString(e){return this[e]}bool(e){return this[e]==="YES"}decimalResolution(e){const t=DECIMAL_RESOLUTION_REGEX.exec(this[e]);if(t!==null)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e){let t;const r={},i='"';for(ATTR_LIST_REGEX.lastIndex=0;(t=ATTR_LIST_REGEX.exec(e))!==null;){let s=t[2];s.indexOf(i)===0&&s.lastIndexOf(i)===s.length-1&&(s=s.slice(1,-1));const o=t[1].trim();r[o]=s}return r}}function isDateRangeCueAttribute(n){return n!=="ID"&&n!=="CLASS"&&n!=="START-DATE"&&n!=="DURATION"&&n!=="END-DATE"&&n!=="END-ON-NEXT"}function isSCTE35Attribute(n){return n==="SCTE35-OUT"||n==="SCTE35-IN"}class DateRange{constructor(e,t){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,t){const r=t.attr;for(const i in r)if(Object.prototype.hasOwnProperty.call(e,i)&&e[i]!==r[i]){logger.warn(`DATERANGE tag attribute: "${i}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=i;break}e=_extends(new AttrList({}),r,e)}if(this.attr=e,this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const r=new Date(this.attr["END-DATE"]);isFiniteNumber(r.getTime())&&(this._endDate=r)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get startDate(){return this._startDate}get endDate(){if(this._endDate)return this._endDate;const e=this.duration;return e!==null?new Date(this._startDate.getTime()+e*1e3):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(isFiniteNumber(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isValid(){return!!this.id&&!this._badValueForSameId&&isFiniteNumber(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)}}class LoadStats{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var ElementaryStreamTypes={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class BaseSegment{constructor(e){this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams={[ElementaryStreamTypes.AUDIO]:null,[ElementaryStreamTypes.VIDEO]:null,[ElementaryStreamTypes.AUDIOVIDEO]:null},this.baseurl=e}setByteRange(e,t){const r=e.split("@",2);let i;r.length===1?i=(t==null?void 0:t.byteRangeEndOffset)||0:i=parseInt(r[1]),this._byteRange=[i,parseInt(r[0])+i]}get byteRange(){return this._byteRange?this._byteRange:[]}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=urlToolkitExports.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}}class Fragment extends BaseSegment{constructor(e,t){super(t),this._decryptdata=null,this.rawProgramDateTime=null,this.programDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.stats=new LoadStats,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=e}get decryptdata(){const{levelkeys:e}=this;if(!e&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const t=this.levelkeys.identity;if(t)this._decryptdata=t.getDecryptData(this.sn);else{const r=Object.keys(this.levelkeys);if(r.length===1)return this._decryptdata=this.levelkeys[r[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null||!isFiniteNumber(this.programDateTime))return null;const e=isFiniteNumber(this.duration)?this.duration:0;return this.programDateTime+e*1e3}get encrypted(){var e;if((e=this._decryptdata)!=null&&e.encrypted)return!0;if(this.levelkeys){const t=Object.keys(this.levelkeys),r=t.length;if(r>1||r===1&&this.levelkeys[t[0]].encrypted)return!0}return!1}setKeyFormat(e){if(this.levelkeys){const t=this.levelkeys[e];t&&!this._decryptdata&&(this._decryptdata=t.getDecryptData(this.sn))}}abortRequests(){var e,t;(e=this.loader)==null||e.abort(),(t=this.keyLoader)==null||t.abort()}setElementaryStreamInfo(e,t,r,i,s,o=!1){const{elementaryStreams:a}=this,l=a[e];if(!l){a[e]={startPTS:t,endPTS:r,startDTS:i,endDTS:s,partial:o};return}l.startPTS=Math.min(l.startPTS,t),l.endPTS=Math.max(l.endPTS,r),l.startDTS=Math.min(l.startDTS,i),l.endDTS=Math.max(l.endDTS,s)}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[ElementaryStreamTypes.AUDIO]=null,e[ElementaryStreamTypes.VIDEO]=null,e[ElementaryStreamTypes.AUDIOVIDEO]=null}}class Part extends BaseSegment{constructor(e,t,r,i,s){super(r),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.stats=new LoadStats,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=i;const o=e.enumeratedString("BYTERANGE");o&&this.setByteRange(o,s),s&&(this.fragOffset=s.fragOffset+s.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}const DEFAULT_TARGET_DURATION=10;class LevelDetails{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e){this.advanced=!0,this.updated=!0;return}const t=this.lastPartSn-e.lastPartSn,r=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!r||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||t===0&&r>0,this.updated||this.advanced?this.misses=Math.floor(e.misses*.6):this.misses=e.misses+1,this.availabilityDelay=e.availabilityDelay}get hasProgramDateTime(){return this.fragments.length?isFiniteNumber(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||DEFAULT_TARGET_DURATION}get drift(){const e=this.driftEndTime-this.driftStartTime;return e>0?(this.driftEnd-this.driftStart)*1e3/e:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var e;return(e=this.fragments)!=null&&e.length?this.fragments[this.fragments.length-1].end:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].index:-1}get lastPartSn(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}function base64Decode(n){return Uint8Array.from(atob(n),e=>e.charCodeAt(0))}function getKeyIdBytes(n){const e=strToUtf8array(n).subarray(0,16),t=new Uint8Array(16);return t.set(e,16-e.length),t}function changeEndianness(n){const e=function(r,i,s){const o=r[i];r[i]=r[s],r[s]=o};e(n,0,3),e(n,1,2),e(n,4,5),e(n,6,7)}function convertDataUriToArrayBytes(n){const e=n.split(":");let t=null;if(e[0]==="data"&&e.length===2){const r=e[1].split(";"),i=r[r.length-1].split(",");if(i.length===2){const s=i[0]==="base64",o=i[1];s?(r.splice(-1,1),t=base64Decode(o)):t=getKeyIdBytes(o)}}return t}function strToUtf8array(n){return Uint8Array.from(unescape(encodeURIComponent(n)),e=>e.charCodeAt(0))}const optionalSelf=typeof self<"u"?self:void 0;var KeySystems={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},KeySystemFormats={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function keySystemFormatToKeySystemDomain(n){switch(n){case KeySystemFormats.FAIRPLAY:return KeySystems.FAIRPLAY;case KeySystemFormats.PLAYREADY:return KeySystems.PLAYREADY;case KeySystemFormats.WIDEVINE:return KeySystems.WIDEVINE;case KeySystemFormats.CLEARKEY:return KeySystems.CLEARKEY}}var KeySystemIds={CENC:"1077efecc0b24d02ace33c1e52e2fb4b",CLEARKEY:"e2719d58a985b3c9781ab030af78d30e",FAIRPLAY:"94ce86fb07ff4f43adb893d2fa968ca2",PLAYREADY:"9a04f07998404286ab92e65be0885f95",WIDEVINE:"edef8ba979d64acea3c827dcd51d21ed"};function keySystemIdToKeySystemDomain(n){if(n===KeySystemIds.WIDEVINE)return KeySystems.WIDEVINE;if(n===KeySystemIds.PLAYREADY)return KeySystems.PLAYREADY;if(n===KeySystemIds.CENC||n===KeySystemIds.CLEARKEY)return KeySystems.CLEARKEY}function keySystemDomainToKeySystemFormat(n){switch(n){case KeySystems.FAIRPLAY:return KeySystemFormats.FAIRPLAY;case KeySystems.PLAYREADY:return KeySystemFormats.PLAYREADY;case KeySystems.WIDEVINE:return KeySystemFormats.WIDEVINE;case KeySystems.CLEARKEY:return KeySystemFormats.CLEARKEY}}function getKeySystemsForConfig(n){const{drmSystems:e,widevineLicenseUrl:t}=n,r=e?[KeySystems.FAIRPLAY,KeySystems.WIDEVINE,KeySystems.PLAYREADY,KeySystems.CLEARKEY].filter(i=>!!e[i]):[];return!r[KeySystems.WIDEVINE]&&t&&r.push(KeySystems.WIDEVINE),r}const requestMediaKeySystemAccess=function(n){return optionalSelf!=null&&(n=optionalSelf.navigator)!=null&&n.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}();function getSupportedMediaKeySystemConfigurations(n,e,t,r){let i;switch(n){case KeySystems.FAIRPLAY:i=["cenc","sinf"];break;case KeySystems.WIDEVINE:case KeySystems.PLAYREADY:i=["cenc"];break;case KeySystems.CLEARKEY:i=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${n}`)}return createMediaKeySystemConfigurations(i,e,t,r)}function createMediaKeySystemConfigurations(n,e,t,r){return[{initDataTypes:n,persistentState:r.persistentState||"optional",distinctiveIdentifier:r.distinctiveIdentifier||"optional",sessionTypes:r.sessionTypes||[r.sessionType||"temporary"],audioCapabilities:e.map(s=>({contentType:`audio/mp4; codecs="${s}"`,robustness:r.audioRobustness||"",encryptionScheme:r.audioEncryptionScheme||null})),videoCapabilities:t.map(s=>({contentType:`video/mp4; codecs="${s}"`,robustness:r.videoRobustness||"",encryptionScheme:r.videoEncryptionScheme||null}))}]}function sliceUint8(n,e,t){return Uint8Array.prototype.slice?n.slice(e,t):new Uint8Array(Array.prototype.slice.call(n,e,t))}const isHeader$2=(n,e)=>e+10<=n.length&&n[e]===73&&n[e+1]===68&&n[e+2]===51&&n[e+3]<255&&n[e+4]<255&&n[e+6]<128&&n[e+7]<128&&n[e+8]<128&&n[e+9]<128,isFooter=(n,e)=>e+10<=n.length&&n[e]===51&&n[e+1]===68&&n[e+2]===73&&n[e+3]<255&&n[e+4]<255&&n[e+6]<128&&n[e+7]<128&&n[e+8]<128&&n[e+9]<128,getID3Data=(n,e)=>{const t=e;let r=0;for(;isHeader$2(n,e);){r+=10;const i=readSize(n,e+6);r+=i,isFooter(n,e+10)&&(r+=10),e+=r}if(r>0)return n.subarray(t,t+r)},readSize=(n,e)=>{let t=0;return t=(n[e]&127)<<21,t|=(n[e+1]&127)<<14,t|=(n[e+2]&127)<<7,t|=n[e+3]&127,t},canParse$2=(n,e)=>isHeader$2(n,e)&&readSize(n,e+6)+10<=n.length-e,getTimeStamp=n=>{const e=getID3Frames(n);for(let t=0;t<e.length;t++){const r=e[t];if(isTimeStampFrame(r))return readTimeStamp(r)}},isTimeStampFrame=n=>n&&n.key==="PRIV"&&n.info==="com.apple.streaming.transportStreamTimestamp",getFrameData=n=>{const e=String.fromCharCode(n[0],n[1],n[2],n[3]),t=readSize(n,4),r=10;return{type:e,size:t,data:n.subarray(r,r+t)}},getID3Frames=n=>{let e=0;const t=[];for(;isHeader$2(n,e);){const r=readSize(n,e+6);e+=10;const i=e+r;for(;e+8<i;){const s=getFrameData(n.subarray(e)),o=decodeFrame(s);o&&t.push(o),e+=s.size+10}isFooter(n,e)&&(e+=10)}return t},decodeFrame=n=>n.type==="PRIV"?decodePrivFrame(n):n.type[0]==="W"?decodeURLFrame(n):decodeTextFrame(n),decodePrivFrame=n=>{if(n.size<2)return;const e=utf8ArrayToStr(n.data,!0),t=new Uint8Array(n.data.subarray(e.length+1));return{key:n.type,info:e,data:t.buffer}},decodeTextFrame=n=>{if(n.size<2)return;if(n.type==="TXXX"){let t=1;const r=utf8ArrayToStr(n.data.subarray(t),!0);t+=r.length+1;const i=utf8ArrayToStr(n.data.subarray(t));return{key:n.type,info:r,data:i}}const e=utf8ArrayToStr(n.data.subarray(1));return{key:n.type,data:e}},decodeURLFrame=n=>{if(n.type==="WXXX"){if(n.size<2)return;let t=1;const r=utf8ArrayToStr(n.data.subarray(t),!0);t+=r.length+1;const i=utf8ArrayToStr(n.data.subarray(t));return{key:n.type,info:r,data:i}}const e=utf8ArrayToStr(n.data);return{key:n.type,data:e}},readTimeStamp=n=>{if(n.data.byteLength===8){const e=new Uint8Array(n.data),t=e[3]&1;let r=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return r/=45,t&&(r+=4772185884e-2),Math.round(r)}},utf8ArrayToStr=(n,e=!1)=>{const t=getTextDecoder();if(t){const c=t.decode(n);if(e){const u=c.indexOf("\0");return u!==-1?c.substring(0,u):c}return c.replace(/\0/g,"")}const r=n.length;let i,s,o,a="",l=0;for(;l<r;){if(i=n[l++],i===0&&e)return a;if(i===0||i===3)continue;switch(i>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:a+=String.fromCharCode(i);break;case 12:case 13:s=n[l++],a+=String.fromCharCode((i&31)<<6|s&63);break;case 14:s=n[l++],o=n[l++],a+=String.fromCharCode((i&15)<<12|(s&63)<<6|(o&63)<<0);break}}return a};let decoder;function getTextDecoder(){if(!navigator.userAgent.includes("PlayStation 4"))return!decoder&&typeof self.TextDecoder<"u"&&(decoder=new self.TextDecoder("utf-8")),decoder}const Hex={hexDump:function(n){let e="";for(let t=0;t<n.length;t++){let r=n[t].toString(16);r.length<2&&(r="0"+r),e+=r}return e}},UINT32_MAX$1=Math.pow(2,32)-1,push=[].push,RemuxerTrackIdConfig={video:1,audio:2,id3:3,text:4};function bin2str(n){return String.fromCharCode.apply(null,n)}function readUint16(n,e){const t=n[e]<<8|n[e+1];return t<0?65536+t:t}function readUint32(n,e){const t=readSint32(n,e);return t<0?4294967296+t:t}function readUint64(n,e){let t=readUint32(n,e);return t*=Math.pow(2,32),t+=readUint32(n,e+4),t}function readSint32(n,e){return n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3]}function writeUint32(n,e,t){n[e]=t>>24,n[e+1]=t>>16&255,n[e+2]=t>>8&255,n[e+3]=t&255}function hasMoofData(n){const e=n.byteLength;for(let t=0;t<e;){const r=readUint32(n,t);if(r>8&&n[t+4]===109&&n[t+5]===111&&n[t+6]===111&&n[t+7]===102)return!0;t=r>1?t+r:e}return!1}function findBox(n,e){const t=[];if(!e.length)return t;const r=n.byteLength;for(let i=0;i<r;){const s=readUint32(n,i),o=bin2str(n.subarray(i+4,i+8)),a=s>1?i+s:r;if(o===e[0])if(e.length===1)t.push(n.subarray(i+8,a));else{const l=findBox(n.subarray(i+8,a),e.slice(1));l.length&&push.apply(t,l)}i=a}return t}function parseSegmentIndex(n){const e=[],t=n[0];let r=8;const i=readUint32(n,r);r+=4;let s=0,o=0;t===0?(s=readUint32(n,r),o=readUint32(n,r+4),r+=8):(s=readUint64(n,r),o=readUint64(n,r+8),r+=16),r+=2;let a=n.length+o;const l=readUint16(n,r);r+=2;for(let c=0;c<l;c++){let u=r;const d=readUint32(n,u);u+=4;const f=d&2147483647;if((d&2147483648)>>>31===1)return logger.warn("SIDX has hierarchical references (not supported)"),null;const g=readUint32(n,u);u+=4,e.push({referenceSize:f,subsegmentDuration:g,info:{duration:g/i,start:a,end:a+f-1}}),a+=f,u+=4,r=u}return{earliestPresentationTime:s,timescale:i,version:t,referencesCount:l,references:e}}function parseInitSegment(n){const e=[],t=findBox(n,["moov","trak"]);for(let i=0;i<t.length;i++){const s=t[i],o=findBox(s,["tkhd"])[0];if(o){let a=o[0];const l=readUint32(o,a===0?12:20),c=findBox(s,["mdia","mdhd"])[0];if(c){a=c[0];const u=readUint32(c,a===0?12:20),d=findBox(s,["mdia","hdlr"])[0];if(d){const f=bin2str(d.subarray(8,12)),m={soun:ElementaryStreamTypes.AUDIO,vide:ElementaryStreamTypes.VIDEO}[f];if(m){const g=findBox(s,["mdia","minf","stbl","stsd"])[0],v=parseStsd(g);e[l]={timescale:u,type:m},e[m]=_objectSpread2({timescale:u,id:l},v)}}}}}return findBox(n,["moov","mvex","trex"]).forEach(i=>{const s=readUint32(i,4),o=e[s];o&&(o.default={duration:readUint32(i,12),flags:readUint32(i,20)})}),e}function parseStsd(n){const e=n.subarray(8),t=e.subarray(86),r=bin2str(e.subarray(4,8));let i=r;const s=r==="enca"||r==="encv";if(s){const a=findBox(e,[r])[0].subarray(r==="enca"?28:78);findBox(a,["sinf"]).forEach(c=>{const u=findBox(c,["schm"])[0];if(u){const d=bin2str(u.subarray(4,8));if(d==="cbcs"||d==="cenc"){const f=findBox(c,["frma"])[0];f&&(i=bin2str(f))}}})}switch(i){case"avc1":case"avc2":case"avc3":case"avc4":{const o=findBox(t,["avcC"])[0];i+="."+toHex(o[1])+toHex(o[2])+toHex(o[3]);break}case"mp4a":{const o=findBox(e,[r])[0],a=findBox(o.subarray(28),["esds"])[0];if(a&&a.length>12){let l=4;if(a[l++]!==3)break;l=skipBERInteger(a,l),l+=2;const c=a[l++];if(c&128&&(l+=2),c&64&&(l+=a[l++]),a[l++]!==4)break;l=skipBERInteger(a,l);const u=a[l++];if(u===64)i+="."+toHex(u);else break;if(l+=12,a[l++]!==5)break;l=skipBERInteger(a,l);const d=a[l++];let f=(d&248)>>3;f===31&&(f+=1+((d&7)<<3)+((a[l]&224)>>5)),i+="."+f}break}case"hvc1":case"hev1":{const o=findBox(t,["hvcC"])[0],a=o[1],l=["","A","B","C"][a>>6],c=a&31,u=readUint32(o,2),d=(a&32)>>5?"H":"L",f=o[12],m=o.subarray(6,12);i+="."+l+c,i+="."+u.toString(16).toUpperCase(),i+="."+d+f;let g="";for(let v=m.length;v--;){const x=m[v];(x||g)&&(g="."+x.toString(16).toUpperCase()+g)}i+=g;break}case"dvh1":case"dvhe":{const o=findBox(t,["dvcC"])[0],a=o[2]>>1&127,l=o[2]<<5&32|o[3]>>3&31;i+="."+addLeadingZero(a)+"."+addLeadingZero(l);break}case"vp09":{const o=findBox(t,["vpcC"])[0],a=o[4],l=o[5],c=o[6]>>4&15;i+="."+addLeadingZero(a)+"."+addLeadingZero(l)+"."+addLeadingZero(c);break}case"av01":{const o=findBox(t,["av1C"])[0],a=o[1]>>>5,l=o[1]&31,c=o[2]>>>7?"H":"M",u=(o[2]&64)>>6,d=(o[2]&32)>>5,f=a===2&&u?d?12:10:u?10:8,m=(o[2]&16)>>4,g=(o[2]&8)>>3,v=(o[2]&4)>>2,x=o[2]&3;i+="."+a+"."+addLeadingZero(l)+c+"."+addLeadingZero(f)+"."+m+"."+g+v+x+"."+addLeadingZero(1)+"."+addLeadingZero(1)+"."+addLeadingZero(1)+"."+0;break}}return{codec:i,encrypted:s}}function skipBERInteger(n,e){const t=e+5;for(;n[e++]&128&&e<t;);return e}function toHex(n){return("0"+n.toString(16).toUpperCase()).slice(-2)}function addLeadingZero(n){return(n<10?"0":"")+n}function patchEncyptionData(n,e){if(!n||!e)return n;const t=e.keyId;return t&&e.isCommonEncryption&&findBox(n,["moov","trak"]).forEach(i=>{const o=findBox(i,["mdia","minf","stbl","stsd"])[0].subarray(8);let a=findBox(o,["enca"]);const l=a.length>0;l||(a=findBox(o,["encv"])),a.forEach(c=>{const u=l?c.subarray(28):c.subarray(78);findBox(u,["sinf"]).forEach(f=>{const m=parseSinf(f);if(m){const g=m.subarray(8,24);g.some(v=>v!==0)||(logger.log(`[eme] Patching keyId in 'enc${l?"a":"v"}>sinf>>tenc' box: ${Hex.hexDump(g)} -> ${Hex.hexDump(t)}`),m.set(t,8))}})})}),n}function parseSinf(n){const e=findBox(n,["schm"])[0];if(e){const t=bin2str(e.subarray(4,8));if(t==="cbcs"||t==="cenc")return findBox(n,["schi","tenc"])[0]}return null}function getStartDTS(n,e){return findBox(e,["moof","traf"]).reduce((t,r)=>{const i=findBox(r,["tfdt"])[0],s=i[0],o=findBox(r,["tfhd"]).reduce((a,l)=>{const c=readUint32(l,4),u=n[c];if(u){let d=readUint32(i,4);if(s===1){if(d===UINT32_MAX$1)return logger.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"),a;d*=UINT32_MAX$1+1,d+=readUint32(i,8)}const f=u.timescale||9e4,m=d/f;if(isFiniteNumber(m)&&(a===null||m<a))return m}return a},null);return o!==null&&isFiniteNumber(o)&&(t===null||o<t)?o:t},null)}function getDuration(n,e){let t=0,r=0,i=0;const s=findBox(n,["moof","traf"]);for(let o=0;o<s.length;o++){const a=s[o],l=findBox(a,["tfhd"])[0],c=readUint32(l,4),u=e[c];if(!u)continue;const d=u.default,f=readUint32(l,0)|(d==null?void 0:d.flags);let m=d==null?void 0:d.duration;f&8&&(f&2?m=readUint32(l,12):m=readUint32(l,8));const g=u.timescale||9e4,v=findBox(a,["trun"]);for(let x=0;x<v.length;x++){if(t=computeRawDurationFromSamples(v[x]),!t&&m){const S=readUint32(v[x],4);t=m*S}u.type===ElementaryStreamTypes.VIDEO?r+=t/g:u.type===ElementaryStreamTypes.AUDIO&&(i+=t/g)}}if(r===0&&i===0){let o=1/0,a=0,l=0;const c=findBox(n,["sidx"]);for(let u=0;u<c.length;u++){const d=parseSegmentIndex(c[u]);if(d!=null&&d.references){o=Math.min(o,d.earliestPresentationTime/d.timescale);const f=d.references.reduce((m,g)=>m+g.info.duration||0,0);a=Math.max(a,f+d.earliestPresentationTime/d.timescale),l=a-o}}if(l&&isFiniteNumber(l))return l}return r||i}function computeRawDurationFromSamples(n){const e=readUint32(n,0);let t=8;e&1&&(t+=4),e&4&&(t+=4);let r=0;const i=readUint32(n,4);for(let s=0;s<i;s++){if(e&256){const o=readUint32(n,t);r+=o,t+=4}e&512&&(t+=4),e&1024&&(t+=4),e&2048&&(t+=4)}return r}function offsetStartDTS(n,e,t){findBox(e,["moof","traf"]).forEach(r=>{findBox(r,["tfhd"]).forEach(i=>{const s=readUint32(i,4),o=n[s];if(!o)return;const a=o.timescale||9e4;findBox(r,["tfdt"]).forEach(l=>{const c=l[0],u=t*a;if(u){let d=readUint32(l,4);if(c===0)d-=u,d=Math.max(d,0),writeUint32(l,4,d);else{d*=Math.pow(2,32),d+=readUint32(l,8),d-=u,d=Math.max(d,0);const f=Math.floor(d/(UINT32_MAX$1+1)),m=Math.floor(d%(UINT32_MAX$1+1));writeUint32(l,4,f),writeUint32(l,8,m)}}})})})}function segmentValidRange(n){const e={valid:null,remainder:null},t=findBox(n,["moof"]);if(t.length<2)return e.remainder=n,e;const r=t[t.length-1];return e.valid=sliceUint8(n,0,r.byteOffset-8),e.remainder=sliceUint8(n,r.byteOffset-8),e}function appendUint8Array(n,e){const t=new Uint8Array(n.length+e.length);return t.set(n),t.set(e,n.length),t}function parseSamples(n,e){const t=[],r=e.samples,i=e.timescale,s=e.id;let o=!1;return findBox(r,["moof"]).map(l=>{const c=l.byteOffset-8;findBox(l,["traf"]).map(d=>{const f=findBox(d,["tfdt"]).map(m=>{const g=m[0];let v=readUint32(m,4);return g===1&&(v*=Math.pow(2,32),v+=readUint32(m,8)),v/i})[0];return f!==void 0&&(n=f),findBox(d,["tfhd"]).map(m=>{const g=readUint32(m,4),v=readUint32(m,0)&16777215,x=(v&1)!==0,S=(v&2)!==0,C=(v&8)!==0;let R=0;const k=(v&16)!==0;let I=0;const F=(v&32)!==0;let N=8;g===s&&(x&&(N+=8),S&&(N+=4),C&&(R=readUint32(m,N),N+=4),k&&(I=readUint32(m,N),N+=4),F&&(N+=4),e.type==="video"&&(o=isHEVC(e.codec)),findBox(d,["trun"]).map(U=>{const M=U[0],B=readUint32(U,0)&16777215,H=(B&1)!==0;let K=0;const Y=(B&4)!==0,oe=(B&256)!==0;let ue=0;const Z=(B&512)!==0;let Ae=0;const ye=(B&1024)!==0,$=(B&2048)!==0;let W=0;const J=readUint32(U,4);let ne=8;H&&(K=readUint32(U,ne),ne+=4),Y&&(ne+=4);let ve=K+c;for(let Re=0;Re<J;Re++){if(oe?(ue=readUint32(U,ne),ne+=4):ue=R,Z?(Ae=readUint32(U,ne),ne+=4):Ae=I,ye&&(ne+=4),$&&(M===0?W=readUint32(U,ne):W=readSint32(U,ne),ne+=4),e.type===ElementaryStreamTypes.VIDEO){let Le=0;for(;Le<Ae;){const Ce=readUint32(r,ve);if(ve+=4,isSEIMessage(o,r[ve])){const j=r.subarray(ve,ve+Ce);parseSEIMessageFromNALu(j,o?2:1,n+W/i,t)}ve+=Ce,Le+=Ce+4}}n+=ue/i}}))})})}),t}function isHEVC(n){if(!n)return!1;const e=n.indexOf("."),t=e<0?n:n.substring(0,e);return t==="hvc1"||t==="hev1"||t==="dvh1"||t==="dvhe"}function isSEIMessage(n,e){if(n){const t=e>>1&63;return t===39||t===40}else return(e&31)===6}function parseSEIMessageFromNALu(n,e,t,r){const i=discardEPB(n);let s=0;s+=e;let o=0,a=0,l=0;for(;s<i.length;){o=0;do{if(s>=i.length)break;l=i[s++],o+=l}while(l===255);a=0;do{if(s>=i.length)break;l=i[s++],a+=l}while(l===255);const c=i.length-s;let u=s;if(a<c)s+=a;else if(a>c){logger.error(`Malformed SEI payload. ${a} is too small, only ${c} bytes left to parse.`);break}if(o===4){if(i[u++]===181){const f=readUint16(i,u);if(u+=2,f===49){const m=readUint32(i,u);if(u+=4,m===1195456820){const g=i[u++];if(g===3){const v=i[u++],x=31&v,S=64&v,C=S?2+x*3:0,R=new Uint8Array(C);if(S){R[0]=v;for(let k=1;k<C;k++)R[k]=i[u++]}r.push({type:g,payloadType:o,pts:t,bytes:R})}}}}}else if(o===5&&a>16){const d=[];for(let g=0;g<16;g++){const v=i[u++].toString(16);d.push(v.length==1?"0"+v:v),(g===3||g===5||g===7||g===9)&&d.push("-")}const f=a-16,m=new Uint8Array(f);for(let g=0;g<f;g++)m[g]=i[u++];r.push({payloadType:o,pts:t,uuid:d.join(""),userData:utf8ArrayToStr(m),userDataBytes:m})}}}function discardEPB(n){const e=n.byteLength,t=[];let r=1;for(;r<e-2;)n[r]===0&&n[r+1]===0&&n[r+2]===3?(t.push(r+2),r+=2):r++;if(t.length===0)return n;const i=e-t.length,s=new Uint8Array(i);let o=0;for(r=0;r<i;o++,r++)o===t[0]&&(o++,t.shift()),s[r]=n[o];return s}function parseEmsg(n){const e=n[0];let t="",r="",i=0,s=0,o=0,a=0,l=0,c=0;if(e===0){for(;bin2str(n.subarray(c,c+1))!=="\0";)t+=bin2str(n.subarray(c,c+1)),c+=1;for(t+=bin2str(n.subarray(c,c+1)),c+=1;bin2str(n.subarray(c,c+1))!=="\0";)r+=bin2str(n.subarray(c,c+1)),c+=1;r+=bin2str(n.subarray(c,c+1)),c+=1,i=readUint32(n,12),s=readUint32(n,16),a=readUint32(n,20),l=readUint32(n,24),c=28}else if(e===1){c+=4,i=readUint32(n,c),c+=4;const d=readUint32(n,c);c+=4;const f=readUint32(n,c);for(c+=4,o=2**32*d+f,isSafeInteger(o)||(o=Number.MAX_SAFE_INTEGER,logger.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),a=readUint32(n,c),c+=4,l=readUint32(n,c),c+=4;bin2str(n.subarray(c,c+1))!=="\0";)t+=bin2str(n.subarray(c,c+1)),c+=1;for(t+=bin2str(n.subarray(c,c+1)),c+=1;bin2str(n.subarray(c,c+1))!=="\0";)r+=bin2str(n.subarray(c,c+1)),c+=1;r+=bin2str(n.subarray(c,c+1)),c+=1}const u=n.subarray(c,n.byteLength);return{schemeIdUri:t,value:r,timeScale:i,presentationTime:o,presentationTimeDelta:s,eventDuration:a,id:l,payload:u}}function mp4Box(n,...e){const t=e.length;let r=8,i=t;for(;i--;)r+=e[i].byteLength;const s=new Uint8Array(r);for(s[0]=r>>24&255,s[1]=r>>16&255,s[2]=r>>8&255,s[3]=r&255,s.set(n,4),i=0,r=8;i<t;i++)s.set(e[i],r),r+=e[i].byteLength;return s}function mp4pssh(n,e,t){if(n.byteLength!==16)throw new RangeError("Invalid system id");let r,i;r=0,i=new Uint8Array;let s;r>0?(s=new Uint8Array(4),e.length>0&&new DataView(s.buffer).setUint32(0,e.length,!1)):s=new Uint8Array;const o=new Uint8Array(4);return t&&t.byteLength>0&&new DataView(o.buffer).setUint32(0,t.byteLength,!1),mp4Box([112,115,115,104],new Uint8Array([r,0,0,0]),n,s,i,o,t||new Uint8Array)}function parseMultiPssh(n){const e=[];if(n instanceof ArrayBuffer){const t=n.byteLength;let r=0;for(;r+32<t;){const i=new DataView(n,r),s=parsePssh(i);e.push(s),r+=s.size}}return e}function parsePssh(n){const e=n.getUint32(0),t=n.byteOffset,r=n.byteLength;if(r<e)return{offset:t,size:r};if(n.getUint32(4)!==1886614376)return{offset:t,size:e};const s=n.getUint32(8)>>>24;if(s!==0&&s!==1)return{offset:t,size:e};const o=n.buffer,a=Hex.hexDump(new Uint8Array(o,t+12,16)),l=n.getUint32(28);let c=null,u=null;if(s===0){if(e-32<l||l<22)return{offset:t,size:e};u=new Uint8Array(o,t+32,l)}else if(s===1){if(!l||r<t+32+l*16+16)return{offset:t,size:e};c=[];for(let d=0;d<l;d++)c.push(new Uint8Array(o,t+32+d*16,16))}return{version:s,systemId:a,kids:c,data:u,offset:t,size:e}}let keyUriToKeyIdMap={};class LevelKey{static clearKeyUriToKeyIdMap(){keyUriToKeyIdMap={}}constructor(e,t,r,i=[1],s=null){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=r,this.keyFormatVersions=i,this.iv=s,this.encrypted=e?e!=="NONE":!1,this.isCommonEncryption=this.encrypted&&e!=="AES-128"}isSupported(){if(this.method){if(this.method==="AES-128"||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case KeySystemFormats.FAIRPLAY:case KeySystemFormats.WIDEVINE:case KeySystemFormats.PLAYREADY:case KeySystemFormats.CLEARKEY:return["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(e){if(!this.encrypted||!this.uri)return null;if(this.method==="AES-128"&&this.uri&&!this.iv){typeof e!="number"&&(this.method==="AES-128"&&!this.iv&&logger.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0);const r=createInitializationVector(e);return new LevelKey(this.method,this.uri,"identity",this.keyFormatVersions,r)}const t=convertDataUriToArrayBytes(this.uri);if(t)switch(this.keyFormat){case KeySystemFormats.WIDEVINE:this.pssh=t,t.length>=22&&(this.keyId=t.subarray(t.length-22,t.length-6));break;case KeySystemFormats.PLAYREADY:{const r=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=mp4pssh(r,null,t);const i=new Uint16Array(t.buffer,t.byteOffset,t.byteLength/2),s=String.fromCharCode.apply(null,Array.from(i)),o=s.substring(s.indexOf("<"),s.length),c=new DOMParser().parseFromString(o,"text/xml").getElementsByTagName("KID")[0];if(c){const u=c.childNodes[0]?c.childNodes[0].nodeValue:c.getAttribute("VALUE");if(u){const d=base64Decode(u).subarray(0,16);changeEndianness(d),this.keyId=d}}break}default:{let r=t.subarray(0,16);if(r.length!==16){const i=new Uint8Array(16);i.set(r,16-r.length),r=i}this.keyId=r;break}}if(!this.keyId||this.keyId.byteLength!==16){let r=keyUriToKeyIdMap[this.uri];if(!r){const i=Object.keys(keyUriToKeyIdMap).length%Number.MAX_SAFE_INTEGER;r=new Uint8Array(16),new DataView(r.buffer,12,4).setUint32(0,i),keyUriToKeyIdMap[this.uri]=r}this.keyId=r}return this}}function createInitializationVector(n){const e=new Uint8Array(16);for(let t=12;t<16;t++)e[t]=n>>8*(15-t)&255;return e}const VARIABLE_REPLACEMENT_REGEX=/\{\$([a-zA-Z0-9-_]+)\}/g;function hasVariableReferences(n){return VARIABLE_REPLACEMENT_REGEX.test(n)}function substituteVariablesInAttributes(n,e,t){if(n.variableList!==null||n.hasVariableRefs)for(let r=t.length;r--;){const i=t[r],s=e[i];s&&(e[i]=substituteVariables(n,s))}}function substituteVariables(n,e){if(n.variableList!==null||n.hasVariableRefs){const t=n.variableList;return e.replace(VARIABLE_REPLACEMENT_REGEX,r=>{const i=r.substring(2,r.length-1),s=t==null?void 0:t[i];return s===void 0?(n.playlistParsingError||(n.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${i}"`)),r):s})}return e}function addVariableDefinition(n,e,t){let r=n.variableList;r||(n.variableList=r={});let i,s;if("QUERYPARAM"in e){i=e.QUERYPARAM;try{const o=new self.URL(t).searchParams;if(o.has(i))s=o.get(i);else throw new Error(`"${i}" does not match any query parameter in URI: "${t}"`)}catch(o){n.playlistParsingError||(n.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${o.message}`))}}else i=e.NAME,s=e.VALUE;i in r?n.playlistParsingError||(n.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${i}"`)):r[i]=s||""}function importVariableDefinition(n,e,t){const r=e.IMPORT;if(t&&r in t){let i=n.variableList;i||(n.variableList=i={}),i[r]=t[r]}else n.playlistParsingError||(n.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${r}"`))}function getMediaSource(n=!0){return typeof self>"u"?void 0:(n||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function isManagedMediaSource(n){return typeof self<"u"&&n===self.ManagedMediaSource}const sampleEntryCodesISO={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function isCodecType(n,e){const t=sampleEntryCodesISO[e];return!!t&&!!t[n.slice(0,4)]}function areCodecsMediaSourceSupported(n,e,t=!0){return!n.split(",").some(r=>!isCodecMediaSourceSupported(r,e,t))}function isCodecMediaSourceSupported(n,e,t=!0){var r;const i=getMediaSource(t);return(r=i==null?void 0:i.isTypeSupported(mimeTypeForCodec(n,e)))!=null?r:!1}function mimeTypeForCodec(n,e){return`${e}/mp4;codecs="${n}"`}function videoCodecPreferenceValue(n){if(n){const e=n.substring(0,4);return sampleEntryCodesISO.video[e]}return 2}function codecsSetSelectionPreferenceValue(n){return n.split(",").reduce((e,t)=>{const r=sampleEntryCodesISO.video[t];return r?(r*2+e)/(e?3:2):(sampleEntryCodesISO.audio[t]+e)/(e?2:1)},0)}const CODEC_COMPATIBLE_NAMES={};function getCodecCompatibleNameLower(n,e=!0){if(CODEC_COMPATIBLE_NAMES[n])return CODEC_COMPATIBLE_NAMES[n];const t={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"]}[n];for(let r=0;r<t.length;r++)if(isCodecMediaSourceSupported(t[r],"audio",e))return CODEC_COMPATIBLE_NAMES[n]=t[r],t[r];return n}const AUDIO_CODEC_REGEXP=/flac|opus/i;function getCodecCompatibleName(n,e=!0){return n.replace(AUDIO_CODEC_REGEXP,t=>getCodecCompatibleNameLower(t.toLowerCase(),e))}function pickMostCompleteCodecName(n,e){return n&&n!=="mp4a"?n:e&&e.split(",")[0]}function convertAVC1ToAVCOTI(n){const e=n.split(",");for(let t=0;t<e.length;t++){const r=e[t].split(".");if(r.length>2){let i=r.shift()+".";i+=parseInt(r.shift()).toString(16),i+=("000"+parseInt(r.shift()).toString(16)).slice(-4),e[t]=i}}return e.join(",")}const MASTER_PLAYLIST_REGEX=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,MASTER_PLAYLIST_MEDIA_REGEX=/#EXT-X-MEDIA:(.*)/g,IS_MEDIA_PLAYLIST=/^#EXT(?:INF|-X-TARGETDURATION):/m,LEVEL_PLAYLIST_REGEX_FAST=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),LEVEL_PLAYLIST_REGEX_SLOW=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class M3U8Parser{static findGroup(e,t){for(let r=0;r<e.length;r++){const i=e[r];if(i.id===t)return i}}static resolve(e,t){return urlToolkitExports.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return IS_MEDIA_PLAYLIST.test(e)}static parseMasterPlaylist(e,t){const r=hasVariableReferences(e),i={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:r},s=[];MASTER_PLAYLIST_REGEX.lastIndex=0;let o;for(;(o=MASTER_PLAYLIST_REGEX.exec(e))!=null;)if(o[1]){var a;const c=new AttrList(o[1]);substituteVariablesInAttributes(i,c,["CODECS","SUPPLEMENTAL-CODECS","ALLOWED-CPC","PATHWAY-ID","STABLE-VARIANT-ID","AUDIO","VIDEO","SUBTITLES","CLOSED-CAPTIONS","NAME"]);const u=substituteVariables(i,o[2]),d={attrs:c,bitrate:c.decimalInteger("BANDWIDTH")||c.decimalInteger("AVERAGE-BANDWIDTH"),name:c.NAME,url:M3U8Parser.resolve(u,t)},f=c.decimalResolution("RESOLUTION");f&&(d.width=f.width,d.height=f.height),setCodecs(c.CODECS,d),(a=d.unknownCodecs)!=null&&a.length||s.push(d),i.levels.push(d)}else if(o[3]){const c=o[3],u=o[4];switch(c){case"SESSION-DATA":{const d=new AttrList(u);substituteVariablesInAttributes(i,d,["DATA-ID","LANGUAGE","VALUE","URI"]);const f=d["DATA-ID"];f&&(i.sessionData===null&&(i.sessionData={}),i.sessionData[f]=d);break}case"SESSION-KEY":{const d=parseKey(u,t,i);d.encrypted&&d.isSupported()?(i.sessionKeys===null&&(i.sessionKeys=[]),i.sessionKeys.push(d)):logger.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${u}"`);break}case"DEFINE":{{const d=new AttrList(u);substituteVariablesInAttributes(i,d,["NAME","VALUE","QUERYPARAM"]),addVariableDefinition(i,d,t)}break}case"CONTENT-STEERING":{const d=new AttrList(u);substituteVariablesInAttributes(i,d,["SERVER-URI","PATHWAY-ID"]),i.contentSteering={uri:M3U8Parser.resolve(d["SERVER-URI"],t),pathwayId:d["PATHWAY-ID"]||"."};break}case"START":{i.startTimeOffset=parseStartTimeOffset(u);break}}}const l=s.length>0&&s.length<i.levels.length;return i.levels=l?s:i.levels,i.levels.length===0&&(i.playlistParsingError=new Error("no levels found in manifest")),i}static parseMasterPlaylistMedia(e,t,r){let i;const s={},o=r.levels,a={AUDIO:o.map(c=>({id:c.attrs.AUDIO,audioCodec:c.audioCodec})),SUBTITLES:o.map(c=>({id:c.attrs.SUBTITLES,textCodec:c.textCodec})),"CLOSED-CAPTIONS":[]};let l=0;for(MASTER_PLAYLIST_MEDIA_REGEX.lastIndex=0;(i=MASTER_PLAYLIST_MEDIA_REGEX.exec(e))!==null;){const c=new AttrList(i[1]),u=c.TYPE;if(u){const d=a[u],f=s[u]||[];s[u]=f,substituteVariablesInAttributes(r,c,["URI","GROUP-ID","LANGUAGE","ASSOC-LANGUAGE","STABLE-RENDITION-ID","NAME","INSTREAM-ID","CHARACTERISTICS","CHANNELS"]);const m=c.LANGUAGE,g=c["ASSOC-LANGUAGE"],v=c.CHANNELS,x=c.CHARACTERISTICS,S=c["INSTREAM-ID"],C={attrs:c,bitrate:0,id:l++,groupId:c["GROUP-ID"]||"",name:c.NAME||m||"",type:u,default:c.bool("DEFAULT"),autoselect:c.bool("AUTOSELECT"),forced:c.bool("FORCED"),lang:m,url:c.URI?M3U8Parser.resolve(c.URI,t):""};if(g&&(C.assocLang=g),v&&(C.channels=v),x&&(C.characteristics=x),S&&(C.instreamId=S),d!=null&&d.length){const R=M3U8Parser.findGroup(d,C.groupId)||d[0];assignCodec(C,R,"audioCodec"),assignCodec(C,R,"textCodec")}f.push(C)}}return s}static parseLevelPlaylist(e,t,r,i,s,o){const a=new LevelDetails(t),l=a.fragments;let c=null,u=0,d=0,f=0,m=0,g=null,v=new Fragment(i,t),x,S,C,R=-1,k=!1,I=null;for(LEVEL_PLAYLIST_REGEX_FAST.lastIndex=0,a.m3u8=e,a.hasVariableRefs=hasVariableReferences(e);(x=LEVEL_PLAYLIST_REGEX_FAST.exec(e))!==null;){k&&(k=!1,v=new Fragment(i,t),v.start=f,v.sn=u,v.cc=m,v.level=r,c&&(v.initSegment=c,v.rawProgramDateTime=c.rawProgramDateTime,c.rawProgramDateTime=null,I&&(v.setByteRange(I),I=null)));const M=x[1];if(M){v.duration=parseFloat(M);const B=(" "+x[2]).slice(1);v.title=B||null,v.tagList.push(B?["INF",M,B]:["INF",M])}else if(x[3]){if(isFiniteNumber(v.duration)){v.start=f,C&&setFragLevelKeys(v,C,a),v.sn=u,v.level=r,v.cc=m,l.push(v);const B=(" "+x[3]).slice(1);v.relurl=substituteVariables(a,B),assignProgramDateTime(v,g),g=v,f+=v.duration,u++,d=0,k=!0}}else if(x[4]){const B=(" "+x[4]).slice(1);g?v.setByteRange(B,g):v.setByteRange(B)}else if(x[5])v.rawProgramDateTime=(" "+x[5]).slice(1),v.tagList.push(["PROGRAM-DATE-TIME",v.rawProgramDateTime]),R===-1&&(R=l.length);else{if(x=x[0].match(LEVEL_PLAYLIST_REGEX_SLOW),!x){logger.warn("No matches on slow regex match for level playlist!");continue}for(S=1;S<x.length&&!(typeof x[S]<"u");S++);const B=(" "+x[S]).slice(1),H=(" "+x[S+1]).slice(1),K=x[S+2]?(" "+x[S+2]).slice(1):"";switch(B){case"PLAYLIST-TYPE":a.type=H.toUpperCase();break;case"MEDIA-SEQUENCE":u=a.startSN=parseInt(H);break;case"SKIP":{const Y=new AttrList(H);substituteVariablesInAttributes(a,Y,["RECENTLY-REMOVED-DATERANGES"]);const oe=Y.decimalInteger("SKIPPED-SEGMENTS");if(isFiniteNumber(oe)){a.skippedSegments=oe;for(let Z=oe;Z--;)l.unshift(null);u+=oe}const ue=Y.enumeratedString("RECENTLY-REMOVED-DATERANGES");ue&&(a.recentlyRemovedDateranges=ue.split("	"));break}case"TARGETDURATION":a.targetduration=Math.max(parseInt(H),1);break;case"VERSION":a.version=parseInt(H);break;case"INDEPENDENT-SEGMENTS":case"EXTM3U":break;case"ENDLIST":a.live=!1;break;case"#":(H||K)&&v.tagList.push(K?[H,K]:[H]);break;case"DISCONTINUITY":m++,v.tagList.push(["DIS"]);break;case"GAP":v.gap=!0,v.tagList.push([B]);break;case"BITRATE":v.tagList.push([B,H]);break;case"DATERANGE":{const Y=new AttrList(H);substituteVariablesInAttributes(a,Y,["ID","CLASS","START-DATE","END-DATE","SCTE35-CMD","SCTE35-OUT","SCTE35-IN"]),substituteVariablesInAttributes(a,Y,Y.clientAttrs);const oe=new DateRange(Y,a.dateRanges[Y.ID]);oe.isValid||a.skippedSegments?a.dateRanges[oe.id]=oe:logger.warn(`Ignoring invalid DATERANGE tag: "${H}"`),v.tagList.push(["EXT-X-DATERANGE",H]);break}case"DEFINE":{{const Y=new AttrList(H);substituteVariablesInAttributes(a,Y,["NAME","VALUE","IMPORT","QUERYPARAM"]),"IMPORT"in Y?importVariableDefinition(a,Y,o):addVariableDefinition(a,Y,t)}break}case"DISCONTINUITY-SEQUENCE":m=parseInt(H);break;case"KEY":{const Y=parseKey(H,t,a);if(Y.isSupported()){if(Y.method==="NONE"){C=void 0;break}C||(C={}),C[Y.keyFormat]&&(C=_extends({},C)),C[Y.keyFormat]=Y}else logger.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${H}"`);break}case"START":a.startTimeOffset=parseStartTimeOffset(H);break;case"MAP":{const Y=new AttrList(H);if(substituteVariablesInAttributes(a,Y,["BYTERANGE","URI"]),v.duration){const oe=new Fragment(i,t);setInitSegment(oe,Y,r,C),c=oe,v.initSegment=c,c.rawProgramDateTime&&!v.rawProgramDateTime&&(v.rawProgramDateTime=c.rawProgramDateTime)}else{const oe=v.byteRangeEndOffset;if(oe){const ue=v.byteRangeStartOffset;I=`${oe-ue}@${ue}`}else I=null;setInitSegment(v,Y,r,C),c=v,k=!0}break}case"SERVER-CONTROL":{const Y=new AttrList(H);a.canBlockReload=Y.bool("CAN-BLOCK-RELOAD"),a.canSkipUntil=Y.optionalFloat("CAN-SKIP-UNTIL",0),a.canSkipDateRanges=a.canSkipUntil>0&&Y.bool("CAN-SKIP-DATERANGES"),a.partHoldBack=Y.optionalFloat("PART-HOLD-BACK",0),a.holdBack=Y.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{const Y=new AttrList(H);a.partTarget=Y.decimalFloatingPoint("PART-TARGET");break}case"PART":{let Y=a.partList;Y||(Y=a.partList=[]);const oe=d>0?Y[Y.length-1]:void 0,ue=d++,Z=new AttrList(H);substituteVariablesInAttributes(a,Z,["BYTERANGE","URI"]);const Ae=new Part(Z,v,t,ue,oe);Y.push(Ae),v.duration+=Ae.duration;break}case"PRELOAD-HINT":{const Y=new AttrList(H);substituteVariablesInAttributes(a,Y,["URI"]),a.preloadHint=Y;break}case"RENDITION-REPORT":{const Y=new AttrList(H);substituteVariablesInAttributes(a,Y,["URI"]),a.renditionReports=a.renditionReports||[],a.renditionReports.push(Y);break}default:logger.warn(`line parsed but not handled: ${x}`);break}}}g&&!g.relurl?(l.pop(),f-=g.duration,a.partList&&(a.fragmentHint=g)):a.partList&&(assignProgramDateTime(v,g),v.cc=m,a.fragmentHint=v,C&&setFragLevelKeys(v,C,a));const F=l.length,N=l[0],U=l[F-1];if(f+=a.skippedSegments*a.targetduration,f>0&&F&&U){a.averagetargetduration=f/F;const M=U.sn;a.endSN=M!=="initSegment"?M:0,a.live||(U.endList=!0),N&&(a.startCC=N.cc)}else a.endSN=0,a.startCC=0;return a.fragmentHint&&(f+=a.fragmentHint.duration),a.totalduration=f,a.endCC=m,R>0&&backfillProgramDateTimes(l,R),a}}function parseKey(n,e,t){var r,i;const s=new AttrList(n);substituteVariablesInAttributes(t,s,["KEYFORMAT","KEYFORMATVERSIONS","URI","IV","URI"]);const o=(r=s.METHOD)!=null?r:"",a=s.URI,l=s.hexadecimalInteger("IV"),c=s.KEYFORMATVERSIONS,u=(i=s.KEYFORMAT)!=null?i:"identity";a&&s.IV&&!l&&logger.error(`Invalid IV: ${s.IV}`);const d=a?M3U8Parser.resolve(a,e):"",f=(c||"1").split("/").map(Number).filter(Number.isFinite);return new LevelKey(o,d,u,f,l)}function parseStartTimeOffset(n){const t=new AttrList(n).decimalFloatingPoint("TIME-OFFSET");return isFiniteNumber(t)?t:null}function setCodecs(n,e){let t=(n||"").split(/[ ,]+/).filter(r=>r);["video","audio","text"].forEach(r=>{const i=t.filter(s=>isCodecType(s,r));i.length&&(e[`${r}Codec`]=i.join(","),t=t.filter(s=>i.indexOf(s)===-1))}),e.unknownCodecs=t}function assignCodec(n,e,t){const r=e[t];r&&(n[t]=r)}function backfillProgramDateTimes(n,e){let t=n[e];for(let r=e;r--;){const i=n[r];if(!i)return;i.programDateTime=t.programDateTime-i.duration*1e3,t=i}}function assignProgramDateTime(n,e){n.rawProgramDateTime?n.programDateTime=Date.parse(n.rawProgramDateTime):e!=null&&e.programDateTime&&(n.programDateTime=e.endProgramDateTime),isFiniteNumber(n.programDateTime)||(n.programDateTime=null,n.rawProgramDateTime=null)}function setInitSegment(n,e,t,r){n.relurl=e.URI,e.BYTERANGE&&n.setByteRange(e.BYTERANGE),n.level=t,n.sn="initSegment",r&&(n.levelkeys=r),n.initSegment=null}function setFragLevelKeys(n,e,t){n.levelkeys=e;const{encryptedFragments:r}=t;(!r.length||r[r.length-1].levelkeys!==e)&&Object.keys(e).some(i=>e[i].isCommonEncryption)&&r.push(n)}var PlaylistContextType={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},PlaylistLevelType={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};function mapContextToLevelType(n){const{type:e}=n;switch(e){case PlaylistContextType.AUDIO_TRACK:return PlaylistLevelType.AUDIO;case PlaylistContextType.SUBTITLE_TRACK:return PlaylistLevelType.SUBTITLE;default:return PlaylistLevelType.MAIN}}function getResponseUrl(n,e){let t=n.url;return(t===void 0||t.indexOf("data:")===0)&&(t=e.url),t}class PlaylistLoader{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Events.LEVEL_LOADING,this.onLevelLoading,this),e.on(Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}unregisterListeners(){const{hls:e}=this;e.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Events.LEVEL_LOADING,this.onLevelLoading,this),e.off(Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}createInternalLoader(e){const t=this.hls.config,r=t.pLoader,i=t.loader,s=r||i,o=new s(t);return this.loaders[e.type]=o,o}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){const{url:r}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:PlaylistContextType.MANIFEST,url:r,deliveryDirectives:null})}onLevelLoading(e,t){const{id:r,level:i,pathwayId:s,url:o,deliveryDirectives:a}=t;this.load({id:r,level:i,pathwayId:s,responseType:"text",type:PlaylistContextType.LEVEL,url:o,deliveryDirectives:a})}onAudioTrackLoading(e,t){const{id:r,groupId:i,url:s,deliveryDirectives:o}=t;this.load({id:r,groupId:i,level:null,responseType:"text",type:PlaylistContextType.AUDIO_TRACK,url:s,deliveryDirectives:o})}onSubtitleTrackLoading(e,t){const{id:r,groupId:i,url:s,deliveryDirectives:o}=t;this.load({id:r,groupId:i,level:null,responseType:"text",type:PlaylistContextType.SUBTITLE_TRACK,url:s,deliveryDirectives:o})}load(e){var t;const r=this.hls.config;let i=this.getInternalLoader(e);if(i){const c=i.context;if(c&&c.url===e.url&&c.level===e.level){logger.trace("[playlist-loader]: playlist request ongoing");return}logger.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),i.abort()}let s;if(e.type===PlaylistContextType.MANIFEST?s=r.manifestLoadPolicy.default:s=_extends({},r.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),i=this.createInternalLoader(e),isFiniteNumber((t=e.deliveryDirectives)==null?void 0:t.part)){let c;if(e.type===PlaylistContextType.LEVEL&&e.level!==null?c=this.hls.levels[e.level].details:e.type===PlaylistContextType.AUDIO_TRACK&&e.id!==null?c=this.hls.audioTracks[e.id].details:e.type===PlaylistContextType.SUBTITLE_TRACK&&e.id!==null&&(c=this.hls.subtitleTracks[e.id].details),c){const u=c.partTarget,d=c.targetduration;if(u&&d){const f=Math.max(u*3,d*.8)*1e3;s=_extends({},s,{maxTimeToFirstByteMs:Math.min(f,s.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(f,s.maxTimeToFirstByteMs)})}}}const o=s.errorRetry||s.timeoutRetry||{},a={loadPolicy:s,timeout:s.maxLoadTimeMs,maxRetry:o.maxNumRetry||0,retryDelay:o.retryDelayMs||0,maxRetryDelay:o.maxRetryDelayMs||0},l={onSuccess:(c,u,d,f)=>{const m=this.getInternalLoader(d);this.resetInternalLoader(d.type);const g=c.data;if(g.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(c,d,new Error("no EXTM3U delimiter"),f||null,u);return}u.parsing.start=performance.now(),M3U8Parser.isMediaPlaylist(g)?this.handleTrackOrLevelPlaylist(c,u,d,f||null,m):this.handleMasterPlaylist(c,u,d,f)},onError:(c,u,d,f)=>{this.handleNetworkError(u,d,!1,c,f)},onTimeout:(c,u,d)=>{this.handleNetworkError(u,d,!0,void 0,c)}};i.load(e,a,l)}handleMasterPlaylist(e,t,r,i){const s=this.hls,o=e.data,a=getResponseUrl(e,r),l=M3U8Parser.parseMasterPlaylist(o,a);if(l.playlistParsingError){this.handleManifestParsingError(e,r,l.playlistParsingError,i,t);return}const{contentSteering:c,levels:u,sessionData:d,sessionKeys:f,startTimeOffset:m,variableList:g}=l;this.variableList=g;const{AUDIO:v=[],SUBTITLES:x,"CLOSED-CAPTIONS":S}=M3U8Parser.parseMasterPlaylistMedia(o,a,l);v.length&&!v.some(R=>!R.url)&&u[0].audioCodec&&!u[0].attrs.AUDIO&&(logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),v.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new AttrList({}),bitrate:0,url:""})),s.trigger(Events.MANIFEST_LOADED,{levels:u,audioTracks:v,subtitles:x,captions:S,contentSteering:c,url:a,stats:t,networkDetails:i,sessionData:d,sessionKeys:f,startTimeOffset:m,variableList:g})}handleTrackOrLevelPlaylist(e,t,r,i,s){const o=this.hls,{id:a,level:l,type:c}=r,u=getResponseUrl(e,r),d=0,f=isFiniteNumber(l)?l:isFiniteNumber(a)?a:0,m=mapContextToLevelType(r),g=M3U8Parser.parseLevelPlaylist(e.data,u,f,m,d,this.variableList);if(c===PlaylistContextType.MANIFEST){const v={attrs:new AttrList({}),bitrate:0,details:g,name:"",url:u};o.trigger(Events.MANIFEST_LOADED,{levels:[v],audioTracks:[],url:u,stats:t,networkDetails:i,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),r.levelDetails=g,this.handlePlaylistLoaded(g,e,t,r,i,s)}handleManifestParsingError(e,t,r,i,s){this.hls.trigger(Events.ERROR,{type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.MANIFEST_PARSING_ERROR,fatal:t.type===PlaylistContextType.MANIFEST,url:e.url,err:r,error:r,reason:r.message,response:e,context:t,networkDetails:i,stats:s})}handleNetworkError(e,t,r=!1,i,s){let o=`A network ${r?"timeout":"error"+(i?" (status "+i.code+")":"")} occurred while loading ${e.type}`;e.type===PlaylistContextType.LEVEL?o+=`: ${e.level} id: ${e.id}`:(e.type===PlaylistContextType.AUDIO_TRACK||e.type===PlaylistContextType.SUBTITLE_TRACK)&&(o+=` id: ${e.id} group-id: "${e.groupId}"`);const a=new Error(o);logger.warn(`[playlist-loader]: ${o}`);let l=ErrorDetails.UNKNOWN,c=!1;const u=this.getInternalLoader(e);switch(e.type){case PlaylistContextType.MANIFEST:l=r?ErrorDetails.MANIFEST_LOAD_TIMEOUT:ErrorDetails.MANIFEST_LOAD_ERROR,c=!0;break;case PlaylistContextType.LEVEL:l=r?ErrorDetails.LEVEL_LOAD_TIMEOUT:ErrorDetails.LEVEL_LOAD_ERROR,c=!1;break;case PlaylistContextType.AUDIO_TRACK:l=r?ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:ErrorDetails.AUDIO_TRACK_LOAD_ERROR,c=!1;break;case PlaylistContextType.SUBTITLE_TRACK:l=r?ErrorDetails.SUBTITLE_TRACK_LOAD_TIMEOUT:ErrorDetails.SUBTITLE_LOAD_ERROR,c=!1;break}u&&this.resetInternalLoader(e.type);const d={type:ErrorTypes.NETWORK_ERROR,details:l,fatal:c,url:e.url,loader:u,context:e,error:a,networkDetails:t,stats:s};if(i){const f=(t==null?void 0:t.url)||e.url;d.response=_objectSpread2({url:f,data:void 0},i)}this.hls.trigger(Events.ERROR,d)}handlePlaylistLoaded(e,t,r,i,s,o){const a=this.hls,{type:l,level:c,id:u,groupId:d,deliveryDirectives:f}=i,m=getResponseUrl(t,i),g=mapContextToLevelType(i),v=typeof i.level=="number"&&g===PlaylistLevelType.MAIN?c:void 0;if(!e.fragments.length){const S=new Error("No Segments found in Playlist");a.trigger(Events.ERROR,{type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.LEVEL_EMPTY_ERROR,fatal:!1,url:m,error:S,reason:S.message,response:t,context:i,level:v,parent:g,networkDetails:s,stats:r});return}e.targetduration||(e.playlistParsingError=new Error("Missing Target Duration"));const x=e.playlistParsingError;if(x){a.trigger(Events.ERROR,{type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.LEVEL_PARSING_ERROR,fatal:!1,url:m,error:x,reason:x.message,response:t,context:i,level:v,parent:g,networkDetails:s,stats:r});return}switch(e.live&&o&&(o.getCacheAge&&(e.ageHeader=o.getCacheAge()||0),(!o.getCacheAge||isNaN(e.ageHeader))&&(e.ageHeader=0)),l){case PlaylistContextType.MANIFEST:case PlaylistContextType.LEVEL:a.trigger(Events.LEVEL_LOADED,{details:e,level:v||0,id:u||0,stats:r,networkDetails:s,deliveryDirectives:f});break;case PlaylistContextType.AUDIO_TRACK:a.trigger(Events.AUDIO_TRACK_LOADED,{details:e,id:u||0,groupId:d||"",stats:r,networkDetails:s,deliveryDirectives:f});break;case PlaylistContextType.SUBTITLE_TRACK:a.trigger(Events.SUBTITLE_TRACK_LOADED,{details:e,id:u||0,groupId:d||"",stats:r,networkDetails:s,deliveryDirectives:f});break}}}function sendAddTrackEvent(n,e){let t;try{t=new Event("addtrack")}catch{t=document.createEvent("Event"),t.initEvent("addtrack",!1,!1)}t.track=n,e.dispatchEvent(t)}function addCueToTrack(n,e){const t=n.mode;if(t==="disabled"&&(n.mode="hidden"),n.cues&&!n.cues.getCueById(e.id))try{if(n.addCue(e),!n.cues.getCueById(e.id))throw new Error(`addCue is failed for: ${e}`)}catch(r){logger.debug(`[texttrack-utils]: ${r}`);try{const i=new self.TextTrackCue(e.startTime,e.endTime,e.text);i.id=e.id,n.addCue(i)}catch(i){logger.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${i}`)}}t==="disabled"&&(n.mode=t)}function clearCurrentCues(n){const e=n.mode;if(e==="disabled"&&(n.mode="hidden"),n.cues)for(let t=n.cues.length;t--;)n.removeCue(n.cues[t]);e==="disabled"&&(n.mode=e)}function removeCuesInRange(n,e,t,r){const i=n.mode;if(i==="disabled"&&(n.mode="hidden"),n.cues&&n.cues.length>0){const s=getCuesInRange(n.cues,e,t);for(let o=0;o<s.length;o++)(!r||r(s[o]))&&n.removeCue(s[o])}i==="disabled"&&(n.mode=i)}function getFirstCueIndexAfterTime(n,e){if(e<n[0].startTime)return 0;const t=n.length-1;if(e>n[t].endTime)return-1;let r=0,i=t;for(;r<=i;){const s=Math.floor((i+r)/2);if(e<n[s].startTime)i=s-1;else if(e>n[s].startTime&&r<t)r=s+1;else return s}return n[r].startTime-e<e-n[i].startTime?r:i}function getCuesInRange(n,e,t){const r=[],i=getFirstCueIndexAfterTime(n,e);if(i>-1)for(let s=i,o=n.length;s<o;s++){const a=n[s];if(a.startTime>=e&&a.endTime<=t)r.push(a);else if(a.startTime>t)return r}return r}function filterSubtitleTracks(n){const e=[];for(let t=0;t<n.length;t++){const r=n[t];(r.kind==="subtitles"||r.kind==="captions")&&r.label&&e.push(n[t])}return e}var MetadataSchema={audioId3:"org.id3",dateRange:"com.apple.quicktime.HLS",emsg:"https://aomedia.org/emsg/ID3"};const MIN_CUE_DURATION=.25;function getCueClass(){if(!(typeof self>"u"))return self.VTTCue||self.TextTrackCue}function createCueWithDataFields(n,e,t,r,i){let s=new n(e,t,"");try{s.value=r,i&&(s.type=i)}catch{s=new n(e,t,JSON.stringify(i?_objectSpread2({type:i},r):r))}return s}const MAX_CUE_ENDTIME=(()=>{const n=getCueClass();try{n&&new n(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();function dateRangeDateToTimelineSeconds(n,e){return n.getTime()/1e3-e}function hexToArrayBuffer(n){return Uint8Array.from(n.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}class ID3TrackController{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null}_registerListeners(){const{hls:e}=this;e.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(Events.LEVEL_UPDATED,this.onLevelUpdated,this)}_unregisterListeners(){const{hls:e}=this;e.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(Events.LEVEL_UPDATED,this.onLevelUpdated,this)}onMediaAttached(e,t){this.media=t.media}onMediaDetaching(){this.id3Track&&(clearCurrentCues(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){const r=e[t];if(r.kind==="metadata"&&r.label==="id3")return sendAddTrackEvent(r,this.media),r}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media)return;const{hls:{config:{enableEmsgMetadataCues:r,enableID3MetadataCues:i}}}=this;if(!r&&!i)return;const{samples:s}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));const o=getCueClass();if(o)for(let a=0;a<s.length;a++){const l=s[a].type;if(l===MetadataSchema.emsg&&!r||!i)continue;const c=getID3Frames(s[a].data);if(c){const u=s[a].pts;let d=u+s[a].duration;d>MAX_CUE_ENDTIME&&(d=MAX_CUE_ENDTIME),d-u<=0&&(d=u+MIN_CUE_DURATION);for(let m=0;m<c.length;m++){const g=c[m];if(!isTimeStampFrame(g)){this.updateId3CueEnds(u,l);const v=createCueWithDataFields(o,u,d,g,l);v&&this.id3Track.addCue(v)}}}}}updateId3CueEnds(e,t){var r;const i=(r=this.id3Track)==null?void 0:r.cues;if(i)for(let s=i.length;s--;){const o=i[s];o.type===t&&o.startTime<e&&o.endTime===MAX_CUE_ENDTIME&&(o.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:r,type:i}){const{id3Track:s,hls:o}=this;if(!o)return;const{config:{enableEmsgMetadataCues:a,enableID3MetadataCues:l}}=o;if(s&&(a||l)){let c;i==="audio"?c=u=>u.type===MetadataSchema.audioId3&&l:i==="video"?c=u=>u.type===MetadataSchema.emsg&&a:c=u=>u.type===MetadataSchema.audioId3&&l||u.type===MetadataSchema.emsg&&a,removeCuesInRange(s,t,r,c)}}onLevelUpdated(e,{details:t}){if(!this.media||!t.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return;const{dateRangeCuesAppended:r,id3Track:i}=this,{dateRanges:s}=t,o=Object.keys(s);if(i){const u=Object.keys(r).filter(d=>!o.includes(d));for(let d=u.length;d--;){const f=u[d];Object.keys(r[f].cues).forEach(m=>{i.removeCue(r[f].cues[m])}),delete r[f]}}const a=t.fragments[t.fragments.length-1];if(o.length===0||!isFiniteNumber(a==null?void 0:a.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));const l=a.programDateTime/1e3-a.start,c=getCueClass();for(let u=0;u<o.length;u++){const d=o[u],f=s[d],m=dateRangeDateToTimelineSeconds(f.startDate,l),g=r[d],v=(g==null?void 0:g.cues)||{};let x=(g==null?void 0:g.durationKnown)||!1,S=MAX_CUE_ENDTIME;const C=f.endDate;if(C)S=dateRangeDateToTimelineSeconds(C,l),x=!0;else if(f.endOnNext&&!x){const k=o.reduce((I,F)=>{if(F!==f.id){const N=s[F];if(N.class===f.class&&N.startDate>f.startDate&&(!I||f.startDate<I.startDate))return N}return I},null);k&&(S=dateRangeDateToTimelineSeconds(k.startDate,l),x=!0)}const R=Object.keys(f.attr);for(let k=0;k<R.length;k++){const I=R[k];if(!isDateRangeCueAttribute(I))continue;const F=v[I];if(F)x&&!g.durationKnown&&(F.endTime=S);else if(c){let N=f.attr[I];isSCTE35Attribute(I)&&(N=hexToArrayBuffer(N));const U=createCueWithDataFields(c,m,S,{key:I,data:N},MetadataSchema.dateRange);U&&(U.id=d,this.id3Track.addCue(U),v[I]=U)}}r[d]={cues:v,dateRange:f,durationKnown:x}}}}class LatencyController{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=()=>this.timeupdate(),this.hls=e,this.config=e.config,this.registerListeners()}get latency(){return this._latency||0}get maxLatency(){const{config:e,levelDetails:t}=this;return e.liveMaxLatencyDuration!==void 0?e.liveMaxLatencyDuration:t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){const{levelDetails:e}=this;if(e===null)return null;const{holdBack:t,partHoldBack:r,targetduration:i}=e,{liveSyncDuration:s,liveSyncDurationCount:o,lowLatencyMode:a}=this.config,l=this.hls.userConfig;let c=a&&r||t;(l.liveSyncDuration||l.liveSyncDurationCount||c===0)&&(c=s!==void 0?s:o*i);const u=i;return c+Math.min(this.stallCount*1,u)}get liveSyncPosition(){const e=this.estimateLiveEdge(),t=this.targetLatency,r=this.levelDetails;if(e===null||t===null||r===null)return null;const i=r.edge,s=e-t-this.edgeStalled,o=i-r.totalduration,a=i-(this.config.lowLatencyMode&&r.partTarget||r.targetduration);return Math.min(Math.max(o,s),a)}get drift(){const{levelDetails:e}=this;return e===null?1:e.drift}get edgeStalled(){const{levelDetails:e}=this;if(e===null)return 0;const t=(this.config.lowLatencyMode&&e.partTarget||e.targetduration)*3;return Math.max(e.age-t,0)}get forwardBufferLength(){const{media:e,levelDetails:t}=this;if(!e||!t)return 0;const r=e.buffered.length;return(r?e.buffered.end(r-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null}registerListeners(){this.hls.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(Events.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(Events.ERROR,this.onError,this)}unregisterListeners(){this.hls.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(Events.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.off(Events.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)}onManifestLoading(){this.levelDetails=null,this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){this.levelDetails=t,t.advanced&&this.timeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)}onError(e,t){var r;t.details===ErrorDetails.BUFFER_STALLED_ERROR&&(this.stallCount++,(r=this.levelDetails)!=null&&r.live&&logger.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))}timeupdate(){const{media:e,levelDetails:t}=this;if(!e||!t)return;this.currentTime=e.currentTime;const r=this.computeLatency();if(r===null)return;this._latency=r;const{lowLatencyMode:i,maxLiveSyncPlaybackRate:s}=this.config;if(!i||s===1||!t.live)return;const o=this.targetLatency;if(o===null)return;const a=r-o,l=Math.min(this.maxLatency,o+t.targetduration);if(a<l&&a>.05&&this.forwardBufferLength>1){const u=Math.min(2,Math.max(1,s)),d=Math.round(2/(1+Math.exp(-.75*a-this.edgeStalled))*20)/20;e.playbackRate=Math.min(u,Math.max(1,d))}else e.playbackRate!==1&&e.playbackRate!==0&&(e.playbackRate=1)}estimateLiveEdge(){const{levelDetails:e}=this;return e===null?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return e===null?null:e-this.currentTime}}const HdcpLevels=["NONE","TYPE-0","TYPE-1",null];function isHdcpLevel(n){return HdcpLevels.indexOf(n)>-1}const VideoRangeValues=["SDR","PQ","HLG"];function isVideoRange(n){return!!n&&VideoRangeValues.indexOf(n)>-1}var HlsSkip={No:"",Yes:"YES",v2:"v2"};function getSkipValue(n){const{canSkipUntil:e,canSkipDateRanges:t,age:r}=n,i=r<e/2;return e&&i?t?HlsSkip.v2:HlsSkip.Yes:HlsSkip.No}class HlsUrlParameters{constructor(e,t,r){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=r}addDirectives(e){const t=new self.URL(e);return this.msn!==void 0&&t.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class Level{constructor(e){this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.frameRate=e.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=e.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.codecSet=[e.videoCodec,e.audioCodec].filter(t=>!!t).map(t=>t.substring(0,4)).join(","),this.addGroupId("audio",e.attrs.AUDIO),this.addGroupId("text",e.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(e){return hasGroup(this._audioGroups,e)}hasSubtitleGroup(e){return hasGroup(this._subtitleGroups,e)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(e,t){if(t){if(e==="audio"){let r=this._audioGroups;r||(r=this._audioGroups=[]),r.indexOf(t)===-1&&r.push(t)}else if(e==="text"){let r=this._subtitleGroups;r||(r=this._subtitleGroups=[]),r.indexOf(t)===-1&&r.push(t)}}}get urlId(){return 0}set urlId(e){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var e;return(e=this.audioGroups)==null?void 0:e[0]}get textGroupId(){var e;return(e=this.subtitleGroups)==null?void 0:e[0]}addFallback(){}}function hasGroup(n,e){return!e||!n?!1:n.indexOf(e)!==-1}function updateFromToPTS(n,e){const t=e.startPTS;if(isFiniteNumber(t)){let r=0,i;e.sn>n.sn?(r=t-n.start,i=n):(r=n.start-t,i=e),i.duration!==r&&(i.duration=r)}else e.sn>n.sn?n.cc===e.cc&&n.minEndPTS?e.start=n.start+(n.minEndPTS-n.start):e.start=n.start+n.duration:e.start=Math.max(n.start-e.duration,0)}function updateFragPTSDTS(n,e,t,r,i,s){r-t<=0&&(logger.warn("Fragment should have a positive duration",e),r=t+e.duration,s=i+e.duration);let a=t,l=r;const c=e.startPTS,u=e.endPTS;if(isFiniteNumber(c)){const x=Math.abs(c-t);isFiniteNumber(e.deltaPTS)?e.deltaPTS=Math.max(x,e.deltaPTS):e.deltaPTS=x,a=Math.max(t,c),t=Math.min(t,c),i=Math.min(i,e.startDTS),l=Math.min(r,u),r=Math.max(r,u),s=Math.max(s,e.endDTS)}const d=t-e.start;e.start!==0&&(e.start=t),e.duration=r-e.start,e.startPTS=t,e.maxStartPTS=a,e.startDTS=i,e.endPTS=r,e.minEndPTS=l,e.endDTS=s;const f=e.sn;if(!n||f<n.startSN||f>n.endSN)return 0;let m;const g=f-n.startSN,v=n.fragments;for(v[g]=e,m=g;m>0;m--)updateFromToPTS(v[m],v[m-1]);for(m=g;m<v.length-1;m++)updateFromToPTS(v[m],v[m+1]);return n.fragmentHint&&updateFromToPTS(v[v.length-1],n.fragmentHint),n.PTSKnown=n.alignedSliding=!0,d}function mergeDetails(n,e){let t=null;const r=n.fragments;for(let l=r.length-1;l>=0;l--){const c=r[l].initSegment;if(c){t=c;break}}n.fragmentHint&&delete n.fragmentHint.endPTS;let i=0,s;if(mapFragmentIntersection(n,e,(l,c)=>{l.relurl&&(i=l.cc-c.cc),isFiniteNumber(l.startPTS)&&isFiniteNumber(l.endPTS)&&(c.start=c.startPTS=l.startPTS,c.startDTS=l.startDTS,c.maxStartPTS=l.maxStartPTS,c.endPTS=l.endPTS,c.endDTS=l.endDTS,c.minEndPTS=l.minEndPTS,c.duration=l.endPTS-l.startPTS,c.duration&&(s=c),e.PTSKnown=e.alignedSliding=!0),c.elementaryStreams=l.elementaryStreams,c.loader=l.loader,c.stats=l.stats,l.initSegment&&(c.initSegment=l.initSegment,t=l.initSegment)}),t&&(e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments).forEach(c=>{var u;c&&(!c.initSegment||c.initSegment.relurl===((u=t)==null?void 0:u.relurl))&&(c.initSegment=t)}),e.skippedSegments)if(e.deltaUpdateFailed=e.fragments.some(l=>!l),e.deltaUpdateFailed){logger.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let l=e.skippedSegments;l--;)e.fragments.shift();e.startSN=e.fragments[0].sn,e.startCC=e.fragments[0].cc}else e.canSkipDateRanges&&(e.dateRanges=mergeDateRanges(n.dateRanges,e.dateRanges,e.recentlyRemovedDateranges));const o=e.fragments;if(i){logger.warn("discontinuity sliding from playlist, take drift into account");for(let l=0;l<o.length;l++)o[l].cc+=i}e.skippedSegments&&(e.startCC=e.fragments[0].cc),mapPartIntersection(n.partList,e.partList,(l,c)=>{c.elementaryStreams=l.elementaryStreams,c.stats=l.stats}),s?updateFragPTSDTS(e,s,s.startPTS,s.endPTS,s.startDTS,s.endDTS):adjustSliding(n,e),o.length&&(e.totalduration=e.edge-o[0].start),e.driftStartTime=n.driftStartTime,e.driftStart=n.driftStart;const a=e.advancedDateTime;if(e.advanced&&a){const l=e.edge;e.driftStart||(e.driftStartTime=a,e.driftStart=l),e.driftEndTime=a,e.driftEnd=l}else e.driftEndTime=n.driftEndTime,e.driftEnd=n.driftEnd,e.advancedDateTime=n.advancedDateTime}function mergeDateRanges(n,e,t){const r=_extends({},n);return t&&t.forEach(i=>{delete r[i]}),Object.keys(e).forEach(i=>{const s=new DateRange(e[i].attr,r[i]);s.isValid?r[i]=s:logger.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${JSON.stringify(e[i].attr)}"`)}),r}function mapPartIntersection(n,e,t){if(n&&e){let r=0;for(let i=0,s=n.length;i<=s;i++){const o=n[i],a=e[i+r];o&&a&&o.index===a.index&&o.fragment.sn===a.fragment.sn?t(o,a):r--}}}function mapFragmentIntersection(n,e,t){const r=e.skippedSegments,i=Math.max(n.startSN,e.startSN)-e.startSN,s=(n.fragmentHint?1:0)+(r?e.endSN:Math.min(n.endSN,e.endSN))-e.startSN,o=e.startSN-n.startSN,a=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,l=n.fragmentHint?n.fragments.concat(n.fragmentHint):n.fragments;for(let c=i;c<=s;c++){const u=l[o+c];let d=a[c];r&&!d&&c<r&&(d=e.fragments[c]=u),u&&d&&t(u,d)}}function adjustSliding(n,e){const t=e.startSN+e.skippedSegments-n.startSN,r=n.fragments;t<0||t>=r.length||addSliding(e,r[t].start)}function addSliding(n,e){if(e){const t=n.fragments;for(let r=n.skippedSegments;r<t.length;r++)t[r].start+=e;n.fragmentHint&&(n.fragmentHint.start+=e)}}function computeReloadInterval(n,e=1/0){let t=1e3*n.targetduration;if(n.updated){const r=n.fragments;if(r.length&&t*4>e){const s=r[r.length-1].duration*1e3;s<t&&(t=s)}}else t/=2;return Math.round(t)}function getFragmentWithSN(n,e,t){if(!(n!=null&&n.details))return null;const r=n.details;let i=r.fragments[e-r.startSN];return i||(i=r.fragmentHint,i&&i.sn===e)?i:e<r.startSN&&t&&t.sn===e?t:null}function getPartWith(n,e,t){var r;return n!=null&&n.details?findPart((r=n.details)==null?void 0:r.partList,e,t):null}function findPart(n,e,t){if(n)for(let r=n.length;r--;){const i=n[r];if(i.index===t&&i.fragment.sn===e)return i}return null}function reassignFragmentLevelIndexes(n){n.forEach((e,t)=>{const{details:r}=e;r!=null&&r.fragments&&r.fragments.forEach(i=>{i.level=t})})}function isTimeoutError(n){switch(n.details){case ErrorDetails.FRAG_LOAD_TIMEOUT:case ErrorDetails.KEY_LOAD_TIMEOUT:case ErrorDetails.LEVEL_LOAD_TIMEOUT:case ErrorDetails.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function getRetryConfig(n,e){const t=isTimeoutError(e);return n.default[`${t?"timeout":"error"}Retry`]}function getRetryDelay(n,e){const t=n.backoff==="linear"?1:Math.pow(2,e);return Math.min(t*n.retryDelayMs,n.maxRetryDelayMs)}function getLoaderConfigWithoutReties(n){return _objectSpread2(_objectSpread2({},n),{errorRetry:null,timeoutRetry:null})}function shouldRetry(n,e,t,r){if(!n)return!1;const i=r==null?void 0:r.code,s=e<n.maxNumRetry&&(retryForHttpStatus(i)||!!t);return n.shouldRetry?n.shouldRetry(n,e,t,r,s):s}function retryForHttpStatus(n){return n===0&&navigator.onLine===!1||!!n&&(n<400||n>499)}const BinarySearch={search:function(n,e){let t=0,r=n.length-1,i=null,s=null;for(;t<=r;){i=(t+r)/2|0,s=n[i];const o=e(s);if(o>0)t=i+1;else if(o<0)r=i-1;else return s}return null}};function findFragmentByPDT(n,e,t){if(e===null||!Array.isArray(n)||!n.length||!isFiniteNumber(e))return null;const r=n[0].programDateTime;if(e<(r||0))return null;const i=n[n.length-1].endProgramDateTime;if(e>=(i||0))return null;t=t||0;for(let s=0;s<n.length;++s){const o=n[s];if(pdtWithinToleranceTest(e,t,o))return o}return null}function findFragmentByPTS(n,e,t=0,r=0,i=.005){let s=null;if(n){s=e[n.sn-e[0].sn+1]||null;const a=n.endDTS-t;a>0&&a<15e-7&&(t+=15e-7)}else t===0&&e[0].start===0&&(s=e[0]);if(s&&((!n||n.level===s.level)&&fragmentWithinToleranceTest(t,r,s)===0||fragmentWithinFastStartSwitch(s,n,Math.min(i,r))))return s;const o=BinarySearch.search(e,fragmentWithinToleranceTest.bind(null,t,r));return o&&(o!==n||!s)?o:s}function fragmentWithinFastStartSwitch(n,e,t){if(e&&e.start===0&&e.level<n.level&&(e.endPTS||0)>0){const r=e.tagList.reduce((i,s)=>(s[0]==="INF"&&(i+=parseFloat(s[1])),i),t);return n.start<=r}return!1}function fragmentWithinToleranceTest(n=0,e=0,t){if(t.start<=n&&t.start+t.duration>n)return 0;const r=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0));return t.start+t.duration-r<=n?1:t.start-r>n&&t.start?-1:0}function pdtWithinToleranceTest(n,e,t){const r=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0))*1e3;return(t.endProgramDateTime||0)-r>n}function findFragWithCC(n,e){return BinarySearch.search(n,t=>t.cc<e?1:t.cc>e?-1:0)}var NetworkErrorAction={DoNothing:0,SendEndCallback:1,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,InsertDiscontinuity:4,RetryRequest:5},ErrorActionFlags={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2,SwitchToSDR:4};class ErrorController{constructor(e){this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.log=void 0,this.warn=void 0,this.error=void 0,this.hls=e,this.log=logger.log.bind(logger,"[info]:"),this.warn=logger.warn.bind(logger,"[warning]:"),this.error=logger.error.bind(logger,"[error]:"),this.registerListeners()}registerListeners(){const e=this.hls;e.on(Events.ERROR,this.onError,this),e.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Events.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;e&&(e.off(Events.ERROR,this.onError,this),e.off(Events.ERROR,this.onErrorOut,this),e.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Events.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(e){}stopLoad(){this.playlistError=0}getVariantLevelIndex(e){return(e==null?void 0:e.type)===PlaylistLevelType.MAIN?e.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(e,t){var r,i;if(t.fatal)return;const s=this.hls,o=t.context;switch(t.details){case ErrorDetails.FRAG_LOAD_ERROR:case ErrorDetails.FRAG_LOAD_TIMEOUT:case ErrorDetails.KEY_LOAD_ERROR:case ErrorDetails.KEY_LOAD_TIMEOUT:t.errorAction=this.getFragRetryOrSwitchAction(t);return;case ErrorDetails.FRAG_PARSING_ERROR:if((r=t.frag)!=null&&r.gap){t.errorAction={action:NetworkErrorAction.DoNothing,flags:ErrorActionFlags.None};return}case ErrorDetails.FRAG_GAP:case ErrorDetails.FRAG_DECRYPT_ERROR:{t.errorAction=this.getFragRetryOrSwitchAction(t),t.errorAction.action=NetworkErrorAction.SendAlternateToPenaltyBox;return}case ErrorDetails.LEVEL_EMPTY_ERROR:case ErrorDetails.LEVEL_PARSING_ERROR:{var a,l;const c=t.parent===PlaylistLevelType.MAIN?t.level:s.loadLevel;t.details===ErrorDetails.LEVEL_EMPTY_ERROR&&((a=t.context)!=null&&(l=a.levelDetails)!=null&&l.live)?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,c):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,c))}return;case ErrorDetails.LEVEL_LOAD_ERROR:case ErrorDetails.LEVEL_LOAD_TIMEOUT:typeof(o==null?void 0:o.level)=="number"&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,o.level));return;case ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:case ErrorDetails.SUBTITLE_LOAD_ERROR:case ErrorDetails.SUBTITLE_TRACK_LOAD_TIMEOUT:if(o){const c=s.levels[s.loadLevel];if(c&&(o.type===PlaylistContextType.AUDIO_TRACK&&c.hasAudioGroup(o.groupId)||o.type===PlaylistContextType.SUBTITLE_TRACK&&c.hasSubtitleGroup(o.groupId))){t.errorAction=this.getPlaylistRetryOrSwitchAction(t,s.loadLevel),t.errorAction.action=NetworkErrorAction.SendAlternateToPenaltyBox,t.errorAction.flags=ErrorActionFlags.MoveAllAlternatesMatchingHost;return}}return;case ErrorDetails.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{const c=s.levels[s.loadLevel],u=c==null?void 0:c.attrs["HDCP-LEVEL"];u?t.errorAction={action:NetworkErrorAction.SendAlternateToPenaltyBox,flags:ErrorActionFlags.MoveAllAlternatesMatchingHDCP,hdcpLevel:u}:this.keySystemError(t)}return;case ErrorDetails.BUFFER_ADD_CODEC_ERROR:case ErrorDetails.REMUX_ALLOC_ERROR:case ErrorDetails.BUFFER_APPEND_ERROR:t.errorAction=this.getLevelSwitchAction(t,(i=t.level)!=null?i:s.loadLevel);return;case ErrorDetails.INTERNAL_EXCEPTION:case ErrorDetails.BUFFER_APPENDING_ERROR:case ErrorDetails.BUFFER_FULL_ERROR:case ErrorDetails.LEVEL_SWITCH_ERROR:case ErrorDetails.BUFFER_STALLED_ERROR:case ErrorDetails.BUFFER_SEEK_OVER_HOLE:case ErrorDetails.BUFFER_NUDGE_ON_STALL:t.errorAction={action:NetworkErrorAction.DoNothing,flags:ErrorActionFlags.None};return}t.type===ErrorTypes.KEY_SYSTEM_ERROR&&this.keySystemError(t)}keySystemError(e){const t=this.getVariantLevelIndex(e.frag);e.levelRetry=!1,e.errorAction=this.getLevelSwitchAction(e,t)}getPlaylistRetryOrSwitchAction(e,t){const r=this.hls,i=getRetryConfig(r.config.playlistLoadPolicy,e),s=this.playlistError++;if(shouldRetry(i,s,isTimeoutError(e),e.response))return{action:NetworkErrorAction.RetryRequest,flags:ErrorActionFlags.None,retryConfig:i,retryCount:s};const a=this.getLevelSwitchAction(e,t);return i&&(a.retryConfig=i,a.retryCount=s),a}getFragRetryOrSwitchAction(e){const t=this.hls,r=this.getVariantLevelIndex(e.frag),i=t.levels[r],{fragLoadPolicy:s,keyLoadPolicy:o}=t.config,a=getRetryConfig(e.details.startsWith("key")?o:s,e),l=t.levels.reduce((u,d)=>u+d.fragmentError,0);if(i&&(e.details!==ErrorDetails.FRAG_GAP&&i.fragmentError++,shouldRetry(a,l,isTimeoutError(e),e.response)))return{action:NetworkErrorAction.RetryRequest,flags:ErrorActionFlags.None,retryConfig:a,retryCount:l};const c=this.getLevelSwitchAction(e,r);return a&&(c.retryConfig=a,c.retryCount=l),c}getLevelSwitchAction(e,t){const r=this.hls;t==null&&(t=r.loadLevel);const i=this.hls.levels[t];if(i){var s,o;const c=e.details;i.loadError++,c===ErrorDetails.BUFFER_APPEND_ERROR&&i.fragmentError++;let u=-1;const{levels:d,loadLevel:f,minAutoLevel:m,maxAutoLevel:g}=r;r.autoLevelEnabled||(r.loadLevel=-1);const v=(s=e.frag)==null?void 0:s.type,S=(v===PlaylistLevelType.AUDIO&&c===ErrorDetails.FRAG_PARSING_ERROR||e.sourceBufferName==="audio"&&(c===ErrorDetails.BUFFER_ADD_CODEC_ERROR||c===ErrorDetails.BUFFER_APPEND_ERROR))&&d.some(({audioCodec:F})=>i.audioCodec!==F),R=e.sourceBufferName==="video"&&(c===ErrorDetails.BUFFER_ADD_CODEC_ERROR||c===ErrorDetails.BUFFER_APPEND_ERROR)&&d.some(({codecSet:F,audioCodec:N})=>i.codecSet!==F&&i.audioCodec===N),{type:k,groupId:I}=(o=e.context)!=null?o:{};for(let F=d.length;F--;){const N=(F+f)%d.length;if(N!==f&&N>=m&&N<=g&&d[N].loadError===0){var a,l;const U=d[N];if(c===ErrorDetails.FRAG_GAP&&v===PlaylistLevelType.MAIN&&e.frag){const M=d[N].details;if(M){const B=findFragmentByPTS(e.frag,M.fragments,e.frag.start);if(B!=null&&B.gap)continue}}else{if(k===PlaylistContextType.AUDIO_TRACK&&U.hasAudioGroup(I)||k===PlaylistContextType.SUBTITLE_TRACK&&U.hasSubtitleGroup(I))continue;if(v===PlaylistLevelType.AUDIO&&(a=i.audioGroups)!=null&&a.some(M=>U.hasAudioGroup(M))||v===PlaylistLevelType.SUBTITLE&&(l=i.subtitleGroups)!=null&&l.some(M=>U.hasSubtitleGroup(M))||S&&i.audioCodec===U.audioCodec||!S&&i.audioCodec!==U.audioCodec||R&&i.codecSet===U.codecSet)continue}u=N;break}}if(u>-1&&r.loadLevel!==u)return e.levelRetry=!0,this.playlistError=0,{action:NetworkErrorAction.SendAlternateToPenaltyBox,flags:ErrorActionFlags.None,nextAutoLevel:u}}return{action:NetworkErrorAction.SendAlternateToPenaltyBox,flags:ErrorActionFlags.MoveAllAlternatesMatchingHost}}onErrorOut(e,t){var r;switch((r=t.errorAction)==null?void 0:r.action){case NetworkErrorAction.DoNothing:break;case NetworkErrorAction.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(t),!t.errorAction.resolved&&t.details!==ErrorDetails.FRAG_GAP?t.fatal=!0:/MediaSource readyState: ended/.test(t.error.message)&&(this.warn(`MediaSource ended after "${t.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError());break}if(t.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(e){const t=this.hls,r=e.errorAction;if(!r)return;const{flags:i,hdcpLevel:s,nextAutoLevel:o}=r;switch(i){case ErrorActionFlags.None:this.switchLevel(e,o);break;case ErrorActionFlags.MoveAllAlternatesMatchingHDCP:s&&(t.maxHdcpLevel=HdcpLevels[HdcpLevels.indexOf(s)-1],r.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`);break}r.resolved||this.switchLevel(e,o)}switchLevel(e,t){t!==void 0&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel)}}class BasePlaylistController{constructor(e,t){this.hls=void 0,this.timer=-1,this.requestScheduled=-1,this.canLoad=!1,this.log=void 0,this.warn=void 0,this.log=logger.log.bind(logger,`${t}:`),this.warn=logger.warn.bind(logger,`${t}:`),this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){this.timer!==-1&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.requestScheduled=-1,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t,r){const i=t==null?void 0:t.renditionReports;if(i){let s=-1;for(let o=0;o<i.length;o++){const a=i[o];let l;try{l=new self.URL(a.URI,t.url).href}catch(c){logger.warn(`Could not construct new URL for Rendition Report: ${c}`),l=a.URI||""}if(l===e){s=o;break}else l===e.substring(0,l.length)&&(s=o)}if(s!==-1){const o=i[s],a=parseInt(o["LAST-MSN"])||(t==null?void 0:t.lastPartSn);let l=parseInt(o["LAST-PART"])||(t==null?void 0:t.lastPartIndex);if(this.hls.config.lowLatencyMode){const u=Math.min(t.age-t.partTarget,t.targetduration);l>=0&&u>t.partTarget&&(l+=1)}const c=r&&getSkipValue(r);return new HlsUrlParameters(a,l>=0?l:void 0,c)}}}loadPlaylist(e){this.requestScheduled===-1&&(this.requestScheduled=self.performance.now())}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}shouldReloadPlaylist(e){return this.timer===-1&&this.requestScheduled===-1&&this.shouldLoadPlaylist(e)}playlistLoaded(e,t,r){const{details:i,stats:s}=t,o=self.performance.now(),a=s.loading.first?Math.max(0,o-s.loading.first):0;if(i.advancedDateTime=Date.now()-a,i.live||r!=null&&r.live){if(i.reloaded(r),r&&this.log(`live playlist ${e} ${i.advanced?"REFRESHED "+i.lastPartSn+"-"+i.lastPartIndex:i.updated?"UPDATED":"MISSED"}`),r&&i.fragments.length>0&&mergeDetails(r,i),!this.canLoad||!i.live)return;let l,c,u;if(i.canBlockReload&&i.endSN&&i.advanced){const x=this.hls.config.lowLatencyMode,S=i.lastPartSn,C=i.endSN,R=i.lastPartIndex,k=R!==-1,I=S===C,F=x?0:R;k?(c=I?C+1:S,u=I?F:R+1):c=C+1;const N=i.age,U=N+i.ageHeader;let M=Math.min(U-i.partTarget,i.targetduration*1.5);if(M>0){if(r&&M>r.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${r.tuneInGoal} to: ${M} with playlist age: ${i.age}`),M=0;else{const B=Math.floor(M/i.targetduration);if(c+=B,u!==void 0){const H=Math.round(M%i.targetduration/i.partTarget);u+=H}this.log(`CDN Tune-in age: ${i.ageHeader}s last advanced ${N.toFixed(2)}s goal: ${M} skip sn ${B} to part ${u}`)}i.tuneInGoal=M}if(l=this.getDeliveryDirectives(i,t.deliveryDirectives,c,u),x||!I){this.loadPlaylist(l);return}}else(i.canBlockReload||i.canSkipUntil)&&(l=this.getDeliveryDirectives(i,t.deliveryDirectives,c,u));const d=this.hls.mainForwardBufferInfo,f=d?d.end-d.len:0,m=(i.edge-f)*1e3,g=computeReloadInterval(i,m);i.updated&&o>this.requestScheduled+g&&(this.requestScheduled=s.loading.start),c!==void 0&&i.canBlockReload?this.requestScheduled=s.loading.first+g-(i.partTarget*1e3||1e3):this.requestScheduled===-1||this.requestScheduled+g<o?this.requestScheduled=o:this.requestScheduled-o<=0&&(this.requestScheduled+=g);let v=this.requestScheduled-o;v=Math.max(0,v),this.log(`reload live playlist ${e} in ${Math.round(v)} ms`),this.timer=self.setTimeout(()=>this.loadPlaylist(l),v)}else this.clearTimer()}getDeliveryDirectives(e,t,r,i){let s=getSkipValue(e);return t!=null&&t.skip&&e.deltaUpdateFailed&&(r=t.msn,i=t.part,s=HlsSkip.No),new HlsUrlParameters(r,i,s)}checkRetry(e){const t=e.details,r=isTimeoutError(e),i=e.errorAction,{action:s,retryCount:o=0,retryConfig:a}=i||{},l=!!i&&!!a&&(s===NetworkErrorAction.RetryRequest||!i.resolved&&s===NetworkErrorAction.SendAlternateToPenaltyBox);if(l){var c;if(this.requestScheduled=-1,o>=a.maxNumRetry)return!1;if(r&&(c=e.context)!=null&&c.deliveryDirectives)this.warn(`Retrying playlist loading ${o+1}/${a.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{const u=getRetryDelay(a,o);this.timer=self.setTimeout(()=>this.loadPlaylist(),u),this.warn(`Retrying playlist loading ${o+1}/${a.maxNumRetry} after "${t}" in ${u}ms`)}e.levelRetry=!0,i.resolved=!0}return l}}class EWMA{constructor(e,t=0,r=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=r}sample(e,t){const r=Math.pow(this.alpha_,e);this.estimate_=t*(1-r)+r*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class EwmaBandWidthEstimator{constructor(e,t,r,i=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=r,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new EWMA(e),this.fast_=new EWMA(t),this.defaultTTFB_=i,this.ttfb_=new EWMA(e)}update(e,t){const{slow_:r,fast_:i,ttfb_:s}=this;r.halfLife!==e&&(this.slow_=new EWMA(e,r.getEstimate(),r.getTotalWeight())),i.halfLife!==t&&(this.fast_=new EWMA(t,i.getEstimate(),i.getTotalWeight())),s.halfLife!==e&&(this.ttfb_=new EWMA(e,s.getEstimate(),s.getTotalWeight()))}sample(e,t){e=Math.max(e,this.minDelayMs_);const r=8*t,i=e/1e3,s=r/i;this.fast_.sample(i,s),this.slow_.sample(i,s)}sampleTTFB(e){const t=e/1e3,r=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(r,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}destroy(){}}const SUPPORTED_INFO_DEFAULT={supported:!0,configurations:[],decodingInfoResults:[{supported:!0,powerEfficient:!0,smooth:!0}]},SUPPORTED_INFO_CACHE={};function requiresMediaCapabilitiesDecodingInfo(n,e,t,r,i,s){const o=n.audioCodec?n.audioGroups:null,a=s==null?void 0:s.audioCodec,l=s==null?void 0:s.channels,c=l?parseInt(l):a?1/0:2;let u=null;if(o!=null&&o.length)try{o.length===1&&o[0]?u=e.groups[o[0]].channels:u=o.reduce((d,f)=>{if(f){const m=e.groups[f];if(!m)throw new Error(`Audio track group ${f} not found`);Object.keys(m.channels).forEach(g=>{d[g]=(d[g]||0)+m.channels[g]})}return d},{2:0})}catch{return!0}return n.videoCodec!==void 0&&(n.width>1920&&n.height>1088||n.height>1920&&n.width>1088||n.frameRate>Math.max(r,30)||n.videoRange!=="SDR"&&n.videoRange!==t||n.bitrate>Math.max(i,8e6))||!!u&&isFiniteNumber(c)&&Object.keys(u).some(d=>parseInt(d)>c)}function getMediaDecodingInfoPromise(n,e,t){const r=n.videoCodec,i=n.audioCodec;if(!r||!i||!t)return Promise.resolve(SUPPORTED_INFO_DEFAULT);const s={width:n.width,height:n.height,bitrate:Math.ceil(Math.max(n.bitrate*.9,n.averageBitrate)),framerate:n.frameRate||30},o=n.videoRange;o!=="SDR"&&(s.transferFunction=o.toLowerCase());const a=r.split(",").map(l=>({type:"media-source",video:_objectSpread2(_objectSpread2({},s),{},{contentType:mimeTypeForCodec(l,"video")})}));return i&&n.audioGroups&&n.audioGroups.forEach(l=>{var c;l&&((c=e.groups[l])==null||c.tracks.forEach(u=>{if(u.groupId===l){const d=u.channels||"",f=parseFloat(d);isFiniteNumber(f)&&f>2&&a.push.apply(a,i.split(",").map(m=>({type:"media-source",audio:{contentType:mimeTypeForCodec(m,"audio"),channels:""+f}})))}}))}),Promise.all(a.map(l=>{const c=getMediaDecodingInfoKey(l);return SUPPORTED_INFO_CACHE[c]||(SUPPORTED_INFO_CACHE[c]=t.decodingInfo(l))})).then(l=>({supported:!l.some(c=>!c.supported),configurations:a,decodingInfoResults:l})).catch(l=>({supported:!1,configurations:a,decodingInfoResults:[],error:l}))}function getMediaDecodingInfoKey(n){const{audio:e,video:t}=n,r=t||e;if(r){const i=r.contentType.split('"')[1];if(t)return`r${t.height}x${t.width}f${Math.ceil(t.framerate)}${t.transferFunction||"sd"}_${i}_${Math.ceil(t.bitrate/1e5)}`;if(e)return`c${e.channels}${e.spatialRendering?"s":"n"}_${i}`}return""}function isHdrSupported(){if(typeof matchMedia=="function"){const n=matchMedia("(dynamic-range: high)"),e=matchMedia("bad query");if(n.media!==e.media)return n.matches===!0}return!1}function getVideoSelectionOptions(n,e){let t=!1,r=[];return n&&(t=n!=="SDR",r=[n]),e&&(r=e.allowedVideoRanges||VideoRangeValues.slice(0),t=e.preferHDR!==void 0?e.preferHDR:isHdrSupported(),t?r=r.filter(i=>i!=="SDR"):r=["SDR"]),{preferHDR:t,allowedVideoRanges:r}}function getStartCodecTier(n,e,t,r,i){const s=Object.keys(n),o=r==null?void 0:r.channels,a=r==null?void 0:r.audioCodec,l=o&&parseInt(o)===2;let c=!0,u=!1,d=1/0,f=1/0,m=1/0,g=0,v=[];const{preferHDR:x,allowedVideoRanges:S}=getVideoSelectionOptions(e,i);for(let I=s.length;I--;){const F=n[s[I]];c=F.channels[2]>0,d=Math.min(d,F.minHeight),f=Math.min(f,F.minFramerate),m=Math.min(m,F.minBitrate);const N=S.filter(U=>F.videoRanges[U]>0);N.length>0&&(u=!0,v=N)}d=isFiniteNumber(d)?d:0,f=isFiniteNumber(f)?f:0;const C=Math.max(1080,d),R=Math.max(30,f);return m=isFiniteNumber(m)?m:t,t=Math.max(m,t),u||(e=void 0,v=[]),{codecSet:s.reduce((I,F)=>{const N=n[F];if(F===I)return I;if(N.minBitrate>t)return logStartCodecCandidateIgnored(F,`min bitrate of ${N.minBitrate} > current estimate of ${t}`),I;if(!N.hasDefaultAudio)return logStartCodecCandidateIgnored(F,"no renditions with default or auto-select sound found"),I;if(a&&F.indexOf(a.substring(0,4))%5!==0)return logStartCodecCandidateIgnored(F,`audio codec preference "${a}" not found`),I;if(o&&!l){if(!N.channels[o])return logStartCodecCandidateIgnored(F,`no renditions with ${o} channel sound found (channels options: ${Object.keys(N.channels)})`),I}else if((!a||l)&&c&&N.channels[2]===0)return logStartCodecCandidateIgnored(F,"no renditions with stereo sound found"),I;return N.minHeight>C?(logStartCodecCandidateIgnored(F,`min resolution of ${N.minHeight} > maximum of ${C}`),I):N.minFramerate>R?(logStartCodecCandidateIgnored(F,`min framerate of ${N.minFramerate} > maximum of ${R}`),I):v.some(U=>N.videoRanges[U]>0)?N.maxScore<g?(logStartCodecCandidateIgnored(F,`max score of ${N.maxScore} < selected max of ${g}`),I):I&&(codecsSetSelectionPreferenceValue(F)>=codecsSetSelectionPreferenceValue(I)||N.fragmentError>n[I].fragmentError)?I:(g=N.maxScore,F):(logStartCodecCandidateIgnored(F,`no variants with VIDEO-RANGE of ${JSON.stringify(v)} found`),I)},void 0),videoRanges:v,preferHDR:x,minFramerate:f,minBitrate:m}}function logStartCodecCandidateIgnored(n,e){logger.log(`[abr] start candidates with "${n}" ignored because ${e}`)}function getAudioTracksByGroup(n){return n.reduce((e,t)=>{let r=e.groups[t.groupId];r||(r=e.groups[t.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),r.tracks.push(t);const i=t.channels||"2";return r.channels[i]=(r.channels[i]||0)+1,r.hasDefault=r.hasDefault||t.default,r.hasAutoSelect=r.hasAutoSelect||t.autoselect,r.hasDefault&&(e.hasDefaultAudio=!0),r.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function getCodecTiers(n,e,t,r){return n.slice(t,r+1).reduce((i,s)=>{if(!s.codecSet)return i;const o=s.audioGroups;let a=i[s.codecSet];a||(i[s.codecSet]=a={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!o,fragmentError:0}),a.minBitrate=Math.min(a.minBitrate,s.bitrate);const l=Math.min(s.height,s.width);return a.minHeight=Math.min(a.minHeight,l),a.minFramerate=Math.min(a.minFramerate,s.frameRate),a.maxScore=Math.max(a.maxScore,s.score),a.fragmentError+=s.fragmentError,a.videoRanges[s.videoRange]=(a.videoRanges[s.videoRange]||0)+1,o&&o.forEach(c=>{if(!c)return;const u=e.groups[c];u&&(a.hasDefaultAudio=a.hasDefaultAudio||e.hasDefaultAudio?u.hasDefault:u.hasAutoSelect||!e.hasDefaultAudio&&!e.hasAutoSelectAudio,Object.keys(u.channels).forEach(d=>{a.channels[d]=(a.channels[d]||0)+u.channels[d]}))}),i},{})}function findMatchingOption(n,e,t){if("attrs"in n){const r=e.indexOf(n);if(r!==-1)return r}for(let r=0;r<e.length;r++){const i=e[r];if(matchesOption(n,i,t))return r}return-1}function matchesOption(n,e,t){const{groupId:r,name:i,lang:s,assocLang:o,characteristics:a,default:l}=n,c=n.forced;return(r===void 0||e.groupId===r)&&(i===void 0||e.name===i)&&(s===void 0||e.lang===s)&&(s===void 0||e.assocLang===o)&&(l===void 0||e.default===l)&&(c===void 0||e.forced===c)&&(a===void 0||characteristicsMatch(a,e.characteristics))&&(t===void 0||t(n,e))}function characteristicsMatch(n,e=""){const t=n.split(","),r=e.split(",");return t.length===r.length&&!t.some(i=>r.indexOf(i)===-1)}function audioMatchPredicate(n,e){const{audioCodec:t,channels:r}=n;return(t===void 0||(e.audioCodec||"").substring(0,4)===t.substring(0,4))&&(r===void 0||r===(e.channels||"2"))}function findClosestLevelWithAudioGroup(n,e,t,r,i){const s=e[r],a=e.reduce((f,m,g)=>{const v=m.uri;return(f[v]||(f[v]=[])).push(g),f},{})[s.uri];a.length>1&&(r=Math.max.apply(Math,a));const l=s.videoRange,c=s.frameRate,u=s.codecSet.substring(0,4),d=searchDownAndUpList(e,r,f=>{if(f.videoRange!==l||f.frameRate!==c||f.codecSet.substring(0,4)!==u)return!1;const m=f.audioGroups,g=t.filter(v=>!m||m.indexOf(v.groupId)!==-1);return findMatchingOption(n,g,i)>-1});return d>-1?d:searchDownAndUpList(e,r,f=>{const m=f.audioGroups,g=t.filter(v=>!m||m.indexOf(v.groupId)!==-1);return findMatchingOption(n,g,i)>-1})}function searchDownAndUpList(n,e,t){for(let r=e;r>-1;r--)if(t(n[r]))return r;for(let r=e+1;r<n.length;r++)if(t(n[r]))return r;return-1}class AbrController{constructor(e){this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this._abandonRulesCheck=()=>{const{fragCurrent:t,partCurrent:r,hls:i}=this,{autoLevelEnabled:s,media:o}=i;if(!t||!o)return;const a=performance.now(),l=r?r.stats:t.stats,c=r?r.duration:t.duration,u=a-l.loading.start,d=i.minAutoLevel;if(l.aborted||l.loaded&&l.loaded===l.total||t.level<=d){this.clearTimer(),this._nextAutoLevel=-1;return}if(!s||o.paused||!o.playbackRate||!o.readyState)return;const f=i.mainForwardBufferInfo;if(f===null)return;const m=this.bwEstimator.getEstimateTTFB(),g=Math.abs(o.playbackRate);if(u<=Math.max(m,1e3*(c/(g*2))))return;const v=f.len/g,x=l.loading.first?l.loading.first-l.loading.start:-1,S=l.loaded&&x>-1,C=this.getBwEstimate(),R=i.levels,k=R[t.level],I=l.total||Math.max(l.loaded,Math.round(c*k.averageBitrate/8));let F=S?u-x:u;F<1&&S&&(F=Math.min(u,l.loaded*8/C));const N=S?l.loaded*1e3/F:0,U=N?(I-l.loaded)/N:I*8/C+m/1e3;if(U<=v)return;const M=N?N*8:C;let B=Number.POSITIVE_INFINITY,H;for(H=t.level-1;H>d;H--){const Y=R[H].maxBitrate;if(B=this.getTimeToLoadFrag(m/1e3,M,c*Y,!R[H].details),B<v)break}if(B>=U||B>c*10)return;i.nextLoadLevel=i.nextAutoLevel=H,S?this.bwEstimator.sample(u-Math.min(m,x),l.loaded):this.bwEstimator.sampleTTFB(u);const K=R[H].maxBitrate;this.getBwEstimate()*this.hls.config.abrBandWidthUpFactor>K&&this.resetEstimator(K),this.clearTimer(),logger.warn(`[abr] Fragment ${t.sn}${r?" part "+r.index:""} of level ${t.level} is loading too slowly;
      Time to underbuffer: ${v.toFixed(3)} s
      Estimated load time for current fragment: ${U.toFixed(3)} s
      Estimated load time for down switch fragment: ${B.toFixed(3)} s
      TTFB estimate: ${x|0} ms
      Current BW estimate: ${isFiniteNumber(C)?C|0:"Unknown"} bps
      New BW estimate: ${this.getBwEstimate()|0} bps
      Switching to level ${H} @ ${K|0} bps`),i.trigger(Events.FRAG_LOAD_EMERGENCY_ABORTED,{frag:t,part:r,stats:l})},this.hls=e,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(e){e&&(logger.log(`setting initial bwe to ${e}`),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const e=this.hls.config;return new EwmaBandWidthEstimator(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)}registerListeners(){const{hls:e}=this;e.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Events.FRAG_LOADING,this.onFragLoading,this),e.on(Events.FRAG_LOADED,this.onFragLoaded,this),e.on(Events.FRAG_BUFFERED,this.onFragBuffered,this),e.on(Events.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(Events.LEVEL_LOADED,this.onLevelLoaded,this),e.on(Events.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(Events.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on(Events.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e&&(e.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Events.FRAG_LOADING,this.onFragLoading,this),e.off(Events.FRAG_LOADED,this.onFragLoaded,this),e.off(Events.FRAG_BUFFERED,this.onFragBuffered,this),e.off(Events.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(Events.LEVEL_LOADED,this.onLevelLoaded,this),e.off(Events.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(Events.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off(Events.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(e,t){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(e,t){const r=t.frag;if(!this.ignoreFragment(r)){if(!r.bitrateTest){var i;this.fragCurrent=r,this.partCurrent=(i=t.part)!=null?i:null}this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(e,t){this.clearTimer()}onError(e,t){if(!t.fatal)switch(t.details){case ErrorDetails.BUFFER_ADD_CODEC_ERROR:case ErrorDetails.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case ErrorDetails.FRAG_LOAD_TIMEOUT:{const r=t.frag,{fragCurrent:i,partCurrent:s}=this;if(r&&i&&r.sn===i.sn&&r.level===i.level){const o=performance.now(),a=s?s.stats:r.stats,l=o-a.loading.start,c=a.loading.first?a.loading.first-a.loading.start:-1;if(a.loaded&&c>-1){const d=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(l-Math.min(d,c),a.loaded)}else this.bwEstimator.sampleTTFB(l)}break}}}getTimeToLoadFrag(e,t,r,i){const s=e+r/t,o=i?this.lastLevelLoadSec:0;return s+o}onLevelLoaded(e,t){const r=this.hls.config,{loading:i}=t.stats,s=i.end-i.start;isFiniteNumber(s)&&(this.lastLevelLoadSec=s/1e3),t.details.live?this.bwEstimator.update(r.abrEwmaSlowLive,r.abrEwmaFastLive):this.bwEstimator.update(r.abrEwmaSlowVoD,r.abrEwmaFastVoD)}onFragLoaded(e,{frag:t,part:r}){const i=r?r.stats:t.stats;if(t.type===PlaylistLevelType.MAIN&&this.bwEstimator.sampleTTFB(i.loading.first-i.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),t.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const s=r?r.duration:t.duration,o=this.hls.levels[t.level],a=(o.loaded?o.loaded.bytes:0)+i.loaded,l=(o.loaded?o.loaded.duration:0)+s;o.loaded={bytes:a,duration:l},o.realBitrate=Math.round(8*a/l)}if(t.bitrateTest){const s={stats:i,frag:t,part:r,id:t.type};this.onFragBuffered(Events.FRAG_BUFFERED,s),t.bitrateTest=!1}else this.lastLoadedFragLevel=t.level}}onFragBuffered(e,t){const{frag:r,part:i}=t,s=i!=null&&i.stats.loaded?i.stats:r.stats;if(s.aborted||this.ignoreFragment(r))return;const o=s.parsing.end-s.loading.start-Math.min(s.loading.first-s.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(o,s.loaded),s.bwEstimate=this.getBwEstimate(),r.bitrateTest?this.bitrateTestDelay=o/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==PlaylistLevelType.MAIN||e.sn==="initSegment"}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:e,minAutoLevel:t}=this.hls,r=this.getBwEstimate(),i=this.hls.config.maxStarvationDelay,s=this.findBestLevel(r,t,e,0,i,1,1);if(s>-1)return s;const o=this.hls.firstLevel,a=Math.min(Math.max(o,t),e);return logger.warn(`[abr] Could not find best starting auto level. Defaulting to first in playlist ${o} clamped to ${a}`),a}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const e=this.forcedAutoLevel,r=this.bwEstimator.canEstimate(),i=this.lastLoadedFragLevel>-1;if(e!==-1&&(!r||!i||this.nextAutoLevelKey===this.getAutoLevelKey()))return e;const s=r&&i?this.getNextABRAutoLevel():this.firstAutoLevel;if(e!==-1){const o=this.hls.levels;if(o.length>Math.max(e,s)&&o[e].loadError<=o[s].loadError)return e}return this._nextAutoLevel=s,this.nextAutoLevelKey=this.getAutoLevelKey(),s}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:t,hls:r}=this,{maxAutoLevel:i,config:s,minAutoLevel:o}=r,a=t?t.duration:e?e.duration:0,l=this.getBwEstimate(),c=this.getStarvationDelay();let u=s.abrBandWidthFactor,d=s.abrBandWidthUpFactor;if(c){const x=this.findBestLevel(l,o,i,c,0,u,d);if(x>=0)return x}let f=a?Math.min(a,s.maxStarvationDelay):s.maxStarvationDelay;if(!c){const x=this.bitrateTestDelay;x&&(f=(a?Math.min(a,s.maxLoadingDelay):s.maxLoadingDelay)-x,logger.info(`[abr] bitrate test took ${Math.round(1e3*x)}ms, set first fragment max fetchDuration to ${Math.round(1e3*f)} ms`),u=d=1)}const m=this.findBestLevel(l,o,i,c,f,u,d);if(logger.info(`[abr] ${c?"rebuffering expected":"buffer is empty"}, optimal quality level ${m}`),m>-1)return m;const g=r.levels[o],v=r.levels[r.loadLevel];return(g==null?void 0:g.bitrate)<(v==null?void 0:v.bitrate)?o:r.loadLevel}getStarvationDelay(){const e=this.hls,t=e.media;if(!t)return 1/0;const r=t&&t.playbackRate!==0?Math.abs(t.playbackRate):1,i=e.mainForwardBufferInfo;return(i?i.len:0)/r}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(e,t,r,i,s,o,a){var l;const c=i+s,u=this.lastLoadedFragLevel,d=u===-1?this.hls.firstLevel:u,{fragCurrent:f,partCurrent:m}=this,{levels:g,allAudioTracks:v,loadLevel:x,config:S}=this.hls;if(g.length===1)return 0;const C=g[d],R=!!(C!=null&&(l=C.details)!=null&&l.live),k=x===-1||u===-1;let I,F="SDR",N=(C==null?void 0:C.frameRate)||0;const{audioPreference:U,videoPreference:M}=S,B=this.audioTracksByGroup||(this.audioTracksByGroup=getAudioTracksByGroup(v));if(k){if(this.firstSelection!==-1)return this.firstSelection;const ue=this.codecTiers||(this.codecTiers=getCodecTiers(g,B,t,r)),Z=getStartCodecTier(ue,F,e,U,M),{codecSet:Ae,videoRanges:ye,minFramerate:$,minBitrate:W,preferHDR:J}=Z;I=Ae,F=J?ye[ye.length-1]:ye[0],N=$,e=Math.max(e,W),logger.log(`[abr] picked start tier ${JSON.stringify(Z)}`)}else I=C==null?void 0:C.codecSet,F=C==null?void 0:C.videoRange;const H=m?m.duration:f?f.duration:0,K=this.bwEstimator.getEstimateTTFB()/1e3,Y=[];for(let ue=r;ue>=t;ue--){var oe;const Z=g[ue],Ae=ue>d;if(!Z)continue;if(S.useMediaCapabilities&&!Z.supportedResult&&!Z.supportedPromise){const Re=navigator.mediaCapabilities;typeof(Re==null?void 0:Re.decodingInfo)=="function"&&requiresMediaCapabilitiesDecodingInfo(Z,B,F,N,e,U)?(Z.supportedPromise=getMediaDecodingInfoPromise(Z,B,Re),Z.supportedPromise.then(Le=>{if(!this.hls)return;Z.supportedResult=Le;const Ce=this.hls.levels,j=Ce.indexOf(Z);Le.error?logger.warn(`[abr] MediaCapabilities decodingInfo error: "${Le.error}" for level ${j} ${JSON.stringify(Le)}`):Le.supported||(logger.warn(`[abr] Unsupported MediaCapabilities decodingInfo result for level ${j} ${JSON.stringify(Le)}`),j>-1&&Ce.length>1&&(logger.log(`[abr] Removing unsupported level ${j}`),this.hls.removeLevel(j)))})):Z.supportedResult=SUPPORTED_INFO_DEFAULT}if(I&&Z.codecSet!==I||F&&Z.videoRange!==F||Ae&&N>Z.frameRate||!Ae&&N>0&&N<Z.frameRate||Z.supportedResult&&!((oe=Z.supportedResult.decodingInfoResults)!=null&&oe[0].smooth)){Y.push(ue);continue}const ye=Z.details,$=(m?ye==null?void 0:ye.partTarget:ye==null?void 0:ye.averagetargetduration)||H;let W;Ae?W=a*e:W=o*e;const J=H&&i>=H*2&&s===0?g[ue].averageBitrate:g[ue].maxBitrate,ne=this.getTimeToLoadFrag(K,W,J*$,ye===void 0);if(W>=J&&(ue===u||Z.loadError===0&&Z.fragmentError===0)&&(ne<=K||!isFiniteNumber(ne)||R&&!this.bitrateTestDelay||ne<c)){const Re=this.forcedAutoLevel;return ue!==x&&(Re===-1||Re!==x)&&(Y.length&&logger.trace(`[abr] Skipped level(s) ${Y.join(",")} of ${r} max with CODECS and VIDEO-RANGE:"${g[Y[0]].codecs}" ${g[Y[0]].videoRange}; not compatible with "${C.codecs}" ${F}`),logger.info(`[abr] switch candidate:${d}->${ue} adjustedbw(${Math.round(W)})-bitrate=${Math.round(W-J)} ttfb:${K.toFixed(1)} avgDuration:${$.toFixed(1)} maxFetchDuration:${c.toFixed(1)} fetchDuration:${ne.toFixed(1)} firstSelection:${k} codecSet:${I} videoRange:${F} hls.loadLevel:${x}`)),k&&(this.firstSelection=ue),ue}}return-1}set nextAutoLevel(e){const{maxAutoLevel:t,minAutoLevel:r}=this.hls,i=Math.min(Math.max(e,r),t);this._nextAutoLevel!==i&&(this.nextAutoLevelKey="",this._nextAutoLevel=i)}}class TaskLoop{constructor(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}var FragmentState={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class FragmentTracker{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(Events.BUFFER_APPENDED,this.onBufferAppended,this),e.on(Events.FRAG_BUFFERED,this.onFragBuffered,this),e.on(Events.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){const{hls:e}=this;e.off(Events.BUFFER_APPENDED,this.onBufferAppended,this),e.off(Events.FRAG_BUFFERED,this.onFragBuffered,this),e.off(Events.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){const r=this.activePartLists[t];if(r)for(let i=r.length;i--;){const s=r[i];if(!s)break;const o=s.end;if(s.start<=e&&o!==null&&e<=o)return s}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){const{fragments:r}=this,i=Object.keys(r);for(let s=i.length;s--;){const o=r[i[s]];if((o==null?void 0:o.body.type)===t&&o.buffered){const a=o.body;if(a.start<=e&&e<=a.end)return a}}return null}detectEvictedFragments(e,t,r,i){this.timeRanges&&(this.timeRanges[e]=t);const s=(i==null?void 0:i.fragment.sn)||-1;Object.keys(this.fragments).forEach(o=>{const a=this.fragments[o];if(!a||s>=a.body.sn)return;if(!a.buffered&&!a.loaded){a.body.type===r&&this.removeFragment(a.body);return}const l=a.range[e];l&&l.time.some(c=>{const u=!this.isTimeBuffered(c.startPTS,c.endPTS,t);return u&&this.removeFragment(a.body),u})})}detectPartialFragments(e){const t=this.timeRanges,{frag:r,part:i}=e;if(!t||r.sn==="initSegment")return;const s=getFragmentKey(r),o=this.fragments[s];if(!o||o.buffered&&r.gap)return;const a=!r.relurl;Object.keys(t).forEach(l=>{const c=r.elementaryStreams[l];if(!c)return;const u=t[l],d=a||c.partial===!0;o.range[l]=this.getBufferedTimes(r,i,d,u)}),o.loaded=null,Object.keys(o.range).length?(o.buffered=!0,(o.body.endList=r.endList||o.body.endList)&&(this.endListFragments[o.body.type]=o),isPartial(o)||this.removeParts(r.sn-1,r.type)):this.removeFragment(o.body)}removeParts(e,t){const r=this.activePartLists[t];r&&(this.activePartLists[t]=r.filter(i=>i.fragment.sn>=e))}fragBuffered(e,t){const r=getFragmentKey(e);let i=this.fragments[r];!i&&t&&(i=this.fragments[r]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),i&&(i.loaded=null,i.buffered=!0)}getBufferedTimes(e,t,r,i){const s={time:[],partial:r},o=e.start,a=e.end,l=e.minEndPTS||a,c=e.maxStartPTS||o;for(let u=0;u<i.length;u++){const d=i.start(u)-this.bufferPadding,f=i.end(u)+this.bufferPadding;if(c>=d&&l<=f){s.time.push({startPTS:Math.max(o,i.start(u)),endPTS:Math.min(a,i.end(u))});break}else if(o<f&&a>d){const m=Math.max(o,i.start(u)),g=Math.min(a,i.end(u));g>m&&(s.partial=!0,s.time.push({startPTS:m,endPTS:g}))}else if(a<=d)break}return s}getPartialFragment(e){let t=null,r,i,s,o=0;const{bufferPadding:a,fragments:l}=this;return Object.keys(l).forEach(c=>{const u=l[c];u&&isPartial(u)&&(i=u.body.start-a,s=u.body.end+a,e>=i&&e<=s&&(r=Math.min(e-i,s-e),o<=r&&(t=u.body,o=r)))}),t}isEndListAppended(e){const t=this.endListFragments[e];return t!==void 0&&(t.buffered||isPartial(t))}getState(e){const t=getFragmentKey(e),r=this.fragments[t];return r?r.buffered?isPartial(r)?FragmentState.PARTIAL:FragmentState.OK:FragmentState.APPENDING:FragmentState.NOT_LOADED}isTimeBuffered(e,t,r){let i,s;for(let o=0;o<r.length;o++){if(i=r.start(o)-this.bufferPadding,s=r.end(o)+this.bufferPadding,e>=i&&t<=s)return!0;if(t<=i)return!1}return!1}onFragLoaded(e,t){const{frag:r,part:i}=t;if(r.sn==="initSegment"||r.bitrateTest)return;const s=i?null:t,o=getFragmentKey(r);this.fragments[o]={body:r,appendedPTS:null,loaded:s,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){const{frag:r,part:i,timeRanges:s}=t;if(r.sn==="initSegment")return;const o=r.type;if(i){let a=this.activePartLists[o];a||(this.activePartLists[o]=a=[]),a.push(i)}this.timeRanges=s,Object.keys(s).forEach(a=>{const l=s[a];this.detectEvictedFragments(a,l,o,i)})}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){const t=getFragmentKey(e);return!!this.fragments[t]}hasParts(e){var t;return!!((t=this.activePartLists[e])!=null&&t.length)}removeFragmentsInRange(e,t,r,i,s){i&&!this.hasGaps||Object.keys(this.fragments).forEach(o=>{const a=this.fragments[o];if(!a)return;const l=a.body;l.type!==r||i&&!l.gap||l.start<t&&l.end>e&&(a.buffered||s)&&this.removeFragment(l)})}removeFragment(e){const t=getFragmentKey(e);e.stats.loaded=0,e.clearElementaryStreamInfo();const r=this.activePartLists[e.type];if(r){const i=e.sn;this.activePartLists[e.type]=r.filter(s=>s.fragment.sn!==i)}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1}}function isPartial(n){var e,t,r;return n.buffered&&(n.body.gap||((e=n.range.video)==null?void 0:e.partial)||((t=n.range.audio)==null?void 0:t.partial)||((r=n.range.audiovideo)==null?void 0:r.partial))}function getFragmentKey(n){return`${n.type}_${n.level}_${n.sn}`}const noopBuffered={length:0,start:()=>0,end:()=>0};class BufferHelper{static isBuffered(e,t){try{if(e){const r=BufferHelper.getBuffered(e);for(let i=0;i<r.length;i++)if(t>=r.start(i)&&t<=r.end(i))return!0}}catch{}return!1}static bufferInfo(e,t,r){try{if(e){const i=BufferHelper.getBuffered(e),s=[];let o;for(o=0;o<i.length;o++)s.push({start:i.start(o),end:i.end(o)});return this.bufferedInfo(s,t,r)}}catch{}return{len:0,start:t,end:t,nextStart:void 0}}static bufferedInfo(e,t,r){t=Math.max(0,t),e.sort(function(c,u){const d=c.start-u.start;return d||u.end-c.end});let i=[];if(r)for(let c=0;c<e.length;c++){const u=i.length;if(u){const d=i[u-1].end;e[c].start-d<r?e[c].end>d&&(i[u-1].end=e[c].end):i.push(e[c])}else i.push(e[c])}else i=e;let s=0,o,a=t,l=t;for(let c=0;c<i.length;c++){const u=i[c].start,d=i[c].end;if(t+r>=u&&t<d)a=u,l=d,s=l-t;else if(t+r<u){o=u;break}}return{len:s,start:a||0,end:l||0,nextStart:o}}static getBuffered(e){try{return e.buffered}catch(t){return logger.log("failed to get media.buffered",t),noopBuffered}}}class ChunkMetadata{constructor(e,t,r,i=0,s=-1,o=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=getNewPerformanceTiming(),this.buffering={audio:getNewPerformanceTiming(),video:getNewPerformanceTiming(),audiovideo:getNewPerformanceTiming()},this.level=e,this.sn=t,this.id=r,this.size=i,this.part=s,this.partial=o}}function getNewPerformanceTiming(){return{start:0,executeStart:0,executeEnd:0,end:0}}function findFirstFragWithCC(n,e){for(let r=0,i=n.length;r<i;r++){var t;if(((t=n[r])==null?void 0:t.cc)===e)return n[r]}return null}function shouldAlignOnDiscontinuities(n,e,t){return!!(e&&(t.endCC>t.startCC||n&&n.cc<t.startCC))}function findDiscontinuousReferenceFrag(n,e){const t=n.fragments,r=e.fragments;if(!r.length||!t.length){logger.log("No fragments to align");return}const i=findFirstFragWithCC(t,r[0].cc);if(!i||i&&!i.startPTS){logger.log("No frag in previous level to align on");return}return i}function adjustFragmentStart(n,e){if(n){const t=n.start+e;n.start=n.startPTS=t,n.endPTS=t+n.duration}}function adjustSlidingStart(n,e){const t=e.fragments;for(let r=0,i=t.length;r<i;r++)adjustFragmentStart(t[r],n);e.fragmentHint&&adjustFragmentStart(e.fragmentHint,n),e.alignedSliding=!0}function alignStream(n,e,t){e&&(alignDiscontinuities(n,t,e),!t.alignedSliding&&e&&alignMediaPlaylistByPDT(t,e),!t.alignedSliding&&e&&!t.skippedSegments&&adjustSliding(e,t))}function alignDiscontinuities(n,e,t){if(shouldAlignOnDiscontinuities(n,t,e)){const r=findDiscontinuousReferenceFrag(t,e);r&&isFiniteNumber(r.start)&&(logger.log(`Adjusting PTS using last level due to CC increase within current level ${e.url}`),adjustSlidingStart(r.start,e))}}function alignMediaPlaylistByPDT(n,e){if(!n.hasProgramDateTime||!e.hasProgramDateTime)return;const t=n.fragments,r=e.fragments;if(!t.length||!r.length)return;let i,s;const o=Math.min(e.endCC,n.endCC);e.startCC<o&&n.startCC<o&&(i=findFirstFragWithCC(r,o),s=findFirstFragWithCC(t,o)),(!i||!s)&&(i=r[Math.floor(r.length/2)],s=findFirstFragWithCC(t,i.cc)||t[Math.floor(t.length/2)]);const a=i.programDateTime,l=s.programDateTime;if(!a||!l)return;const c=(l-a)/1e3-(s.start-i.start);adjustSlidingStart(c,n)}const MIN_CHUNK_SIZE=Math.pow(2,17);class FragmentLoader{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){const r=e.url;if(!r)return Promise.reject(new LoadError({type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error(`Fragment does not have a ${r?"part list":"url"}`),networkDetails:null}));this.abort();const i=this.config,s=i.fLoader,o=i.loader;return new Promise((a,l)=>{if(this.loader&&this.loader.destroy(),e.gap)if(e.tagList.some(m=>m[0]==="GAP")){l(createGapLoadError(e));return}else e.gap=!1;const c=this.loader=e.loader=s?new s(i):new o(i),u=createLoaderContext(e),d=getLoaderConfigWithoutReties(i.fragLoadPolicy.default),f={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:e.sn==="initSegment"?1/0:MIN_CHUNK_SIZE};e.stats=c.stats,c.load(u,f,{onSuccess:(m,g,v,x)=>{this.resetLoader(e,c);let S=m.data;v.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(S.slice(0,16)),S=S.slice(16)),a({frag:e,part:null,payload:S,networkDetails:x})},onError:(m,g,v,x)=>{this.resetLoader(e,c),l(new LoadError({type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:_objectSpread2({url:r,data:void 0},m),error:new Error(`HTTP Error ${m.code} ${m.text}`),networkDetails:v,stats:x}))},onAbort:(m,g,v)=>{this.resetLoader(e,c),l(new LoadError({type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:v,stats:m}))},onTimeout:(m,g,v)=>{this.resetLoader(e,c),l(new LoadError({type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${f.timeout}ms`),networkDetails:v,stats:m}))},onProgress:(m,g,v,x)=>{t&&t({frag:e,part:null,payload:v,networkDetails:x})}})})}loadPart(e,t,r){this.abort();const i=this.config,s=i.fLoader,o=i.loader;return new Promise((a,l)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap){l(createGapLoadError(e,t));return}const c=this.loader=e.loader=s?new s(i):new o(i),u=createLoaderContext(e,t),d=getLoaderConfigWithoutReties(i.fragLoadPolicy.default),f={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:MIN_CHUNK_SIZE};t.stats=c.stats,c.load(u,f,{onSuccess:(m,g,v,x)=>{this.resetLoader(e,c),this.updateStatsFromPart(e,t);const S={frag:e,part:t,payload:m.data,networkDetails:x};r(S),a(S)},onError:(m,g,v,x)=>{this.resetLoader(e,c),l(new LoadError({type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:_objectSpread2({url:u.url,data:void 0},m),error:new Error(`HTTP Error ${m.code} ${m.text}`),networkDetails:v,stats:x}))},onAbort:(m,g,v)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,c),l(new LoadError({type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:v,stats:m}))},onTimeout:(m,g,v)=>{this.resetLoader(e,c),l(new LoadError({type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${f.timeout}ms`),networkDetails:v,stats:m}))}})})}updateStatsFromPart(e,t){const r=e.stats,i=t.stats,s=i.total;if(r.loaded+=i.loaded,s){const l=Math.round(e.duration/t.duration),c=Math.min(Math.round(r.loaded/s),l),d=(l-c)*Math.round(r.loaded/c);r.total=r.loaded+d}else r.total=Math.max(r.loaded,r.total);const o=r.loading,a=i.loading;o.start?o.first+=a.first-a.start:(o.start=a.start,o.first=a.first),o.end=a.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function createLoaderContext(n,e=null){const t=e||n,r={frag:n,part:e,responseType:"arraybuffer",url:t.url,headers:{},rangeStart:0,rangeEnd:0},i=t.byteRangeStartOffset,s=t.byteRangeEndOffset;if(isFiniteNumber(i)&&isFiniteNumber(s)){var o;let a=i,l=s;if(n.sn==="initSegment"&&((o=n.decryptdata)==null?void 0:o.method)==="AES-128"){const c=s-i;c%16&&(l=s+(16-c%16)),i!==0&&(r.resetIV=!0,a=i-16)}r.rangeStart=a,r.rangeEnd=l}return r}function createGapLoadError(n,e){const t=new Error(`GAP ${n.gap?"tag":"attribute"} found`),r={type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_GAP,fatal:!1,frag:n,error:t,networkDetails:null};return e&&(r.part=e),(e||n).stats.aborted=!0,new LoadError(r)}class LoadError extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class AESCrypto{constructor(e,t){this.subtle=void 0,this.aesIV=void 0,this.subtle=e,this.aesIV=t}decrypt(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)}}class FastAESKey{constructor(e,t){this.subtle=void 0,this.key=void 0,this.subtle=e,this.key=t}expandKey(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}}function removePadding(n){const e=n.byteLength,t=e&&new DataView(n.buffer).getUint8(e-1);return t?sliceUint8(n,0,e-t):n}class AESDecryptor{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const t=new DataView(e),r=new Uint32Array(4);for(let i=0;i<4;i++)r[i]=t.getUint32(i*4);return r}initTable(){const e=this.sBox,t=this.invSBox,r=this.subMix,i=r[0],s=r[1],o=r[2],a=r[3],l=this.invSubMix,c=l[0],u=l[1],d=l[2],f=l[3],m=new Uint32Array(256);let g=0,v=0,x=0;for(x=0;x<256;x++)x<128?m[x]=x<<1:m[x]=x<<1^283;for(x=0;x<256;x++){let S=v^v<<1^v<<2^v<<3^v<<4;S=S>>>8^S&255^99,e[g]=S,t[S]=g;const C=m[g],R=m[C],k=m[R];let I=m[S]*257^S*16843008;i[g]=I<<24|I>>>8,s[g]=I<<16|I>>>16,o[g]=I<<8|I>>>24,a[g]=I,I=k*16843009^R*65537^C*257^g*16843008,c[S]=I<<24|I>>>8,u[S]=I<<16|I>>>16,d[S]=I<<8|I>>>24,f[S]=I,g?(g=C^m[m[m[k^C]]],v^=m[m[v]]):g=v=1}}expandKey(e){const t=this.uint8ArrayToUint32Array_(e);let r=!0,i=0;for(;i<t.length&&r;)r=t[i]===this.key[i],i++;if(r)return;this.key=t;const s=this.keySize=t.length;if(s!==4&&s!==6&&s!==8)throw new Error("Invalid aes key size="+s);const o=this.ksRows=(s+6+1)*4;let a,l;const c=this.keySchedule=new Uint32Array(o),u=this.invKeySchedule=new Uint32Array(o),d=this.sBox,f=this.rcon,m=this.invSubMix,g=m[0],v=m[1],x=m[2],S=m[3];let C,R;for(a=0;a<o;a++){if(a<s){C=c[a]=t[a];continue}R=C,a%s===0?(R=R<<8|R>>>24,R=d[R>>>24]<<24|d[R>>>16&255]<<16|d[R>>>8&255]<<8|d[R&255],R^=f[a/s|0]<<24):s>6&&a%s===4&&(R=d[R>>>24]<<24|d[R>>>16&255]<<16|d[R>>>8&255]<<8|d[R&255]),c[a]=C=(c[a-s]^R)>>>0}for(l=0;l<o;l++)a=o-l,l&3?R=c[a]:R=c[a-4],l<4||a<=4?u[l]=R:u[l]=g[d[R>>>24]]^v[d[R>>>16&255]]^x[d[R>>>8&255]]^S[d[R&255]],u[l]=u[l]>>>0}networkToHostOrderSwap(e){return e<<24|(e&65280)<<8|(e&16711680)>>8|e>>>24}decrypt(e,t,r){const i=this.keySize+6,s=this.invKeySchedule,o=this.invSBox,a=this.invSubMix,l=a[0],c=a[1],u=a[2],d=a[3],f=this.uint8ArrayToUint32Array_(r);let m=f[0],g=f[1],v=f[2],x=f[3];const S=new Int32Array(e),C=new Int32Array(S.length);let R,k,I,F,N,U,M,B,H,K,Y,oe,ue,Z;const Ae=this.networkToHostOrderSwap;for(;t<S.length;){for(H=Ae(S[t]),K=Ae(S[t+1]),Y=Ae(S[t+2]),oe=Ae(S[t+3]),N=H^s[0],U=oe^s[1],M=Y^s[2],B=K^s[3],ue=4,Z=1;Z<i;Z++)R=l[N>>>24]^c[U>>16&255]^u[M>>8&255]^d[B&255]^s[ue],k=l[U>>>24]^c[M>>16&255]^u[B>>8&255]^d[N&255]^s[ue+1],I=l[M>>>24]^c[B>>16&255]^u[N>>8&255]^d[U&255]^s[ue+2],F=l[B>>>24]^c[N>>16&255]^u[U>>8&255]^d[M&255]^s[ue+3],N=R,U=k,M=I,B=F,ue=ue+4;R=o[N>>>24]<<24^o[U>>16&255]<<16^o[M>>8&255]<<8^o[B&255]^s[ue],k=o[U>>>24]<<24^o[M>>16&255]<<16^o[B>>8&255]<<8^o[N&255]^s[ue+1],I=o[M>>>24]<<24^o[B>>16&255]<<16^o[N>>8&255]<<8^o[U&255]^s[ue+2],F=o[B>>>24]<<24^o[N>>16&255]<<16^o[U>>8&255]<<8^o[M&255]^s[ue+3],C[t]=Ae(R^m),C[t+1]=Ae(F^g),C[t+2]=Ae(I^v),C[t+3]=Ae(k^x),m=H,g=K,v=Y,x=oe,t=t+4}return C.buffer}}const CHUNK_SIZE=16;class Decrypter{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.useSoftware=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{const r=self.crypto;r&&(this.subtle=r.subtle||r.webkitSubtle)}catch{}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;const r=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?removePadding(r):r}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,r){return this.useSoftware?new Promise((i,s)=>{this.softwareDecrypt(new Uint8Array(e),t,r);const o=this.flush();o?i(o.buffer):s(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),t,r)}softwareDecrypt(e,t,r){const{currentIV:i,currentResult:s,remainderData:o}=this;this.logOnce("JS AES decrypt"),o&&(e=appendUint8Array(o,e),this.remainderData=null);const a=this.getValidChunk(e);if(!a.length)return null;i&&(r=i);let l=this.softwareDecrypter;l||(l=this.softwareDecrypter=new AESDecryptor),l.expandKey(t);const c=s;return this.currentResult=l.decrypt(a.buffer,0,r),this.currentIV=sliceUint8(a,-16).buffer,c||null}webCryptoDecrypt(e,t,r){if(this.key!==t||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(e,t,r));this.key=t,this.fastAesKey=new FastAESKey(this.subtle,t)}return this.fastAesKey.expandKey().then(i=>this.subtle?(this.logOnce("WebCrypto AES decrypt"),new AESCrypto(this.subtle,new Uint8Array(r)).decrypt(e.buffer,i)):Promise.reject(new Error("web crypto not initialized"))).catch(i=>(logger.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${i.name}: ${i.message}`),this.onWebCryptoError(e,t,r)))}onWebCryptoError(e,t,r){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,r);const i=this.flush();if(i)return i.buffer;throw new Error("WebCrypto and softwareDecrypt: failed to decrypt data")}getValidChunk(e){let t=e;const r=e.length-e.length%CHUNK_SIZE;return r!==e.length&&(t=sliceUint8(e,0,r),this.remainderData=sliceUint8(e,r)),t}logOnce(e){this.logEnabled&&(logger.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}const TimeRanges={toString:function(n){let e="";const t=n.length;for(let r=0;r<t;r++)e+=`[${n.start(r).toFixed(3)}-${n.end(r).toFixed(3)}]`;return e}},State={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class BaseStreamController extends TaskLoop{constructor(e,t,r,i,s){super(),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=State.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.loadedmetadata=!1,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.onvseeking=null,this.onvended=null,this.logPrefix="",this.log=void 0,this.warn=void 0,this.playlistType=s,this.logPrefix=i,this.log=logger.log.bind(logger,`${i}:`),this.warn=logger.warn.bind(logger,`${i}:`),this.hls=e,this.fragmentLoader=new FragmentLoader(e.config),this.keyLoader=r,this.fragmentTracker=t,this.config=e.config,this.decrypter=new Decrypter(e.config),e.on(Events.MANIFEST_LOADED,this.onManifestLoaded,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;e!=null&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=State.STOPPED}_streamEnded(e,t){if(t.live||e.nextStart||!e.end||!this.media)return!1;const r=t.partList;if(r!=null&&r.length){const s=r[r.length-1];return BufferHelper.isBuffered(this.media,s.start+s.duration/2)}const i=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(i)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null){var e;return(e=this.levelLastLoaded)==null?void 0:e.details}}onMediaAttached(e,t){const r=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),r.addEventListener("seeking",this.onvseeking),r.addEventListener("ended",this.onvended);const i=this.config;this.levels&&i.autoStartLoad&&this.state===State.STOPPED&&this.startLoad(i.startPosition)}onMediaDetaching(){const e=this.media;e!=null&&e.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&this.onvseeking&&this.onvended&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.keyLoader&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}onMediaSeeking(){const{config:e,fragCurrent:t,media:r,mediaBuffer:i,state:s}=this,o=r?r.currentTime:0,a=BufferHelper.bufferInfo(i||r,o,e.maxBufferHole);if(this.log(`media seeking to ${isFiniteNumber(o)?o.toFixed(3):o}, state: ${s}`),this.state===State.ENDED)this.resetLoadingState();else if(t){const l=e.maxFragLookUpTolerance,c=t.start-l,u=t.start+t.duration+l;if(!a.len||u<a.start||c>a.end){const d=o>u;(o<c||d)&&(d&&t.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),t.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}r&&(this.fragmentTracker.removeFragmentsInRange(o,1/0,this.playlistType,!0),this.lastCurrentTime=o),!this.loadedmetadata&&!a.len&&(this.nextLoadPosition=this.startPosition=o),this.tickImmediate()}onMediaEnded(){this.startPosition=this.lastCurrentTime=0}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset,this.initPTS=[]}onHandlerDestroying(){this.hls.off(Events.MANIFEST_LOADED,this.onManifestLoaded,this),this.stopLoad(),super.onHandlerDestroying(),this.hls=null}onHandlerDestroyed(){this.state=State.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,r){this._loadFragForPlayback(e,t,r)}_loadFragForPlayback(e,t,r){const i=s=>{if(this.fragContextChanged(e)){this.warn(`Fragment ${e.sn}${s.part?" p: "+s.part.index:""} of level ${e.level} was dropped during download.`),this.fragmentTracker.removeFragment(e);return}e.stats.chunkCount++,this._handleFragmentLoadProgress(s)};this._doFragLoad(e,t,r,i).then(s=>{if(!s)return;const o=this.state;if(this.fragContextChanged(e)){(o===State.FRAG_LOADING||!this.fragCurrent&&o===State.PARSING)&&(this.fragmentTracker.removeFragment(e),this.state=State.IDLE);return}"payload"in s&&(this.log(`Loaded fragment ${e.sn} of level ${e.level}`),this.hls.trigger(Events.FRAG_LOADED,s)),this._handleFragmentLoadComplete(s)}).catch(s=>{this.state===State.STOPPED||this.state===State.ERROR||(this.warn(`Frag error: ${(s==null?void 0:s.message)||s}`),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var t;const{fragmentTracker:r}=this;if(r.getState(e)===FragmentState.APPENDING){const s=e.type,o=this.getFwdBufferInfo(this.mediaBuffer,s),a=Math.max(e.duration,o?o.len:this.config.maxBufferLength),l=this.backtrackFragment;((l?e.sn-l.sn:0)===1||this.reduceMaxBufferLength(a,e.duration))&&r.removeFragment(e)}else((t=this.mediaBuffer)==null?void 0:t.buffered.length)===0?r.removeAllFragments():r.hasParts(e.type)&&(r.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),r.getState(e)===FragmentState.PARTIAL&&r.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){const t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}flushMainBuffer(e,t,r=null){if(!(e-t))return;const i={startOffset:e,endOffset:t,type:r};this.hls.trigger(Events.BUFFER_FLUSHING,i)}_loadInitSegment(e,t){this._doFragLoad(e,t).then(r=>{if(!r||this.fragContextChanged(e)||!this.levels)throw new Error("init load aborted");return r}).then(r=>{const{hls:i}=this,{payload:s}=r,o=e.decryptdata;if(s&&s.byteLength>0&&o!=null&&o.key&&o.iv&&o.method==="AES-128"){const a=self.performance.now();return this.decrypter.decrypt(new Uint8Array(s),o.key.buffer,o.iv.buffer).catch(l=>{throw i.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_DECRYPT_ERROR,fatal:!1,error:l,reason:l.message,frag:e}),l}).then(l=>{const c=self.performance.now();return i.trigger(Events.FRAG_DECRYPTED,{frag:e,payload:l,stats:{tstart:a,tdecrypt:c}}),r.payload=l,this.completeInitSegmentLoad(r)})}return this.completeInitSegmentLoad(r)}).catch(r=>{this.state===State.STOPPED||this.state===State.ERROR||(this.warn(r),this.resetFragmentLoading(e))})}completeInitSegmentLoad(e){const{levels:t}=this;if(!t)throw new Error("init load aborted, missing levels");const r=e.frag.stats;this.state=State.IDLE,e.frag.data=new Uint8Array(e.payload),r.parsing.start=r.buffering.start=self.performance.now(),r.parsing.end=r.buffering.end=self.performance.now(),this.tick()}fragContextChanged(e){const{fragCurrent:t}=this;return!e||!t||e.sn!==t.sn||e.level!==t.level}fragBufferedComplete(e,t){var r,i,s,o;const a=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.playlistType===PlaylistLevelType.MAIN?"level":"track"} ${e.level} (frag:[${((r=e.startPTS)!=null?r:NaN).toFixed(3)}-${((i=e.endPTS)!=null?i:NaN).toFixed(3)}] > buffer:${a?TimeRanges.toString(BufferHelper.getBuffered(a)):"(detached)"})`),e.sn!=="initSegment"){var l;if(e.type!==PlaylistLevelType.SUBTITLE){const u=e.elementaryStreams;if(!Object.keys(u).some(d=>!!u[d])){this.state=State.IDLE;return}}const c=(l=this.levels)==null?void 0:l[e.level];c!=null&&c.fragmentError&&(this.log(`Resetting level fragment error count of ${c.fragmentError} on frag buffered`),c.fragmentError=0)}this.state=State.IDLE,a&&(!this.loadedmetadata&&e.type==PlaylistLevelType.MAIN&&a.buffered.length&&((s=this.fragCurrent)==null?void 0:s.sn)===((o=this.fragPrevious)==null?void 0:o.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())}seekToStartPos(){}_handleFragmentLoadComplete(e){const{transmuxer:t}=this;if(!t)return;const{frag:r,part:i,partsLoaded:s}=e,o=!s||s.length===0||s.some(l=>!l),a=new ChunkMetadata(r.level,r.sn,r.stats.chunkCount+1,0,i?i.index:-1,!o);t.flush(a)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,r=null,i){var s;const o=t==null?void 0:t.details;if(!this.levels||!o)throw new Error(`frag load aborted, missing level${o?"":" detail"}s`);let a=null;if(e.encrypted&&!((s=e.decryptdata)!=null&&s.key)?(this.log(`Loading key for ${e.sn} of [${o.startSN}-${o.endSN}], ${this.logPrefix==="[stream-controller]"?"level":"track"} ${e.level}`),this.state=State.KEY_LOADING,this.fragCurrent=e,a=this.keyLoader.load(e).then(u=>{if(!this.fragContextChanged(u.frag))return this.hls.trigger(Events.KEY_LOADED,u),this.state===State.KEY_LOADING&&(this.state=State.IDLE),u}),this.hls.trigger(Events.KEY_LOADING,{frag:e}),this.fragCurrent===null&&(a=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))):!e.encrypted&&o.encryptedFragments.length&&this.keyLoader.loadClear(e,o.encryptedFragments),r=Math.max(e.start,r||0),this.config.lowLatencyMode&&e.sn!=="initSegment"){const u=o.partList;if(u&&i){r>e.end&&o.fragmentHint&&(e=o.fragmentHint);const d=this.getNextPart(u,e,r);if(d>-1){const f=u[d];this.log(`Loading part sn: ${e.sn} p: ${f.index} cc: ${e.cc} of playlist [${o.startSN}-${o.endSN}] parts [0-${d}-${u.length-1}] ${this.logPrefix==="[stream-controller]"?"level":"track"}: ${e.level}, target: ${parseFloat(r.toFixed(3))}`),this.nextLoadPosition=f.start+f.duration,this.state=State.FRAG_LOADING;let m;return a?m=a.then(g=>!g||this.fragContextChanged(g.frag)?null:this.doFragPartsLoad(e,f,t,i)).catch(g=>this.handleFragLoadError(g)):m=this.doFragPartsLoad(e,f,t,i).catch(g=>this.handleFragLoadError(g)),this.hls.trigger(Events.FRAG_LOADING,{frag:e,part:f,targetBufferTime:r}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):m}else if(!e.url||this.loadedEndOfParts(u,r))return Promise.resolve(null)}}this.log(`Loading fragment ${e.sn} cc: ${e.cc} ${o?"of ["+o.startSN+"-"+o.endSN+"] ":""}${this.logPrefix==="[stream-controller]"?"level":"track"}: ${e.level}, target: ${parseFloat(r.toFixed(3))}`),isFiniteNumber(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=State.FRAG_LOADING;const l=this.config.progressive;let c;return l&&a?c=a.then(u=>!u||this.fragContextChanged(u==null?void 0:u.frag)?null:this.fragmentLoader.load(e,i)).catch(u=>this.handleFragLoadError(u)):c=Promise.all([this.fragmentLoader.load(e,l?i:void 0),a]).then(([u])=>(!l&&u&&i&&i(u),u)).catch(u=>this.handleFragLoadError(u)),this.hls.trigger(Events.FRAG_LOADING,{frag:e,targetBufferTime:r}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):c}doFragPartsLoad(e,t,r,i){return new Promise((s,o)=>{var a;const l=[],c=(a=r.details)==null?void 0:a.partList,u=d=>{this.fragmentLoader.loadPart(e,d,i).then(f=>{l[d.index]=f;const m=f.part;this.hls.trigger(Events.FRAG_LOADED,f);const g=getPartWith(r,e.sn,d.index+1)||findPart(c,e.sn,d.index+1);if(g)u(g);else return s({frag:e,part:m,partsLoaded:l})}).catch(o)};u(t)})}handleFragLoadError(e){if("data"in e){const t=e.data;e.data&&t.details===ErrorDetails.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):this.hls.trigger(Events.ERROR,t)}else this.hls.trigger(Events.ERROR,{type:ErrorTypes.OTHER_ERROR,details:ErrorDetails.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const t=this.getCurrentContext(e);if(!t||this.state!==State.PARSING){!this.fragCurrent&&this.state!==State.STOPPED&&this.state!==State.ERROR&&(this.state=State.IDLE);return}const{frag:r,part:i,level:s}=t,o=self.performance.now();r.stats.parsing.end=o,i&&(i.stats.parsing.end=o),this.updateLevelTiming(r,i,s,e.partial)}getCurrentContext(e){const{levels:t,fragCurrent:r}=this,{level:i,sn:s,part:o}=e;if(!(t!=null&&t[i]))return this.warn(`Levels object was unset while buffering fragment ${s} of level ${i}. The current chunk will not be buffered.`),null;const a=t[i],l=o>-1?getPartWith(a,s,o):null,c=l?l.fragment:getFragmentWithSN(a,s,r);return c?(r&&r!==c&&(c.stats=r.stats),{frag:c,part:l,level:a}):null}bufferFragmentData(e,t,r,i,s){var o;if(!e||this.state!==State.PARSING)return;const{data1:a,data2:l}=e;let c=a;if(a&&l&&(c=appendUint8Array(a,l)),!((o=c)!=null&&o.length))return;const u={type:e.type,frag:t,part:r,chunkMeta:i,parent:t.type,data:c};if(this.hls.trigger(Events.BUFFER_APPENDING,u),e.dropped&&e.independent&&!r){if(s)return;this.flushBufferGap(t)}}flushBufferGap(e){const t=this.media;if(!t)return;if(!BufferHelper.isBuffered(t,t.currentTime)){this.flushMainBuffer(0,e.start);return}const r=t.currentTime,i=BufferHelper.bufferInfo(t,r,0),s=e.duration,o=Math.min(this.config.maxFragLookUpTolerance*2,s*.25),a=Math.max(Math.min(e.start-o,i.end-o),r+o);e.start-a>o&&this.flushMainBuffer(a,e.start)}getFwdBufferInfo(e,t){const r=this.getLoadPosition();return isFiniteNumber(r)?this.getFwdBufferInfoAtPos(e,r,t):null}getFwdBufferInfoAtPos(e,t,r){const{config:{maxBufferHole:i}}=this,s=BufferHelper.bufferInfo(e,t,i);if(s.len===0&&s.nextStart!==void 0){const o=this.fragmentTracker.getBufferedFrag(t,r);if(o&&s.nextStart<o.end)return BufferHelper.bufferInfo(e,t,Math.max(s.nextStart,i))}return s}getMaxBufferLength(e){const{config:t}=this;let r;return e?r=Math.max(8*t.maxBufferSize/e,t.maxBufferLength):r=t.maxBufferLength,Math.min(r,t.maxMaxBufferLength)}reduceMaxBufferLength(e,t){const r=this.config,i=Math.max(Math.min(e-t,r.maxBufferLength),t),s=Math.max(e-t*3,r.maxMaxBufferLength/2,i);return s>=i?(r.maxMaxBufferLength=s,this.warn(`Reduce max buffer length to ${s}s`),!0):!1}getAppendedFrag(e,t=PlaylistLevelType.MAIN){const r=this.fragmentTracker.getAppendedFrag(e,PlaylistLevelType.MAIN);return r&&"fragment"in r?r.fragment:r}getNextFragment(e,t){const r=t.fragments,i=r.length;if(!i)return null;const{config:s}=this,o=r[0].start;let a;if(t.live){const l=s.initialLiveManifestSize;if(i<l)return this.warn(`Not enough fragments to start playback (have: ${i}, need: ${l})`),null;(!t.PTSKnown&&!this.startFragRequested&&this.startPosition===-1||e<o)&&(a=this.getInitialLiveFragment(t,r),this.startPosition=this.nextLoadPosition=a?this.hls.liveSyncPosition||a.start:e)}else e<=o&&(a=r[0]);if(!a){const l=s.lowLatencyMode?t.partEnd:t.fragmentEnd;a=this.getFragmentAtPosition(e,l,t)}return this.mapToInitFragWhenRequired(a)}isLoopLoading(e,t){const r=this.fragmentTracker.getState(e);return(r===FragmentState.OK||r===FragmentState.PARTIAL&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,r,i,s){const o=e.gap,a=this.getNextFragment(this.nextLoadPosition,t);if(a===null)return a;if(e=a,o&&e&&!e.gap&&r.nextStart){const l=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,r.nextStart,i);if(l!==null&&r.len+l.len>=s)return this.log(`buffer full after gaps in "${i}" playlist starting at sn: ${e.sn}`),null}return e}mapToInitFragWhenRequired(e){return e!=null&&e.initSegment&&!(e!=null&&e.initSegment.data)&&!this.bitrateTest?e.initSegment:e}getNextPart(e,t,r){let i=-1,s=!1,o=!0;for(let a=0,l=e.length;a<l;a++){const c=e[a];if(o=o&&!c.independent,i>-1&&r<c.start)break;const u=c.loaded;u?i=-1:(s||c.independent||o)&&c.fragment===t&&(i=a),s=u}return i}loadedEndOfParts(e,t){const r=e[e.length-1];return r&&t>r.start&&r.loaded}getInitialLiveFragment(e,t){const r=this.fragPrevious;let i=null;if(r){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${r.programDateTime}`),i=findFragmentByPDT(t,r.endProgramDateTime,this.config.maxFragLookUpTolerance)),!i){const s=r.sn+1;if(s>=e.startSN&&s<=e.endSN){const o=t[s-e.startSN];r.cc===o.cc&&(i=o,this.log(`Live playlist, switching playlist, load frag with next SN: ${i.sn}`))}i||(i=findFragWithCC(t,r.cc),i&&this.log(`Live playlist, switching playlist, load frag with same CC: ${i.sn}`))}}else{const s=this.hls.liveSyncPosition;s!==null&&(i=this.getFragmentAtPosition(s,this.bitrateTest?e.fragmentEnd:e.edge,e))}return i}getFragmentAtPosition(e,t,r){const{config:i}=this;let{fragPrevious:s}=this,{fragments:o,endSN:a}=r;const{fragmentHint:l}=r,{maxFragLookUpTolerance:c}=i,u=r.partList,d=!!(i.lowLatencyMode&&u!=null&&u.length&&l);d&&l&&!this.bitrateTest&&(o=o.concat(l),a=l.sn);let f;if(e<t){const m=e>t-c?0:c;f=findFragmentByPTS(s,o,e,m)}else f=o[o.length-1];if(f){const m=f.sn-r.startSN,g=this.fragmentTracker.getState(f);if((g===FragmentState.OK||g===FragmentState.PARTIAL&&f.gap)&&(s=f),s&&f.sn===s.sn&&(!d||u[0].fragment.sn>f.sn)&&s&&f.level===s.level){const x=o[m+1];f.sn<a&&this.fragmentTracker.getState(x)!==FragmentState.OK?f=x:f=null}}return f}synchronizeToLiveEdge(e){const{config:t,media:r}=this;if(!r)return;const i=this.hls.liveSyncPosition,s=r.currentTime,o=e.fragments[0].start,a=e.edge,l=s>=o-t.maxFragLookUpTolerance&&s<=a;if(i!==null&&r.duration>i&&(s<i||!l)){const c=t.liveMaxLatencyDuration!==void 0?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;(!l&&r.readyState<4||s<a-c)&&(this.loadedmetadata||(this.nextLoadPosition=i),r.readyState&&(this.warn(`Playback: ${s.toFixed(3)} is located too far from the end of live sliding playlist: ${a}, reset currentTime to : ${i.toFixed(3)}`),r.currentTime=i))}}alignPlaylists(e,t,r){const i=e.fragments.length;if(!i)return this.warn("No fragments in live playlist"),0;const s=e.fragments[0].start,o=!t,a=e.alignedSliding&&isFiniteNumber(s);if(o||!a&&!s){const{fragPrevious:l}=this;alignStream(l,r,e);const c=e.fragments[0].start;return this.log(`Live playlist sliding: ${c.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} prev-sn: ${l?l.sn:"na"} fragments: ${i}`),c}return s}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,e.partTarget*3)}setStartPosition(e,t){let r=this.startPosition;if(r<t&&(r=-1),r===-1||this.lastCurrentTime===-1){const i=this.startTimeOffset!==null,s=i?this.startTimeOffset:e.startTimeOffset;s!==null&&isFiniteNumber(s)?(r=t+s,s<0&&(r+=e.totalduration),r=Math.min(Math.max(t,r),t+e.totalduration),this.log(`Start time offset ${s} found in ${i?"multivariant":"media"} playlist, adjust startPosition to ${r}`),this.startPosition=r):e.live?r=this.hls.liveSyncPosition||t:this.startPosition=r=0,this.lastCurrentTime=r}this.nextLoadPosition=r}getLoadPosition(){const{media:e}=this;let t=0;return this.loadedmetadata&&e?t=e.currentTime:this.nextLoadPosition&&(t=this.nextLoadPosition),t}handleFragLoadAborted(e,t){this.transmuxer&&e.sn!=="initSegment"&&e.stats.aborted&&(this.warn(`Fragment ${e.sn}${t?" part "+t.index:""} of level ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){(!this.fragCurrent||!this.fragContextChanged(e)&&this.state!==State.FRAG_LOADING_WAITING_RETRY)&&(this.state=State.IDLE)}onFragmentOrKeyLoadError(e,t){if(t.chunkMeta&&!t.frag){const u=this.getCurrentContext(t.chunkMeta);u&&(t.frag=u.frag)}const r=t.frag;if(!r||r.type!==e||!this.levels)return;if(this.fragContextChanged(r)){var i;this.warn(`Frag load error must match current frag to retry ${r.url} > ${(i=this.fragCurrent)==null?void 0:i.url}`);return}const s=t.details===ErrorDetails.FRAG_GAP;s&&this.fragmentTracker.fragBuffered(r,!0);const o=t.errorAction,{action:a,retryCount:l=0,retryConfig:c}=o||{};if(o&&a===NetworkErrorAction.RetryRequest&&c){this.resetStartWhenNotLoaded(this.levelLastLoaded);const u=getRetryDelay(c,l);this.warn(`Fragment ${r.sn} of ${e} ${r.level} errored with ${t.details}, retrying loading ${l+1}/${c.maxNumRetry} in ${u}ms`),o.resolved=!0,this.retryDate=self.performance.now()+u,this.state=State.FRAG_LOADING_WAITING_RETRY}else if(c&&o)if(this.resetFragmentErrors(e),l<c.maxNumRetry)!s&&a!==NetworkErrorAction.RemoveAlternatePermanently&&(o.resolved=!0);else{logger.warn(`${t.details} reached or exceeded max retry (${l})`);return}else(o==null?void 0:o.action)===NetworkErrorAction.SendAlternateToPenaltyBox?this.state=State.WAITING_LEVEL:this.state=State.ERROR;this.tickImmediate()}reduceLengthAndFlushBuffer(e){if(this.state===State.PARSING||this.state===State.PARSED){const t=e.frag,r=e.parent,i=this.getFwdBufferInfo(this.mediaBuffer,r),s=i&&i.len>.5;s&&this.reduceMaxBufferLength(i.len,(t==null?void 0:t.duration)||10);const o=!s;return o&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${r} buffer`),t&&(this.fragmentTracker.removeFragment(t),this.nextLoadPosition=t.start),this.resetLoadingState(),o}return!1}resetFragmentErrors(e){e===PlaylistLevelType.AUDIO&&(this.fragCurrent=null),this.loadedmetadata||(this.startFragRequested=!1),this.state!==State.STOPPED&&(this.state=State.IDLE)}afterBufferFlushed(e,t,r){if(!e)return;const i=BufferHelper.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,i,r),this.state===State.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state=State.IDLE}resetStartWhenNotLoaded(e){if(!this.loadedmetadata){this.startFragRequested=!1;const t=e?e.details:null;t!=null&&t.live?(this.startPosition=-1,this.setStartPosition(t,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.warn(`The loading context changed while buffering fragment ${e.sn} of level ${e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,r,i){var s;const o=r.details;if(!o){this.warn("level.details undefined");return}if(!Object.keys(e.elementaryStreams).reduce((l,c)=>{const u=e.elementaryStreams[c];if(u){const d=u.endPTS-u.startPTS;if(d<=0)return this.warn(`Could not parse fragment ${e.sn} ${c} duration reliably (${d})`),l||!1;const f=i?0:updateFragPTSDTS(o,e,u.startPTS,u.endPTS,u.startDTS,u.endDTS);return this.hls.trigger(Events.LEVEL_PTS_UPDATED,{details:o,level:r,drift:f,type:c,frag:e,start:u.startPTS,end:u.endPTS}),!0}return l},!1)&&((s=this.transmuxer)==null?void 0:s.error)===null){const l=new Error(`Found no media in fragment ${e.sn} of level ${e.level} resetting transmuxer to fallback to playlist timing`);if(r.fragmentError===0&&(r.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)),this.warn(l.message),this.hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,error:l,frag:e,reason:`Found no media in msn ${e.sn} of level "${r.url}"`}),!this.hls)return;this.resetTransmuxer()}this.state=State.PARSED,this.hls.trigger(Events.FRAG_PARSED,{frag:e,part:t})}resetTransmuxer(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)}recoverWorkerError(e){e.event==="demuxerWorker"&&(this.fragmentTracker.removeAllFragments(),this.resetTransmuxer(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState())}set state(e){const t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}}class ChunkCache{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:t}=this;let r;if(e.length)e.length===1?r=e[0]:r=concatUint8Arrays(e,t);else return new Uint8Array(0);return this.reset(),r}reset(){this.chunks.length=0,this.dataLength=0}}function concatUint8Arrays(n,e){const t=new Uint8Array(e);let r=0;for(let i=0;i<n.length;i++){const s=n[i];t.set(s,r),r+=s.length}return t}function hasUMDWorker(){return typeof __HLS_WORKER_BUNDLE__=="function"}function injectWorker(){const n=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),e=self.URL.createObjectURL(n);return{worker:new self.Worker(e),objectURL:e}}function loadWorker(n){const e=new self.URL(n,self.location.href).href;return{worker:new self.Worker(e),scriptURL:e}}function dummyTrack(n="",e=9e4){return{type:n,id:-1,pid:-1,inputTimeScale:e,sequenceNumber:-1,samples:[],dropped:0}}class BaseAudioDemuxer{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,r,i){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,r){}demux(e,t){this.cachedData&&(e=appendUint8Array(this.cachedData,e),this.cachedData=null);let r=getID3Data(e,0),i=r?r.length:0,s;const o=this._audioTrack,a=this._id3Track,l=r?getTimeStamp(r):void 0,c=e.length;for((this.basePTS===null||this.frameIndex===0&&isFiniteNumber(l))&&(this.basePTS=initPTSFn(l,t,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),r&&r.length>0&&a.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:r,type:MetadataSchema.audioId3,duration:Number.POSITIVE_INFINITY});i<c;){if(this.canParse(e,i)){const u=this.appendFrame(o,e,i);u?(this.frameIndex++,this.lastPTS=u.sample.pts,i+=u.length,s=i):i=c}else canParse$2(e,i)?(r=getID3Data(e,i),a.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:r,type:MetadataSchema.audioId3,duration:Number.POSITIVE_INFINITY}),i+=r.length,s=i):i++;if(i===c&&s!==c){const u=sliceUint8(e,s);this.cachedData?this.cachedData=appendUint8Array(this.cachedData,u):this.cachedData=u}}return{audioTrack:o,videoTrack:dummyTrack(),id3Track:a,textTrack:dummyTrack()}}demuxSampleAes(e,t,r){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:dummyTrack(),id3Track:this._id3Track,textTrack:dummyTrack()}}destroy(){}}const initPTSFn=(n,e,t)=>{if(isFiniteNumber(n))return n*90;const r=t?t.baseTime*9e4/t.timescale:0;return e*9e4+r};function getAudioConfig(n,e,t,r){let i,s,o,a;const l=navigator.userAgent.toLowerCase(),c=r,u=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];i=((e[t+2]&192)>>>6)+1;const d=(e[t+2]&60)>>>2;if(d>u.length-1){const f=new Error(`invalid ADTS sampling index:${d}`);n.emit(Events.ERROR,Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,error:f,reason:f.message});return}return o=(e[t+2]&1)<<2,o|=(e[t+3]&192)>>>6,logger.log(`manifest codec:${r}, ADTS type:${i}, samplingIndex:${d}`),/firefox/i.test(l)?d>=6?(i=5,a=new Array(4),s=d-3):(i=2,a=new Array(2),s=d):l.indexOf("android")!==-1?(i=2,a=new Array(2),s=d):(i=5,a=new Array(4),r&&(r.indexOf("mp4a.40.29")!==-1||r.indexOf("mp4a.40.5")!==-1)||!r&&d>=6?s=d-3:((r&&r.indexOf("mp4a.40.2")!==-1&&(d>=6&&o===1||/vivaldi/i.test(l))||!r&&o===1)&&(i=2,a=new Array(2)),s=d)),a[0]=i<<3,a[0]|=(d&14)>>1,a[1]|=(d&1)<<7,a[1]|=o<<3,i===5&&(a[1]|=(s&14)>>1,a[2]=(s&1)<<7,a[2]|=8,a[3]=0),{config:a,samplerate:u[d],channelCount:o,codec:"mp4a.40."+i,manifestCodec:c}}function isHeaderPattern$1(n,e){return n[e]===255&&(n[e+1]&246)===240}function getHeaderLength(n,e){return n[e+1]&1?7:9}function getFullFrameLength(n,e){return(n[e+3]&3)<<11|n[e+4]<<3|(n[e+5]&224)>>>5}function canGetFrameLength(n,e){return e+5<n.length}function isHeader$1(n,e){return e+1<n.length&&isHeaderPattern$1(n,e)}function canParse$1(n,e){return canGetFrameLength(n,e)&&isHeaderPattern$1(n,e)&&getFullFrameLength(n,e)<=n.length-e}function probe$1(n,e){if(isHeader$1(n,e)){const t=getHeaderLength(n,e);if(e+t>=n.length)return!1;const r=getFullFrameLength(n,e);if(r<=t)return!1;const i=e+r;return i===n.length||isHeader$1(n,i)}return!1}function initTrackConfig(n,e,t,r,i){if(!n.samplerate){const s=getAudioConfig(e,t,r,i);if(!s)return;n.config=s.config,n.samplerate=s.samplerate,n.channelCount=s.channelCount,n.codec=s.codec,n.manifestCodec=s.manifestCodec,logger.log(`parsed codec:${n.codec}, rate:${s.samplerate}, channels:${s.channelCount}`)}}function getFrameDuration(n){return 1024*9e4/n}function parseFrameHeader(n,e){const t=getHeaderLength(n,e);if(e+t<=n.length){const r=getFullFrameLength(n,e)-t;if(r>0)return{headerLength:t,frameLength:r}}}function appendFrame$2(n,e,t,r,i){const s=getFrameDuration(n.samplerate),o=r+i*s,a=parseFrameHeader(e,t);let l;if(a){const{frameLength:d,headerLength:f}=a,m=f+d,g=Math.max(0,t+m-e.length);g?(l=new Uint8Array(m-f),l.set(e.subarray(t+f,e.length),0)):l=e.subarray(t+f,t+m);const v={unit:l,pts:o};return g||n.samples.push(v),{sample:v,length:m,missing:g}}const c=e.length-t;return l=new Uint8Array(c),l.set(e.subarray(t,e.length),0),{sample:{unit:l,pts:o},length:c,missing:-1}}let chromeVersion$1=null;const BitratesMap=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],SamplesCoefficients=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],BytesInSlot=[0,1,1,4];function appendFrame$1(n,e,t,r,i){if(t+24>e.length)return;const s=parseHeader(e,t);if(s&&t+s.frameLength<=e.length){const o=s.samplesPerFrame*9e4/s.sampleRate,a=r+i*o,l={unit:e.subarray(t,t+s.frameLength),pts:a,dts:a};return n.config=[],n.channelCount=s.channelCount,n.samplerate=s.sampleRate,n.samples.push(l),{sample:l,length:s.frameLength,missing:0}}}function parseHeader(n,e){const t=n[e+1]>>3&3,r=n[e+1]>>1&3,i=n[e+2]>>4&15,s=n[e+2]>>2&3;if(t!==1&&i!==0&&i!==15&&s!==3){const o=n[e+2]>>1&1,a=n[e+3]>>6,l=t===3?3-r:r===3?3:4,c=BitratesMap[l*14+i-1]*1e3,d=SamplingRateMap[(t===3?0:t===2?1:2)*3+s],f=a===3?1:2,m=SamplesCoefficients[t][r],g=BytesInSlot[r],v=m*8*g,x=Math.floor(m*c/d+o)*g;if(chromeVersion$1===null){const R=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);chromeVersion$1=R?parseInt(R[1]):0}return!!chromeVersion$1&&chromeVersion$1<=87&&r===2&&c>=224e3&&a===0&&(n[e+3]=n[e+3]|128),{sampleRate:d,channelCount:f,frameLength:x,samplesPerFrame:v}}}function isHeaderPattern(n,e){return n[e]===255&&(n[e+1]&224)===224&&(n[e+1]&6)!==0}function isHeader(n,e){return e+1<n.length&&isHeaderPattern(n,e)}function canParse(n,e){return isHeaderPattern(n,e)&&4<=n.length-e}function probe(n,e){if(e+1<n.length&&isHeaderPattern(n,e)){const r=parseHeader(n,e);let i=4;r!=null&&r.frameLength&&(i=r.frameLength);const s=e+i;return s===n.length||isHeader(n,s)}return!1}class AACDemuxer extends BaseAudioDemuxer{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,r,i){super.resetInitSegment(e,t,r,i),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=getID3Data(e,0);let r=(t==null?void 0:t.length)||0;if(probe(e,r))return!1;for(let i=e.length;r<i;r++)if(probe$1(e,r))return logger.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return canParse$1(e,t)}appendFrame(e,t,r){initTrackConfig(e,this.observer,t,r,e.manifestCodec);const i=appendFrame$2(e,t,r,this.basePTS,this.frameIndex);if(i&&i.missing===0)return i}}const emsgSchemePattern=/\/emsg[-/]ID3/i;class MP4Demuxer{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,r,i){const s=this.videoTrack=dummyTrack("video",1),o=this.audioTrack=dummyTrack("audio",1),a=this.txtTrack=dummyTrack("text",1);if(this.id3Track=dummyTrack("id3",1),this.timeOffset=0,!(e!=null&&e.byteLength))return;const l=parseInitSegment(e);if(l.video){const{id:c,timescale:u,codec:d}=l.video;s.id=c,s.timescale=a.timescale=u,s.codec=d}if(l.audio){const{id:c,timescale:u,codec:d}=l.audio;o.id=c,o.timescale=u,o.codec=d}a.id=RemuxerTrackIdConfig.text,s.sampleDuration=0,s.duration=o.duration=i}resetContiguity(){this.remainderData=null}static probe(e){return hasMoofData(e)}demux(e,t){this.timeOffset=t;let r=e;const i=this.videoTrack,s=this.txtTrack;if(this.config.progressive){this.remainderData&&(r=appendUint8Array(this.remainderData,e));const a=segmentValidRange(r);this.remainderData=a.remainder,i.samples=a.valid||new Uint8Array}else i.samples=r;const o=this.extractID3Track(i,t);return s.samples=parseSamples(t,i),{videoTrack:i,audioTrack:this.audioTrack,id3Track:o,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,t=this.videoTrack,r=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;const i=this.extractID3Track(t,this.timeOffset);return r.samples=parseSamples(e,t),{videoTrack:t,audioTrack:dummyTrack(),id3Track:i,textTrack:dummyTrack()}}extractID3Track(e,t){const r=this.id3Track;if(e.samples.length){const i=findBox(e.samples,["emsg"]);i&&i.forEach(s=>{const o=parseEmsg(s);if(emsgSchemePattern.test(o.schemeIdUri)){const a=isFiniteNumber(o.presentationTime)?o.presentationTime/o.timeScale:t+o.presentationTimeDelta/o.timeScale;let l=o.eventDuration===4294967295?Number.POSITIVE_INFINITY:o.eventDuration/o.timeScale;l<=.001&&(l=Number.POSITIVE_INFINITY);const c=o.payload;r.samples.push({data:c,len:c.byteLength,dts:a,pts:a,type:MetadataSchema.emsg,duration:l})}})}return r}demuxSampleAes(e,t,r){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){}}const getAudioBSID=(n,e)=>{let t=0,r=5;e+=r;const i=new Uint32Array(1),s=new Uint32Array(1),o=new Uint8Array(1);for(;r>0;){o[0]=n[e];const a=Math.min(r,8),l=8-a;s[0]=4278190080>>>24+l<<l,i[0]=(o[0]&s[0])>>l,t=t?t<<a|i[0]:i[0],e+=1,r-=a}return t};class AC3Demuxer extends BaseAudioDemuxer{constructor(e){super(),this.observer=void 0,this.observer=e}resetInitSegment(e,t,r,i){super.resetInitSegment(e,t,r,i),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}canParse(e,t){return t+64<e.length}appendFrame(e,t,r){const i=appendFrame(e,t,r,this.basePTS,this.frameIndex);if(i!==-1)return{sample:e.samples[e.samples.length-1],length:i,missing:0}}static probe(e){if(!e)return!1;const t=getID3Data(e,0);if(!t)return!1;const r=t.length;return e[r]===11&&e[r+1]===119&&getTimeStamp(t)!==void 0&&getAudioBSID(e,r)<16}}function appendFrame(n,e,t,r,i){if(t+8>e.length||e[t]!==11||e[t+1]!==119)return-1;const s=e[t+4]>>6;if(s>=3)return-1;const a=[48e3,44100,32e3][s],l=e[t+4]&63,u=[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][l*3+s]*2;if(t+u>e.length)return-1;const d=e[t+6]>>5;let f=0;d===2?f+=2:(d&1&&d!==1&&(f+=2),d&4&&(f+=2));const m=(e[t+6]<<8|e[t+7])>>12-f&1,v=[2,1,2,3,3,4,4,5][d]+m,x=e[t+5]>>3,S=e[t+5]&7,C=new Uint8Array([s<<6|x<<1|S>>2,(S&3)<<6|d<<3|m<<2|l>>4,l<<4&224]),R=1536/a*9e4,k=r+i*R,I=e.subarray(t,t+u);return n.config=C,n.channelCount=v,n.samplerate=a,n.samples.push({unit:I,pts:k}),u}class BaseVideoParser{constructor(){this.VideoSample=null}createVideoSample(e,t,r,i){return{key:e,frame:!1,pts:t,dts:r,units:[],debug:i,length:0}}getLastNalUnit(e){var t;let r=this.VideoSample,i;if((!r||r.units.length===0)&&(r=e[e.length-1]),(t=r)!=null&&t.units){const s=r.units;i=s[s.length-1]}return i}pushAccessUnit(e,t){if(e.units.length&&e.frame){if(e.pts===void 0){const r=t.samples,i=r.length;if(i){const s=r[i-1];e.pts=s.pts,e.dts=s.dts}else{t.dropped++;return}}t.samples.push(e)}e.debug.length&&logger.log(e.pts+"/"+e.dts+":"+e.debug)}}class ExpGolomb{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,t=this.bytesAvailable,r=e.byteLength-t,i=new Uint8Array(4),s=Math.min(4,t);if(s===0)throw new Error("no bytes available");i.set(e.subarray(r,r+s)),this.word=new DataView(i.buffer).getUint32(0),this.bitsAvailable=s*8,this.bytesAvailable-=s}skipBits(e){let t;e=Math.min(e,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const r=this.word>>>32-t;if(e>32&&logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return t=e-t,t>0&&this.bitsAvailable?r<<t|this.readBits(t):r}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if(this.word&2147483648>>>e)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}skipScalingList(e){let t=8,r=8,i;for(let s=0;s<e;s++)r!==0&&(i=this.readEG(),r=(t+i+256)%256),t=r===0?t:r}readSPS(){let e=0,t=0,r=0,i=0,s,o,a;const l=this.readUByte.bind(this),c=this.readBits.bind(this),u=this.readUEG.bind(this),d=this.readBoolean.bind(this),f=this.skipBits.bind(this),m=this.skipEG.bind(this),g=this.skipUEG.bind(this),v=this.skipScalingList.bind(this);l();const x=l();if(c(5),f(3),l(),g(),x===100||x===110||x===122||x===244||x===44||x===83||x===86||x===118||x===128){const F=u();if(F===3&&f(1),g(),g(),f(1),d())for(o=F!==3?8:12,a=0;a<o;a++)d()&&(a<6?v(16):v(64))}g();const S=u();if(S===0)u();else if(S===1)for(f(1),m(),m(),s=u(),a=0;a<s;a++)m();g(),f(1);const C=u(),R=u(),k=c(1);k===0&&f(1),f(1),d()&&(e=u(),t=u(),r=u(),i=u());let I=[1,1];if(d()&&d())switch(l()){case 1:I=[1,1];break;case 2:I=[12,11];break;case 3:I=[10,11];break;case 4:I=[16,11];break;case 5:I=[40,33];break;case 6:I=[24,11];break;case 7:I=[20,11];break;case 8:I=[32,11];break;case 9:I=[80,33];break;case 10:I=[18,11];break;case 11:I=[15,11];break;case 12:I=[64,33];break;case 13:I=[160,99];break;case 14:I=[4,3];break;case 15:I=[3,2];break;case 16:I=[2,1];break;case 255:{I=[l()<<8|l(),l()<<8|l()];break}}return{width:Math.ceil((C+1)*16-e*2-t*2),height:(2-k)*(R+1)*16-(k?2:4)*(r+i),pixelRatio:I}}readSliceType(){return this.readUByte(),this.readUEG(),this.readUEG()}}class AvcVideoParser extends BaseVideoParser{parseAVCPES(e,t,r,i,s){const o=this.parseAVCNALu(e,r.data);let a=this.VideoSample,l,c=!1;r.data=null,a&&o.length&&!e.audFound&&(this.pushAccessUnit(a,e),a=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts,"")),o.forEach(u=>{var d;switch(u.type){case 1:{let v=!1;l=!0;const x=u.data;if(c&&x.length>4){const S=new ExpGolomb(x).readSliceType();(S===2||S===4||S===7||S===9)&&(v=!0)}if(v){var f;(f=a)!=null&&f.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null)}a||(a=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts,"")),a.frame=!0,a.key=v;break}case 5:l=!0,(d=a)!=null&&d.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null),a||(a=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts,"")),a.key=!0,a.frame=!0;break;case 6:{l=!0,parseSEIMessageFromNALu(u.data,1,r.pts,t.samples);break}case 7:{var m,g;l=!0,c=!0;const v=u.data,S=new ExpGolomb(v).readSPS();if(!e.sps||e.width!==S.width||e.height!==S.height||((m=e.pixelRatio)==null?void 0:m[0])!==S.pixelRatio[0]||((g=e.pixelRatio)==null?void 0:g[1])!==S.pixelRatio[1]){e.width=S.width,e.height=S.height,e.pixelRatio=S.pixelRatio,e.sps=[v],e.duration=s;const C=v.subarray(1,4);let R="avc1.";for(let k=0;k<3;k++){let I=C[k].toString(16);I.length<2&&(I="0"+I),R+=I}e.codec=R}break}case 8:l=!0,e.pps=[u.data];break;case 9:l=!0,e.audFound=!0,a&&this.pushAccessUnit(a,e),a=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts,"");break;case 12:l=!0;break;default:l=!1,a&&(a.debug+="unknown NAL "+u.type+" ");break}a&&l&&a.units.push(u)}),i&&a&&(this.pushAccessUnit(a,e),this.VideoSample=null)}parseAVCNALu(e,t){const r=t.byteLength;let i=e.naluState||0;const s=i,o=[];let a=0,l,c,u,d=-1,f=0;for(i===-1&&(d=0,f=t[0]&31,i=0,a=1);a<r;){if(l=t[a++],!i){i=l?0:1;continue}if(i===1){i=l?0:2;continue}if(!l)i=3;else if(l===1){if(c=a-i-1,d>=0){const m={data:t.subarray(d,c),type:f};o.push(m)}else{const m=this.getLastNalUnit(e.samples);m&&(s&&a<=4-s&&m.state&&(m.data=m.data.subarray(0,m.data.byteLength-s)),c>0&&(m.data=appendUint8Array(m.data,t.subarray(0,c)),m.state=0))}a<r?(u=t[a]&31,d=a,f=u,i=0):i=-1}else i=0}if(d>=0&&i>=0){const m={data:t.subarray(d,r),type:f,state:i};o.push(m)}if(o.length===0){const m=this.getLastNalUnit(e.samples);m&&(m.data=appendUint8Array(m.data,t))}return e.naluState=i,o}}class SampleAesDecrypter{constructor(e,t,r){this.keyData=void 0,this.decrypter=void 0,this.keyData=r,this.decrypter=new Decrypter(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer)}decryptAacSample(e,t,r){const i=e[t].unit;if(i.length<=16)return;const s=i.subarray(16,i.length-i.length%16),o=s.buffer.slice(s.byteOffset,s.byteOffset+s.length);this.decryptBuffer(o).then(a=>{const l=new Uint8Array(a);i.set(l,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,r)})}decryptAacSamples(e,t,r){for(;;t++){if(t>=e.length){r();return}if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,r),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){const t=Math.floor((e.length-48)/160)*16+16,r=new Int8Array(t);let i=0;for(let s=32;s<e.length-16;s+=160,i+=16)r.set(e.subarray(s,s+16),i);return r}getAvcDecryptedUnit(e,t){const r=new Uint8Array(t);let i=0;for(let s=32;s<e.length-16;s+=160,i+=16)e.set(r.subarray(i,i+16),s);return e}decryptAvcSample(e,t,r,i,s){const o=discardEPB(s.data),a=this.getAvcEncryptedData(o);this.decryptBuffer(a.buffer).then(l=>{s.data=this.getAvcDecryptedUnit(o,l),this.decrypter.isSync()||this.decryptAvcSamples(e,t,r+1,i)})}decryptAvcSamples(e,t,r,i){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,r=0){if(t>=e.length){i();return}const s=e[t].units;for(;!(r>=s.length);r++){const o=s[r];if(!(o.data.length<=48||o.type!==1&&o.type!==5)&&(this.decryptAvcSample(e,t,r,i,o),!this.decrypter.isSync()))return}}}}const PACKET_LENGTH=188;class TSDemuxer{constructor(e,t,r){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=e,this.config=t,this.typeSupported=r,this.videoParser=new AvcVideoParser}static probe(e){const t=TSDemuxer.syncOffset(e);return t>0&&logger.warn(`MPEG2-TS detected but first sync word found @ offset ${t}`),t!==-1}static syncOffset(e){const t=e.length;let r=Math.min(PACKET_LENGTH*5,t-PACKET_LENGTH)+1,i=0;for(;i<r;){let s=!1,o=-1,a=0;for(let l=i;l<t;l+=PACKET_LENGTH)if(e[l]===71&&(t-l===PACKET_LENGTH||e[l+PACKET_LENGTH]===71)){if(a++,o===-1&&(o=l,o!==0&&(r=Math.min(o+PACKET_LENGTH*99,e.length-PACKET_LENGTH)+1)),s||(s=parsePID(e,l)===0),s&&a>1&&(o===0&&a>2||l+PACKET_LENGTH>r))return o}else{if(a)return-1;break}i++}return-1}static createTrack(e,t){return{container:e==="video"||e==="audio"?"video/mp2t":void 0,type:e,id:RemuxerTrackIdConfig[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:e==="audio"?t:void 0}}resetInitSegment(e,t,r,i){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=TSDemuxer.createTrack("video"),this._audioTrack=TSDemuxer.createTrack("audio",i),this._id3Track=TSDemuxer.createTrack("id3"),this._txtTrack=TSDemuxer.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=r,this._duration=i}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_videoTrack:t,_id3Track:r}=this;e&&(e.pesData=null),t&&(t.pesData=null),r&&(r.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(e,t,r=!1,i=!1){r||(this.sampleAes=null);let s;const o=this._videoTrack,a=this._audioTrack,l=this._id3Track,c=this._txtTrack;let u=o.pid,d=o.pesData,f=a.pid,m=l.pid,g=a.pesData,v=l.pesData,x=null,S=this.pmtParsed,C=this._pmtId,R=e.length;if(this.remainderData&&(e=appendUint8Array(this.remainderData,e),R=e.length,this.remainderData=null),R<PACKET_LENGTH&&!i)return this.remainderData=e,{audioTrack:a,videoTrack:o,id3Track:l,textTrack:c};const k=Math.max(0,TSDemuxer.syncOffset(e));R-=(R-k)%PACKET_LENGTH,R<e.byteLength&&!i&&(this.remainderData=new Uint8Array(e.buffer,R,e.buffer.byteLength-R));let I=0;for(let N=k;N<R;N+=PACKET_LENGTH)if(e[N]===71){const U=!!(e[N+1]&64),M=parsePID(e,N),B=(e[N+3]&48)>>4;let H;if(B>1){if(H=N+5+e[N+4],H===N+PACKET_LENGTH)continue}else H=N+4;switch(M){case u:U&&(d&&(s=parsePES(d))&&this.videoParser.parseAVCPES(o,c,s,!1,this._duration),d={data:[],size:0}),d&&(d.data.push(e.subarray(H,N+PACKET_LENGTH)),d.size+=N+PACKET_LENGTH-H);break;case f:if(U){if(g&&(s=parsePES(g)))switch(a.segmentCodec){case"aac":this.parseAACPES(a,s);break;case"mp3":this.parseMPEGPES(a,s);break;case"ac3":this.parseAC3PES(a,s);break}g={data:[],size:0}}g&&(g.data.push(e.subarray(H,N+PACKET_LENGTH)),g.size+=N+PACKET_LENGTH-H);break;case m:U&&(v&&(s=parsePES(v))&&this.parseID3PES(l,s),v={data:[],size:0}),v&&(v.data.push(e.subarray(H,N+PACKET_LENGTH)),v.size+=N+PACKET_LENGTH-H);break;case 0:U&&(H+=e[H]+1),C=this._pmtId=parsePAT(e,H);break;case C:{U&&(H+=e[H]+1);const K=parsePMT(e,H,this.typeSupported,r,this.observer);u=K.videoPid,u>0&&(o.pid=u,o.segmentCodec=K.segmentVideoCodec),f=K.audioPid,f>0&&(a.pid=f,a.segmentCodec=K.segmentAudioCodec),m=K.id3Pid,m>0&&(l.pid=m),x!==null&&!S&&(logger.warn(`MPEG-TS PMT found at ${N} after unknown PID '${x}'. Backtracking to sync byte @${k} to parse all TS packets.`),x=null,N=k-188),S=this.pmtParsed=!0;break}case 17:case 8191:break;default:x=M;break}}else I++;I>0&&emitParsingError(this.observer,new Error(`Found ${I} TS packet/s that do not start with 0x47`)),o.pesData=d,a.pesData=g,l.pesData=v;const F={audioTrack:a,videoTrack:o,id3Track:l,textTrack:c};return i&&this.extractRemainingSamples(F),F}flush(){const{remainderData:e}=this;this.remainderData=null;let t;return e?t=this.demux(e,-1,!1,!0):t={videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){const{audioTrack:t,videoTrack:r,id3Track:i,textTrack:s}=e,o=r.pesData,a=t.pesData,l=i.pesData;let c;if(o&&(c=parsePES(o))?(this.videoParser.parseAVCPES(r,s,c,!0,this._duration),r.pesData=null):r.pesData=o,a&&(c=parsePES(a))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,c);break;case"mp3":this.parseMPEGPES(t,c);break;case"ac3":this.parseAC3PES(t,c);break}t.pesData=null}else a!=null&&a.size&&logger.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=a;l&&(c=parsePES(l))?(this.parseID3PES(i,c),i.pesData=null):i.pesData=l}demuxSampleAes(e,t,r){const i=this.demux(e,r,!0,!this.config.progressive),s=this.sampleAes=new SampleAesDecrypter(this.observer,this.config,t);return this.decrypt(i,s)}decrypt(e,t){return new Promise(r=>{const{audioTrack:i,videoTrack:s}=e;i.samples&&i.segmentCodec==="aac"?t.decryptAacSamples(i.samples,0,()=>{s.samples?t.decryptAvcSamples(s.samples,0,0,()=>{r(e)}):r(e)}):s.samples&&t.decryptAvcSamples(s.samples,0,0,()=>{r(e)})})}destroy(){this._duration=0}parseAACPES(e,t){let r=0;const i=this.aacOverFlow;let s=t.data;if(i){this.aacOverFlow=null;const d=i.missing,f=i.sample.unit.byteLength;if(d===-1)s=appendUint8Array(i.sample.unit,s);else{const m=f-d;i.sample.unit.set(s.subarray(0,d),m),e.samples.push(i.sample),r=i.missing}}let o,a;for(o=r,a=s.length;o<a-1&&!isHeader$1(s,o);o++);if(o!==r){let d;const f=o<a-1;if(f?d=`AAC PES did not start with ADTS header,offset:${o}`:d="No ADTS header found in AAC PES",emitParsingError(this.observer,new Error(d),f),!f)return}initTrackConfig(e,this.observer,s,o,this.audioCodec);let l;if(t.pts!==void 0)l=t.pts;else if(i){const d=getFrameDuration(e.samplerate);l=i.sample.pts+d}else{logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}let c=0,u;for(;o<a;)if(u=appendFrame$2(e,s,o,l,c),o+=u.length,u.missing){this.aacOverFlow=u;break}else for(c++;o<a-1&&!isHeader$1(s,o);o++);}parseMPEGPES(e,t){const r=t.data,i=r.length;let s=0,o=0;const a=t.pts;if(a===void 0){logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;o<i;)if(isHeader(r,o)){const l=appendFrame$1(e,r,o,a,s);if(l)o+=l.length,s++;else break}else o++}parseAC3PES(e,t){{const r=t.data,i=t.pts;if(i===void 0){logger.warn("[tsdemuxer]: AC3 PES unknown PTS");return}const s=r.length;let o=0,a=0,l;for(;a<s&&(l=appendFrame(e,r,a,i,o++))>0;)a+=l}}parseID3PES(e,t){if(t.pts===void 0){logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}const r=_extends({},t,{type:this._videoTrack?MetadataSchema.emsg:MetadataSchema.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(r)}}function parsePID(n,e){return((n[e+1]&31)<<8)+n[e+2]}function parsePAT(n,e){return(n[e+10]&31)<<8|n[e+11]}function parsePMT(n,e,t,r,i){const s={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},o=(n[e+1]&15)<<8|n[e+2],a=e+3+o-4,l=(n[e+10]&15)<<8|n[e+11];for(e+=12+l;e<a;){const c=parsePID(n,e),u=(n[e+3]&15)<<8|n[e+4];switch(n[e]){case 207:if(!r){logEncryptedSamplesFoundInUnencryptedStream("ADTS AAC");break}case 15:s.audioPid===-1&&(s.audioPid=c);break;case 21:s.id3Pid===-1&&(s.id3Pid=c);break;case 219:if(!r){logEncryptedSamplesFoundInUnencryptedStream("H.264");break}case 27:s.videoPid===-1&&(s.videoPid=c,s.segmentVideoCodec="avc");break;case 3:case 4:!t.mpeg&&!t.mp3?logger.log("MPEG audio found, not supported in this browser"):s.audioPid===-1&&(s.audioPid=c,s.segmentAudioCodec="mp3");break;case 193:if(!r){logEncryptedSamplesFoundInUnencryptedStream("AC-3");break}case 129:t.ac3?s.audioPid===-1&&(s.audioPid=c,s.segmentAudioCodec="ac3"):logger.log("AC-3 audio found, not supported in this browser");break;case 6:if(s.audioPid===-1&&u>0){let d=e+5,f=u;for(;f>2;){switch(n[d]){case 106:t.ac3!==!0?logger.log("AC-3 audio found, not supported in this browser for now"):(s.audioPid=c,s.segmentAudioCodec="ac3");break}const g=n[d+1]+2;d+=g,f-=g}}break;case 194:case 135:return emitParsingError(i,new Error("Unsupported EC-3 in M2TS found")),s;case 36:return emitParsingError(i,new Error("Unsupported HEVC in M2TS found")),s}e+=u+5}return s}function emitParsingError(n,e,t){logger.warn(`parsing error: ${e.message}`),n.emit(Events.ERROR,Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,levelRetry:t,error:e,reason:e.message})}function logEncryptedSamplesFoundInUnencryptedStream(n){logger.log(`${n} with AES-128-CBC encryption found in unencrypted stream`)}function parsePES(n){let e=0,t,r,i,s,o;const a=n.data;if(!n||n.size===0)return null;for(;a[0].length<19&&a.length>1;)a[0]=appendUint8Array(a[0],a[1]),a.splice(1,1);if(t=a[0],(t[0]<<16)+(t[1]<<8)+t[2]===1){if(r=(t[4]<<8)+t[5],r&&r>n.size-6)return null;const c=t[7];c&192&&(s=(t[9]&14)*536870912+(t[10]&255)*4194304+(t[11]&254)*16384+(t[12]&255)*128+(t[13]&254)/2,c&64?(o=(t[14]&14)*536870912+(t[15]&255)*4194304+(t[16]&254)*16384+(t[17]&255)*128+(t[18]&254)/2,s-o>60*9e4&&(logger.warn(`${Math.round((s-o)/9e4)}s delta between PTS and DTS, align them`),s=o)):o=s),i=t[8];let u=i+9;if(n.size<=u)return null;n.size-=u;const d=new Uint8Array(n.size);for(let f=0,m=a.length;f<m;f++){t=a[f];let g=t.byteLength;if(u)if(u>g){u-=g;continue}else t=t.subarray(u),g-=u,u=0;d.set(t,e),e+=g}return r&&(r-=i+3),{data:d,pts:s,dts:o,len:r}}return null}class MP3Demuxer extends BaseAudioDemuxer{resetInitSegment(e,t,r,i){super.resetInitSegment(e,t,r,i),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=getID3Data(e,0);let r=(t==null?void 0:t.length)||0;if(t&&e[r]===11&&e[r+1]===119&&getTimeStamp(t)!==void 0&&getAudioBSID(e,r)<=16)return!1;for(let i=e.length;r<i;r++)if(probe(e,r))return logger.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return canParse(e,t)}appendFrame(e,t,r){if(this.basePTS!==null)return appendFrame$1(e,t,r,this.basePTS,this.frameIndex)}}class AAC{static getSilentFrame(e,t){switch(e){case"mp4a.40.2":if(t===1)return new Uint8Array([0,200,0,128,35,128]);if(t===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(t===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(t===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(t===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(t===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(t===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const UINT32_MAX=Math.pow(2,32)-1;class MP4{static init(){MP4.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let e;for(e in MP4.types)MP4.types.hasOwnProperty(e)&&(MP4.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),r=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);MP4.HDLR_TYPES={video:t,audio:r};const i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),s=new Uint8Array([0,0,0,0,0,0,0,0]);MP4.STTS=MP4.STSC=MP4.STCO=s,MP4.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),MP4.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),MP4.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),MP4.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const o=new Uint8Array([105,115,111,109]),a=new Uint8Array([97,118,99,49]),l=new Uint8Array([0,0,0,1]);MP4.FTYP=MP4.box(MP4.types.ftyp,o,l,o,a),MP4.DINF=MP4.box(MP4.types.dinf,MP4.box(MP4.types.dref,i))}static box(e,...t){let r=8,i=t.length;const s=i;for(;i--;)r+=t[i].byteLength;const o=new Uint8Array(r);for(o[0]=r>>24&255,o[1]=r>>16&255,o[2]=r>>8&255,o[3]=r&255,o.set(e,4),i=0,r=8;i<s;i++)o.set(t[i],r),r+=t[i].byteLength;return o}static hdlr(e){return MP4.box(MP4.types.hdlr,MP4.HDLR_TYPES[e])}static mdat(e){return MP4.box(MP4.types.mdat,e)}static mdhd(e,t){t*=e;const r=Math.floor(t/(UINT32_MAX+1)),i=Math.floor(t%(UINT32_MAX+1));return MP4.box(MP4.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,r>>24,r>>16&255,r>>8&255,r&255,i>>24,i>>16&255,i>>8&255,i&255,85,196,0,0]))}static mdia(e){return MP4.box(MP4.types.mdia,MP4.mdhd(e.timescale,e.duration),MP4.hdlr(e.type),MP4.minf(e))}static mfhd(e){return MP4.box(MP4.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,e&255]))}static minf(e){return e.type==="audio"?MP4.box(MP4.types.minf,MP4.box(MP4.types.smhd,MP4.SMHD),MP4.DINF,MP4.stbl(e)):MP4.box(MP4.types.minf,MP4.box(MP4.types.vmhd,MP4.VMHD),MP4.DINF,MP4.stbl(e))}static moof(e,t,r){return MP4.box(MP4.types.moof,MP4.mfhd(e),MP4.traf(r,t))}static moov(e){let t=e.length;const r=[];for(;t--;)r[t]=MP4.trak(e[t]);return MP4.box.apply(null,[MP4.types.moov,MP4.mvhd(e[0].timescale,e[0].duration)].concat(r).concat(MP4.mvex(e)))}static mvex(e){let t=e.length;const r=[];for(;t--;)r[t]=MP4.trex(e[t]);return MP4.box.apply(null,[MP4.types.mvex,...r])}static mvhd(e,t){t*=e;const r=Math.floor(t/(UINT32_MAX+1)),i=Math.floor(t%(UINT32_MAX+1)),s=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,r>>24,r>>16&255,r>>8&255,r&255,i>>24,i>>16&255,i>>8&255,i&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return MP4.box(MP4.types.mvhd,s)}static sdtp(e){const t=e.samples||[],r=new Uint8Array(4+t.length);let i,s;for(i=0;i<t.length;i++)s=t[i].flags,r[i+4]=s.dependsOn<<4|s.isDependedOn<<2|s.hasRedundancy;return MP4.box(MP4.types.sdtp,r)}static stbl(e){return MP4.box(MP4.types.stbl,MP4.stsd(e),MP4.box(MP4.types.stts,MP4.STTS),MP4.box(MP4.types.stsc,MP4.STSC),MP4.box(MP4.types.stsz,MP4.STSZ),MP4.box(MP4.types.stco,MP4.STCO))}static avc1(e){let t=[],r=[],i,s,o;for(i=0;i<e.sps.length;i++)s=e.sps[i],o=s.byteLength,t.push(o>>>8&255),t.push(o&255),t=t.concat(Array.prototype.slice.call(s));for(i=0;i<e.pps.length;i++)s=e.pps[i],o=s.byteLength,r.push(o>>>8&255),r.push(o&255),r=r.concat(Array.prototype.slice.call(s));const a=MP4.box(MP4.types.avcC,new Uint8Array([1,t[3],t[4],t[5],255,224|e.sps.length].concat(t).concat([e.pps.length]).concat(r))),l=e.width,c=e.height,u=e.pixelRatio[0],d=e.pixelRatio[1];return MP4.box(MP4.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,l&255,c>>8&255,c&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),a,MP4.box(MP4.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),MP4.box(MP4.types.pasp,new Uint8Array([u>>24,u>>16&255,u>>8&255,u&255,d>>24,d>>16&255,d>>8&255,d&255])))}static esds(e){const t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))}static audioStsd(e){const t=e.samplerate;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,t&255,0,0])}static mp4a(e){return MP4.box(MP4.types.mp4a,MP4.audioStsd(e),MP4.box(MP4.types.esds,MP4.esds(e)))}static mp3(e){return MP4.box(MP4.types[".mp3"],MP4.audioStsd(e))}static ac3(e){return MP4.box(MP4.types["ac-3"],MP4.audioStsd(e),MP4.box(MP4.types.dac3,e.config))}static stsd(e){return e.type==="audio"?e.segmentCodec==="mp3"&&e.codec==="mp3"?MP4.box(MP4.types.stsd,MP4.STSD,MP4.mp3(e)):e.segmentCodec==="ac3"?MP4.box(MP4.types.stsd,MP4.STSD,MP4.ac3(e)):MP4.box(MP4.types.stsd,MP4.STSD,MP4.mp4a(e)):MP4.box(MP4.types.stsd,MP4.STSD,MP4.avc1(e))}static tkhd(e){const t=e.id,r=e.duration*e.timescale,i=e.width,s=e.height,o=Math.floor(r/(UINT32_MAX+1)),a=Math.floor(r%(UINT32_MAX+1));return MP4.box(MP4.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,0,0,0,0,o>>24,o>>16&255,o>>8&255,o&255,a>>24,a>>16&255,a>>8&255,a&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,i>>8&255,i&255,0,0,s>>8&255,s&255,0,0]))}static traf(e,t){const r=MP4.sdtp(e),i=e.id,s=Math.floor(t/(UINT32_MAX+1)),o=Math.floor(t%(UINT32_MAX+1));return MP4.box(MP4.types.traf,MP4.box(MP4.types.tfhd,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,i&255])),MP4.box(MP4.types.tfdt,new Uint8Array([1,0,0,0,s>>24,s>>16&255,s>>8&255,s&255,o>>24,o>>16&255,o>>8&255,o&255])),MP4.trun(e,r.length+16+20+8+16+8+8),r)}static trak(e){return e.duration=e.duration||4294967295,MP4.box(MP4.types.trak,MP4.tkhd(e),MP4.mdia(e))}static trex(e){const t=e.id;return MP4.box(MP4.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){const r=e.samples||[],i=r.length,s=12+16*i,o=new Uint8Array(s);let a,l,c,u,d,f;for(t+=8+s,o.set([e.type==="video"?1:0,0,15,1,i>>>24&255,i>>>16&255,i>>>8&255,i&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255],0),a=0;a<i;a++)l=r[a],c=l.duration,u=l.size,d=l.flags,f=l.cts,o.set([c>>>24&255,c>>>16&255,c>>>8&255,c&255,u>>>24&255,u>>>16&255,u>>>8&255,u&255,d.isLeading<<2|d.dependsOn,d.isDependedOn<<6|d.hasRedundancy<<4|d.paddingValue<<1|d.isNonSync,d.degradPrio&61440,d.degradPrio&15,f>>>24&255,f>>>16&255,f>>>8&255,f&255],12+16*a);return MP4.box(MP4.types.trun,o)}static initSegment(e){MP4.types||MP4.init();const t=MP4.moov(e);return appendUint8Array(MP4.FTYP,t)}}MP4.types=void 0;MP4.HDLR_TYPES=void 0;MP4.STTS=void 0;MP4.STSC=void 0;MP4.STCO=void 0;MP4.STSZ=void 0;MP4.VMHD=void 0;MP4.SMHD=void 0;MP4.STSD=void 0;MP4.FTYP=void 0;MP4.DINF=void 0;const MPEG_TS_CLOCK_FREQ_HZ=9e4;function toTimescaleFromBase(n,e,t=1,r=!1){const i=n*e*t;return r?Math.round(i):i}function toTimescaleFromScale(n,e,t=1,r=!1){return toTimescaleFromBase(n,e,1/t,r)}function toMsFromMpegTsClock(n,e=!1){return toTimescaleFromBase(n,1e3,1/MPEG_TS_CLOCK_FREQ_HZ,e)}function toMpegTsClockFromTimescale(n,e=1){return toTimescaleFromBase(n,MPEG_TS_CLOCK_FREQ_HZ,1/e)}const MAX_SILENT_FRAME_DURATION=10*1e3,AAC_SAMPLES_PER_FRAME=1024,MPEG_AUDIO_SAMPLE_PER_FRAME=1152,AC3_SAMPLES_PER_FRAME=1536;let chromeVersion=null,safariWebkitVersion=null;class MP4Remuxer{constructor(e,t,r,i=""){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=e,this.config=t,this.typeSupported=r,this.ISGenerated=!1,chromeVersion===null){const o=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);chromeVersion=o?parseInt(o[1]):0}if(safariWebkitVersion===null){const s=navigator.userAgent.match(/Safari\/(\d+)/i);safariWebkitVersion=s?parseInt(s[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(e){logger.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=e}resetNextTimestamp(){logger.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){logger.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(e){let t=!1;const r=e.reduce((i,s)=>{const o=s.pts-i;return o<-4294967296?(t=!0,normalizePts(i,s.pts)):o>0?i:s.pts},e[0].pts);return t&&logger.debug("PTS rollover detected"),r}remux(e,t,r,i,s,o,a,l){let c,u,d,f,m,g,v=s,x=s;const S=e.pid>-1,C=t.pid>-1,R=t.samples.length,k=e.samples.length>0,I=a&&R>0||R>1;if((!S||k)&&(!C||I)||this.ISGenerated||a){if(this.ISGenerated){var N,U,M,B;const oe=this.videoTrackConfig;oe&&(t.width!==oe.width||t.height!==oe.height||((N=t.pixelRatio)==null?void 0:N[0])!==((U=oe.pixelRatio)==null?void 0:U[0])||((M=t.pixelRatio)==null?void 0:M[1])!==((B=oe.pixelRatio)==null?void 0:B[1]))&&this.resetInitSegment()}else d=this.generateIS(e,t,s,o);const H=this.isVideoContiguous;let K=-1,Y;if(I&&(K=findKeyframeIndex(t.samples),!H&&this.config.forceKeyFrameOnDiscontinuity))if(g=!0,K>0){logger.warn(`[mp4-remuxer]: Dropped ${K} out of ${R} video samples due to a missing keyframe`);const oe=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(K),t.dropped+=K,x+=(t.samples[0].pts-oe)/t.inputTimeScale,Y=x}else K===-1&&(logger.warn(`[mp4-remuxer]: No keyframe found out of ${R} video samples`),g=!1);if(this.ISGenerated){if(k&&I){const oe=this.getVideoStartPts(t.samples),Z=(normalizePts(e.samples[0].pts,oe)-oe)/t.inputTimeScale;v+=Math.max(0,Z),x+=Math.max(0,-Z)}if(k){if(e.samplerate||(logger.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),d=this.generateIS(e,t,s,o)),u=this.remuxAudio(e,v,this.isAudioContiguous,o,C||I||l===PlaylistLevelType.AUDIO?x:void 0),I){const oe=u?u.endPTS-u.startPTS:0;t.inputTimeScale||(logger.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),d=this.generateIS(e,t,s,o)),c=this.remuxVideo(t,x,H,oe)}}else I&&(c=this.remuxVideo(t,x,H,0));c&&(c.firstKeyFrame=K,c.independent=K!==-1,c.firstKeyFramePTS=Y)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(r.samples.length&&(m=flushTextTrackMetadataCueSamples(r,s,this._initPTS,this._initDTS)),i.samples.length&&(f=flushTextTrackUserdataCueSamples(i,s,this._initPTS))),{audio:u,video:c,initSegment:d,independent:g,text:f,id3:m}}generateIS(e,t,r,i){const s=e.samples,o=t.samples,a=this.typeSupported,l={},c=this._initPTS;let u=!c||i,d="audio/mp4",f,m,g;if(u&&(f=m=1/0),e.config&&s.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":a.mpeg?(d="audio/mpeg",e.codec=""):a.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3";break}l.audio={id:"audio",container:d,codec:e.codec,initSegment:e.segmentCodec==="mp3"&&a.mpeg?new Uint8Array(0):MP4.initSegment([e]),metadata:{channelCount:e.channelCount}},u&&(g=e.inputTimeScale,!c||g!==c.timescale?f=m=s[0].pts-Math.round(g*r):u=!1)}if(t.sps&&t.pps&&o.length){if(t.timescale=t.inputTimeScale,l.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:MP4.initSegment([t]),metadata:{width:t.width,height:t.height}},u)if(g=t.inputTimeScale,!c||g!==c.timescale){const v=this.getVideoStartPts(o),x=Math.round(g*r);m=Math.min(m,normalizePts(o[0].dts,v)-x),f=Math.min(f,v-x)}else u=!1;this.videoTrackConfig={width:t.width,height:t.height,pixelRatio:t.pixelRatio}}if(Object.keys(l).length)return this.ISGenerated=!0,u?(this._initPTS={baseTime:f,timescale:g},this._initDTS={baseTime:m,timescale:g}):f=g=void 0,{tracks:l,initPTS:f,timescale:g}}remuxVideo(e,t,r,i){const s=e.inputTimeScale,o=e.samples,a=[],l=o.length,c=this._initPTS;let u=this.nextAvcDts,d=8,f=this.videoSampleDuration,m,g,v=Number.POSITIVE_INFINITY,x=Number.NEGATIVE_INFINITY,S=!1;if(!r||u===null){const $=t*s,W=o[0].pts-normalizePts(o[0].dts,o[0].pts);chromeVersion&&u!==null&&Math.abs($-W-u)<15e3?r=!0:u=$-W}const C=c.baseTime*s/c.timescale;for(let $=0;$<l;$++){const W=o[$];W.pts=normalizePts(W.pts-C,u),W.dts=normalizePts(W.dts-C,u),W.dts<o[$>0?$-1:$].dts&&(S=!0)}S&&o.sort(function($,W){const J=$.dts-W.dts,ne=$.pts-W.pts;return J||ne}),m=o[0].dts,g=o[o.length-1].dts;const R=g-m,k=R?Math.round(R/(l-1)):f||e.inputTimeScale/30;if(r){const $=m-u,W=$>k,J=$<-1;if((W||J)&&(W?logger.warn(`AVC: ${toMsFromMpegTsClock($,!0)} ms (${$}dts) hole between fragments detected at ${t.toFixed(3)}`):logger.warn(`AVC: ${toMsFromMpegTsClock(-$,!0)} ms (${$}dts) overlapping between fragments detected at ${t.toFixed(3)}`),!J||u>=o[0].pts||chromeVersion)){m=u;const ne=o[0].pts-$;if(W)o[0].dts=m,o[0].pts=ne;else for(let ve=0;ve<o.length&&!(o[ve].dts>ne);ve++)o[ve].dts-=$,o[ve].pts-=$;logger.log(`Video: Initial PTS/DTS adjusted: ${toMsFromMpegTsClock(ne,!0)}/${toMsFromMpegTsClock(m,!0)}, delta: ${toMsFromMpegTsClock($,!0)} ms`)}}m=Math.max(0,m);let I=0,F=0,N=m;for(let $=0;$<l;$++){const W=o[$],J=W.units,ne=J.length;let ve=0;for(let Re=0;Re<ne;Re++)ve+=J[Re].data.length;F+=ve,I+=ne,W.length=ve,W.dts<N?(W.dts=N,N+=k/4|0||1):N=W.dts,v=Math.min(W.pts,v),x=Math.max(W.pts,x)}g=o[l-1].dts;const U=F+4*I+8;let M;try{M=new Uint8Array(U)}catch($){this.observer.emit(Events.ERROR,Events.ERROR,{type:ErrorTypes.MUX_ERROR,details:ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,error:$,bytes:U,reason:`fail allocating video mdat ${U}`});return}const B=new DataView(M.buffer);B.setUint32(0,U),M.set(MP4.types.mdat,4);let H=!1,K=Number.POSITIVE_INFINITY,Y=Number.POSITIVE_INFINITY,oe=Number.NEGATIVE_INFINITY,ue=Number.NEGATIVE_INFINITY;for(let $=0;$<l;$++){const W=o[$],J=W.units;let ne=0;for(let Le=0,Ce=J.length;Le<Ce;Le++){const j=J[Le],ae=j.data,ie=j.data.byteLength;B.setUint32(d,ie),d+=4,M.set(ae,d),d+=ie,ne+=4+ie}let ve;if($<l-1)f=o[$+1].dts-W.dts,ve=o[$+1].pts-W.pts;else{const Le=this.config,Ce=$>0?W.dts-o[$-1].dts:k;if(ve=$>0?W.pts-o[$-1].pts:k,Le.stretchShortVideoTrack&&this.nextAudioPts!==null){const j=Math.floor(Le.maxBufferHole*s),ae=(i?v+i*s:this.nextAudioPts)-W.pts;ae>j?(f=ae-Ce,f<0?f=Ce:H=!0,logger.log(`[mp4-remuxer]: It is approximately ${ae/90} ms to the next segment; using duration ${f/90} ms for the last video frame.`)):f=Ce}else f=Ce}const Re=Math.round(W.pts-W.dts);K=Math.min(K,f),oe=Math.max(oe,f),Y=Math.min(Y,ve),ue=Math.max(ue,ve),a.push(new Mp4Sample(W.key,f,ne,Re))}if(a.length){if(chromeVersion){if(chromeVersion<70){const $=a[0].flags;$.dependsOn=2,$.isNonSync=0}}else if(safariWebkitVersion&&ue-Y<oe-K&&k/oe<.025&&a[0].cts===0){logger.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let $=m;for(let W=0,J=a.length;W<J;W++){const ne=$+a[W].duration,ve=$+a[W].cts;if(W<J-1){const Re=ne+a[W+1].cts;a[W].duration=Re-ve}else a[W].duration=W?a[W-1].duration:k;a[W].cts=0,$=ne}}}f=H||!f?k:f,this.nextAvcDts=u=g+f,this.videoSampleDuration=f,this.isVideoContiguous=!0;const ye={data1:MP4.moof(e.sequenceNumber++,m,_extends({},e,{samples:a})),data2:M,startPTS:v/s,endPTS:(x+f)/s,startDTS:m/s,endDTS:u/s,type:"video",hasAudio:!1,hasVideo:!0,nb:a.length,dropped:e.dropped};return e.samples=[],e.dropped=0,ye}getSamplesPerFrame(e){switch(e.segmentCodec){case"mp3":return MPEG_AUDIO_SAMPLE_PER_FRAME;case"ac3":return AC3_SAMPLES_PER_FRAME;default:return AAC_SAMPLES_PER_FRAME}}remuxAudio(e,t,r,i,s){const o=e.inputTimeScale,a=e.samplerate?e.samplerate:o,l=o/a,c=this.getSamplesPerFrame(e),u=c*l,d=this._initPTS,f=e.segmentCodec==="mp3"&&this.typeSupported.mpeg,m=[],g=s!==void 0;let v=e.samples,x=f?0:8,S=this.nextAudioPts||-1;const C=t*o,R=d.baseTime*o/d.timescale;if(this.isAudioContiguous=r=r||v.length&&S>0&&(i&&Math.abs(C-S)<9e3||Math.abs(normalizePts(v[0].pts-R,C)-S)<20*u),v.forEach(function(Z){Z.pts=normalizePts(Z.pts-R,C)}),!r||S<0){if(v=v.filter(Z=>Z.pts>=0),!v.length)return;s===0?S=0:i&&!g?S=Math.max(0,C):S=v[0].pts}if(e.segmentCodec==="aac"){const Z=this.config.maxAudioFramesDrift;for(let Ae=0,ye=S;Ae<v.length;Ae++){const $=v[Ae],W=$.pts,J=W-ye,ne=Math.abs(1e3*J/o);if(J<=-Z*u&&g)Ae===0&&(logger.warn(`Audio frame @ ${(W/o).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*J/o)} ms.`),this.nextAudioPts=S=ye=W);else if(J>=Z*u&&ne<MAX_SILENT_FRAME_DURATION&&g){let ve=Math.round(J/u);ye=W-ve*u,ye<0&&(ve--,ye+=u),Ae===0&&(this.nextAudioPts=S=ye),logger.warn(`[mp4-remuxer]: Injecting ${ve} audio frame @ ${(ye/o).toFixed(3)}s due to ${Math.round(1e3*J/o)} ms gap.`);for(let Re=0;Re<ve;Re++){const Le=Math.max(ye,0);let Ce=AAC.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);Ce||(logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),Ce=$.unit.subarray()),v.splice(Ae,0,{unit:Ce,pts:Le}),ye+=u,Ae++}}$.pts=ye,ye+=u}}let k=null,I=null,F,N=0,U=v.length;for(;U--;)N+=v[U].unit.byteLength;for(let Z=0,Ae=v.length;Z<Ae;Z++){const ye=v[Z],$=ye.unit;let W=ye.pts;if(I!==null){const ne=m[Z-1];ne.duration=Math.round((W-I)/l)}else if(r&&e.segmentCodec==="aac"&&(W=S),k=W,N>0){N+=x;try{F=new Uint8Array(N)}catch(ne){this.observer.emit(Events.ERROR,Events.ERROR,{type:ErrorTypes.MUX_ERROR,details:ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,error:ne,bytes:N,reason:`fail allocating audio mdat ${N}`});return}f||(new DataView(F.buffer).setUint32(0,N),F.set(MP4.types.mdat,4))}else return;F.set($,x);const J=$.byteLength;x+=J,m.push(new Mp4Sample(!0,c,J,0)),I=W}const M=m.length;if(!M)return;const B=m[m.length-1];this.nextAudioPts=S=I+l*B.duration;const H=f?new Uint8Array(0):MP4.moof(e.sequenceNumber++,k/l,_extends({},e,{samples:m}));e.samples=[];const K=k/o,Y=S/o,ue={data1:H,data2:F,startPTS:K,endPTS:Y,startDTS:K,endDTS:Y,type:"audio",hasAudio:!0,hasVideo:!1,nb:M};return this.isAudioContiguous=!0,ue}remuxEmptyAudio(e,t,r,i){const s=e.inputTimeScale,o=e.samplerate?e.samplerate:s,a=s/o,l=this.nextAudioPts,c=this._initDTS,u=c.baseTime*9e4/c.timescale,d=(l!==null?l:i.startDTS*s)+u,f=i.endDTS*s+u,m=a*AAC_SAMPLES_PER_FRAME,g=Math.ceil((f-d)/m),v=AAC.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(logger.warn("[mp4-remuxer]: remux empty Audio"),!v){logger.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");return}const x=[];for(let S=0;S<g;S++){const C=d+S*m;x.push({unit:v,pts:C,dts:C})}return e.samples=x,this.remuxAudio(e,t,r,!1)}}function normalizePts(n,e){let t;if(e===null)return n;for(e<n?t=-8589934592:t=8589934592;Math.abs(n-e)>4294967296;)n+=t;return n}function findKeyframeIndex(n){for(let e=0;e<n.length;e++)if(n[e].key)return e;return-1}function flushTextTrackMetadataCueSamples(n,e,t,r){const i=n.samples.length;if(!i)return;const s=n.inputTimeScale;for(let a=0;a<i;a++){const l=n.samples[a];l.pts=normalizePts(l.pts-t.baseTime*s/t.timescale,e*s)/s,l.dts=normalizePts(l.dts-r.baseTime*s/r.timescale,e*s)/s}const o=n.samples;return n.samples=[],{samples:o}}function flushTextTrackUserdataCueSamples(n,e,t){const r=n.samples.length;if(!r)return;const i=n.inputTimeScale;for(let o=0;o<r;o++){const a=n.samples[o];a.pts=normalizePts(a.pts-t.baseTime*i/t.timescale,e*i)/i}n.samples.sort((o,a)=>o.pts-a.pts);const s=n.samples;return n.samples=[],{samples:s}}class Mp4Sample{constructor(e,t,r,i){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=t,this.size=r,this.cts=i,this.flags={isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:e?2:1,isNonSync:e?0:1}}}class PassThroughRemuxer{constructor(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null}destroy(){}resetTimeStamp(e){this.initPTS=e,this.lastEndTime=null}resetNextTimestamp(){this.lastEndTime=null}resetInitSegment(e,t,r,i){this.audioCodec=t,this.videoCodec=r,this.generateInitSegment(patchEncyptionData(e,i)),this.emitInitSegment=!0}generateInitSegment(e){let{audioCodec:t,videoCodec:r}=this;if(!(e!=null&&e.byteLength)){this.initTracks=void 0,this.initData=void 0;return}const i=this.initData=parseInitSegment(e);i.audio&&(t=getParsedTrackCodec(i.audio,ElementaryStreamTypes.AUDIO)),i.video&&(r=getParsedTrackCodec(i.video,ElementaryStreamTypes.VIDEO));const s={};i.audio&&i.video?s.audiovideo={container:"video/mp4",codec:t+","+r,initSegment:e,id:"main"}:i.audio?s.audio={container:"audio/mp4",codec:t,initSegment:e,id:"audio"}:i.video?s.video={container:"video/mp4",codec:r,initSegment:e,id:"main"}:logger.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=s}remux(e,t,r,i,s,o){var a,l;let{initPTS:c,lastEndTime:u}=this;const d={audio:void 0,video:void 0,text:i,id3:r,initSegment:void 0};isFiniteNumber(u)||(u=this.lastEndTime=s||0);const f=t.samples;if(!(f!=null&&f.length))return d;const m={initPTS:void 0,timescale:1};let g=this.initData;if((a=g)!=null&&a.length||(this.generateInitSegment(f),g=this.initData),!((l=g)!=null&&l.length))return logger.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),d;this.emitInitSegment&&(m.tracks=this.initTracks,this.emitInitSegment=!1);const v=getDuration(f,g),x=getStartDTS(g,f),S=x===null?s:x;(isInvalidInitPts(c,S,s,v)||m.timescale!==c.timescale&&o)&&(m.initPTS=S-s,c&&c.timescale===1&&logger.warn(`Adjusting initPTS by ${m.initPTS-c.baseTime}`),this.initPTS=c={baseTime:m.initPTS,timescale:1});const C=e?S-c.baseTime/c.timescale:u,R=C+v;offsetStartDTS(g,f,c.baseTime/c.timescale),v>0?this.lastEndTime=R:(logger.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const k=!!g.audio,I=!!g.video;let F="";k&&(F+="audio"),I&&(F+="video");const N={data1:f,startPTS:C,startDTS:C,endPTS:R,endDTS:R,type:F,hasAudio:k,hasVideo:I,nb:1,dropped:0};return d.audio=N.type==="audio"?N:void 0,d.video=N.type!=="audio"?N:void 0,d.initSegment=m,d.id3=flushTextTrackMetadataCueSamples(r,s,c,c),i.samples.length&&(d.text=flushTextTrackUserdataCueSamples(i,s,c)),d}}function isInvalidInitPts(n,e,t,r){if(n===null)return!0;const i=Math.max(r,1),s=e-n.baseTime/n.timescale;return Math.abs(s-t)>i}function getParsedTrackCodec(n,e){const t=n==null?void 0:n.codec;if(t&&t.length>4)return t;if(e===ElementaryStreamTypes.AUDIO){if(t==="ec-3"||t==="ac-3"||t==="alac")return t;if(t==="fLaC"||t==="Opus")return getCodecCompatibleName(t,!1);const r="mp4a.40.5";return logger.info(`Parsed audio codec "${t}" or audio object type not handled. Using "${r}"`),r}return logger.warn(`Unhandled video codec "${t}"`),t==="hvc1"||t==="hev1"?"hvc1.1.6.L120.90":t==="av01"?"av01.0.04M.08":"avc1.42e01e"}let now;try{now=self.performance.now.bind(self.performance)}catch(n){logger.debug("Unable to use Performance API on this environment"),now=optionalSelf==null?void 0:optionalSelf.Date.now}const muxConfig=[{demux:MP4Demuxer,remux:PassThroughRemuxer},{demux:TSDemuxer,remux:MP4Remuxer},{demux:AACDemuxer,remux:MP4Remuxer},{demux:MP3Demuxer,remux:MP4Remuxer}];muxConfig.splice(2,0,{demux:AC3Demuxer,remux:MP4Remuxer});class Transmuxer{constructor(e,t,r,i,s){this.async=!1,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=r,this.vendor=i,this.id=s}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,r,i){const s=r.transmuxing;s.executeStart=now();let o=new Uint8Array(e);const{currentTransmuxState:a,transmuxConfig:l}=this;i&&(this.currentTransmuxState=i);const{contiguous:c,discontinuity:u,trackSwitch:d,accurateTimeOffset:f,timeOffset:m,initSegmentChange:g}=i||a,{audioCodec:v,videoCodec:x,defaultInitPts:S,duration:C,initSegmentData:R}=l,k=getEncryptionType(o,t);if(k&&k.method==="AES-128"){const U=this.getDecrypter();if(U.isSync()){let M=U.softwareDecrypt(o,k.key.buffer,k.iv.buffer);if(r.part>-1&&(M=U.flush()),!M)return s.executeEnd=now(),emptyResult(r);o=new Uint8Array(M)}else return this.decryptionPromise=U.webCryptoDecrypt(o,k.key.buffer,k.iv.buffer).then(M=>{const B=this.push(M,null,r);return this.decryptionPromise=null,B}),this.decryptionPromise}const I=this.needsProbing(u,d);if(I){const U=this.configureTransmuxer(o);if(U)return logger.warn(`[transmuxer] ${U.message}`),this.observer.emit(Events.ERROR,Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,error:U,reason:U.message}),s.executeEnd=now(),emptyResult(r)}(u||d||g||I)&&this.resetInitSegment(R,v,x,C,t),(u||g||I)&&this.resetInitialTimestamp(S),c||this.resetContiguity();const F=this.transmux(o,k,m,f,r),N=this.currentTransmuxState;return N.contiguous=!0,N.discontinuity=!1,N.trackSwitch=!1,s.executeEnd=now(),F}flush(e){const t=e.transmuxing;t.executeStart=now();const{decrypter:r,currentTransmuxState:i,decryptionPromise:s}=this;if(s)return s.then(()=>this.flush(e));const o=[],{timeOffset:a}=i;if(r){const d=r.flush();d&&o.push(this.push(d,null,e))}const{demuxer:l,remuxer:c}=this;if(!l||!c)return t.executeEnd=now(),[emptyResult(e)];const u=l.flush(a);return isPromise(u)?u.then(d=>(this.flushRemux(o,d,e),o)):(this.flushRemux(o,u,e),o)}flushRemux(e,t,r){const{audioTrack:i,videoTrack:s,id3Track:o,textTrack:a}=t,{accurateTimeOffset:l,timeOffset:c}=this.currentTransmuxState;logger.log(`[transmuxer.ts]: Flushed fragment ${r.sn}${r.part>-1?" p: "+r.part:""} of level ${r.level}`);const u=this.remuxer.remux(i,s,o,a,c,l,!0,this.id);e.push({remuxResult:u,chunkMeta:r}),r.transmuxing.executeEnd=now()}resetInitialTimestamp(e){const{demuxer:t,remuxer:r}=this;!t||!r||(t.resetTimeStamp(e),r.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:t}=this;!e||!t||(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,r,i,s){const{demuxer:o,remuxer:a}=this;!o||!a||(o.resetInitSegment(e,t,r,i),a.resetInitSegment(e,t,r,s))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,r,i,s){let o;return t&&t.method==="SAMPLE-AES"?o=this.transmuxSampleAes(e,t,r,i,s):o=this.transmuxUnencrypted(e,r,i,s),o}transmuxUnencrypted(e,t,r,i){const{audioTrack:s,videoTrack:o,id3Track:a,textTrack:l}=this.demuxer.demux(e,t,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(s,o,a,l,t,r,!1,this.id),chunkMeta:i}}transmuxSampleAes(e,t,r,i,s){return this.demuxer.demuxSampleAes(e,t,r).then(o=>({remuxResult:this.remuxer.remux(o.audioTrack,o.videoTrack,o.id3Track,o.textTrack,r,i,!1,this.id),chunkMeta:s}))}configureTransmuxer(e){const{config:t,observer:r,typeSupported:i,vendor:s}=this;let o;for(let f=0,m=muxConfig.length;f<m;f++){var a;if((a=muxConfig[f].demux)!=null&&a.probe(e)){o=muxConfig[f];break}}if(!o)return new Error("Failed to find demuxer by probing fragment data");const l=this.demuxer,c=this.remuxer,u=o.remux,d=o.demux;(!c||!(c instanceof u))&&(this.remuxer=new u(r,t,i,s)),(!l||!(l instanceof d))&&(this.demuxer=new d(r,t,i),this.probe=d.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new Decrypter(this.config)),e}}function getEncryptionType(n,e){let t=null;return n.byteLength>0&&(e==null?void 0:e.key)!=null&&e.iv!==null&&e.method!=null&&(t=e),t}const emptyResult=n=>({remuxResult:{},chunkMeta:n});function isPromise(n){return"then"in n&&n.then instanceof Function}class TransmuxConfig{constructor(e,t,r,i,s){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=r,this.duration=i,this.defaultInitPts=s||null}}class TransmuxState{constructor(e,t,r,i,s,o){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=r,this.trackSwitch=i,this.timeOffset=s,this.initSegmentChange=o}}var eventemitter3={exports:{}};(function(n){var e=Object.prototype.hasOwnProperty,t="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(t=!1));function i(l,c,u){this.fn=l,this.context=c,this.once=u||!1}function s(l,c,u,d,f){if(typeof u!="function")throw new TypeError("The listener must be a function");var m=new i(u,d||l,f),g=t?t+c:c;return l._events[g]?l._events[g].fn?l._events[g]=[l._events[g],m]:l._events[g].push(m):(l._events[g]=m,l._eventsCount++),l}function o(l,c){--l._eventsCount===0?l._events=new r:delete l._events[c]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var c=[],u,d;if(this._eventsCount===0)return c;for(d in u=this._events)e.call(u,d)&&c.push(t?d.slice(1):d);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},a.prototype.listeners=function(c){var u=t?t+c:c,d=this._events[u];if(!d)return[];if(d.fn)return[d.fn];for(var f=0,m=d.length,g=new Array(m);f<m;f++)g[f]=d[f].fn;return g},a.prototype.listenerCount=function(c){var u=t?t+c:c,d=this._events[u];return d?d.fn?1:d.length:0},a.prototype.emit=function(c,u,d,f,m,g){var v=t?t+c:c;if(!this._events[v])return!1;var x=this._events[v],S=arguments.length,C,R;if(x.fn){switch(x.once&&this.removeListener(c,x.fn,void 0,!0),S){case 1:return x.fn.call(x.context),!0;case 2:return x.fn.call(x.context,u),!0;case 3:return x.fn.call(x.context,u,d),!0;case 4:return x.fn.call(x.context,u,d,f),!0;case 5:return x.fn.call(x.context,u,d,f,m),!0;case 6:return x.fn.call(x.context,u,d,f,m,g),!0}for(R=1,C=new Array(S-1);R<S;R++)C[R-1]=arguments[R];x.fn.apply(x.context,C)}else{var k=x.length,I;for(R=0;R<k;R++)switch(x[R].once&&this.removeListener(c,x[R].fn,void 0,!0),S){case 1:x[R].fn.call(x[R].context);break;case 2:x[R].fn.call(x[R].context,u);break;case 3:x[R].fn.call(x[R].context,u,d);break;case 4:x[R].fn.call(x[R].context,u,d,f);break;default:if(!C)for(I=1,C=new Array(S-1);I<S;I++)C[I-1]=arguments[I];x[R].fn.apply(x[R].context,C)}}return!0},a.prototype.on=function(c,u,d){return s(this,c,u,d,!1)},a.prototype.once=function(c,u,d){return s(this,c,u,d,!0)},a.prototype.removeListener=function(c,u,d,f){var m=t?t+c:c;if(!this._events[m])return this;if(!u)return o(this,m),this;var g=this._events[m];if(g.fn)g.fn===u&&(!f||g.once)&&(!d||g.context===d)&&o(this,m);else{for(var v=0,x=[],S=g.length;v<S;v++)(g[v].fn!==u||f&&!g[v].once||d&&g[v].context!==d)&&x.push(g[v]);x.length?this._events[m]=x.length===1?x[0]:x:o(this,m)}return this},a.prototype.removeAllListeners=function(c){var u;return c?(u=t?t+c:c,this._events[u]&&o(this,u)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=t,a.EventEmitter=a,n.exports=a})(eventemitter3);var eventemitter3Exports=eventemitter3.exports,EventEmitter=getDefaultExportFromCjs(eventemitter3Exports);class TransmuxerInterface{constructor(e,t,r,i){this.error=null,this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;const s=e.config;this.hls=e,this.id=t,this.useWorker=!!s.enableWorker,this.onTransmuxComplete=r,this.onFlush=i;const o=(c,u)=>{u=u||{},u.frag=this.frag,u.id=this.id,c===Events.ERROR&&(this.error=u.error),this.hls.trigger(c,u)};this.observer=new EventEmitter,this.observer.on(Events.FRAG_DECRYPTED,o),this.observer.on(Events.ERROR,o);const a=getMediaSource(s.preferManagedMediaSource)||{isTypeSupported:()=>!1},l={mpeg:a.isTypeSupported("audio/mpeg"),mp3:a.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:a.isTypeSupported('audio/mp4; codecs="ac-3"')};if(this.useWorker&&typeof Worker<"u"&&(s.workerPath||hasUMDWorker())){try{s.workerPath?(logger.log(`loading Web Worker ${s.workerPath} for "${t}"`),this.workerContext=loadWorker(s.workerPath)):(logger.log(`injecting Web Worker for "${t}"`),this.workerContext=injectWorker()),this.onwmsg=d=>this.onWorkerMessage(d);const{worker:u}=this.workerContext;u.addEventListener("message",this.onwmsg),u.onerror=d=>{const f=new Error(`${d.message}  (${d.filename}:${d.lineno})`);s.enableWorker=!1,logger.warn(`Error in "${t}" Web Worker, fallback to inline`),this.hls.trigger(Events.ERROR,{type:ErrorTypes.OTHER_ERROR,details:ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:f})},u.postMessage({cmd:"init",typeSupported:l,vendor:"",id:t,config:JSON.stringify(s)})}catch(u){logger.warn(`Error setting up "${t}" Web Worker, fallback to inline`,u),this.resetWorker(),this.error=null,this.transmuxer=new Transmuxer(this.observer,l,s,"",t)}return}this.transmuxer=new Transmuxer(this.observer,l,s,"",t)}resetWorker(){if(this.workerContext){const{worker:e,objectURL:t}=this.workerContext;t&&self.URL.revokeObjectURL(t),e.removeEventListener("message",this.onwmsg),e.onerror=null,e.terminate(),this.workerContext=null}}destroy(){if(this.workerContext)this.resetWorker(),this.onwmsg=void 0;else{const t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null}push(e,t,r,i,s,o,a,l,c,u){var d,f;c.transmuxing.start=self.performance.now();const{transmuxer:m}=this,g=o?o.start:s.start,v=s.decryptdata,x=this.frag,S=!(x&&s.cc===x.cc),C=!(x&&c.level===x.level),R=x?c.sn-x.sn:-1,k=this.part?c.part-this.part.index:-1,I=R===0&&c.id>1&&c.id===(x==null?void 0:x.stats.chunkCount),F=!C&&(R===1||R===0&&(k===1||I&&k<=0)),N=self.performance.now();(C||R||s.stats.parsing.start===0)&&(s.stats.parsing.start=N),o&&(k||!F)&&(o.stats.parsing.start=N);const U=!(x&&((d=s.initSegment)==null?void 0:d.url)===((f=x.initSegment)==null?void 0:f.url)),M=new TransmuxState(S,F,l,C,g,U);if(!F||S||U){logger.log(`[transmuxer-interface, ${s.type}]: Starting new transmux session for sn: ${c.sn} p: ${c.part} level: ${c.level} id: ${c.id}
        discontinuity: ${S}
        trackSwitch: ${C}
        contiguous: ${F}
        accurateTimeOffset: ${l}
        timeOffset: ${g}
        initSegmentChange: ${U}`);const B=new TransmuxConfig(r,i,t,a,u);this.configureTransmuxer(B)}if(this.frag=s,this.part=o,this.workerContext)this.workerContext.worker.postMessage({cmd:"demux",data:e,decryptdata:v,chunkMeta:c,state:M},e instanceof ArrayBuffer?[e]:[]);else if(m){const B=m.push(e,v,c,M);isPromise(B)?(m.async=!0,B.then(H=>{this.handleTransmuxComplete(H)}).catch(H=>{this.transmuxerError(H,c,"transmuxer-interface push error")})):(m.async=!1,this.handleTransmuxComplete(B))}}flush(e){e.transmuxing.start=self.performance.now();const{transmuxer:t}=this;if(this.workerContext)this.workerContext.worker.postMessage({cmd:"flush",chunkMeta:e});else if(t){let r=t.flush(e);isPromise(r)||t.async?(isPromise(r)||(r=Promise.resolve(r)),r.then(s=>{this.handleFlushResult(s,e)}).catch(s=>{this.transmuxerError(s,e,"transmuxer-interface flush error")})):this.handleFlushResult(r,e)}}transmuxerError(e,t,r){this.hls&&(this.error=e,this.hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_PARSING_ERROR,chunkMeta:t,frag:this.frag||void 0,fatal:!1,error:e,err:e,reason:r}))}handleFlushResult(e,t){e.forEach(r=>{this.handleTransmuxComplete(r)}),this.onFlush(t)}onWorkerMessage(e){const t=e.data;if(!(t!=null&&t.event)){logger.warn(`worker message received with no ${t?"event name":"data"}`);return}const r=this.hls;if(this.hls)switch(t.event){case"init":{var i;const s=(i=this.workerContext)==null?void 0:i.objectURL;s&&self.URL.revokeObjectURL(s);break}case"transmuxComplete":{this.handleTransmuxComplete(t.data);break}case"flush":{this.onFlush(t.data);break}case"workerLog":logger[t.data.logType]&&logger[t.data.logType](t.data.message);break;default:{t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,r.trigger(t.event,t.data);break}}}configureTransmuxer(e){const{transmuxer:t}=this;this.workerContext?this.workerContext.worker.postMessage({cmd:"configure",config:e}):t&&t.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}function subtitleOptionsIdentical(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(!mediaAttributesIdentical(n[t].attrs,e[t].attrs))return!1;return!0}function mediaAttributesIdentical(n,e,t){const r=n["STABLE-RENDITION-ID"];return r&&!t?r===e["STABLE-RENDITION-ID"]:!(t||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(i=>n[i]!==e[i])}function subtitleTrackMatchesTextTrack(n,e){return e.label.toLowerCase()===n.name.toLowerCase()&&(!e.language||e.language.toLowerCase()===(n.lang||"").toLowerCase())}const TICK_INTERVAL$2=100;class AudioStreamController extends BaseStreamController{constructor(e,t,r){super(e,t,r,"[audio-stream-controller]",PlaylistLevelType.AUDIO),this.videoBuffer=null,this.videoTrackCC=-1,this.waitingVideoCC=-1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null,this.bufferedTrack=null,this.switchingTrack=null}_registerListeners(){const{hls:e}=this;e.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Events.LEVEL_LOADED,this.onLevelLoaded,this),e.on(Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(Events.ERROR,this.onError,this),e.on(Events.BUFFER_RESET,this.onBufferReset,this),e.on(Events.BUFFER_CREATED,this.onBufferCreated,this),e.on(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(Events.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(Events.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(Events.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Events.LEVEL_LOADED,this.onLevelLoaded,this),e.off(Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(Events.ERROR,this.onError,this),e.off(Events.BUFFER_RESET,this.onBufferReset,this),e.off(Events.BUFFER_CREATED,this.onBufferCreated,this),e.off(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(Events.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(Events.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(Events.FRAG_BUFFERED,this.onFragBuffered,this)}onInitPtsFound(e,{frag:t,id:r,initPTS:i,timescale:s}){if(r==="main"){const o=t.cc;this.initPTS[t.cc]={baseTime:i,timescale:s},this.log(`InitPTS for cc: ${o} found from main: ${i}`),this.videoTrackCC=o,this.state===State.WAITING_INIT_PTS&&this.tick()}}startLoad(e){if(!this.levels){this.startPosition=e,this.state=State.STOPPED;return}const t=this.lastCurrentTime;this.stopLoad(),this.setInterval(TICK_INTERVAL$2),t>0&&e===-1?(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t,this.state=State.IDLE):(this.loadedmetadata=!1,this.state=State.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}doTick(){switch(this.state){case State.IDLE:this.doTickIdle();break;case State.WAITING_TRACK:{var e;const{levels:r,trackId:i}=this,s=r==null||(e=r[i])==null?void 0:e.details;if(s){if(this.waitForCdnTuneIn(s))break;this.state=State.WAITING_INIT_PTS}break}case State.FRAG_LOADING_WAITING_RETRY:{var t;const r=performance.now(),i=this.retryDate;if(!i||r>=i||(t=this.media)!=null&&t.seeking){const{levels:s,trackId:o}=this;this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded((s==null?void 0:s[o])||null),this.state=State.IDLE}break}case State.WAITING_INIT_PTS:{const r=this.waitingData;if(r){const{frag:i,part:s,cache:o,complete:a}=r;if(this.initPTS[i.cc]!==void 0){this.waitingData=null,this.waitingVideoCC=-1,this.state=State.FRAG_LOADING;const l=o.flush(),c={frag:i,part:s,payload:l,networkDetails:null};this._handleFragmentLoadProgress(c),a&&super._handleFragmentLoadComplete(c)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log(`Waiting fragment cc (${i.cc}) cancelled because video is at cc ${this.videoTrackCC}`),this.clearWaitingFragment();else{const l=this.getLoadPosition(),c=BufferHelper.bufferInfo(this.mediaBuffer,l,this.config.maxBufferHole);fragmentWithinToleranceTest(c.end,this.config.maxFragLookUpTolerance,i)<0&&(this.log(`Waiting fragment cc (${i.cc}) @ ${i.start} cancelled because another fragment at ${c.end} is needed`),this.clearWaitingFragment())}}else this.state=State.IDLE}}this.onTickEnd()}clearWaitingFragment(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=State.IDLE)}resetLoadingState(){this.clearWaitingFragment(),super.resetLoadingState()}onTickEnd(){const{media:e}=this;e!=null&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){const{hls:e,levels:t,media:r,trackId:i}=this,s=e.config;if(!r&&(this.startFragRequested||!s.startFragPrefetch)||!(t!=null&&t[i]))return;const o=t[i],a=o.details;if(!a||a.live&&this.levelLastLoaded!==o||this.waitForCdnTuneIn(a)){this.state=State.WAITING_TRACK;return}const l=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&l&&(this.bufferFlushed=!1,this.afterBufferFlushed(l,ElementaryStreamTypes.AUDIO,PlaylistLevelType.AUDIO));const c=this.getFwdBufferInfo(l,PlaylistLevelType.AUDIO);if(c===null)return;const{bufferedTrack:u,switchingTrack:d}=this;if(!d&&this._streamEnded(c,a)){e.trigger(Events.BUFFER_EOS,{type:"audio"}),this.state=State.ENDED;return}const f=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,PlaylistLevelType.MAIN),m=c.len,g=this.getMaxBufferLength(f==null?void 0:f.len),v=a.fragments,x=v[0].start;let S=this.flushing?this.getLoadPosition():c.end;if(d&&r){const I=this.getLoadPosition();u&&!mediaAttributesIdentical(d.attrs,u.attrs)&&(S=I),a.PTSKnown&&I<x&&(c.end>x||c.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),r.currentTime=x+.05)}if(m>=g&&!d&&S<v[v.length-1].start)return;let C=this.getNextFragment(S,a),R=!1;if(C&&this.isLoopLoading(C,S)&&(R=!!C.gap,C=this.getNextFragmentLoopLoading(C,a,c,PlaylistLevelType.MAIN,g)),!C){this.bufferFlushed=!0;return}const k=f&&C.start>f.end+a.targetduration;if(k||!(f!=null&&f.len)&&c.len){const I=this.getAppendedFrag(C.start,PlaylistLevelType.MAIN);if(I===null||(R||(R=!!I.gap||!!k&&f.len===0),k&&!R||R&&c.nextStart&&c.nextStart<I.end))return}this.loadFragment(C,o,S)}getMaxBufferLength(e){const t=super.getMaxBufferLength();return e?Math.min(Math.max(t,e),this.config.maxMaxBufferLength):t}onMediaDetaching(){this.videoBuffer=null,this.bufferFlushed=this.flushing=!1,super.onMediaDetaching()}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map(r=>new Level(r))}onAudioTrackSwitching(e,t){const r=!!t.url;this.trackId=t.id;const{fragCurrent:i}=this;i&&(i.abortRequests(),this.removeUnbufferedFrags(i.start)),this.resetLoadingState(),r?this.setInterval(TICK_INTERVAL$2):this.resetTransmuxer(),r?(this.switchingTrack=t,this.state=State.IDLE,this.flushAudioIfNeeded(t)):(this.switchingTrack=null,this.bufferedTrack=t,this.state=State.STOPPED),this.tick()}onManifestLoading(){this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=this.flushing=!1,this.levels=this.mainDetails=this.waitingData=this.bufferedTrack=this.cachedTrackLoadedData=this.switchingTrack=null,this.startFragRequested=!1,this.trackId=this.videoTrackCC=this.waitingVideoCC=-1}onLevelLoaded(e,t){this.mainDetails=t.details,this.cachedTrackLoadedData!==null&&(this.hls.trigger(Events.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)}onAudioTrackLoaded(e,t){var r;if(this.mainDetails==null){this.cachedTrackLoadedData=t;return}const{levels:i}=this,{details:s,id:o}=t;if(!i){this.warn(`Audio tracks were reset while loading level ${o}`);return}this.log(`Audio track ${o} loaded [${s.startSN},${s.endSN}]${s.lastPartSn?`[part-${s.lastPartSn}-${s.lastPartIndex}]`:""},duration:${s.totalduration}`);const a=i[o];let l=0;if(s.live||(r=a.details)!=null&&r.live){this.checkLiveUpdate(s);const u=this.mainDetails;if(s.deltaUpdateFailed||!u)return;if(!a.details&&s.hasProgramDateTime&&u.hasProgramDateTime)alignMediaPlaylistByPDT(s,u),l=s.fragments[0].start;else{var c;l=this.alignPlaylists(s,a.details,(c=this.levelLastLoaded)==null?void 0:c.details)}}a.details=s,this.levelLastLoaded=a,!this.startFragRequested&&(this.mainDetails||!s.live)&&this.setStartPosition(this.mainDetails||s,l),this.state===State.WAITING_TRACK&&!this.waitForCdnTuneIn(s)&&(this.state=State.IDLE),this.tick()}_handleFragmentLoadProgress(e){var t;const{frag:r,part:i,payload:s}=e,{config:o,trackId:a,levels:l}=this;if(!l){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${r.sn} of level ${r.level} will not be buffered`);return}const c=l[a];if(!c){this.warn("Audio track is undefined on fragment load progress");return}const u=c.details;if(!u){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(r.start);return}const d=o.defaultAudioCodec||c.audioCodec||"mp4a.40.2";let f=this.transmuxer;f||(f=this.transmuxer=new TransmuxerInterface(this.hls,PlaylistLevelType.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const m=this.initPTS[r.cc],g=(t=r.initSegment)==null?void 0:t.data;if(m!==void 0){const x=i?i.index:-1,S=x!==-1,C=new ChunkMetadata(r.level,r.sn,r.stats.chunkCount,s.byteLength,x,S);f.push(s,g,d,"",r,i,u.totalduration,!1,C,m)}else{this.log(`Unknown video PTS for cc ${r.cc}, waiting for video PTS before demuxing audio frag ${r.sn} of [${u.startSN} ,${u.endSN}],track ${a}`);const{cache:v}=this.waitingData=this.waitingData||{frag:r,part:i,cache:new ChunkCache,complete:!1};v.push(new Uint8Array(s)),this.waitingVideoCC=this.videoTrackCC,this.state=State.WAITING_INIT_PTS}}_handleFragmentLoadComplete(e){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1}onBufferCreated(e,t){const r=t.tracks.audio;r&&(this.mediaBuffer=r.buffer||null),t.tracks.video&&(this.videoBuffer=t.tracks.video.buffer||null)}onFragBuffered(e,t){const{frag:r,part:i}=t;if(r.type!==PlaylistLevelType.AUDIO){if(!this.loadedmetadata&&r.type===PlaylistLevelType.MAIN){const s=this.videoBuffer||this.media;s&&BufferHelper.getBuffered(s).length&&(this.loadedmetadata=!0)}return}if(this.fragContextChanged(r)){this.warn(`Fragment ${r.sn}${i?" p: "+i.index:""} of level ${r.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(r.sn!=="initSegment"){this.fragPrevious=r;const s=this.switchingTrack;s&&(this.bufferedTrack=s,this.switchingTrack=null,this.hls.trigger(Events.AUDIO_TRACK_SWITCHED,_objectSpread2({},s)))}this.fragBufferedComplete(r,i)}onError(e,t){var r;if(t.fatal){this.state=State.ERROR;return}switch(t.details){case ErrorDetails.FRAG_GAP:case ErrorDetails.FRAG_PARSING_ERROR:case ErrorDetails.FRAG_DECRYPT_ERROR:case ErrorDetails.FRAG_LOAD_ERROR:case ErrorDetails.FRAG_LOAD_TIMEOUT:case ErrorDetails.KEY_LOAD_ERROR:case ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(PlaylistLevelType.AUDIO,t);break;case ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:case ErrorDetails.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===State.WAITING_TRACK&&((r=t.context)==null?void 0:r.type)===PlaylistContextType.AUDIO_TRACK&&(this.state=State.IDLE);break;case ErrorDetails.BUFFER_APPEND_ERROR:case ErrorDetails.BUFFER_FULL_ERROR:if(!t.parent||t.parent!=="audio")return;if(t.details===ErrorDetails.BUFFER_APPEND_ERROR){this.resetLoadingState();return}this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case ErrorDetails.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onBufferFlushing(e,{type:t}){t!==ElementaryStreamTypes.VIDEO&&(this.flushing=!0)}onBufferFlushed(e,{type:t}){if(t!==ElementaryStreamTypes.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===State.ENDED&&(this.state=State.IDLE);const r=this.mediaBuffer||this.media;r&&(this.afterBufferFlushed(r,t,PlaylistLevelType.AUDIO),this.tick())}}_handleTransmuxComplete(e){var t;const r="audio",{hls:i}=this,{remuxResult:s,chunkMeta:o}=e,a=this.getCurrentContext(o);if(!a){this.resetWhenMissingContext(o);return}const{frag:l,part:c,level:u}=a,{details:d}=u,{audio:f,text:m,id3:g,initSegment:v}=s;if(this.fragContextChanged(l)||!d){this.fragmentTracker.removeFragment(l);return}if(this.state=State.PARSING,this.switchingTrack&&f&&this.completeAudioSwitch(this.switchingTrack),v!=null&&v.tracks){const x=l.initSegment||l;this._bufferInitSegment(u,v.tracks,x,o),i.trigger(Events.FRAG_PARSING_INIT_SEGMENT,{frag:x,id:r,tracks:v.tracks})}if(f){const{startPTS:x,endPTS:S,startDTS:C,endDTS:R}=f;c&&(c.elementaryStreams[ElementaryStreamTypes.AUDIO]={startPTS:x,endPTS:S,startDTS:C,endDTS:R}),l.setElementaryStreamInfo(ElementaryStreamTypes.AUDIO,x,S,C,R),this.bufferFragmentData(f,l,c,o)}if(g!=null&&(t=g.samples)!=null&&t.length){const x=_extends({id:r,frag:l,details:d},g);i.trigger(Events.FRAG_PARSING_METADATA,x)}if(m){const x=_extends({id:r,frag:l,details:d},m);i.trigger(Events.FRAG_PARSING_USERDATA,x)}}_bufferInitSegment(e,t,r,i){if(this.state!==State.PARSING)return;t.video&&delete t.video;const s=t.audio;if(!s)return;s.id="audio";const o=e.audioCodec;this.log(`Init audio buffer, container:${s.container}, codecs[level/parsed]=[${o}/${s.codec}]`),o&&o.split(",").length===1&&(s.levelCodec=o),this.hls.trigger(Events.BUFFER_CODECS,t);const a=s.initSegment;if(a!=null&&a.byteLength){const l={type:"audio",frag:r,part:null,chunkMeta:i,parent:r.type,data:a};this.hls.trigger(Events.BUFFER_APPENDING,l)}this.tickImmediate()}loadFragment(e,t,r){const i=this.fragmentTracker.getState(e);if(this.fragCurrent=e,this.switchingTrack||i===FragmentState.NOT_LOADED||i===FragmentState.PARTIAL){var s;if(e.sn==="initSegment")this._loadInitSegment(e,t);else if((s=t.details)!=null&&s.live&&!this.initPTS[e.cc]){this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=State.WAITING_INIT_PTS;const o=this.mainDetails;o&&o.fragments[0].start!==t.details.fragments[0].start&&alignMediaPlaylistByPDT(t.details,o)}else this.startFragRequested=!0,super.loadFragment(e,t,r)}else this.clearTrackerIfNeeded(e)}flushAudioIfNeeded(e){const{media:t,bufferedTrack:r}=this,i=r==null?void 0:r.attrs,s=e.attrs;t&&i&&(i.CHANNELS!==s.CHANNELS||r.name!==e.name||r.lang!==e.lang)&&(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null)}completeAudioSwitch(e){const{hls:t}=this;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(Events.AUDIO_TRACK_SWITCHED,_objectSpread2({},e))}}class AudioTrackController extends BasePlaylistController{constructor(e){super(e,"[audio-track-controller]"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Events.MANIFEST_PARSED,this.onManifestParsed,this),e.on(Events.LEVEL_LOADING,this.onLevelLoading,this),e.on(Events.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(Events.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Events.MANIFEST_PARSED,this.onManifestParsed,this),e.off(Events.LEVEL_LOADING,this.onLevelLoading,this),e.off(Events.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(Events.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){const{id:r,groupId:i,details:s}=t,o=this.tracksInGroup[r];if(!o||o.groupId!==i){this.warn(`Audio track with id:${r} and group:${i} not found in active group ${o==null?void 0:o.groupId}`);return}const a=o.details;o.details=t.details,this.log(`Audio track ${r} "${o.name}" lang:${o.lang} group:${i} loaded [${s.startSN}-${s.endSN}]`),r===this.trackId&&this.playlistLoaded(r,t,a)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const r=t.audioGroups||null,i=this.groupIds;let s=this.currentTrack;if(!r||(i==null?void 0:i.length)!==(r==null?void 0:r.length)||r!=null&&r.some(a=>(i==null?void 0:i.indexOf(a))===-1)){this.groupIds=r,this.trackId=-1,this.currentTrack=null;const a=this.tracks.filter(f=>!r||r.indexOf(f.groupId)!==-1);if(a.length)this.selectDefaultTrack&&!a.some(f=>f.default)&&(this.selectDefaultTrack=!1),a.forEach((f,m)=>{f.id=m});else if(!s&&!this.tracksInGroup.length)return;this.tracksInGroup=a;const l=this.hls.config.audioPreference;if(!s&&l){const f=findMatchingOption(l,a,audioMatchPredicate);if(f>-1)s=a[f];else{const m=findMatchingOption(l,this.tracks);s=this.tracks[m]}}let c=this.findTrackId(s);c===-1&&s&&(c=this.findTrackId(null));const u={audioTracks:a};this.log(`Updating audio tracks, ${a.length} track(s) found in group(s): ${r==null?void 0:r.join(",")}`),this.hls.trigger(Events.AUDIO_TRACKS_UPDATED,u);const d=this.trackId;if(c!==-1&&d===-1)this.setAudioTrack(c);else if(a.length&&d===-1){var o;const f=new Error(`No audio track selected for current audio group-ID(s): ${(o=this.groupIds)==null?void 0:o.join(",")} track count: ${a.length}`);this.warn(f.message),this.hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:f})}}else this.shouldReloadPlaylist(s)&&this.setAudioTrack(this.trackId)}onError(e,t){t.fatal||!t.context||t.context.type===PlaylistContextType.AUDIO_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&(this.requestScheduled=-1,this.checkRetry(t))}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioOption(e){const t=this.hls;if(t.config.audioPreference=e,e){const r=this.allAudioTracks;if(this.selectDefaultTrack=!1,r.length){const i=this.currentTrack;if(i&&matchesOption(e,i,audioMatchPredicate))return i;const s=findMatchingOption(e,this.tracksInGroup,audioMatchPredicate);if(s>-1){const o=this.tracksInGroup[s];return this.setAudioTrack(s),o}else if(i){let o=t.loadLevel;o===-1&&(o=t.firstAutoLevel);const a=findClosestLevelWithAudioGroup(e,t.levels,r,o,audioMatchPredicate);if(a===-1)return null;t.nextLoadLevel=a}if(e.channels||e.audioCodec){const o=findMatchingOption(e,r);if(o>-1)return r[o]}}}return null}setAudioTrack(e){const t=this.tracksInGroup;if(e<0||e>=t.length){this.warn(`Invalid audio track id: ${e}`);return}this.clearTimer(),this.selectDefaultTrack=!1;const r=this.currentTrack,i=t[e],s=i.details&&!i.details.live;if(e===this.trackId&&i===r&&s||(this.log(`Switching to audio-track ${e} "${i.name}" lang:${i.lang} group:${i.groupId} channels:${i.channels}`),this.trackId=e,this.currentTrack=i,this.hls.trigger(Events.AUDIO_TRACK_SWITCHING,_objectSpread2({},i)),s))return;const o=this.switchParams(i.url,r==null?void 0:r.details,i.details);this.loadPlaylist(o)}findTrackId(e){const t=this.tracksInGroup;for(let r=0;r<t.length;r++){const i=t[r];if(!(this.selectDefaultTrack&&!i.default)&&(!e||matchesOption(e,i,audioMatchPredicate)))return r}if(e){const{name:r,lang:i,assocLang:s,characteristics:o,audioCodec:a,channels:l}=e;for(let c=0;c<t.length;c++){const u=t[c];if(matchesOption({name:r,lang:i,assocLang:s,characteristics:o,audioCodec:a,channels:l},u,audioMatchPredicate))return c}for(let c=0;c<t.length;c++){const u=t[c];if(mediaAttributesIdentical(e.attrs,u.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return c}for(let c=0;c<t.length;c++){const u=t[c];if(mediaAttributesIdentical(e.attrs,u.attrs,["LANGUAGE"]))return c}}return-1}loadPlaylist(e){const t=this.currentTrack;if(this.shouldLoadPlaylist(t)&&t){super.loadPlaylist();const r=t.id,i=t.groupId;let s=t.url;if(e)try{s=e.addDirectives(s)}catch(o){this.warn(`Could not construct new URL with HLS Delivery Directives: ${o}`)}this.log(`loading audio-track playlist ${r} "${t.name}" lang:${t.lang} group:${i}`),this.clearTimer(),this.hls.trigger(Events.AUDIO_TRACK_LOADING,{url:s,id:r,groupId:i,deliveryDirectives:e||null})}}}const TICK_INTERVAL$1=500;class SubtitleStreamController extends BaseStreamController{constructor(e,t,r){super(e,t,r,"[subtitle-stream-controller]",PlaylistLevelType.SUBTITLE),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}_registerListeners(){const{hls:e}=this;e.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Events.LEVEL_LOADED,this.onLevelLoaded,this),e.on(Events.ERROR,this.onError,this),e.on(Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(Events.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Events.LEVEL_LOADED,this.onLevelLoaded,this),e.off(Events.ERROR,this.onError,this),e.off(Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(Events.FRAG_BUFFERED,this.onFragBuffered,this)}startLoad(e){this.stopLoad(),this.state=State.IDLE,this.setInterval(TICK_INTERVAL$1),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}onManifestLoading(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()}onMediaDetaching(){this.tracksBuffered=[],super.onMediaDetaching()}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){const{frag:r,success:i}=t;if(this.fragPrevious=r,this.state=State.IDLE,!i)return;const s=this.tracksBuffered[this.currentTrackId];if(!s)return;let o;const a=r.start;for(let c=0;c<s.length;c++)if(a>=s[c].start&&a<=s[c].end){o=s[c];break}const l=r.start+r.duration;o?o.end=l:(o={start:a,end:l},s.push(o)),this.fragmentTracker.fragBuffered(r),this.fragBufferedComplete(r,null)}onBufferFlushing(e,t){const{startOffset:r,endOffset:i}=t;if(r===0&&i!==Number.POSITIVE_INFINITY){const s=i-1;if(s<=0)return;t.endOffsetSubtitles=Math.max(0,s),this.tracksBuffered.forEach(o=>{for(let a=0;a<o.length;){if(o[a].end<=s){o.shift();continue}else if(o[a].start<s)o[a].start=s;else break;a++}}),this.fragmentTracker.removeFragmentsInRange(r,s,PlaylistLevelType.SUBTITLE)}}onFragBuffered(e,t){if(!this.loadedmetadata&&t.frag.type===PlaylistLevelType.MAIN){var r;(r=this.media)!=null&&r.buffered.length&&(this.loadedmetadata=!0)}}onError(e,t){const r=t.frag;(r==null?void 0:r.type)===PlaylistLevelType.SUBTITLE&&(t.details===ErrorDetails.FRAG_GAP&&this.fragmentTracker.fragBuffered(r,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==State.STOPPED&&(this.state=State.IDLE))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){if(this.levels&&subtitleOptionsIdentical(this.levels,t)){this.levels=t.map(r=>new Level(r));return}this.tracksBuffered=[],this.levels=t.map(r=>{const i=new Level(r);return this.tracksBuffered[i.id]=[],i}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,PlaylistLevelType.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(e,t){var r;if(this.currentTrackId=t.id,!((r=this.levels)!=null&&r.length)||this.currentTrackId===-1){this.clearInterval();return}const i=this.levels[this.currentTrackId];i!=null&&i.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,i&&this.setInterval(TICK_INTERVAL$1)}onSubtitleTrackLoaded(e,t){var r;const{currentTrackId:i,levels:s}=this,{details:o,id:a}=t;if(!s){this.warn(`Subtitle tracks were reset while loading level ${a}`);return}const l=s[a];if(a>=s.length||!l)return;this.log(`Subtitle track ${a} loaded [${o.startSN},${o.endSN}]${o.lastPartSn?`[part-${o.lastPartSn}-${o.lastPartIndex}]`:""},duration:${o.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let c=0;if(o.live||(r=l.details)!=null&&r.live){const d=this.mainDetails;if(o.deltaUpdateFailed||!d)return;const f=d.fragments[0];if(!l.details)o.hasProgramDateTime&&d.hasProgramDateTime?(alignMediaPlaylistByPDT(o,d),c=o.fragments[0].start):f&&(c=f.start,addSliding(o,c));else{var u;c=this.alignPlaylists(o,l.details,(u=this.levelLastLoaded)==null?void 0:u.details),c===0&&f&&(c=f.start,addSliding(o,c))}}l.details=o,this.levelLastLoaded=l,a===i&&(!this.startFragRequested&&(this.mainDetails||!o.live)&&this.setStartPosition(this.mainDetails||o,c),this.tick(),o.live&&!this.fragCurrent&&this.media&&this.state===State.IDLE&&(findFragmentByPTS(null,o.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),l.details=void 0)))}_handleFragmentLoadComplete(e){const{frag:t,payload:r}=e,i=t.decryptdata,s=this.hls;if(!this.fragContextChanged(t)&&r&&r.byteLength>0&&i!=null&&i.key&&i.iv&&i.method==="AES-128"){const o=performance.now();this.decrypter.decrypt(new Uint8Array(r),i.key.buffer,i.iv.buffer).catch(a=>{throw s.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_DECRYPT_ERROR,fatal:!1,error:a,reason:a.message,frag:t}),a}).then(a=>{const l=performance.now();s.trigger(Events.FRAG_DECRYPTED,{frag:t,payload:a,stats:{tstart:o,tdecrypt:l}})}).catch(a=>{this.warn(`${a.name}: ${a.message}`),this.state=State.IDLE})}}doTick(){if(!this.media){this.state=State.IDLE;return}if(this.state===State.IDLE){const{currentTrackId:e,levels:t}=this,r=t==null?void 0:t[e];if(!r||!t.length||!r.details)return;const{config:i}=this,s=this.getLoadPosition(),o=BufferHelper.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],s,i.maxBufferHole),{end:a,len:l}=o,c=this.getFwdBufferInfo(this.media,PlaylistLevelType.MAIN),u=r.details,d=this.getMaxBufferLength(c==null?void 0:c.len)+u.levelTargetDuration;if(l>d)return;const f=u.fragments,m=f.length,g=u.edge;let v=null;const x=this.fragPrevious;if(a<g){const S=i.maxFragLookUpTolerance,C=a>g-S?0:S;v=findFragmentByPTS(x,f,Math.max(f[0].start,a),C),!v&&x&&x.start<f[0].start&&(v=f[0])}else v=f[m-1];if(!v)return;if(v=this.mapToInitFragWhenRequired(v),v.sn!=="initSegment"){const S=v.sn-u.startSN,C=f[S-1];C&&C.cc===v.cc&&this.fragmentTracker.getState(C)===FragmentState.NOT_LOADED&&(v=C)}this.fragmentTracker.getState(v)===FragmentState.NOT_LOADED&&this.loadFragment(v,r,a)}}getMaxBufferLength(e){const t=super.getMaxBufferLength();return e?Math.max(t,e):t}loadFragment(e,t,r){this.fragCurrent=e,e.sn==="initSegment"?this._loadInitSegment(e,t):(this.startFragRequested=!0,super.loadFragment(e,t,r))}get mediaBufferTimeRanges(){return new BufferableInstance(this.tracksBuffered[this.currentTrackId]||[])}}class BufferableInstance{constructor(e){this.buffered=void 0;const t=(r,i,s)=>{if(i=i>>>0,i>s-1)throw new DOMException(`Failed to execute '${r}' on 'TimeRanges': The index provided (${i}) is greater than the maximum bound (${s})`);return e[i][r]};this.buffered={get length(){return e.length},end(r){return t("end",r,e.length)},start(r){return t("start",r,e.length)}}}}class SubtitleTrackController extends BasePlaylistController{constructor(e){super(e,"[subtitle-track-controller]"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let t=null;const r=filterSubtitleTracks(this.media.textTracks);for(let s=0;s<r.length;s++)if(r[s].mode==="hidden")t=r[s];else if(r[s].mode==="showing"){t=r[s];break}const i=this.findTrackForTextTrack(t);this.subtitleTrack!==i&&this.setSubtitleTrack(i)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:e}=this;e.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Events.MANIFEST_PARSED,this.onManifestParsed,this),e.on(Events.LEVEL_LOADING,this.onLevelLoading,this),e.on(Events.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(Events.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Events.MANIFEST_PARSED,this.onManifestParsed,this),e.off(Events.LEVEL_LOADING,this.onLevelLoading,this),e.off(Events.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(Events.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,e)}onMediaDetaching(){if(!this.media)return;self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),filterSubtitleTracks(this.media.textTracks).forEach(t=>{clearCurrentCues(t)}),this.subtitleTrack=-1,this.media=null}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){const{id:r,groupId:i,details:s}=t,o=this.tracksInGroup[r];if(!o||o.groupId!==i){this.warn(`Subtitle track with id:${r} and group:${i} not found in active group ${o==null?void 0:o.groupId}`);return}const a=o.details;o.details=t.details,this.log(`Subtitle track ${r} "${o.name}" lang:${o.lang} group:${i} loaded [${s.startSN}-${s.endSN}]`),r===this.trackId&&this.playlistLoaded(r,t,a)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const r=t.subtitleGroups||null,i=this.groupIds;let s=this.currentTrack;if(!r||(i==null?void 0:i.length)!==(r==null?void 0:r.length)||r!=null&&r.some(o=>(i==null?void 0:i.indexOf(o))===-1)){this.groupIds=r,this.trackId=-1,this.currentTrack=null;const o=this.tracks.filter(u=>!r||r.indexOf(u.groupId)!==-1);if(o.length)this.selectDefaultTrack&&!o.some(u=>u.default)&&(this.selectDefaultTrack=!1),o.forEach((u,d)=>{u.id=d});else if(!s&&!this.tracksInGroup.length)return;this.tracksInGroup=o;const a=this.hls.config.subtitlePreference;if(!s&&a){this.selectDefaultTrack=!1;const u=findMatchingOption(a,o);if(u>-1)s=o[u];else{const d=findMatchingOption(a,this.tracks);s=this.tracks[d]}}let l=this.findTrackId(s);l===-1&&s&&(l=this.findTrackId(null));const c={subtitleTracks:o};this.log(`Updating subtitle tracks, ${o.length} track(s) found in "${r==null?void 0:r.join(",")}" group-id`),this.hls.trigger(Events.SUBTITLE_TRACKS_UPDATED,c),l!==-1&&this.trackId===-1&&this.setSubtitleTrack(l)}else this.shouldReloadPlaylist(s)&&this.setSubtitleTrack(this.trackId)}findTrackId(e){const t=this.tracksInGroup,r=this.selectDefaultTrack;for(let i=0;i<t.length;i++){const s=t[i];if(!(r&&!s.default||!r&&!e)&&(!e||matchesOption(s,e)))return i}if(e){for(let i=0;i<t.length;i++){const s=t[i];if(mediaAttributesIdentical(e.attrs,s.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return i}for(let i=0;i<t.length;i++){const s=t[i];if(mediaAttributesIdentical(e.attrs,s.attrs,["LANGUAGE"]))return i}}return-1}findTrackForTextTrack(e){if(e){const t=this.tracksInGroup;for(let r=0;r<t.length;r++){const i=t[r];if(subtitleTrackMatchesTextTrack(i,e))return r}}return-1}onError(e,t){t.fatal||!t.context||t.context.type===PlaylistContextType.SUBTITLE_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e)}setSubtitleOption(e){if(this.hls.config.subtitlePreference=e,e){const t=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,t.length){const r=this.currentTrack;if(r&&matchesOption(e,r))return r;const i=findMatchingOption(e,this.tracksInGroup);if(i>-1){const s=this.tracksInGroup[i];return this.setSubtitleTrack(i),s}else{if(r)return null;{const s=findMatchingOption(e,t);if(s>-1)return t[s]}}}}return null}loadPlaylist(e){super.loadPlaylist();const t=this.currentTrack;if(this.shouldLoadPlaylist(t)&&t){const r=t.id,i=t.groupId;let s=t.url;if(e)try{s=e.addDirectives(s)}catch(o){this.warn(`Could not construct new URL with HLS Delivery Directives: ${o}`)}this.log(`Loading subtitle playlist for id ${r}`),this.hls.trigger(Events.SUBTITLE_TRACK_LOADING,{url:s,id:r,groupId:i,deliveryDirectives:e||null})}}toggleTrackModes(){const{media:e}=this;if(!e)return;const t=filterSubtitleTracks(e.textTracks),r=this.currentTrack;let i;if(r&&(i=t.filter(s=>subtitleTrackMatchesTextTrack(r,s))[0],i||this.warn(`Unable to find subtitle TextTrack with name "${r.name}" and language "${r.lang}"`)),[].slice.call(t).forEach(s=>{s.mode!=="disabled"&&s!==i&&(s.mode="disabled")}),i){const s=this.subtitleDisplay?"showing":"hidden";i.mode!==s&&(i.mode=s)}}setSubtitleTrack(e){const t=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=e;return}if(e<-1||e>=t.length||!isFiniteNumber(e)){this.warn(`Invalid subtitle track id: ${e}`);return}this.clearTimer(),this.selectDefaultTrack=!1;const r=this.currentTrack,i=t[e]||null;if(this.trackId=e,this.currentTrack=i,this.toggleTrackModes(),!i){this.hls.trigger(Events.SUBTITLE_TRACK_SWITCH,{id:e});return}const s=!!i.details&&!i.details.live;if(e===this.trackId&&i===r&&s)return;this.log(`Switching to subtitle-track ${e}`+(i?` "${i.name}" lang:${i.lang} group:${i.groupId}`:""));const{id:o,groupId:a="",name:l,type:c,url:u}=i;this.hls.trigger(Events.SUBTITLE_TRACK_SWITCH,{id:o,groupId:a,name:l,type:c,url:u});const d=this.switchParams(i.url,r==null?void 0:r.details,i.details);this.loadPlaylist(d)}}class BufferOperationQueue{constructor(e){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=e}append(e,t,r){const i=this.queues[t];i.push(e),i.length===1&&!r&&this.executeNext(t)}insertAbort(e,t){this.queues[t].unshift(e),this.executeNext(t)}appendBlocker(e){let t;const r=new Promise(s=>{t=s}),i={execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};return this.append(i,e),r}executeNext(e){const t=this.queues[e];if(t.length){const r=t[0];try{r.execute()}catch(i){logger.warn(`[buffer-operation-queue]: Exception executing "${e}" SourceBuffer operation: ${i}`),r.onError(i);const s=this.buffers[e];s!=null&&s.updating||this.shiftAndExecuteNext(e)}}}shiftAndExecuteNext(e){this.queues[e].shift(),this.executeNext(e)}current(e){return this.queues[e][0]}}const VIDEO_CODEC_PROFILE_REPLACE=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/;class BufferController{constructor(e){this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.appendSource=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this.log=void 0,this.warn=void 0,this.error=void 0,this._onEndStreaming=r=>{this.hls&&this.hls.pauseBuffering()},this._onStartStreaming=r=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=()=>{const{media:r,mediaSource:i}=this;this.log("Media source opened"),r&&(r.removeEventListener("emptied",this._onMediaEmptied),this.updateMediaElementDuration(),this.hls.trigger(Events.MEDIA_ATTACHED,{media:r,mediaSource:i})),i&&i.removeEventListener("sourceopen",this._onMediaSourceOpen),this.checkPendingTracks()},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:r,_objectUrl:i}=this;r!==i&&logger.error(`Media element src was set while attaching MediaSource (${i} > ${r})`)},this.hls=e;const t="[buffer-controller]";this.appendSource=isManagedMediaSource(getMediaSource(e.config.preferManagedMediaSource)),this.log=logger.log.bind(logger,t),this.warn=logger.warn.bind(logger,t),this.error=logger.error.bind(logger,t),this._initSourceBuffer(),this.registerListeners()}hasSourceTypes(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=null,this.hls=null}registerListeners(){const{hls:e}=this;e.on(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Events.MANIFEST_PARSED,this.onManifestParsed,this),e.on(Events.BUFFER_RESET,this.onBufferReset,this),e.on(Events.BUFFER_APPENDING,this.onBufferAppending,this),e.on(Events.BUFFER_CODECS,this.onBufferCodecs,this),e.on(Events.BUFFER_EOS,this.onBufferEos,this),e.on(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(Events.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(Events.FRAG_PARSED,this.onFragParsed,this),e.on(Events.FRAG_CHANGED,this.onFragChanged,this)}unregisterListeners(){const{hls:e}=this;e.off(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Events.MANIFEST_PARSED,this.onManifestParsed,this),e.off(Events.BUFFER_RESET,this.onBufferReset,this),e.off(Events.BUFFER_APPENDING,this.onBufferAppending,this),e.off(Events.BUFFER_CODECS,this.onBufferCodecs,this),e.off(Events.BUFFER_EOS,this.onBufferEos,this),e.off(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(Events.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(Events.FRAG_PARSED,this.onFragParsed,this),e.off(Events.FRAG_CHANGED,this.onFragChanged,this)}_initSourceBuffer(){this.sourceBuffer={},this.operationQueue=new BufferOperationQueue(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]},this.appendErrors={audio:0,video:0,audiovideo:0},this.lastMpegAudioChunk=null}onManifestLoading(){this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){let r=2;(t.audio&&!t.video||!t.altAudio)&&(r=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=r,this.log(`${this.bufferCodecEventsExpected} bufferCodec event(s) expected`)}onMediaAttaching(e,t){const r=this.media=t.media,i=getMediaSource(this.appendSource);if(r&&i){var s;const o=this.mediaSource=new i;this.log(`created media source: ${(s=o.constructor)==null?void 0:s.name}`),o.addEventListener("sourceopen",this._onMediaSourceOpen),o.addEventListener("sourceended",this._onMediaSourceEnded),o.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(o.addEventListener("startstreaming",this._onStartStreaming),o.addEventListener("endstreaming",this._onEndStreaming));const a=this._objectUrl=self.URL.createObjectURL(o);if(this.appendSource)try{r.removeAttribute("src");const l=self.ManagedMediaSource;r.disableRemotePlayback=r.disableRemotePlayback||l&&o instanceof l,removeSourceChildren(r),addSource(r,a),r.load()}catch{r.src=a}else r.src=a;r.addEventListener("emptied",this._onMediaEmptied)}}onMediaDetaching(){const{media:e,mediaSource:t,_objectUrl:r}=this;if(t){if(this.log("media source detaching"),t.readyState==="open")try{t.endOfStream()}catch(i){this.warn(`onMediaDetaching: ${i.message} while calling endOfStream`)}this.onBufferReset(),t.removeEventListener("sourceopen",this._onMediaSourceOpen),t.removeEventListener("sourceended",this._onMediaSourceEnded),t.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(t.removeEventListener("startstreaming",this._onStartStreaming),t.removeEventListener("endstreaming",this._onEndStreaming)),e&&(e.removeEventListener("emptied",this._onMediaEmptied),r&&self.URL.revokeObjectURL(r),this.mediaSrc===r?(e.removeAttribute("src"),this.appendSource&&removeSourceChildren(e),e.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(Events.MEDIA_DETACHED,void 0)}onBufferReset(){this.getSourceBufferTypes().forEach(e=>{this.resetBuffer(e)}),this._initSourceBuffer()}resetBuffer(e){const t=this.sourceBuffer[e];try{if(t){var r;this.removeBufferListeners(e),this.sourceBuffer[e]=void 0,(r=this.mediaSource)!=null&&r.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(t)}}catch(i){this.warn(`onBufferReset ${e}`,i)}}onBufferCodecs(e,t){const r=this.getSourceBufferTypes().length,i=Object.keys(t);if(i.forEach(o=>{if(r){const l=this.tracks[o];if(l&&typeof l.buffer.changeType=="function"){var a;const{id:c,codec:u,levelCodec:d,container:f,metadata:m}=t[o],g=pickMostCompleteCodecName(l.codec,l.levelCodec),v=g==null?void 0:g.replace(VIDEO_CODEC_PROFILE_REPLACE,"$1");let x=pickMostCompleteCodecName(u,d);const S=(a=x)==null?void 0:a.replace(VIDEO_CODEC_PROFILE_REPLACE,"$1");if(x&&v!==S){o.slice(0,5)==="audio"&&(x=getCodecCompatibleName(x,this.appendSource));const C=`${f};codecs=${x}`;this.appendChangeType(o,C),this.log(`switching codec ${g} to ${x}`),this.tracks[o]={buffer:l.buffer,codec:u,container:f,levelCodec:d,metadata:m,id:c}}}}else this.pendingTracks[o]=t[o]}),r)return;const s=Math.max(this.bufferCodecEventsExpected-1,0);this.bufferCodecEventsExpected!==s&&(this.log(`${s} bufferCodec event(s) expected ${i.join(",")}`),this.bufferCodecEventsExpected=s),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks()}appendChangeType(e,t){const{operationQueue:r}=this,i={execute:()=>{const s=this.sourceBuffer[e];s&&(this.log(`changing ${e} sourceBuffer type to ${t}`),s.changeType(t)),r.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:s=>{this.warn(`Failed to change ${e} SourceBuffer type`,s)}};r.append(i,e,!!this.pendingTracks[e])}onBufferAppending(e,t){const{hls:r,operationQueue:i,tracks:s}=this,{data:o,type:a,frag:l,part:c,chunkMeta:u}=t,d=u.buffering[a],f=self.performance.now();d.start=f;const m=l.stats.buffering,g=c?c.stats.buffering:null;m.start===0&&(m.start=f),g&&g.start===0&&(g.start=f);const v=s.audio;let x=!1;a==="audio"&&(v==null?void 0:v.container)==="audio/mpeg"&&(x=!this.lastMpegAudioChunk||u.id===1||this.lastMpegAudioChunk.sn!==u.sn,this.lastMpegAudioChunk=u);const S=l.start,C={execute:()=>{if(d.executeStart=self.performance.now(),x){const R=this.sourceBuffer[a];if(R){const k=S-R.timestampOffset;Math.abs(k)>=.1&&(this.log(`Updating audio SourceBuffer timestampOffset to ${S} (delta: ${k}) sn: ${l.sn})`),R.timestampOffset=S)}}this.appendExecutor(o,a)},onStart:()=>{},onComplete:()=>{const R=self.performance.now();d.executeEnd=d.end=R,m.first===0&&(m.first=R),g&&g.first===0&&(g.first=R);const{sourceBuffer:k}=this,I={};for(const F in k)I[F]=BufferHelper.getBuffered(k[F]);this.appendErrors[a]=0,a==="audio"||a==="video"?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(Events.BUFFER_APPENDED,{type:a,frag:l,part:c,chunkMeta:u,parent:l.type,timeRanges:I})},onError:R=>{const k={type:ErrorTypes.MEDIA_ERROR,parent:l.type,details:ErrorDetails.BUFFER_APPEND_ERROR,sourceBufferName:a,frag:l,part:c,chunkMeta:u,error:R,err:R,fatal:!1};if(R.code===DOMException.QUOTA_EXCEEDED_ERR)k.details=ErrorDetails.BUFFER_FULL_ERROR;else{const I=++this.appendErrors[a];k.details=ErrorDetails.BUFFER_APPEND_ERROR,this.warn(`Failed ${I}/${r.config.appendErrorMaxRetry} times to append segment in "${a}" sourceBuffer`),I>=r.config.appendErrorMaxRetry&&(k.fatal=!0)}r.trigger(Events.ERROR,k)}};i.append(C,a,!!this.pendingTracks[a])}onBufferFlushing(e,t){const{operationQueue:r}=this,i=s=>({execute:this.removeExecutor.bind(this,s,t.startOffset,t.endOffset),onStart:()=>{},onComplete:()=>{this.hls.trigger(Events.BUFFER_FLUSHED,{type:s})},onError:o=>{this.warn(`Failed to remove from ${s} SourceBuffer`,o)}});t.type?r.append(i(t.type),t.type):this.getSourceBufferTypes().forEach(s=>{r.append(i(s),s)})}onFragParsed(e,t){const{frag:r,part:i}=t,s=[],o=i?i.elementaryStreams:r.elementaryStreams;o[ElementaryStreamTypes.AUDIOVIDEO]?s.push("audiovideo"):(o[ElementaryStreamTypes.AUDIO]&&s.push("audio"),o[ElementaryStreamTypes.VIDEO]&&s.push("video"));const a=()=>{const l=self.performance.now();r.stats.buffering.end=l,i&&(i.stats.buffering.end=l);const c=i?i.stats:r.stats;this.hls.trigger(Events.FRAG_BUFFERED,{frag:r,part:i,stats:c,id:r.type})};s.length===0&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${r.type} level: ${r.level} sn: ${r.sn}`),this.blockBuffers(a,s)}onFragChanged(e,t){this.trimBuffers()}onBufferEos(e,t){this.getSourceBufferTypes().reduce((i,s)=>{const o=this.sourceBuffer[s];return o&&(!t.type||t.type===s)&&(o.ending=!0,o.ended||(o.ended=!0,this.log(`${s} sourceBuffer now EOS`))),i&&!!(!o||o.ended)},!0)&&(this.log("Queueing mediaSource.endOfStream()"),this.blockBuffers(()=>{this.getSourceBufferTypes().forEach(s=>{const o=this.sourceBuffer[s];o&&(o.ending=!1)});const{mediaSource:i}=this;if(!i||i.readyState!=="open"){i&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${i.readyState}`);return}this.log("Calling mediaSource.endOfStream()"),i.endOfStream()}))}onLevelUpdated(e,{details:t}){t.fragments.length&&(this.details=t,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())}trimBuffers(){const{hls:e,details:t,media:r}=this;if(!r||t===null||!this.getSourceBufferTypes().length)return;const s=e.config,o=r.currentTime,a=t.levelTargetDuration,l=t.live&&s.liveBackBufferLength!==null?s.liveBackBufferLength:s.backBufferLength;if(isFiniteNumber(l)&&l>0){const c=Math.max(l,a),u=Math.floor(o/a)*a-c;this.flushBackBuffer(o,a,u)}if(isFiniteNumber(s.frontBufferFlushThreshold)&&s.frontBufferFlushThreshold>0){const c=Math.max(s.maxBufferLength,s.frontBufferFlushThreshold),u=Math.max(c,a),d=Math.floor(o/a)*a+u;this.flushFrontBuffer(o,a,d)}}flushBackBuffer(e,t,r){const{details:i,sourceBuffer:s}=this;this.getSourceBufferTypes().forEach(a=>{const l=s[a];if(l){const c=BufferHelper.getBuffered(l);if(c.length>0&&r>c.start(0)){if(this.hls.trigger(Events.BACK_BUFFER_REACHED,{bufferEnd:r}),i!=null&&i.live)this.hls.trigger(Events.LIVE_BACK_BUFFER_REACHED,{bufferEnd:r});else if(l.ended&&c.end(c.length-1)-e<t*2){this.log(`Cannot flush ${a} back buffer while SourceBuffer is in ended state`);return}this.hls.trigger(Events.BUFFER_FLUSHING,{startOffset:0,endOffset:r,type:a})}}})}flushFrontBuffer(e,t,r){const{sourceBuffer:i}=this;this.getSourceBufferTypes().forEach(o=>{const a=i[o];if(a){const l=BufferHelper.getBuffered(a),c=l.length;if(c<2)return;const u=l.start(c-1),d=l.end(c-1);if(r>u||e>=u&&e<=d)return;if(a.ended&&e-d<2*t){this.log(`Cannot flush ${o} front buffer while SourceBuffer is in ended state`);return}this.hls.trigger(Events.BUFFER_FLUSHING,{startOffset:u,endOffset:1/0,type:o})}})}updateMediaElementDuration(){if(!this.details||!this.media||!this.mediaSource||this.mediaSource.readyState!=="open")return;const{details:e,hls:t,media:r,mediaSource:i}=this,s=e.fragments[0].start+e.totalduration,o=r.duration,a=isFiniteNumber(i.duration)?i.duration:0;e.live&&t.config.liveDurationInfinity?(i.duration=1/0,this.updateSeekableRange(e)):(s>a&&s>o||!isFiniteNumber(o))&&(this.log(`Updating Media Source duration to ${s.toFixed(3)}`),i.duration=s)}updateSeekableRange(e){const t=this.mediaSource,r=e.fragments;if(r.length&&e.live&&t!=null&&t.setLiveSeekableRange){const s=Math.max(0,r[0].start),o=Math.max(s,s+e.totalduration);this.log(`Media Source duration is set to ${t.duration}. Setting seekable range to ${s}-${o}.`),t.setLiveSeekableRange(s,o)}}checkPendingTracks(){const{bufferCodecEventsExpected:e,operationQueue:t,pendingTracks:r}=this,i=Object.keys(r).length;if(i&&(!e||i===2||"audiovideo"in r)){this.createSourceBuffers(r),this.pendingTracks={};const s=this.getSourceBufferTypes();if(s.length)this.hls.trigger(Events.BUFFER_CREATED,{tracks:this.tracks}),s.forEach(o=>{t.executeNext(o)});else{const o=new Error("could not create source buffer for media codec(s)");this.hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:o,reason:o.message})}}}createSourceBuffers(e){const{sourceBuffer:t,mediaSource:r}=this;if(!r)throw Error("createSourceBuffers called when mediaSource was null");for(const s in e)if(!t[s]){var i;const o=e[s];if(!o)throw Error(`source buffer exists for track ${s}, however track does not`);let a=((i=o.levelCodec)==null?void 0:i.indexOf(","))===-1?o.levelCodec:o.codec;a&&s.slice(0,5)==="audio"&&(a=getCodecCompatibleName(a,this.appendSource));const l=`${o.container};codecs=${a}`;this.log(`creating sourceBuffer(${l})`);try{const c=t[s]=r.addSourceBuffer(l),u=s;this.addBufferListener(u,"updatestart",this._onSBUpdateStart),this.addBufferListener(u,"updateend",this._onSBUpdateEnd),this.addBufferListener(u,"error",this._onSBUpdateError),this.appendSource&&this.addBufferListener(u,"bufferedchange",(d,f)=>{const m=f.removedRanges;m!=null&&m.length&&this.hls.trigger(Events.BUFFER_FLUSHED,{type:s})}),this.tracks[s]={buffer:c,codec:a,container:o.container,levelCodec:o.levelCodec,metadata:o.metadata,id:o.id}}catch(c){this.error(`error while trying to add sourceBuffer: ${c.message}`),this.hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:c,sourceBufferName:s,mimeType:l})}}}get mediaSrc(){var e,t;const r=((e=this.media)==null||(t=e.querySelector)==null?void 0:t.call(e,"source"))||this.media;return r==null?void 0:r.src}_onSBUpdateStart(e){const{operationQueue:t}=this;t.current(e).onStart()}_onSBUpdateEnd(e){var t;if(((t=this.mediaSource)==null?void 0:t.readyState)==="closed"){this.resetBuffer(e);return}const{operationQueue:r}=this;r.current(e).onComplete(),r.shiftAndExecuteNext(e)}_onSBUpdateError(e,t){var r;const i=new Error(`${e} SourceBuffer error. MediaSource readyState: ${(r=this.mediaSource)==null?void 0:r.readyState}`);this.error(`${i}`,t),this.hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:i,fatal:!1});const s=this.operationQueue.current(e);s&&s.onError(i)}removeExecutor(e,t,r){const{media:i,mediaSource:s,operationQueue:o,sourceBuffer:a}=this,l=a[e];if(!i||!s||!l){this.warn(`Attempting to remove from the ${e} SourceBuffer, but it does not exist`),o.shiftAndExecuteNext(e);return}const c=isFiniteNumber(i.duration)?i.duration:1/0,u=isFiniteNumber(s.duration)?s.duration:1/0,d=Math.max(0,t),f=Math.min(r,c,u);f>d&&(!l.ending||l.ended)?(l.ended=!1,this.log(`Removing [${d},${f}] from the ${e} SourceBuffer`),l.remove(d,f)):o.shiftAndExecuteNext(e)}appendExecutor(e,t){const r=this.sourceBuffer[t];if(!r){if(!this.pendingTracks[t])throw new Error(`Attempting to append to the ${t} SourceBuffer, but it does not exist`);return}r.ended=!1,r.appendBuffer(e)}blockBuffers(e,t=this.getSourceBufferTypes()){if(!t.length){this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);return}const{operationQueue:r}=this,i=t.map(s=>r.appendBlocker(s));Promise.all(i).then(()=>{e(),t.forEach(s=>{const o=this.sourceBuffer[s];o!=null&&o.updating||r.shiftAndExecuteNext(s)})})}getSourceBufferTypes(){return Object.keys(this.sourceBuffer)}addBufferListener(e,t,r){const i=this.sourceBuffer[e];if(!i)return;const s=r.bind(this,e);this.listeners[e].push({event:t,listener:s}),i.addEventListener(t,s)}removeBufferListeners(e){const t=this.sourceBuffer[e];t&&this.listeners[e].forEach(r=>{t.removeEventListener(r.event,r.listener)})}}function removeSourceChildren(n){const e=n.querySelectorAll("source");[].slice.call(e).forEach(t=>{n.removeChild(t)})}function addSource(n,e){const t=self.document.createElement("source");t.type="video/mp4",t.src=e,n.appendChild(t)}const specialCea608CharsCodes={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},getCharForByte=n=>String.fromCharCode(specialCea608CharsCodes[n]||n),NR_ROWS=15,NR_COLS=100,rowsLowCh1={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},rowsHighCh1={17:2,18:4,21:6,22:8,23:10,19:13,20:15},rowsLowCh2={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},rowsHighCh2={25:2,26:4,29:6,30:8,31:10,27:13,28:15},backgroundColors=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class CaptionsLogger{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){const r=typeof t=="function"?t():t;logger.log(`${this.time} [${e}] ${r}`)}}}const numArrayToHexArray=function n(e){const t=[];for(let r=0;r<e.length;r++)t.push(e[r].toString(16));return t};class PenState{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const t=["foreground","underline","italics","background","flash"];for(let r=0;r<t.length;r++){const i=t[r];e.hasOwnProperty(i)&&(this[i]=e[i])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class StyledUnicodeChar{constructor(){this.uchar=" ",this.penState=new PenState}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}class Row{constructor(e){this.chars=[],this.pos=0,this.currPenState=new PenState,this.cueStartTime=null,this.logger=void 0;for(let t=0;t<NR_COLS;t++)this.chars.push(new StyledUnicodeChar);this.logger=e}equals(e){for(let t=0;t<NR_COLS;t++)if(!this.chars[t].equals(e.chars[t]))return!1;return!0}copy(e){for(let t=0;t<NR_COLS;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<NR_COLS;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>NR_COLS&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=NR_COLS)}moveCursor(e){const t=this.pos+e;if(e>1)for(let r=this.pos+1;r<t+1;r++)this.chars[r].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const t=getCharForByte(e);if(this.pos>=NR_COLS){this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1)}clearFromPos(e){let t;for(t=e;t<NR_COLS;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let t=!0;for(let r=0;r<NR_COLS;r++){const i=this.chars[r].uchar;i!==" "&&(t=!1),e.push(i)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}}class CaptionScreen{constructor(e){this.rows=[],this.currRow=NR_ROWS-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let t=0;t<NR_ROWS;t++)this.rows.push(new Row(e));this.logger=e}reset(){for(let e=0;e<NR_ROWS;e++)this.rows[e].clear();this.currRow=NR_ROWS-1}equals(e){let t=!0;for(let r=0;r<NR_ROWS;r++)if(!this.rows[r].equals(e.rows[r])){t=!1;break}return t}copy(e){for(let t=0;t<NR_ROWS;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<NR_ROWS;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+JSON.stringify(e));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let a=0;a<NR_ROWS;a++)this.rows[a].clear();const s=this.currRow+1-this.nrRollUpRows,o=this.lastOutputScreen;if(o){const a=o.rows[s].cueStartTime,l=this.logger.time;if(a!==null&&l!==null&&a<l)for(let c=0;c<this.nrRollUpRows;c++)this.rows[t-this.nrRollUpRows+c+1].copy(o.rows[s+c])}}this.currRow=t;const r=this.rows[this.currRow];if(e.indent!==null){const s=e.indent,o=Math.max(s-1,0);r.setCursor(e.indent),e.color=r.chars[o].penState.foreground}const i={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(i)}setBkgData(e){this.logger.log(2,()=>"bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());const e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const t=[];let r="",i=-1;for(let s=0;s<NR_ROWS;s++){const o=this.rows[s].getTextString();o&&(i=s+1,e?t.push("Row "+i+": '"+o+"'"):t.push(o.trim()))}return t.length>0&&(e?r="["+t.join(" | ")+"]":r=t.join(`
`)),r}getTextAndFormat(){return this.rows}}class Cea608Channel{constructor(e,t,r){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new CaptionScreen(r),this.nonDisplayedMemory=new CaptionScreen(r),this.lastOutputScreen=new CaptionScreen(r),this.currRollUpRow=this.displayedMemory.rows[NR_ROWS-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=r}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[NR_ROWS-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let r=0;r<e.length;r++)this.writeScreen.insertChar(e[r]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>t+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const t={flash:!1};if(t.underline=e%2===1,t.italics=e>=46,t.italics)t.foreground="white";else{const r=Math.floor(e/2)-16,i=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=i[r]}this.logger.log(2,"MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){const t=this.logger.time;t!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=t:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class Cea608Parser{constructor(e,t,r){this.channels=void 0,this.currentChannel=0,this.cmdHistory=createCmdHistory(),this.logger=void 0;const i=this.logger=new CaptionsLogger;this.channels=[null,new Cea608Channel(e,t,i),new Cea608Channel(e+1,r,i)]}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){this.logger.time=e;for(let r=0;r<t.length;r+=2){const i=t[r]&127,s=t[r+1]&127;let o=!1,a=null;if(i===0&&s===0)continue;this.logger.log(3,()=>"["+numArrayToHexArray([t[r],t[r+1]])+"] -> ("+numArrayToHexArray([i,s])+")");const l=this.cmdHistory;if(i>=16&&i<=31){if(hasCmdRepeated(i,s,l)){setLastCmd(null,null,l),this.logger.log(3,()=>"Repeated command ("+numArrayToHexArray([i,s])+") is dropped");continue}setLastCmd(i,s,this.cmdHistory),o=this.parseCmd(i,s),o||(o=this.parseMidrow(i,s)),o||(o=this.parsePAC(i,s)),o||(o=this.parseBackgroundAttributes(i,s))}else setLastCmd(null,null,l);if(!o&&(a=this.parseChars(i,s),a)){const u=this.currentChannel;u&&u>0?this.channels[u].insertChars(a):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!o&&!a&&this.logger.log(2,()=>"Couldn't parse cleaned data "+numArrayToHexArray([i,s])+" orig: "+numArrayToHexArray([t[r],t[r+1]]))}}parseCmd(e,t){const r=(e===20||e===28||e===21||e===29)&&t>=32&&t<=47,i=(e===23||e===31)&&t>=33&&t<=35;if(!(r||i))return!1;const s=e===20||e===21||e===23?1:2,o=this.channels[s];return e===20||e===21||e===28||e===29?t===32?o.ccRCL():t===33?o.ccBS():t===34?o.ccAOF():t===35?o.ccAON():t===36?o.ccDER():t===37?o.ccRU(2):t===38?o.ccRU(3):t===39?o.ccRU(4):t===40?o.ccFON():t===41?o.ccRDC():t===42?o.ccTR():t===43?o.ccRTD():t===44?o.ccEDM():t===45?o.ccCR():t===46?o.ccENM():t===47&&o.ccEOC():o.ccTO(t-32),this.currentChannel=s,!0}parseMidrow(e,t){let r=0;if((e===17||e===25)&&t>=32&&t<=47){if(e===17?r=1:r=2,r!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const i=this.channels[r];return i?(i.ccMIDROW(t),this.logger.log(3,()=>"MIDROW ("+numArrayToHexArray([e,t])+")"),!0):!1}return!1}parsePAC(e,t){let r;const i=(e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127,s=(e===16||e===24)&&t>=64&&t<=95;if(!(i||s))return!1;const o=e<=23?1:2;t>=64&&t<=95?r=o===1?rowsLowCh1[e]:rowsLowCh2[e]:r=o===1?rowsHighCh1[e]:rowsHighCh2[e];const a=this.channels[o];return a?(a.setPAC(this.interpretPAC(r,t)),this.currentChannel=o,!0):!1}interpretPAC(e,t){let r;const i={color:null,italics:!1,indent:null,underline:!1,row:e};return t>95?r=t-96:r=t-64,i.underline=(r&1)===1,r<=13?i.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(r/2)]:r<=15?(i.italics=!0,i.color="white"):i.indent=Math.floor((r-16)/2)*4,i}parseChars(e,t){let r,i=null,s=null;if(e>=25?(r=2,s=e-8):(r=1,s=e),s>=17&&s<=19){let o;s===17?o=t+80:s===18?o=t+112:o=t+144,this.logger.log(2,()=>"Special char '"+getCharForByte(o)+"' in channel "+r),i=[o]}else e>=32&&e<=127&&(i=t===0?[e]:[e,t]);return i&&this.logger.log(3,()=>"Char codes =  "+numArrayToHexArray(i).join(",")),i}parseBackgroundAttributes(e,t){const r=(e===16||e===24)&&t>=32&&t<=47,i=(e===23||e===31)&&t>=45&&t<=47;if(!(r||i))return!1;let s;const o={};e===16||e===24?(s=Math.floor((t-32)/2),o.background=backgroundColors[s],t%2===1&&(o.background=o.background+"_semi")):t===45?o.background="transparent":(o.foreground="black",t===47&&(o.underline=!0));const a=e<=23?1:2;return this.channels[a].setBkgData(o),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const t=this.channels[e];t&&t.reset()}setLastCmd(null,null,this.cmdHistory)}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){const r=this.channels[t];r&&r.cueSplitAtTime(e)}}}function setLastCmd(n,e,t){t.a=n,t.b=e}function hasCmdRepeated(n,e,t){return t.a===n&&t.b===e}function createCmdHistory(){return{a:null,b:null}}class OutputFilter{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,r){(this.startTime===null||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=r,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}var VTTCue=function(){if(optionalSelf!=null&&optionalSelf.VTTCue)return self.VTTCue;const n=["","lr","rl"],e=["start","middle","end","left","right"];function t(a,l){if(typeof l!="string"||!Array.isArray(a))return!1;const c=l.toLowerCase();return~a.indexOf(c)?c:!1}function r(a){return t(n,a)}function i(a){return t(e,a)}function s(a,...l){let c=1;for(;c<arguments.length;c++){const u=arguments[c];for(const d in u)a[d]=u[d]}return a}function o(a,l,c){const u=this,d={enumerable:!0};u.hasBeenReset=!1;let f="",m=!1,g=a,v=l,x=c,S=null,C="",R=!0,k="auto",I="start",F=50,N="middle",U=50,M="middle";Object.defineProperty(u,"id",s({},d,{get:function(){return f},set:function(B){f=""+B}})),Object.defineProperty(u,"pauseOnExit",s({},d,{get:function(){return m},set:function(B){m=!!B}})),Object.defineProperty(u,"startTime",s({},d,{get:function(){return g},set:function(B){if(typeof B!="number")throw new TypeError("Start time must be set to a number.");g=B,this.hasBeenReset=!0}})),Object.defineProperty(u,"endTime",s({},d,{get:function(){return v},set:function(B){if(typeof B!="number")throw new TypeError("End time must be set to a number.");v=B,this.hasBeenReset=!0}})),Object.defineProperty(u,"text",s({},d,{get:function(){return x},set:function(B){x=""+B,this.hasBeenReset=!0}})),Object.defineProperty(u,"region",s({},d,{get:function(){return S},set:function(B){S=B,this.hasBeenReset=!0}})),Object.defineProperty(u,"vertical",s({},d,{get:function(){return C},set:function(B){const H=r(B);if(H===!1)throw new SyntaxError("An invalid or illegal string was specified.");C=H,this.hasBeenReset=!0}})),Object.defineProperty(u,"snapToLines",s({},d,{get:function(){return R},set:function(B){R=!!B,this.hasBeenReset=!0}})),Object.defineProperty(u,"line",s({},d,{get:function(){return k},set:function(B){if(typeof B!="number"&&B!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");k=B,this.hasBeenReset=!0}})),Object.defineProperty(u,"lineAlign",s({},d,{get:function(){return I},set:function(B){const H=i(B);if(!H)throw new SyntaxError("An invalid or illegal string was specified.");I=H,this.hasBeenReset=!0}})),Object.defineProperty(u,"position",s({},d,{get:function(){return F},set:function(B){if(B<0||B>100)throw new Error("Position must be between 0 and 100.");F=B,this.hasBeenReset=!0}})),Object.defineProperty(u,"positionAlign",s({},d,{get:function(){return N},set:function(B){const H=i(B);if(!H)throw new SyntaxError("An invalid or illegal string was specified.");N=H,this.hasBeenReset=!0}})),Object.defineProperty(u,"size",s({},d,{get:function(){return U},set:function(B){if(B<0||B>100)throw new Error("Size must be between 0 and 100.");U=B,this.hasBeenReset=!0}})),Object.defineProperty(u,"align",s({},d,{get:function(){return M},set:function(B){const H=i(B);if(!H)throw new SyntaxError("An invalid or illegal string was specified.");M=H,this.hasBeenReset=!0}})),u.displayState=void 0}return o.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},o}();class StringDecoder{decode(e,t){if(!e)return"";if(typeof e!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function parseTimeStamp(n){function e(r,i,s,o){return(r|0)*3600+(i|0)*60+(s|0)+parseFloat(o||0)}const t=n.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return t?parseFloat(t[2])>59?e(t[2],t[3],0,t[4]):e(t[1],t[2],t[3],t[4]):null}class Settings{constructor(){this.values=Object.create(null)}set(e,t){!this.get(e)&&t!==""&&(this.values[e]=t)}get(e,t,r){return r?this.has(e)?this.values[e]:t[r]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,r){for(let i=0;i<r.length;++i)if(t===r[i]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){const r=parseFloat(t);if(r>=0&&r<=100)return this.set(e,r),!0}return!1}}function parseOptions(n,e,t,r){const i=r?n.split(r):[n];for(const s in i){if(typeof i[s]!="string")continue;const o=i[s].split(t);if(o.length!==2)continue;const a=o[0],l=o[1];e(a,l)}}const defaults=new VTTCue(0,0,""),center=defaults.align==="middle"?"middle":"center";function parseCue(n,e,t){const r=n;function i(){const a=parseTimeStamp(n);if(a===null)throw new Error("Malformed timestamp: "+r);return n=n.replace(/^[^\sa-zA-Z-]+/,""),a}function s(a,l){const c=new Settings;parseOptions(a,function(f,m){let g;switch(f){case"region":for(let v=t.length-1;v>=0;v--)if(t[v].id===m){c.set(f,t[v].region);break}break;case"vertical":c.alt(f,m,["rl","lr"]);break;case"line":g=m.split(","),c.integer(f,g[0]),c.percent(f,g[0])&&c.set("snapToLines",!1),c.alt(f,g[0],["auto"]),g.length===2&&c.alt("lineAlign",g[1],["start",center,"end"]);break;case"position":g=m.split(","),c.percent(f,g[0]),g.length===2&&c.alt("positionAlign",g[1],["start",center,"end","line-left","line-right","auto"]);break;case"size":c.percent(f,m);break;case"align":c.alt(f,m,["start",center,"end","left","right"]);break}},/:/,/\s/),l.region=c.get("region",null),l.vertical=c.get("vertical","");let u=c.get("line","auto");u==="auto"&&defaults.line===-1&&(u=-1),l.line=u,l.lineAlign=c.get("lineAlign","start"),l.snapToLines=c.get("snapToLines",!0),l.size=c.get("size",100),l.align=c.get("align",center);let d=c.get("position","auto");d==="auto"&&defaults.position===50&&(d=l.align==="start"||l.align==="left"?0:l.align==="end"||l.align==="right"?100:50),l.position=d}function o(){n=n.replace(/^\s+/,"")}if(o(),e.startTime=i(),o(),n.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+r);n=n.slice(3),o(),e.endTime=i(),o(),s(n,e)}function fixLineBreaks(n){return n.replace(/<br(?: \/)?>/gi,`
`)}class VTTParser{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new StringDecoder,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const t=this;e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));function r(){let s=t.buffer,o=0;for(s=fixLineBreaks(s);o<s.length&&s[o]!=="\r"&&s[o]!==`
`;)++o;const a=s.slice(0,o);return s[o]==="\r"&&++o,s[o]===`
`&&++o,t.buffer=s.slice(o),a}function i(s){parseOptions(s,function(o,a){},/:/)}try{let s="";if(t.state==="INITIAL"){if(!/\r\n|\n/.test(t.buffer))return this;s=r();const a=s.match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!(a!=null&&a[0]))throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let o=!1;for(;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(o?o=!1:s=r(),t.state){case"HEADER":/:/.test(s)?i(s):s||(t.state="ID");continue;case"NOTE":s||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(s)){t.state="NOTE";break}if(!s)continue;if(t.cue=new VTTCue(0,0,""),t.state="CUE",s.indexOf("-->")===-1){t.cue.id=s;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{parseCue(s,t.cue,t.regionList)}catch{t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{const a=s.indexOf("-->")!==-1;if(!s||a&&(o=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(t.cue===null)continue;t.cue.text&&(t.cue.text+=`
`),t.cue.text+=s}continue;case"BADCUE":s||(t.state="ID")}}}catch{t.state==="CUETEXT"&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state=t.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||e.state==="HEADER")&&(e.buffer+=`

`,e.parse()),e.state==="INITIAL"||e.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}}const LINEBREAKS=/\r\n|\n\r|\n|\r/g,startsWith=function n(e,t,r=0){return e.slice(r,r+t.length)===t},cueString2millis=function n(e){let t=parseInt(e.slice(-3));const r=parseInt(e.slice(-6,-4)),i=parseInt(e.slice(-9,-7)),s=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!isFiniteNumber(t)||!isFiniteNumber(r)||!isFiniteNumber(i)||!isFiniteNumber(s))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+=1e3*r,t+=60*1e3*i,t+=60*60*1e3*s,t},hash=function n(e){let t=5381,r=e.length;for(;r;)t=t*33^e.charCodeAt(--r);return(t>>>0).toString()};function generateCueId(n,e,t){return hash(n.toString())+hash(e.toString())+hash(t)}const calculateOffset=function n(e,t,r){let i=e[t],s=e[i.prevCC];if(!s||!s.new&&i.new){e.ccOffset=e.presentationOffset=i.start,i.new=!1;return}for(;(o=s)!=null&&o.new;){var o;e.ccOffset+=i.start-s.start,i.new=!1,i=s,s=e[i.prevCC]}e.presentationOffset=r};function parseWebVTT(n,e,t,r,i,s,o){const a=new VTTParser,l=utf8ArrayToStr(new Uint8Array(n)).trim().replace(LINEBREAKS,`
`).split(`
`),c=[],u=e?toMpegTsClockFromTimescale(e.baseTime,e.timescale):0;let d="00:00.000",f=0,m=0,g,v=!0;a.oncue=function(x){const S=t[r];let C=t.ccOffset;const R=(f-u)/9e4;if(S!=null&&S.new&&(m!==void 0?C=t.ccOffset=S.start:calculateOffset(t,r,R)),R){if(!e){g=new Error("Missing initPTS for VTT MPEGTS");return}C=R-t.presentationOffset}const k=x.endTime-x.startTime,I=normalizePts((x.startTime+C-m)*9e4,i*9e4)/9e4;x.startTime=Math.max(I,0),x.endTime=Math.max(I+k,0);const F=x.text.trim();x.text=decodeURIComponent(encodeURIComponent(F)),x.id||(x.id=generateCueId(x.startTime,x.endTime,F)),x.endTime>0&&c.push(x)},a.onparsingerror=function(x){g=x},a.onflush=function(){if(g){o(g);return}s(c)},l.forEach(x=>{if(v)if(startsWith(x,"X-TIMESTAMP-MAP=")){v=!1,x.slice(16).split(",").forEach(S=>{startsWith(S,"LOCAL:")?d=S.slice(6):startsWith(S,"MPEGTS:")&&(f=parseInt(S.slice(7)))});try{m=cueString2millis(d)/1e3}catch(S){g=S}return}else x===""&&(v=!1);a.parse(x+`
`)}),a.flush()}const IMSC1_CODEC="stpp.ttml.im1t",HMSF_REGEX=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,TIME_UNIT_REGEX=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,textAlignToLineAlign={left:"start",center:"center",right:"end",start:"start",end:"end"};function parseIMSC1(n,e,t,r){const i=findBox(new Uint8Array(n),["mdat"]);if(i.length===0){r(new Error("Could not parse IMSC1 mdat"));return}const s=i.map(a=>utf8ArrayToStr(a)),o=toTimescaleFromScale(e.baseTime,1,e.timescale);try{s.forEach(a=>t(parseTTML(a,o)))}catch(a){r(a)}}function parseTTML(n,e){const i=new DOMParser().parseFromString(n,"text/xml").getElementsByTagName("tt")[0];if(!i)throw new Error("Invalid ttml");const s={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},o=Object.keys(s).reduce((d,f)=>(d[f]=i.getAttribute(`ttp:${f}`)||s[f],d),{}),a=i.getAttribute("xml:space")!=="preserve",l=collectionToDictionary(getElementCollection(i,"styling","style")),c=collectionToDictionary(getElementCollection(i,"layout","region")),u=getElementCollection(i,"body","[begin]");return[].map.call(u,d=>{const f=getTextContent(d,a);if(!f||!d.hasAttribute("begin"))return null;const m=parseTtmlTime(d.getAttribute("begin"),o),g=parseTtmlTime(d.getAttribute("dur"),o);let v=parseTtmlTime(d.getAttribute("end"),o);if(m===null)throw timestampParsingError(d);if(v===null){if(g===null)throw timestampParsingError(d);v=m+g}const x=new VTTCue(m-e,v-e,f);x.id=generateCueId(x.startTime,x.endTime,x.text);const S=c[d.getAttribute("region")],C=l[d.getAttribute("style")],R=getTtmlStyles(S,C,l),{textAlign:k}=R;if(k){const I=textAlignToLineAlign[k];I&&(x.lineAlign=I),x.align=k}return _extends(x,R),x}).filter(d=>d!==null)}function getElementCollection(n,e,t){const r=n.getElementsByTagName(e)[0];return r?[].slice.call(r.querySelectorAll(t)):[]}function collectionToDictionary(n){return n.reduce((e,t)=>{const r=t.getAttribute("xml:id");return r&&(e[r]=t),e},{})}function getTextContent(n,e){return[].slice.call(n.childNodes).reduce((t,r,i)=>{var s;return r.nodeName==="br"&&i?t+`
`:(s=r.childNodes)!=null&&s.length?getTextContent(r,e):e?t+r.textContent.trim().replace(/\s+/g," "):t+r.textContent},"")}function getTtmlStyles(n,e,t){const r="http://www.w3.org/ns/ttml#styling";let i=null;const s=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],o=n!=null&&n.hasAttribute("style")?n.getAttribute("style"):null;return o&&t.hasOwnProperty(o)&&(i=t[o]),s.reduce((a,l)=>{const c=getAttributeNS(e,r,l)||getAttributeNS(n,r,l)||getAttributeNS(i,r,l);return c&&(a[l]=c),a},{})}function getAttributeNS(n,e,t){return n&&n.hasAttributeNS(e,t)?n.getAttributeNS(e,t):null}function timestampParsingError(n){return new Error(`Could not parse ttml timestamp ${n}`)}function parseTtmlTime(n,e){if(!n)return null;let t=parseTimeStamp(n);return t===null&&(HMSF_REGEX.test(n)?t=parseHoursMinutesSecondsFrames(n,e):TIME_UNIT_REGEX.test(n)&&(t=parseTimeUnits(n,e))),t}function parseHoursMinutesSecondsFrames(n,e){const t=HMSF_REGEX.exec(n),r=(t[4]|0)+(t[5]|0)/e.subFrameRate;return(t[1]|0)*3600+(t[2]|0)*60+(t[3]|0)+r/e.frameRate}function parseTimeUnits(n,e){const t=TIME_UNIT_REGEX.exec(n),r=Number(t[1]);switch(t[2]){case"h":return r*3600;case"m":return r*60;case"ms":return r*1e3;case"f":return r/e.frameRate;case"t":return r/e.tickRate}return r}class TimelineController{constructor(e){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=newVTTCCs(),this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},e.on(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Events.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(Events.FRAG_LOADING,this.onFragLoading,this),e.on(Events.FRAG_LOADED,this.onFragLoaded,this),e.on(Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(Events.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(Events.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(Events.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Events.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(Events.FRAG_LOADING,this.onFragLoading,this),e.off(Events.FRAG_LOADED,this.onFragLoaded,this),e.off(Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(Events.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(Events.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){if(this.config.enableCEA708Captions&&(!this.cea608Parser1||!this.cea608Parser2)){const e=new OutputFilter(this,"textTrack1"),t=new OutputFilter(this,"textTrack2"),r=new OutputFilter(this,"textTrack3"),i=new OutputFilter(this,"textTrack4");this.cea608Parser1=new Cea608Parser(1,e,t),this.cea608Parser2=new Cea608Parser(3,r,i)}}addCues(e,t,r,i,s){let o=!1;for(let a=s.length;a--;){const l=s[a],c=intersection(l[0],l[1],t,r);if(c>=0&&(l[0]=Math.min(l[0],t),l[1]=Math.max(l[1],r),o=!0,c/(r-t)>.5))return}if(o||s.push([t,r]),this.config.renderTextTracksNatively){const a=this.captionsTracks[e];this.Cues.newCue(a,t,r,i)}else{const a=this.Cues.newCue(null,t,r,i);this.hls.trigger(Events.CUES_PARSED,{type:"captions",cues:a,track:e})}}onInitPtsFound(e,{frag:t,id:r,initPTS:i,timescale:s}){const{unparsedVttFrags:o}=this;r==="main"&&(this.initPTS[t.cc]={baseTime:i,timescale:s}),o.length&&(this.unparsedVttFrags=[],o.forEach(a=>{this.onFragLoaded(Events.FRAG_LOADED,a)}))}getExistingTrack(e,t){const{media:r}=this;if(r)for(let i=0;i<r.textTracks.length;i++){const s=r.textTracks[i];if(canReuseVttTextTrack(s,{name:e,lang:t,attrs:{}}))return s}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:t,captionsTracks:r,media:i}=this,{label:s,languageCode:o}=t[e],a=this.getExistingTrack(s,o);if(a)r[e]=a,clearCurrentCues(r[e]),sendAddTrackEvent(r[e],i);else{const l=this.createTextTrack("captions",s,o);l&&(l[e]=!0,r[e]=l)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const t=this.captionsProperties[e];if(!t)return;const r=t.label,i={_id:e,label:r,kind:"captions",default:t.media?!!t.media.default:!1,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=i,this.hls.trigger(Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[i]})}createTextTrack(e,t,r){const i=this.media;if(i)return i.addTextTrack(e,t,r)}onMediaAttaching(e,t){this.media=t.media,this._cleanTracks()}onMediaDetaching(){const{captionsTracks:e}=this;Object.keys(e).forEach(t=>{clearCurrentCues(e[t]),delete e[t]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=newVTTCCs(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const t=e.textTracks;if(t)for(let r=0;r<t.length;r++)clearCurrentCues(t[r])}onSubtitleTracksUpdated(e,t){const r=t.subtitleTracks||[],i=r.some(s=>s.textCodec===IMSC1_CODEC);if(this.config.enableWebVTT||i&&this.config.enableIMSC1){if(subtitleOptionsIdentical(this.tracks,r)){this.tracks=r;return}if(this.textTracks=[],this.tracks=r,this.config.renderTextTracksNatively){const o=this.media,a=o?filterSubtitleTracks(o.textTracks):null;if(this.tracks.forEach((l,c)=>{let u;if(a){let d=null;for(let f=0;f<a.length;f++)if(a[f]&&canReuseVttTextTrack(a[f],l)){d=a[f],a[f]=null;break}d&&(u=d)}if(u)clearCurrentCues(u);else{const d=captionsOrSubtitlesFromCharacteristics(l);u=this.createTextTrack(d,l.name,l.lang),u&&(u.mode="disabled")}u&&this.textTracks.push(u)}),a!=null&&a.length){const l=a.filter(c=>c!==null).map(c=>c.label);l.length&&logger.warn(`Media element contains unused subtitle tracks: ${l.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const o=this.tracks.map(a=>({label:a.name,kind:a.type.toLowerCase(),default:a.default,subtitleTrack:a}));this.hls.trigger(Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:o})}}}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(r=>{const i=/(?:CC|SERVICE)([1-4])/.exec(r.instreamId);if(!i)return;const s=`textTrack${i[1]}`,o=this.captionsProperties[s];o&&(o.label=r.name,r.lang&&(o.languageCode=r.lang),o.media=r)})}closedCaptionsForLevel(e){const t=this.hls.levels[e.level];return t==null?void 0:t.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){if(this.enabled&&t.frag.type===PlaylistLevelType.MAIN){var r,i;const{cea608Parser1:s,cea608Parser2:o,lastSn:a}=this,{cc:l,sn:c}=t.frag,u=(r=(i=t.part)==null?void 0:i.index)!=null?r:-1;s&&o&&(c!==a+1||c===a&&u!==this.lastPartIndex+1||l!==this.lastCc)&&(s.reset(),o.reset()),this.lastCc=l,this.lastSn=c,this.lastPartIndex=u}}onFragLoaded(e,t){const{frag:r,payload:i}=t;if(r.type===PlaylistLevelType.SUBTITLE)if(i.byteLength){const s=r.decryptdata,o="stats"in t;if(s==null||!s.encrypted||o){const a=this.tracks[r.level],l=this.vttCCs;l[r.cc]||(l[r.cc]={start:r.start,prevCC:this.prevCC,new:!0},this.prevCC=r.cc),a&&a.textCodec===IMSC1_CODEC?this._parseIMSC1(r,i):this._parseVTTs(t)}}else this.hls.trigger(Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:r,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){const r=this.hls;parseIMSC1(t,this.initPTS[e.cc],i=>{this._appendCues(i,e.level),r.trigger(Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},i=>{logger.log(`Failed to parse IMSC1: ${i}`),r.trigger(Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:i})})}_parseVTTs(e){var t;const{frag:r,payload:i}=e,{initPTS:s,unparsedVttFrags:o}=this,a=s.length-1;if(!s[r.cc]&&a===-1){o.push(e);return}const l=this.hls,c=(t=r.initSegment)!=null&&t.data?appendUint8Array(r.initSegment.data,new Uint8Array(i)):i;parseWebVTT(c,this.initPTS[r.cc],this.vttCCs,r.cc,r.start,u=>{this._appendCues(u,r.level),l.trigger(Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:r})},u=>{const d=u.message==="Missing initPTS for VTT MPEGTS";d?o.push(e):this._fallbackToIMSC1(r,i),logger.log(`Failed to parse VTT cue: ${u}`),!(d&&a>r.cc)&&l.trigger(Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:r,error:u})})}_fallbackToIMSC1(e,t){const r=this.tracks[e.level];r.textCodec||parseIMSC1(t,this.initPTS[e.cc],()=>{r.textCodec=IMSC1_CODEC,this._parseIMSC1(e,t)},()=>{r.textCodec="wvtt"})}_appendCues(e,t){const r=this.hls;if(this.config.renderTextTracksNatively){const i=this.textTracks[t];if(!i||i.mode==="disabled")return;e.forEach(s=>addCueToTrack(i,s))}else{const i=this.tracks[t];if(!i)return;const s=i.default?"default":"subtitles"+t;r.trigger(Events.CUES_PARSED,{type:"subtitles",cues:e,track:s})}}onFragDecrypted(e,t){const{frag:r}=t;r.type===PlaylistLevelType.SUBTITLE&&this.onFragLoaded(Events.FRAG_LOADED,t)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){this.initCea608Parsers();const{cea608Parser1:r,cea608Parser2:i}=this;if(!this.enabled||!r||!i)return;const{frag:s,samples:o}=t;if(!(s.type===PlaylistLevelType.MAIN&&this.closedCaptionsForLevel(s)==="NONE"))for(let a=0;a<o.length;a++){const l=o[a].bytes;if(l){const c=this.extractCea608Data(l);r.addData(o[a].pts,c[0]),i.addData(o[a].pts,c[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:r,endOffsetSubtitles:i,type:s}){const{media:o}=this;if(!(!o||o.currentTime<r)){if(!s||s==="video"){const{captionsTracks:a}=this;Object.keys(a).forEach(l=>removeCuesInRange(a[l],t,r))}if(this.config.renderTextTracksNatively&&t===0&&i!==void 0){const{textTracks:a}=this;Object.keys(a).forEach(l=>removeCuesInRange(a[l],t,i))}}}extractCea608Data(e){const t=[[],[]],r=e[0]&31;let i=2;for(let s=0;s<r;s++){const o=e[i++],a=127&e[i++],l=127&e[i++];if(a===0&&l===0)continue;if((4&o)!==0){const u=3&o;(u===0||u===1)&&(t[u].push(a),t[u].push(l))}}return t}}function captionsOrSubtitlesFromCharacteristics(n){return n.characteristics&&/transcribes-spoken-dialog/gi.test(n.characteristics)&&/describes-music-and-sound/gi.test(n.characteristics)?"captions":"subtitles"}function canReuseVttTextTrack(n,e){return!!n&&n.kind===captionsOrSubtitlesFromCharacteristics(e)&&subtitleTrackMatchesTextTrack(e,n)}function intersection(n,e,t,r){return Math.min(e,r)-Math.max(n,t)}function newVTTCCs(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}class CapLevelController{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(Events.MANIFEST_PARSED,this.onManifestParsed,this),e.on(Events.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(Events.BUFFER_CODECS,this.onBufferCodecs,this),e.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(Events.MANIFEST_PARSED,this.onManifestParsed,this),e.off(Events.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(Events.BUFFER_CODECS,this.onBufferCodecs,this),e.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){const r=this.hls.levels[t.droppedLevel];this.isLevelAllowed(r)&&this.restrictedLevels.push({bitrate:r.bitrate,height:r.height,width:r.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(e,t){const r=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,r.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onLevelsUpdated(e,t){this.timer&&isFiniteNumber(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping()}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0){this.clientRect=null;return}const e=this.hls.levels;if(e.length){const t=this.hls,r=this.getMaxLevel(e.length-1);r!==this.autoLevelCapping&&logger.log(`Setting autoLevelCapping to ${r}: ${e[r].height}p@${e[r].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),t.autoLevelCapping=r,t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){const t=this.hls.levels;if(!t.length)return-1;const r=t.filter((i,s)=>this.isLevelAllowed(i)&&s<=e);return this.clientRect=null,CapLevelController.getMaxLevelByMediaSize(r,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,t={width:0,height:0};if(e){const r=e.getBoundingClientRect();t.width=r.width,t.height=r.height,!t.width&&!t.height&&(t.width=r.right-r.left||e.width||0,t.height=r.bottom-r.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch{}return e}isLevelAllowed(e){return!this.restrictedLevels.some(r=>e.bitrate===r.bitrate&&e.width===r.width&&e.height===r.height)}static getMaxLevelByMediaSize(e,t,r){if(!(e!=null&&e.length))return-1;const i=(a,l)=>l?a.width!==l.width||a.height!==l.height:!0;let s=e.length-1;const o=Math.max(t,r);for(let a=0;a<e.length;a+=1){const l=e[a];if((l.width>=o||l.height>=o)&&i(l,e[a+1])){s=a;break}}return s}}class FPSController{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(Events.MEDIA_ATTACHING,this.onMediaAttaching,this)}unregisterListeners(){this.hls.off(Events.MEDIA_ATTACHING,this.onMediaAttaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){const r=this.hls.config;if(r.capLevelOnFPSDrop){const i=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=i,i&&typeof i.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),r.fpsDroppedMonitoringPeriod)}}checkFPS(e,t,r){const i=performance.now();if(t){if(this.lastTime){const s=i-this.lastTime,o=r-this.lastDroppedFrames,a=t-this.lastDecodedFrames,l=1e3*o/s,c=this.hls;if(c.trigger(Events.FPS_DROP,{currentDropped:o,currentDecoded:a,totalDroppedFrames:r}),l>0&&o>c.config.fpsDroppedMonitoringThreshold*a){let u=c.currentLevel;logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+u),u>0&&(c.autoLevelCapping===-1||c.autoLevelCapping>=u)&&(u=u-1,c.trigger(Events.FPS_DROP_LEVEL_CAPPING,{level:u,droppedLevel:c.currentLevel}),c.autoLevelCapping=u,this.streamController.nextLevelSwitch())}}this.lastTime=i,this.lastDroppedFrames=r,this.lastDecodedFrames=t}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}const LOGGER_PREFIX="[eme]";class EMEController{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=EMEController.CDMCleanupPromise?[EMEController.CDMCleanupPromise]:[],this.onMediaEncrypted=this._onMediaEncrypted.bind(this),this.onWaitingForKey=this._onWaitingForKey.bind(this),this.debug=logger.debug.bind(logger,LOGGER_PREFIX),this.log=logger.log.bind(logger,LOGGER_PREFIX),this.warn=logger.warn.bind(logger,LOGGER_PREFIX),this.error=logger.error.bind(logger,LOGGER_PREFIX),this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.unregisterListeners(),this.onMediaDetached();const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.onMediaEncrypted=this.onWaitingForKey=this.keyIdToKeySessionPromise=null,this.config=null}registerListeners(){this.hls.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(Events.MANIFEST_LOADED,this.onManifestLoaded,this)}unregisterListeners(){this.hls.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(Events.MANIFEST_LOADED,this.onManifestLoaded,this)}getLicenseServerUrl(e){const{drmSystems:t,widevineLicenseUrl:r}=this.config,i=t[e];if(i)return i.licenseUrl;if(e===KeySystems.WIDEVINE&&r)return r;throw new Error(`no license server URL configured for key-system "${e}"`)}getServerCertificateUrl(e){const{drmSystems:t}=this.config,r=t[e];if(r)return r.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const t=this.hls.levels,r=(o,a,l)=>!!o&&l.indexOf(o)===a,i=t.map(o=>o.audioCodec).filter(r),s=t.map(o=>o.videoCodec).filter(r);return i.length+s.length===0&&s.push("avc1.42e01e"),new Promise((o,a)=>{const l=c=>{const u=c.shift();this.getMediaKeysPromise(u,i,s).then(d=>o({keySystem:u,mediaKeys:d})).catch(d=>{c.length?l(c):d instanceof EMEKeyError?a(d):a(new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_NO_ACCESS,error:d,fatal:!0},d.message))})};l(e)})}requestMediaKeySystemAccess(e,t){const{requestMediaKeySystemAccessFunc:r}=this.config;if(typeof r!="function"){let i=`Configured requestMediaKeySystemAccess is not a function ${r}`;return requestMediaKeySystemAccess===null&&self.location.protocol==="http:"&&(i=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(i))}return r(e,t)}getMediaKeysPromise(e,t,r){const i=getSupportedMediaKeySystemConfigurations(e,t,r,this.config.drmSystemOptions),s=this.keySystemAccessPromises[e];let o=s==null?void 0:s.keySystemAccess;if(!o){this.log(`Requesting encrypted media "${e}" key-system access with config: ${JSON.stringify(i)}`),o=this.requestMediaKeySystemAccess(e,i);const a=this.keySystemAccessPromises[e]={keySystemAccess:o};return o.catch(l=>{this.log(`Failed to obtain access to key-system "${e}": ${l}`)}),o.then(l=>{this.log(`Access for key-system "${l.keySystem}" obtained`);const c=this.fetchServerCertificate(e);return this.log(`Create media-keys for "${e}"`),a.mediaKeys=l.createMediaKeys().then(u=>(this.log(`Media-keys created for "${e}"`),c.then(d=>d?this.setMediaKeysServerCertificate(u,e,d):u))),a.mediaKeys.catch(u=>{this.error(`Failed to create media-keys for "${e}"}: ${u}`)}),a.mediaKeys})}return o.then(()=>s.mediaKeys)}createMediaKeySessionContext({decryptdata:e,keySystem:t,mediaKeys:r}){this.log(`Creating key-system session "${t}" keyId: ${Hex.hexDump(e.keyId||[])}`);const i=r.createSession(),s={decryptdata:e,keySystem:t,mediaKeys:r,mediaKeysSession:i,keyStatus:"status-pending"};return this.mediaKeySessions.push(s),s}renewKeySession(e){const t=e.decryptdata;if(t.pssh){const r=this.createMediaKeySessionContext(e),i=this.getKeyIdString(t),s="cenc";this.keyIdToKeySessionPromise[i]=this.generateRequestWithPreferredKeySession(r,s,t.pssh,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}getKeyIdString(e){if(!e)throw new Error("Could not read keyId of undefined decryptdata");if(e.keyId===null)throw new Error("keyId is null");return Hex.hexDump(e.keyId)}updateKeySession(e,t){var r;const i=e.mediaKeysSession;return this.log(`Updating key-session "${i.sessionId}" for keyID ${Hex.hexDump(((r=e.decryptdata)==null?void 0:r.keyId)||[])}
      } (data length: ${t&&t.byteLength})`),i.update(t)}selectKeySystemFormat(e){const t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){return new Promise((t,r)=>{const i=getKeySystemsForConfig(this.config),s=e.map(keySystemFormatToKeySystemDomain).filter(o=>!!o&&i.indexOf(o)!==-1);return this.getKeySystemSelectionPromise(s).then(({keySystem:o})=>{const a=keySystemDomainToKeySystemFormat(o);a?t(a):r(new Error(`Unable to find format for key-system "${o}"`))}).catch(r)})}loadKey(e){const t=e.keyInfo.decryptdata,r=this.getKeyIdString(t),i=`(keyId: ${r} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log(`Starting session for key ${i}`);let s=this.keyIdToKeySessionPromise[r];return s||(s=this.keyIdToKeySessionPromise[r]=this.getKeySystemForKeyPromise(t).then(({keySystem:o,mediaKeys:a})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${i}`),this.attemptSetMediaKeys(o,a).then(()=>{this.throwIfDestroyed();const l=this.createMediaKeySessionContext({keySystem:o,mediaKeys:a,decryptdata:t});return this.generateRequestWithPreferredKeySession(l,"cenc",t.pssh,"playlist-key")}))),s.catch(o=>this.handleError(o))),s}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e){this.hls&&(this.error(e.message),e instanceof EMEKeyError?this.hls.trigger(Events.ERROR,e.data):this.hls.trigger(Events.ERROR,{type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0}))}getKeySystemForKeyPromise(e){const t=this.getKeyIdString(e),r=this.keyIdToKeySessionPromise[t];if(!r){const i=keySystemFormatToKeySystemDomain(e.keyFormat),s=i?[i]:getKeySystemsForConfig(this.config);return this.attemptKeySystemAccess(s)}return r}getKeySystemSelectionPromise(e){if(e.length||(e=getKeySystemsForConfig(this.config)),e.length===0)throw new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${JSON.stringify({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}_onMediaEncrypted(e){const{initDataType:t,initData:r}=e,i=`"${e.type}" event: init data type: "${t}"`;if(this.debug(i),r===null)return;let s,o;if(t==="sinf"&&this.config.drmSystems[KeySystems.FAIRPLAY]){const d=bin2str(new Uint8Array(r));try{const f=base64Decode(JSON.parse(d).sinf),m=parseSinf(new Uint8Array(f));if(!m)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");s=m.subarray(8,24),o=KeySystems.FAIRPLAY}catch(f){this.warn(`${i} Failed to parse sinf: ${f}`);return}}else{const d=parseMultiPssh(r),f=d.filter(m=>m.systemId===KeySystemIds.WIDEVINE)[0];if(!f){d.length===0||d.some(m=>!m.systemId)?this.warn(`${i} contains incomplete or invalid pssh data`):this.log(`ignoring ${i} for ${d.map(m=>keySystemIdToKeySystemDomain(m.systemId)).join(",")} pssh data in favor of playlist keys`);return}if(o=keySystemIdToKeySystemDomain(f.systemId),f.version===0&&f.data){const m=f.data.length-22;s=f.data.subarray(m,m+16)}}if(!o||!s)return;const a=Hex.hexDump(s),{keyIdToKeySessionPromise:l,mediaKeySessions:c}=this;let u=l[a];for(let d=0;d<c.length;d++){const f=c[d],m=f.decryptdata;if(!m.keyId)continue;const g=Hex.hexDump(m.keyId);if(a===g||m.uri.replace(/-/g,"").indexOf(a)!==-1){if(u=l[g],m.pssh)break;delete l[g],m.pssh=new Uint8Array(r),m.keyId=s,u=l[a]=u.then(()=>this.generateRequestWithPreferredKeySession(f,t,r,"encrypted-event-key-match"));break}}u||(u=l[a]=this.getKeySystemSelectionPromise([o]).then(({keySystem:d,mediaKeys:f})=>{var m;this.throwIfDestroyed();const g=new LevelKey("ISO-23001-7",a,(m=keySystemDomainToKeySystemFormat(d))!=null?m:"");return g.pssh=new Uint8Array(r),g.keyId=s,this.attemptSetMediaKeys(d,f).then(()=>{this.throwIfDestroyed();const v=this.createMediaKeySessionContext({decryptdata:g,keySystem:d,mediaKeys:f});return this.generateRequestWithPreferredKeySession(v,t,r,"encrypted-event-no-match")})})),u.catch(d=>this.handleError(d))}_onWaitingForKey(e){this.log(`"${e.type}" event`)}attemptSetMediaKeys(e,t){const r=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const i=Promise.all(r).then(()=>{if(!this.media)throw new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(t)});return this.setMediaKeysQueue.push(i),i.then(()=>{this.log(`Media-keys set for "${e}"`),r.push(i),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(s=>r.indexOf(s)===-1)})}generateRequestWithPreferredKeySession(e,t,r,i){var s,o;const a=(s=this.config.drmSystems)==null||(o=s[e.keySystem])==null?void 0:o.generateRequest;if(a)try{const g=a.call(this.hls,t,r,e);if(!g)throw new Error("Invalid response from configured generateRequest filter");t=g.initDataType,r=e.decryptdata.pssh=g.initData?new Uint8Array(g.initData):null}catch(g){var l;if(this.warn(g.message),(l=this.hls)!=null&&l.config.debug)throw g}if(r===null)return this.log(`Skipping key-session request for "${i}" (no initData)`),Promise.resolve(e);const c=this.getKeyIdString(e.decryptdata);this.log(`Generating key-session request for "${i}": ${c} (init data type: ${t} length: ${r?r.byteLength:null})`);const u=new EventEmitter,d=e._onmessage=g=>{const v=e.mediaKeysSession;if(!v){u.emit("error",new Error("invalid state"));return}const{messageType:x,message:S}=g;this.log(`"${x}" message event for session "${v.sessionId}" message size: ${S.byteLength}`),x==="license-request"||x==="license-renewal"?this.renewLicense(e,S).catch(C=>{this.handleError(C),u.emit("error",C)}):x==="license-release"?e.keySystem===KeySystems.FAIRPLAY&&(this.updateKeySession(e,strToUtf8array("acknowledged")),this.removeSession(e)):this.warn(`unhandled media key message type "${x}"`)},f=e._onkeystatuseschange=g=>{if(!e.mediaKeysSession){u.emit("error",new Error("invalid state"));return}this.onKeyStatusChange(e);const x=e.keyStatus;u.emit("keyStatus",x),x==="expired"&&(this.warn(`${e.keySystem} expired for key ${c}`),this.renewKeySession(e))};e.mediaKeysSession.addEventListener("message",d),e.mediaKeysSession.addEventListener("keystatuseschange",f);const m=new Promise((g,v)=>{u.on("error",v),u.on("keyStatus",x=>{x.startsWith("usable")?g():x==="output-restricted"?v(new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):x==="internal-error"?v(new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${x}"`)):x==="expired"?v(new Error("key expired while generating request")):this.warn(`unhandled key status change "${x}"`)})});return e.mediaKeysSession.generateRequest(t,r).then(()=>{var g;this.log(`Request generated for key-session "${(g=e.mediaKeysSession)==null?void 0:g.sessionId}" keyId: ${c}`)}).catch(g=>{throw new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_NO_SESSION,error:g,fatal:!1},`Error generating key-session request: ${g}`)}).then(()=>m).catch(g=>{throw u.removeAllListeners(),this.removeSession(e),g}).then(()=>(u.removeAllListeners(),e))}onKeyStatusChange(e){e.mediaKeysSession.keyStatuses.forEach((t,r)=>{this.log(`key status change "${t}" for keyStatuses keyId: ${Hex.hexDump("buffer"in r?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):new Uint8Array(r))} session keyId: ${Hex.hexDump(new Uint8Array(e.decryptdata.keyId||[]))} uri: ${e.decryptdata.uri}`),e.keyStatus=t})}fetchServerCertificate(e){const t=this.config,r=t.loader,i=new r(t),s=this.getServerCertificateUrl(e);return s?(this.log(`Fetching server certificate for "${e}"`),new Promise((o,a)=>{const l={responseType:"arraybuffer",url:s},c=t.certLoadPolicy.default,u={loadPolicy:c,timeout:c.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},d={onSuccess:(f,m,g,v)=>{o(f.data)},onError:(f,m,g,v)=>{a(new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:g,response:_objectSpread2({url:l.url,data:void 0},f)},`"${e}" certificate request failed (${s}). Status: ${f.code} (${f.text})`))},onTimeout:(f,m,g)=>{a(new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:g,response:{url:l.url,data:void 0}},`"${e}" certificate request timed out (${s})`))},onAbort:(f,m,g)=>{a(new Error("aborted"))}};i.load(l,u,d)})):Promise.resolve()}setMediaKeysServerCertificate(e,t,r){return new Promise((i,s)=>{e.setServerCertificate(r).then(o=>{this.log(`setServerCertificate ${o?"success":"not supported by CDM"} (${r==null?void 0:r.byteLength}) on "${t}"`),i(e)}).catch(o=>{s(new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:o,fatal:!0},o.message))})})}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then(r=>this.updateKeySession(e,new Uint8Array(r)).catch(i=>{throw new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:i,fatal:!0},i.message)}))}unpackPlayReadyKeyMessage(e,t){const r=String.fromCharCode.apply(null,new Uint16Array(t.buffer));if(!r.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),t;const i=new DOMParser().parseFromString(r,"application/xml"),s=i.querySelectorAll("HttpHeader");if(s.length>0){let u;for(let d=0,f=s.length;d<f;d++){var o,a;u=s[d];const m=(o=u.querySelector("name"))==null?void 0:o.textContent,g=(a=u.querySelector("value"))==null?void 0:a.textContent;m&&g&&e.setRequestHeader(m,g)}}const l=i.querySelector("Challenge"),c=l==null?void 0:l.textContent;if(!c)throw new Error("Cannot find <Challenge> in key message");return strToUtf8array(atob(c))}setupLicenseXHR(e,t,r,i){const s=this.config.licenseXhrSetup;return s?Promise.resolve().then(()=>{if(!r.decryptdata)throw new Error("Key removed");return s.call(this.hls,e,t,r,i)}).catch(o=>{if(!r.decryptdata)throw o;return e.open("POST",t,!0),s.call(this.hls,e,t,r,i)}).then(o=>(e.readyState||e.open("POST",t,!0),{xhr:e,licenseChallenge:o||i})):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:i}))}requestLicense(e,t){const r=this.config.keyLoadPolicy.default;return new Promise((i,s)=>{const o=this.getLicenseServerUrl(e.keySystem);this.log(`Sending license request to URL: ${o}`);const a=new XMLHttpRequest;a.responseType="arraybuffer",a.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return s(new Error("invalid state"));if(a.readyState===4)if(a.status===200){this._requestLicenseFailureCount=0;let l=a.response;this.log(`License received ${l instanceof ArrayBuffer?l.byteLength:l}`);const c=this.config.licenseResponseCallback;if(c)try{l=c.call(this.hls,a,o,e)}catch(u){this.error(u)}i(l)}else{const l=r.errorRetry,c=l?l.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>c||a.status>=400&&a.status<500)s(new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:a,response:{url:o,data:void 0,code:a.status,text:a.statusText}},`License Request XHR failed (${o}). Status: ${a.status} (${a.statusText})`));else{const u=c-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${u} attempts left`),this.requestLicense(e,t).then(i,s)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=a,this.setupLicenseXHR(a,o,e,t).then(({xhr:l,licenseChallenge:c})=>{e.keySystem==KeySystems.PLAYREADY&&(c=this.unpackPlayReadyKeyMessage(l,c)),l.send(c)})})}onMediaAttached(e,t){if(!this.config.emeEnabled)return;const r=t.media;this.media=r,r.addEventListener("encrypted",this.onMediaEncrypted),r.addEventListener("waitingforkey",this.onWaitingForKey)}onMediaDetached(){const e=this.media,t=this.mediaKeySessions;e&&(e.removeEventListener("encrypted",this.onMediaEncrypted),e.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null),this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},LevelKey.clearKeyUriToKeyIdMap();const r=t.length;EMEController.CDMCleanupPromise=Promise.all(t.map(i=>this.removeSession(i)).concat(e==null?void 0:e.setMediaKeys(null).catch(i=>{this.log(`Could not clear media keys: ${i}`)}))).then(()=>{r&&(this.log("finished closing key sessions and clearing media keys"),t.length=0)}).catch(i=>{this.log(`Could not close sessions and clear media keys: ${i}`)})}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(e,{sessionKeys:t}){if(!(!t||!this.config.emeEnabled)&&!this.keyFormatPromise){const r=t.reduce((i,s)=>(i.indexOf(s.keyFormat)===-1&&i.push(s.keyFormat),i),[]);this.log(`Selecting key-system from session-keys ${r.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(r)}}removeSession(e){const{mediaKeysSession:t,licenseXhr:r}=e;if(t){this.log(`Remove licenses and keys and close session ${t.sessionId}`),e._onmessage&&(t.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(t.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),r&&r.readyState!==XMLHttpRequest.DONE&&r.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const i=this.mediaKeySessions.indexOf(e);return i>-1&&this.mediaKeySessions.splice(i,1),t.remove().catch(s=>{this.log(`Could not remove session: ${s}`)}).then(()=>t.close()).catch(s=>{this.log(`Could not close session: ${s}`)})}}}EMEController.CDMCleanupPromise=void 0;class EMEKeyError extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}}var CmObjectType;(function(n){n.MANIFEST="m",n.AUDIO="a",n.VIDEO="v",n.MUXED="av",n.INIT="i",n.CAPTION="c",n.TIMED_TEXT="tt",n.KEY="k",n.OTHER="o"})(CmObjectType||(CmObjectType={}));var CmStreamingFormat;(function(n){n.DASH="d",n.HLS="h",n.SMOOTH="s",n.OTHER="o"})(CmStreamingFormat||(CmStreamingFormat={}));var CmcdHeaderField;(function(n){n.OBJECT="CMCD-Object",n.REQUEST="CMCD-Request",n.SESSION="CMCD-Session",n.STATUS="CMCD-Status"})(CmcdHeaderField||(CmcdHeaderField={}));const CmcdHeaderMap={[CmcdHeaderField.OBJECT]:["br","d","ot","tb"],[CmcdHeaderField.REQUEST]:["bl","dl","mtp","nor","nrr","su"],[CmcdHeaderField.SESSION]:["cid","pr","sf","sid","st","v"],[CmcdHeaderField.STATUS]:["bs","rtp"]};class SfItem{constructor(e,t){this.value=void 0,this.params=void 0,Array.isArray(e)&&(e=e.map(r=>r instanceof SfItem?r:new SfItem(r))),this.value=e,this.params=t}}class SfToken{constructor(e){this.description=void 0,this.description=e}}const DICT="Dict";function format(n){return Array.isArray(n)?JSON.stringify(n):n instanceof Map?"Map{}":n instanceof Set?"Set{}":typeof n=="object"?JSON.stringify(n):String(n)}function throwError(n,e,t,r){return new Error(`failed to ${n} "${format(e)}" as ${t}`,{cause:r})}const BARE_ITEM="Bare Item",BOOLEAN="Boolean",BYTES="Byte Sequence",DECIMAL="Decimal",INTEGER="Integer";function isInvalidInt(n){return n<-999999999999999||999999999999999<n}const STRING_REGEX=/[\x00-\x1f\x7f]+/,TOKEN="Token",KEY="Key";function serializeError(n,e,t){return throwError("serialize",n,e,t)}function serializeBoolean(n){if(typeof n!="boolean")throw serializeError(n,BOOLEAN);return n?"?1":"?0"}function base64encode(n){return btoa(String.fromCharCode(...n))}function serializeByteSequence(n){if(ArrayBuffer.isView(n)===!1)throw serializeError(n,BYTES);return`:${base64encode(n)}:`}function serializeInteger(n){if(isInvalidInt(n))throw serializeError(n,INTEGER);return n.toString()}function serializeDate(n){return`@${serializeInteger(n.getTime()/1e3)}`}function roundToEven(n,e){if(n<0)return-roundToEven(-n,e);const t=Math.pow(10,e);if(Math.abs(n*t%1-.5)<Number.EPSILON){const i=Math.floor(n*t);return(i%2===0?i:i+1)/t}else return Math.round(n*t)/t}function serializeDecimal(n){const e=roundToEven(n,3);if(Math.floor(Math.abs(e)).toString().length>12)throw serializeError(n,DECIMAL);const t=e.toString();return t.includes(".")?t:`${t}.0`}const STRING="String";function serializeString(n){if(STRING_REGEX.test(n))throw serializeError(n,STRING);return`"${n.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}function symbolToStr(n){return n.description||n.toString().slice(7,-1)}function serializeToken(n){const e=symbolToStr(n);if(/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(e)===!1)throw serializeError(e,TOKEN);return e}function serializeBareItem(n){switch(typeof n){case"number":if(!isFiniteNumber(n))throw serializeError(n,BARE_ITEM);return Number.isInteger(n)?serializeInteger(n):serializeDecimal(n);case"string":return serializeString(n);case"symbol":return serializeToken(n);case"boolean":return serializeBoolean(n);case"object":if(n instanceof Date)return serializeDate(n);if(n instanceof Uint8Array)return serializeByteSequence(n);if(n instanceof SfToken)return serializeToken(n);default:throw serializeError(n,BARE_ITEM)}}function serializeKey(n){if(/^[a-z*][a-z0-9\-_.*]*$/.test(n)===!1)throw serializeError(n,KEY);return n}function serializeParams(n){return n==null?"":Object.entries(n).map(([e,t])=>t===!0?`;${serializeKey(e)}`:`;${serializeKey(e)}=${serializeBareItem(t)}`).join("")}function serializeItem(n){return n instanceof SfItem?`${serializeBareItem(n.value)}${serializeParams(n.params)}`:serializeBareItem(n)}function serializeInnerList(n){return`(${n.value.map(serializeItem).join(" ")})${serializeParams(n.params)}`}function serializeDict(n,e={whitespace:!0}){if(typeof n!="object")throw serializeError(n,DICT);const t=n instanceof Map?n.entries():Object.entries(n),r=e!=null&&e.whitespace?" ":"";return Array.from(t).map(([i,s])=>{s instanceof SfItem||(s=new SfItem(s));let o=serializeKey(i);return s.value===!0?o+=serializeParams(s.params):(o+="=",Array.isArray(s.value)?o+=serializeInnerList(s):o+=serializeItem(s)),o}).join(`,${r}`)}function encodeSfDict(n,e){return serializeDict(n,e)}const isTokenField=n=>n==="ot"||n==="sf"||n==="st",isValid=n=>typeof n=="number"?isFiniteNumber(n):n!=null&&n!==""&&n!==!1;function urlToRelativePath(n,e){const t=new URL(n),r=new URL(e);if(t.origin!==r.origin)return n;const i=t.pathname.split("/").slice(1),s=r.pathname.split("/").slice(1,-1);for(;i[0]===s[0];)i.shift(),s.shift();for(;s.length;)s.shift(),i.unshift("..");return i.join("/")}function uuid(){try{return crypto.randomUUID()}catch{try{const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}catch{let t=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,i=>{const s=(t+Math.random()*16)%16|0;return t=Math.floor(t/16),(i=="x"?s:s&3|8).toString(16)})}}}const toRounded=n=>Math.round(n),toUrlSafe=(n,e)=>(e!=null&&e.baseUrl&&(n=urlToRelativePath(n,e.baseUrl)),encodeURIComponent(n)),toHundred=n=>toRounded(n/100)*100,CmcdFormatters={br:toRounded,d:toRounded,bl:toHundred,dl:toHundred,mtp:toHundred,nor:toUrlSafe,rtp:toHundred,tb:toRounded};function processCmcd(n,e){const t={};if(n==null||typeof n!="object")return t;const r=Object.keys(n).sort(),i=_extends({},CmcdFormatters,e==null?void 0:e.formatters),s=e==null?void 0:e.filter;return r.forEach(o=>{if(s!=null&&s(o))return;let a=n[o];const l=i[o];l&&(a=l(a,e)),!(o==="v"&&a===1)&&(o=="pr"&&a===1||isValid(a)&&(isTokenField(o)&&typeof a=="string"&&(a=new SfToken(a)),t[o]=a))}),t}function encodeCmcd(n,e={}){return n?encodeSfDict(processCmcd(n,e),_extends({whitespace:!1},e)):""}function toCmcdHeaders(n,e={}){if(!n)return{};const t=Object.entries(n),r=Object.entries(CmcdHeaderMap).concat(Object.entries((e==null?void 0:e.customHeaderMap)||{})),i=t.reduce((s,o)=>{var a,l;const[c,u]=o,d=((a=r.find(f=>f[1].includes(c)))==null?void 0:a[0])||CmcdHeaderField.REQUEST;return(l=s[d])!=null||(s[d]={}),s[d][c]=u,s},{});return Object.entries(i).reduce((s,[o,a])=>(s[o]=encodeCmcd(a,e),s),{})}function appendCmcdHeaders(n,e,t){return _extends(n,toCmcdHeaders(e,t))}const CMCD_PARAM="CMCD";function toCmcdQuery(n,e={}){if(!n)return"";const t=encodeCmcd(n,e);return`${CMCD_PARAM}=${encodeURIComponent(t)}`}const REGEX=/CMCD=[^&#]+/;function appendCmcdQuery(n,e,t){const r=toCmcdQuery(e,t);if(!r)return n;if(REGEX.test(n))return n.replace(REGEX,r);const i=n.includes("?")?"&":"?";return`${n}${i}${r}`}class CMCDController{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=i=>{try{this.apply(i,{ot:CmObjectType.MANIFEST,su:!this.initialized})}catch(s){logger.warn("Could not generate manifest CMCD data.",s)}},this.applyFragmentData=i=>{try{const s=i.frag,o=this.hls.levels[s.level],a=this.getObjectType(s),l={d:s.duration*1e3,ot:a};(a===CmObjectType.VIDEO||a===CmObjectType.AUDIO||a==CmObjectType.MUXED)&&(l.br=o.bitrate/1e3,l.tb=this.getTopBandwidth(a)/1e3,l.bl=this.getBufferLength(a)),this.apply(i,l)}catch(s){logger.warn("Could not generate segment CMCD data.",s)}},this.hls=e;const t=this.config=e.config,{cmcd:r}=t;r!=null&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=r.sessionId||uuid(),this.cid=r.contentId,this.useHeaders=r.useHeaders===!0,this.includeKeys=r.includeKeys,this.registerListeners())}registerListeners(){const e=this.hls;e.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(Events.MEDIA_DETACHED,this.onMediaDetached,this),e.on(Events.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(Events.MEDIA_DETACHED,this.onMediaDetached,this),e.off(Events.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var r,i;this.audioBuffer=(r=t.tracks.audio)==null?void 0:r.buffer,this.videoBuffer=(i=t.tracks.video)==null?void 0:i.buffer}createData(){var e;return{v:1,sf:CmStreamingFormat.HLS,sid:this.sid,cid:this.cid,pr:(e=this.media)==null?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){_extends(t,this.createData());const r=t.ot===CmObjectType.INIT||t.ot===CmObjectType.VIDEO||t.ot===CmObjectType.MUXED;this.starved&&r&&(t.bs=!0,t.su=!0,this.starved=!1),t.su==null&&(t.su=this.buffering);const{includeKeys:i}=this;i&&(t=Object.keys(t).reduce((s,o)=>(i.includes(o)&&(s[o]=t[o]),s),{})),this.useHeaders?(e.headers||(e.headers={}),appendCmcdHeaders(e.headers,t)):e.url=appendCmcdQuery(e.url,t)}getObjectType(e){const{type:t}=e;if(t==="subtitle")return CmObjectType.TIMED_TEXT;if(e.sn==="initSegment")return CmObjectType.INIT;if(t==="audio")return CmObjectType.AUDIO;if(t==="main")return this.hls.audioTracks.length?CmObjectType.VIDEO:CmObjectType.MUXED}getTopBandwidth(e){let t=0,r;const i=this.hls;if(e===CmObjectType.AUDIO)r=i.audioTracks;else{const s=i.maxAutoLevel,o=s>-1?s+1:i.levels.length;r=i.levels.slice(0,o)}for(const s of r)s.bitrate>t&&(t=s.bitrate);return t>0?t:NaN}getBufferLength(e){const t=this.hls.media,r=e===CmObjectType.AUDIO?this.audioBuffer:this.videoBuffer;return!r||!t?NaN:BufferHelper.bufferInfo(r,t.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){const{pLoader:e}=this.config,t=this.applyPlaylistData,r=e||this.config.loader;return class{constructor(s){this.loader=void 0,this.loader=new r(s)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(s,o,a){t(s),this.loader.load(s,o,a)}}}createFragmentLoader(){const{fLoader:e}=this.config,t=this.applyFragmentData,r=e||this.config.loader;return class{constructor(s){this.loader=void 0,this.loader=new r(s)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(s,o,a){t(s),this.loader.load(s,o,a)}}}}const PATHWAY_PENALTY_DURATION_MS=3e5;class ContentSteeringController{constructor(e){this.hls=void 0,this.log=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this.pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.log=logger.log.bind(logger,"[content-steering]:"),this.registerListeners()}registerListeners(){const e=this.hls;e.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Events.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(Events.MANIFEST_PARSED,this.onManifestParsed,this),e.on(Events.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Events.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(Events.MANIFEST_PARSED,this.onManifestParsed,this),e.off(Events.ERROR,this.onError,this))}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const e=this.timeToLoad*1e3-(performance.now()-this.updated);if(e>0){this.scheduleRefresh(this.uri,e);return}}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){this.reloadTimer!==-1&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const t=this.levels;t&&(this.levels=t.filter(r=>r!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){const{contentSteering:r}=t;r!==null&&(this.pathwayId=r.pathwayId,this.uri=r.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){const{errorAction:r}=t;if((r==null?void 0:r.action)===NetworkErrorAction.SendAlternateToPenaltyBox&&r.flags===ErrorActionFlags.MoveAllAlternatesMatchingHost){const i=this.levels;let s=this.pathwayPriority,o=this.pathwayId;if(t.context){const{groupId:a,pathwayId:l,type:c}=t.context;a&&i?o=this.getPathwayForGroupId(a,c,o):l&&(o=l)}o in this.penalizedPathways||(this.penalizedPathways[o]=performance.now()),!s&&i&&(s=i.reduce((a,l)=>(a.indexOf(l.pathwayId)===-1&&a.push(l.pathwayId),a),[])),s&&s.length>1&&(this.updatePathwayPriority(s),r.resolved=this.pathwayId!==o),r.resolved||logger.warn(`Could not resolve ${t.details} ("${t.error.message}") with content-steering for Pathway: ${o} levels: ${i&&i.length} priorities: ${JSON.stringify(s)} penalized: ${JSON.stringify(this.penalizedPathways)}`)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(t.length===0){const r=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${r}"`),t=this.getLevelsForPathway(r),this.pathwayId=r}return t.length!==e.length&&this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t}getLevelsForPathway(e){return this.levels===null?[]:this.levels.filter(t=>e===t.pathwayId)}updatePathwayPriority(e){this.pathwayPriority=e;let t;const r=this.penalizedPathways,i=performance.now();Object.keys(r).forEach(s=>{i-r[s]>PATHWAY_PENALTY_DURATION_MS&&delete r[s]});for(let s=0;s<e.length;s++){const o=e[s];if(o in r)continue;if(o===this.pathwayId)return;const a=this.hls.nextLoadLevel,l=this.hls.levels[a];if(t=this.getLevelsForPathway(o),t.length>0){this.log(`Setting Pathway to "${o}"`),this.pathwayId=o,reassignFragmentLevelIndexes(t),this.hls.trigger(Events.LEVELS_UPDATED,{levels:t});const c=this.hls.levels[a];l&&c&&this.levels&&(c.attrs["STABLE-VARIANT-ID"]!==l.attrs["STABLE-VARIANT-ID"]&&c.bitrate!==l.bitrate&&this.log(`Unstable Pathways change from bitrate ${l.bitrate} to ${c.bitrate}`),this.hls.nextLoadLevel=a);break}}}getPathwayForGroupId(e,t,r){const i=this.getLevelsForPathway(r).concat(this.levels||[]);for(let s=0;s<i.length;s++)if(t===PlaylistContextType.AUDIO_TRACK&&i[s].hasAudioGroup(e)||t===PlaylistContextType.SUBTITLE_TRACK&&i[s].hasSubtitleGroup(e))return i[s].pathwayId;return r}clonePathways(e){const t=this.levels;if(!t)return;const r={},i={};e.forEach(s=>{const{ID:o,"BASE-ID":a,"URI-REPLACEMENT":l}=s;if(t.some(u=>u.pathwayId===o))return;const c=this.getLevelsForPathway(a).map(u=>{const d=new AttrList(u.attrs);d["PATHWAY-ID"]=o;const f=d.AUDIO&&`${d.AUDIO}_clone_${o}`,m=d.SUBTITLES&&`${d.SUBTITLES}_clone_${o}`;f&&(r[d.AUDIO]=f,d.AUDIO=f),m&&(i[d.SUBTITLES]=m,d.SUBTITLES=m);const g=performUriReplacement(u.uri,d["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",l),v=new Level({attrs:d,audioCodec:u.audioCodec,bitrate:u.bitrate,height:u.height,name:u.name,url:g,videoCodec:u.videoCodec,width:u.width});if(u.audioGroups)for(let x=1;x<u.audioGroups.length;x++)v.addGroupId("audio",`${u.audioGroups[x]}_clone_${o}`);if(u.subtitleGroups)for(let x=1;x<u.subtitleGroups.length;x++)v.addGroupId("text",`${u.subtitleGroups[x]}_clone_${o}`);return v});t.push(...c),cloneRenditionGroups(this.audioTracks,r,l,o),cloneRenditionGroups(this.subtitleTracks,i,l,o)})}loadSteeringManifest(e){const t=this.hls.config,r=t.loader;this.loader&&this.loader.destroy(),this.loader=new r(t);let i;try{i=new self.URL(e)}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${e}`);return}if(i.protocol!=="data:"){const u=(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate)|0;i.searchParams.set("_HLS_pathway",this.pathwayId),i.searchParams.set("_HLS_throughput",""+u)}const s={responseType:"json",url:i.href},o=t.steeringManifestLoadPolicy.default,a=o.errorRetry||o.timeoutRetry||{},l={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:a.maxNumRetry||0,retryDelay:a.retryDelayMs||0,maxRetryDelay:a.maxRetryDelayMs||0},c={onSuccess:(u,d,f,m)=>{this.log(`Loaded steering manifest: "${i}"`);const g=u.data;if(g.VERSION!==1){this.log(`Steering VERSION ${g.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=g.TTL;const{"RELOAD-URI":v,"PATHWAY-CLONES":x,"PATHWAY-PRIORITY":S}=g;if(v)try{this.uri=new self.URL(v,i).href}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${v}`);return}this.scheduleRefresh(this.uri||f.url),x&&this.clonePathways(x);const C={steeringManifest:g,url:i.toString()};this.hls.trigger(Events.STEERING_MANIFEST_LOADED,C),S&&this.updatePathwayPriority(S)},onError:(u,d,f,m)=>{if(this.log(`Error loading steering manifest: ${u.code} ${u.text} (${d.url})`),this.stopLoad(),u.code===410){this.enabled=!1,this.log(`Steering manifest ${d.url} no longer available`);return}let g=this.timeToLoad*1e3;if(u.code===429){const v=this.loader;if(typeof(v==null?void 0:v.getResponseHeader)=="function"){const x=v.getResponseHeader("Retry-After");x&&(g=parseFloat(x)*1e3)}this.log(`Steering manifest ${d.url} rate limited`);return}this.scheduleRefresh(this.uri||d.url,g)},onTimeout:(u,d,f)=>{this.log(`Timeout loading steering manifest (${d.url})`),this.scheduleRefresh(this.uri||d.url)}};this.log(`Requesting steering manifest: ${i}`),this.loader.load(s,l,c)}scheduleRefresh(e,t=this.timeToLoad*1e3){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var r;const i=(r=this.hls)==null?void 0:r.media;if(i&&!i.ended){this.loadSteeringManifest(e);return}this.scheduleRefresh(e,this.timeToLoad*1e3)},t)}}function cloneRenditionGroups(n,e,t,r){n&&Object.keys(e).forEach(i=>{const s=n.filter(o=>o.groupId===i).map(o=>{const a=_extends({},o);return a.details=void 0,a.attrs=new AttrList(a.attrs),a.url=a.attrs.URI=performUriReplacement(o.url,o.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",t),a.groupId=a.attrs["GROUP-ID"]=e[i],a.attrs["PATHWAY-ID"]=r,a});n.push(...s)})}function performUriReplacement(n,e,t,r){const{HOST:i,PARAMS:s,[t]:o}=r;let a;e&&(a=o==null?void 0:o[e],a&&(n=a));const l=new self.URL(n);return i&&!a&&(l.host=i),s&&Object.keys(s).sort().forEach(c=>{c&&l.searchParams.set(c,s[c])}),l.href}const AGE_HEADER_LINE_REGEX=/^age:\s*[\d.]+\s*$/im;class XhrLoader{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new LoadStats,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,e.readyState!==4&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,r){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=r,this.loadInternal()}loadInternal(){const{config:e,context:t}=this;if(!e||!t)return;const r=this.loader=new self.XMLHttpRequest,i=this.stats;i.loading.first=0,i.loaded=0,i.aborted=!1;const s=this.xhrSetup;s?Promise.resolve().then(()=>{if(!(this.loader!==r||this.stats.aborted))return s(r,t.url)}).catch(o=>{if(!(this.loader!==r||this.stats.aborted))return r.open("GET",t.url,!0),s(r,t.url)}).then(()=>{this.loader!==r||this.stats.aborted||this.openAndSendXhr(r,t,e)}).catch(o=>{this.callbacks.onError({code:r.status,text:o.message},t,r,i)}):this.openAndSendXhr(r,t,e)}openAndSendXhr(e,t,r){e.readyState||e.open("GET",t.url,!0);const i=t.headers,{maxTimeToFirstByteMs:s,maxLoadTimeMs:o}=r.loadPolicy;if(i)for(const a in i)e.setRequestHeader(a,i[a]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),r.timeout=s&&isFiniteNumber(s)?s:o,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),r.timeout),e.send()}readystatechange(){const{context:e,loader:t,stats:r}=this;if(!e||!t)return;const i=t.readyState,s=this.config;if(!r.aborted&&i>=2&&(r.loading.first===0&&(r.loading.first=Math.max(self.performance.now(),r.loading.start),s.timeout!==s.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),s.timeout=s.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),s.loadPolicy.maxLoadTimeMs-(r.loading.first-r.loading.start)))),i===4)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;const o=t.status,a=t.responseType!=="text";if(o>=200&&o<300&&(a&&t.response||t.responseText!==null)){r.loading.end=Math.max(self.performance.now(),r.loading.first);const l=a?t.response:t.responseText,c=t.responseType==="arraybuffer"?l.byteLength:l.length;if(r.loaded=r.total=c,r.bwEstimate=r.total*8e3/(r.loading.end-r.loading.first),!this.callbacks)return;const u=this.callbacks.onProgress;if(u&&u(r,e,l,t),!this.callbacks)return;const d={url:t.responseURL,data:l,code:o};this.callbacks.onSuccess(d,r,e,t)}else{const l=s.loadPolicy.errorRetry,c=r.retry,u={url:e.url,data:void 0,code:o};shouldRetry(l,c,!1,u)?this.retry(l):(logger.error(`${o} while loading ${e.url}`),this.callbacks.onError({code:o,text:t.statusText},e,t,r))}}}loadtimeout(){if(!this.config)return;const e=this.config.loadPolicy.timeoutRetry,t=this.stats.retry;if(shouldRetry(e,t,!0))this.retry(e);else{var r;logger.warn(`timeout while loading ${(r=this.context)==null?void 0:r.url}`);const i=this.callbacks;i&&(this.abortInternal(),i.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:t,stats:r}=this;this.retryDelay=getRetryDelay(e,r.retry),r.retry++,logger.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${t==null?void 0:t.url}, retrying ${r.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&AGE_HEADER_LINE_REGEX.test(this.loader.getAllResponseHeaders())){const t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}function fetchSupported(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}const BYTERANGE=/(\d+)-(\d+)\/(\d+)/;class FetchLoader{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||getRequest,this.controller=new self.AbortController,this.stats=new LoadStats}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,r){const i=this.stats;if(i.loading.start)throw new Error("Loader can only be used once.");i.loading.start=self.performance.now();const s=getRequestParameters(e,this.controller.signal),o=r.onProgress,a=e.responseType==="arraybuffer",l=a?"byteLength":"length",{maxTimeToFirstByteMs:c,maxLoadTimeMs:u}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=r,this.request=this.fetchSetup(e,s),self.clearTimeout(this.requestTimeout),t.timeout=c&&isFiniteNumber(c)?c:u,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),r.onTimeout(i,e,this.response)},t.timeout),self.fetch(this.request).then(d=>{this.response=this.loader=d;const f=Math.max(self.performance.now(),i.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=u,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),r.onTimeout(i,e,this.response)},u-(f-i.loading.start)),!d.ok){const{status:m,statusText:g}=d;throw new FetchError(g||"fetch, bad network response",m,d)}return i.loading.first=f,i.total=getContentLength(d.headers)||i.total,o&&isFiniteNumber(t.highWaterMark)?this.loadProgressively(d,i,e,t.highWaterMark,o):a?d.arrayBuffer():e.responseType==="json"?d.json():d.text()}).then(d=>{const f=this.response;if(!f)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),i.loading.end=Math.max(self.performance.now(),i.loading.first);const m=d[l];m&&(i.loaded=i.total=m);const g={url:f.url,data:d,code:f.status};o&&!isFiniteNumber(t.highWaterMark)&&o(i,e,d,f),r.onSuccess(g,i,e,f)}).catch(d=>{if(self.clearTimeout(this.requestTimeout),i.aborted)return;const f=d&&d.code||0,m=d?d.message:null;r.onError({code:f,text:m},e,d?d.details:null,i)})}getCacheAge(){let e=null;if(this.response){const t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,r,i=0,s){const o=new ChunkCache,a=e.body.getReader(),l=()=>a.read().then(c=>{if(c.done)return o.dataLength&&s(t,r,o.flush(),e),Promise.resolve(new ArrayBuffer(0));const u=c.value,d=u.length;return t.loaded+=d,d<i||o.dataLength?(o.push(u),o.dataLength>=i&&s(t,r,o.flush(),e)):s(t,r,u,e),l()}).catch(()=>Promise.reject());return l()}}function getRequestParameters(n,e){const t={method:"GET",mode:"cors",credentials:"same-origin",signal:e,headers:new self.Headers(_extends({},n.headers))};return n.rangeEnd&&t.headers.set("Range","bytes="+n.rangeStart+"-"+String(n.rangeEnd-1)),t}function getByteRangeLength(n){const e=BYTERANGE.exec(n);if(e)return parseInt(e[2])-parseInt(e[1])+1}function getContentLength(n){const e=n.get("Content-Range");if(e){const r=getByteRangeLength(e);if(isFiniteNumber(r))return r}const t=n.get("Content-Length");if(t)return parseInt(t)}function getRequest(n,e){return new self.Request(n.url,e)}class FetchError extends Error{constructor(e,t,r){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=r}}const WHITESPACE_CHAR=/\s/,Cues={newCue(n,e,t,r){const i=[];let s,o,a,l,c;const u=self.VTTCue||self.TextTrackCue;for(let f=0;f<r.rows.length;f++)if(s=r.rows[f],a=!0,l=0,c="",!s.isEmpty()){var d;for(let v=0;v<s.chars.length;v++)WHITESPACE_CHAR.test(s.chars[v].uchar)&&a?l++:(c+=s.chars[v].uchar,a=!1);s.cueStartTime=e,e===t&&(t+=1e-4),l>=16?l--:l++;const m=fixLineBreaks(c.trim()),g=generateCueId(e,t,m);n!=null&&(d=n.cues)!=null&&d.getCueById(g)||(o=new u(e,t,m),o.id=g,o.line=f+1,o.align="left",o.position=10+Math.min(80,Math.floor(l*8/32)*10),i.push(o))}return n&&i.length&&(i.sort((f,m)=>f.line==="auto"||m.line==="auto"?0:f.line>8&&m.line>8?m.line-f.line:f.line-m.line),i.forEach(f=>addCueToTrack(n,f))),i}},defaultLoadPolicy={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},hlsDefaultConfig=_objectSpread2(_objectSpread2({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,maxBufferSize:60*1e3*1e3,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:XhrLoader,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:AbrController,bufferController:BufferController,capLevelController:CapLevelController,errorController:ErrorController,fpsController:FPSController,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:requestMediaKeySystemAccess,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0,useMediaCapabilities:!0,certLoadPolicy:{default:defaultLoadPolicy},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},timelineConfig()),{},{subtitleStreamController:SubtitleStreamController,subtitleTrackController:SubtitleTrackController,timelineController:TimelineController,audioStreamController:AudioStreamController,audioTrackController:AudioTrackController,emeController:EMEController,cmcdController:CMCDController,contentSteeringController:ContentSteeringController});function timelineConfig(){return{cueHandler:Cues,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function mergeConfig(n,e){if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(e.liveMaxLatencyDurationCount!==void 0&&(e.liveSyncDurationCount===void 0||e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(e.liveMaxLatencyDuration!==void 0&&(e.liveSyncDuration===void 0||e.liveMaxLatencyDuration<=e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const t=deepCpy(n),r=["manifest","level","frag"],i=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return r.forEach(s=>{const o=`${s==="level"?"playlist":s}LoadPolicy`,a=e[o]===void 0,l=[];i.forEach(c=>{const u=`${s}Loading${c}`,d=e[u];if(d!==void 0&&a){l.push(u);const f=t[o].default;switch(e[o]={default:f},c){case"TimeOut":f.maxLoadTimeMs=d,f.maxTimeToFirstByteMs=d;break;case"MaxRetry":f.errorRetry.maxNumRetry=d,f.timeoutRetry.maxNumRetry=d;break;case"RetryDelay":f.errorRetry.retryDelayMs=d,f.timeoutRetry.retryDelayMs=d;break;case"MaxRetryTimeout":f.errorRetry.maxRetryDelayMs=d,f.timeoutRetry.maxRetryDelayMs=d;break}}}),l.length&&logger.warn(`hls.js config: "${l.join('", "')}" setting(s) are deprecated, use "${o}": ${JSON.stringify(e[o])}`)}),_objectSpread2(_objectSpread2({},t),e)}function deepCpy(n){return n&&typeof n=="object"?Array.isArray(n)?n.map(deepCpy):Object.keys(n).reduce((e,t)=>(e[t]=deepCpy(n[t]),e),{}):n}function enableStreamingMode(n){const e=n.loader;e!==FetchLoader&&e!==XhrLoader?(logger.log("[config]: Custom loader detected, cannot enable progressive streaming"),n.progressive=!1):fetchSupported()&&(n.loader=FetchLoader,n.progressive=!0,n.enableSoftwareAES=!0,logger.log("[config]: Progressive streaming enabled, using FetchLoader"))}let chromeOrFirefox;class LevelController extends BasePlaylistController{constructor(e,t){super(e,"[level-controller]"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Events.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(Events.LEVEL_LOADED,this.onLevelLoaded,this),e.on(Events.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(Events.FRAG_BUFFERED,this.onFragBuffered,this),e.on(Events.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Events.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(Events.LEVEL_LOADED,this.onLevelLoaded,this),e.off(Events.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(Events.FRAG_BUFFERED,this.onFragBuffered,this),e.off(Events.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach(t=>{t.loadError=0,t.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){const r=this.hls.config.preferManagedMediaSource,i=[],s={},o={};let a=!1,l=!1,c=!1;t.levels.forEach(u=>{var d,f;const m=u.attrs;let{audioCodec:g,videoCodec:v}=u;((d=g)==null?void 0:d.indexOf("mp4a.40.34"))!==-1&&(chromeOrFirefox||(chromeOrFirefox=/chrome|firefox/i.test(navigator.userAgent)),chromeOrFirefox&&(u.audioCodec=g=void 0)),g&&(u.audioCodec=g=getCodecCompatibleName(g,r)),((f=v)==null?void 0:f.indexOf("avc1"))===0&&(v=u.videoCodec=convertAVC1ToAVCOTI(v));const{width:x,height:S,unknownCodecs:C}=u;if(a||(a=!!(x&&S)),l||(l=!!v),c||(c=!!g),C!=null&&C.length||g&&!areCodecsMediaSourceSupported(g,"audio",r)||v&&!areCodecsMediaSourceSupported(v,"video",r))return;const{CODECS:R,"FRAME-RATE":k,"HDCP-LEVEL":I,"PATHWAY-ID":F,RESOLUTION:N,"VIDEO-RANGE":U}=m,B=`${`${F||"."}-`}${u.bitrate}-${N}-${k}-${R}-${U}-${I}`;if(s[B])if(s[B].uri!==u.url&&!u.attrs["PATHWAY-ID"]){const H=o[B]+=1;u.attrs["PATHWAY-ID"]=new Array(H+1).join(".");const K=new Level(u);s[B]=K,i.push(K)}else s[B].addGroupId("audio",m.AUDIO),s[B].addGroupId("text",m.SUBTITLES);else{const H=new Level(u);s[B]=H,o[B]=1,i.push(H)}}),this.filterAndSortMediaOptions(i,t,a,l,c)}filterAndSortMediaOptions(e,t,r,i,s){let o=[],a=[],l=e;if((r||i)&&s&&(l=l.filter(({videoCodec:g,videoRange:v,width:x,height:S})=>(!!g||!!(x&&S))&&isVideoRange(v))),l.length===0){Promise.resolve().then(()=>{if(this.hls){t.levels.length&&this.warn(`One or more CODECS in variant not supported: ${JSON.stringify(t.levels[0].attrs)}`);const g=new Error("no level with compatible codecs found in manifest");this.hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:g,reason:g.message})}});return}if(t.audioTracks){const{preferManagedMediaSource:g}=this.hls.config;o=t.audioTracks.filter(v=>!v.audioCodec||areCodecsMediaSourceSupported(v.audioCodec,"audio",g)),assignTrackIdsByGroup(o)}t.subtitles&&(a=t.subtitles,assignTrackIdsByGroup(a));const c=l.slice(0);l.sort((g,v)=>{if(g.attrs["HDCP-LEVEL"]!==v.attrs["HDCP-LEVEL"])return(g.attrs["HDCP-LEVEL"]||"")>(v.attrs["HDCP-LEVEL"]||"")?1:-1;if(r&&g.height!==v.height)return g.height-v.height;if(g.frameRate!==v.frameRate)return g.frameRate-v.frameRate;if(g.videoRange!==v.videoRange)return VideoRangeValues.indexOf(g.videoRange)-VideoRangeValues.indexOf(v.videoRange);if(g.videoCodec!==v.videoCodec){const x=videoCodecPreferenceValue(g.videoCodec),S=videoCodecPreferenceValue(v.videoCodec);if(x!==S)return S-x}if(g.uri===v.uri&&g.codecSet!==v.codecSet){const x=codecsSetSelectionPreferenceValue(g.codecSet),S=codecsSetSelectionPreferenceValue(v.codecSet);if(x!==S)return S-x}return g.averageBitrate!==v.averageBitrate?g.averageBitrate-v.averageBitrate:0});let u=c[0];if(this.steering&&(l=this.steering.filterParsedLevels(l),l.length!==c.length)){for(let g=0;g<c.length;g++)if(c[g].pathwayId===l[0].pathwayId){u=c[g];break}}this._levels=l;for(let g=0;g<l.length;g++)if(l[g]===u){var d;this._firstLevel=g;const v=u.bitrate,x=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${l.length} level(s) found, first bitrate: ${v}`),((d=this.hls.userConfig)==null?void 0:d.abrEwmaDefaultEstimate)===void 0){const S=Math.min(v,this.hls.config.abrEwmaDefaultEstimateMax);S>x&&x===hlsDefaultConfig.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=S)}break}const f=s&&!i,m={levels:l,audioTracks:o,subtitleTracks:a,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:s,video:i,altAudio:!f&&o.some(g=>!!g.url)};this.hls.trigger(Events.MANIFEST_PARSED,m),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}get levels(){return this._levels.length===0?null:this._levels}get level(){return this.currentLevelIndex}set level(e){const t=this._levels;if(t.length===0)return;if(e<0||e>=t.length){const u=new Error("invalid level idx"),d=e<0;if(this.hls.trigger(Events.ERROR,{type:ErrorTypes.OTHER_ERROR,details:ErrorDetails.LEVEL_SWITCH_ERROR,level:e,fatal:d,error:u,reason:u.message}),d)return;e=Math.min(e,t.length-1)}const r=this.currentLevelIndex,i=this.currentLevel,s=i?i.attrs["PATHWAY-ID"]:void 0,o=t[e],a=o.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=o,r===e&&o.details&&i&&s===a)return;this.log(`Switching to level ${e} (${o.height?o.height+"p ":""}${o.videoRange?o.videoRange+" ":""}${o.codecSet?o.codecSet+" ":""}@${o.bitrate})${a?" with Pathway "+a:""} from level ${r}${s?" with Pathway "+s:""}`);const l={level:e,attrs:o.attrs,details:o.details,bitrate:o.bitrate,averageBitrate:o.averageBitrate,maxBitrate:o.maxBitrate,realBitrate:o.realBitrate,width:o.width,height:o.height,codecSet:o.codecSet,audioCodec:o.audioCodec,videoCodec:o.videoCodec,audioGroups:o.audioGroups,subtitleGroups:o.subtitleGroups,loaded:o.loaded,loadError:o.loadError,fragmentError:o.fragmentError,name:o.name,id:o.id,uri:o.uri,url:o.url,urlId:0,audioGroupIds:o.audioGroupIds,textGroupIds:o.textGroupIds};this.hls.trigger(Events.LEVEL_SWITCHING,l);const c=o.details;if(!c||c.live){const u=this.switchParams(o.uri,i==null?void 0:i.details,c);this.loadPlaylist(u)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,this._startLevel===void 0&&(this._startLevel=e),e!==-1&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(this._startLevel===void 0){const e=this.hls.config.startLevel;return e!==void 0?e:this.hls.firstAutoLevel}return this._startLevel}set startLevel(e){this._startLevel=e}onError(e,t){t.fatal||!t.context||t.context.type===PlaylistContextType.LEVEL&&t.context.level===this.level&&this.checkRetry(t)}onFragBuffered(e,{frag:t}){if(t!==void 0&&t.type===PlaylistLevelType.MAIN){const r=t.elementaryStreams;if(!Object.keys(r).some(s=>!!r[s]))return;const i=this._levels[t.level];i!=null&&i.loadError&&(this.log(`Resetting level error count of ${i.loadError} on frag buffered`),i.loadError=0)}}onLevelLoaded(e,t){var r;const{level:i,details:s}=t,o=this._levels[i];if(!o){var a;this.warn(`Invalid level index ${i}`),(a=t.deliveryDirectives)!=null&&a.skip&&(s.deltaUpdateFailed=!0);return}i===this.currentLevelIndex?(o.fragmentError===0&&(o.loadError=0),this.playlistLoaded(i,t,o.details)):(r=t.deliveryDirectives)!=null&&r.skip&&(s.deltaUpdateFailed=!0)}loadPlaylist(e){super.loadPlaylist();const t=this.currentLevelIndex,r=this.currentLevel;if(r&&this.shouldLoadPlaylist(r)){let i=r.uri;if(e)try{i=e.addDirectives(i)}catch(o){this.warn(`Could not construct new URL with HLS Delivery Directives: ${o}`)}const s=r.attrs["PATHWAY-ID"];this.log(`Loading level index ${t}${(e==null?void 0:e.msn)!==void 0?" at sn "+e.msn+" part "+e.part:""} with${s?" Pathway "+s:""} ${i}`),this.clearTimer(),this.hls.trigger(Events.LEVEL_LOADING,{url:i,level:t,pathwayId:r.attrs["PATHWAY-ID"],id:0,deliveryDirectives:e||null})}}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=e)}removeLevel(e){var t;const r=this._levels.filter((i,s)=>s!==e?!0:(this.steering&&this.steering.removeLevel(i),i===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,i.details&&i.details.fragments.forEach(o=>o.level=-1)),!1));reassignFragmentLevelIndexes(r),this._levels=r,this.currentLevelIndex>-1&&(t=this.currentLevel)!=null&&t.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.hls.trigger(Events.LEVELS_UPDATED,{levels:r})}onLevelsUpdated(e,{levels:t}){this._levels=t}checkMaxAutoUpdated(){const{autoLevelCapping:e,maxAutoLevel:t,maxHdcpLevel:r}=this.hls;this._maxAutoLevel!==t&&(this._maxAutoLevel=t,this.hls.trigger(Events.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:e,levels:this.levels,maxAutoLevel:t,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:r}))}}function assignTrackIdsByGroup(n){const e={};n.forEach(t=>{const r=t.groupId||"";t.id=e[r]=e[r]||0,e[r]++})}class KeyLoader{constructor(e){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const r in this.keyUriToKeyInfo){const i=this.keyUriToKeyInfo[r].loader;if(i){var t;if(e&&e!==((t=i.context)==null?void 0:t.frag.type))return;i.abort()}}}detach(){for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e].loader;t&&t.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(e,t=ErrorDetails.KEY_LOAD_ERROR,r,i,s){return new LoadError({type:ErrorTypes.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:s,error:r,networkDetails:i})}loadClear(e,t){if(this.emeController&&this.config.emeEnabled){const{sn:r,cc:i}=e;for(let s=0;s<t.length;s++){const o=t[s];if(i<=o.cc&&(r==="initSegment"||o.sn==="initSegment"||r<o.sn)){this.emeController.selectKeySystemFormat(o).then(a=>{o.setKeyFormat(a)});break}}}}load(e){return!e.decryptdata&&e.encrypted&&this.emeController?this.emeController.selectKeySystemFormat(e).then(t=>this.loadInternal(e,t)):this.loadInternal(e)}loadInternal(e,t){var r,i;t&&e.setKeyFormat(t);const s=e.decryptdata;if(!s){const c=new Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(e,ErrorDetails.KEY_LOAD_ERROR,c))}const o=s.uri;if(!o)return Promise.reject(this.createKeyLoadError(e,ErrorDetails.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${o}"`)));let a=this.keyUriToKeyInfo[o];if((r=a)!=null&&r.decryptdata.key)return s.key=a.decryptdata.key,Promise.resolve({frag:e,keyInfo:a});if((i=a)!=null&&i.keyLoadPromise){var l;switch((l=a.mediaKeySessionContext)==null?void 0:l.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return a.keyLoadPromise.then(c=>(s.key=c.keyInfo.decryptdata.key,{frag:e,keyInfo:a}))}}switch(a=this.keyUriToKeyInfo[o]={decryptdata:s,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},s.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return s.keyFormat==="identity"?this.loadKeyHTTP(a,e):this.loadKeyEME(a,e);case"AES-128":return this.loadKeyHTTP(a,e);default:return Promise.reject(this.createKeyLoadError(e,ErrorDetails.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${s.method}"`)))}}loadKeyEME(e,t){const r={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){const i=this.emeController.loadKey(r);if(i)return(e.keyLoadPromise=i.then(s=>(e.mediaKeySessionContext=s,r))).catch(s=>{throw e.keyLoadPromise=null,s})}return Promise.resolve(r)}loadKeyHTTP(e,t){const r=this.config,i=r.loader,s=new i(r);return t.keyLoader=e.loader=s,e.keyLoadPromise=new Promise((o,a)=>{const l={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},c=r.keyLoadPolicy.default,u={loadPolicy:c,timeout:c.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},d={onSuccess:(f,m,g,v)=>{const{frag:x,keyInfo:S,url:C}=g;if(!x.decryptdata||S!==this.keyUriToKeyInfo[C])return a(this.createKeyLoadError(x,ErrorDetails.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),v));S.decryptdata.key=x.decryptdata.key=new Uint8Array(f.data),x.keyLoader=null,S.loader=null,o({frag:x,keyInfo:S})},onError:(f,m,g,v)=>{this.resetLoader(m),a(this.createKeyLoadError(t,ErrorDetails.KEY_LOAD_ERROR,new Error(`HTTP Error ${f.code} loading key ${f.text}`),g,_objectSpread2({url:l.url,data:void 0},f)))},onTimeout:(f,m,g)=>{this.resetLoader(m),a(this.createKeyLoadError(t,ErrorDetails.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),g))},onAbort:(f,m,g)=>{this.resetLoader(m),a(this.createKeyLoadError(t,ErrorDetails.INTERNAL_ABORTED,new Error("key loading aborted"),g))}};s.load(l,u,d)})}resetLoader(e){const{frag:t,keyInfo:r,url:i}=e,s=r.loader;t.keyLoader===s&&(t.keyLoader=null,r.loader=null),delete this.keyUriToKeyInfo[i],s&&s.destroy()}}function getSourceBuffer(){return self.SourceBuffer||self.WebKitSourceBuffer}function isMSESupported(){if(!getMediaSource())return!1;const e=getSourceBuffer();return!e||e.prototype&&typeof e.prototype.appendBuffer=="function"&&typeof e.prototype.remove=="function"}function isSupported(){if(!isMSESupported())return!1;const n=getMediaSource();return typeof(n==null?void 0:n.isTypeSupported)=="function"&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(e=>n.isTypeSupported(mimeTypeForCodec(e,"video")))||["mp4a.40.2","fLaC"].some(e=>n.isTypeSupported(mimeTypeForCodec(e,"audio"))))}function changeTypeSupported(){var n;const e=getSourceBuffer();return typeof(e==null||(n=e.prototype)==null?void 0:n.changeType)=="function"}const STALL_MINIMUM_DURATION_MS=250,MAX_START_GAP_JUMP=2,SKIP_BUFFER_HOLE_STEP_SECONDS=.1,SKIP_BUFFER_RANGE_START=.05;class GapController{constructor(e,t,r,i){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=e,this.media=t,this.fragmentTracker=r,this.hls=i}destroy(){this.media=null,this.hls=this.fragmentTracker=null}poll(e,t){const{config:r,media:i,stalled:s}=this;if(i===null)return;const{currentTime:o,seeking:a}=i,l=this.seeking&&!a,c=!this.seeking&&a;if(this.seeking=a,o!==e){if(this.moved=!0,a||(this.nudgeRetry=0),s!==null){if(this.stallReported){const x=self.performance.now()-s;logger.warn(`playback not stuck anymore @${o}, after ${Math.round(x)}ms`),this.stallReported=!1}this.stalled=null}return}if(c||l){this.stalled=null;return}if(i.paused&&!a||i.ended||i.playbackRate===0||!BufferHelper.getBuffered(i).length){this.nudgeRetry=0;return}const u=BufferHelper.bufferInfo(i,o,0),d=u.nextStart||0;if(a){const x=u.len>MAX_START_GAP_JUMP,S=!d||t&&t.start<=o||d-o>MAX_START_GAP_JUMP&&!this.fragmentTracker.getPartialFragment(o);if(x||S)return;this.moved=!1}if(!this.moved&&this.stalled!==null){var f;if(!(u.len>0)&&!d)return;const S=Math.max(d,u.start||0)-o,C=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,k=(C==null||(f=C.details)==null?void 0:f.live)?C.details.targetduration*2:MAX_START_GAP_JUMP,I=this.fragmentTracker.getPartialFragment(o);if(S>0&&(S<=k||I)){i.paused||this._trySkipBufferHole(I);return}}const m=self.performance.now();if(s===null){this.stalled=m;return}const g=m-s;if(!a&&g>=STALL_MINIMUM_DURATION_MS&&(this._reportStall(u),!this.media))return;const v=BufferHelper.bufferInfo(i,o,r.maxBufferHole);this._tryFixBufferStall(v,g)}_tryFixBufferStall(e,t){const{config:r,fragmentTracker:i,media:s}=this;if(s===null)return;const o=s.currentTime,a=i.getPartialFragment(o);a&&(this._trySkipBufferHole(a)||!this.media)||(e.len>r.maxBufferHole||e.nextStart&&e.nextStart-o<r.maxBufferHole)&&t>r.highBufferWatchdogPeriod*1e3&&(logger.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}_reportStall(e){const{hls:t,media:r,stallReported:i}=this;if(!i&&r){this.stallReported=!0;const s=new Error(`Playback stalling at @${r.currentTime} due to low buffer (${JSON.stringify(e)})`);logger.warn(s.message),t.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,error:s,buffer:e.len})}}_trySkipBufferHole(e){const{config:t,hls:r,media:i}=this;if(i===null)return 0;const s=i.currentTime,o=BufferHelper.bufferInfo(i,s,0),a=s<o.start?o.start:o.nextStart;if(a){const l=o.len<=t.maxBufferHole,c=o.len>0&&o.len<1&&i.readyState<3,u=a-s;if(u>0&&(l||c)){if(u>t.maxBufferHole){const{fragmentTracker:f}=this;let m=!1;if(s===0){const g=f.getAppendedFrag(0,PlaylistLevelType.MAIN);g&&a<g.end&&(m=!0)}if(!m){const g=e||f.getAppendedFrag(s,PlaylistLevelType.MAIN);if(g){let v=!1,x=g.end;for(;x<a;){const S=f.getPartialFragment(x);if(S)x+=S.duration;else{v=!0;break}}if(v)return 0}}}const d=Math.max(a+SKIP_BUFFER_RANGE_START,s+SKIP_BUFFER_HOLE_STEP_SECONDS);if(logger.warn(`skipping hole, adjusting currentTime from ${s} to ${d}`),this.moved=!0,this.stalled=null,i.currentTime=d,e&&!e.gap){const f=new Error(`fragment loaded with buffer holes, seeking from ${s} to ${d}`);r.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:f,reason:f.message,frag:e})}return d}}return 0}_tryNudgeBuffer(){const{config:e,hls:t,media:r,nudgeRetry:i}=this;if(r===null)return;const s=r.currentTime;if(this.nudgeRetry++,i<e.nudgeMaxRetry){const o=s+(i+1)*e.nudgeOffset,a=new Error(`Nudging 'currentTime' from ${s} to ${o}`);logger.warn(a.message),r.currentTime=o,t.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.BUFFER_NUDGE_ON_STALL,error:a,fatal:!1})}else{const o=new Error(`Playhead still not moving while enough data buffered @${s} after ${e.nudgeMaxRetry} nudges`);logger.error(o.message),t.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.BUFFER_STALLED_ERROR,error:o,fatal:!0})}}}const TICK_INTERVAL=100;class StreamController extends BaseStreamController{constructor(e,t,r){super(e,t,r,"[stream-controller]",PlaylistLevelType.MAIN),this.audioCodecSwap=!1,this.gapController=null,this.level=-1,this._forceStartLoad=!1,this.altAudio=!1,this.audioOnly=!1,this.fragPlaying=null,this.onvplaying=null,this.onvseeked=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.on(Events.MANIFEST_PARSED,this.onManifestParsed,this),e.on(Events.LEVEL_LOADING,this.onLevelLoading,this),e.on(Events.LEVEL_LOADED,this.onLevelLoaded,this),e.on(Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(Events.ERROR,this.onError,this),e.on(Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(Events.BUFFER_CREATED,this.onBufferCreated,this),e.on(Events.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(Events.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(Events.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:e}=this;e.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(Events.MANIFEST_PARSED,this.onManifestParsed,this),e.off(Events.LEVEL_LOADED,this.onLevelLoaded,this),e.off(Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(Events.ERROR,this.onError,this),e.off(Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(Events.BUFFER_CREATED,this.onBufferCreated,this),e.off(Events.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(Events.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(Events.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this._unregisterListeners(),super.onHandlerDestroying()}startLoad(e){if(this.levels){const{lastCurrentTime:t,hls:r}=this;if(this.stopLoad(),this.setInterval(TICK_INTERVAL),this.level=-1,!this.startFragRequested){let i=r.startLevel;i===-1&&(r.config.testBandwidth&&this.levels.length>1?(i=0,this.bitrateTest=!0):i=r.firstAutoLevel),r.nextLoadLevel=i,this.level=r.loadLevel,this.loadedmetadata=!1}t>0&&e===-1&&(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t),this.state=State.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this._forceStartLoad=!0,this.state=State.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case State.WAITING_LEVEL:{const{levels:t,level:r}=this,i=t==null?void 0:t[r],s=i==null?void 0:i.details;if(s&&(!s.live||this.levelLastLoaded===i)){if(this.waitForCdnTuneIn(s))break;this.state=State.IDLE;break}else if(this.hls.nextLoadLevel!==this.level){this.state=State.IDLE;break}break}case State.FRAG_LOADING_WAITING_RETRY:{var e;const t=self.performance.now(),r=this.retryDate;if(!r||t>=r||(e=this.media)!=null&&e.seeking){const{levels:i,level:s}=this,o=i==null?void 0:i[s];this.resetStartWhenNotLoaded(o||null),this.state=State.IDLE}}break}this.state===State.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){super.onTickEnd(),this.checkBuffer(),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:t,levels:r,media:i}=this;if(t===null||!i&&(this.startFragRequested||!e.config.startFragPrefetch)||this.altAudio&&this.audioOnly)return;const s=e.nextLoadLevel;if(!(r!=null&&r[s]))return;const o=r[s],a=this.getMainFwdBufferInfo();if(a===null)return;const l=this.getLevelDetails();if(l&&this._streamEnded(a,l)){const v={};this.altAudio&&(v.type="video"),this.hls.trigger(Events.BUFFER_EOS,v),this.state=State.ENDED;return}e.loadLevel!==s&&e.manualLevel===-1&&this.log(`Adapting to level ${s} from level ${this.level}`),this.level=e.nextLoadLevel=s;const c=o.details;if(!c||this.state===State.WAITING_LEVEL||c.live&&this.levelLastLoaded!==o){this.level=s,this.state=State.WAITING_LEVEL;return}const u=a.len,d=this.getMaxBufferLength(o.maxBitrate);if(u>=d)return;this.backtrackFragment&&this.backtrackFragment.start>a.end&&(this.backtrackFragment=null);const f=this.backtrackFragment?this.backtrackFragment.start:a.end;let m=this.getNextFragment(f,c);if(this.couldBacktrack&&!this.fragPrevious&&m&&m.sn!=="initSegment"&&this.fragmentTracker.getState(m)!==FragmentState.OK){var g;const x=((g=this.backtrackFragment)!=null?g:m).sn-c.startSN,S=c.fragments[x-1];S&&m.cc===S.cc&&(m=S,this.fragmentTracker.removeFragment(S))}else this.backtrackFragment&&a.len&&(this.backtrackFragment=null);if(m&&this.isLoopLoading(m,f)){if(!m.gap){const x=this.audioOnly&&!this.altAudio?ElementaryStreamTypes.AUDIO:ElementaryStreamTypes.VIDEO,S=(x===ElementaryStreamTypes.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;S&&this.afterBufferFlushed(S,x,PlaylistLevelType.MAIN)}m=this.getNextFragmentLoopLoading(m,c,a,PlaylistLevelType.MAIN,d)}m&&(m.initSegment&&!m.initSegment.data&&!this.bitrateTest&&(m=m.initSegment),this.loadFragment(m,o,f))}loadFragment(e,t,r){const i=this.fragmentTracker.getState(e);this.fragCurrent=e,i===FragmentState.NOT_LOADED||i===FragmentState.PARTIAL?e.sn==="initSegment"?this._loadInitSegment(e,t):this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):(this.startFragRequested=!0,super.loadFragment(e,t,r)):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,PlaylistLevelType.MAIN)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:t}=this;if(t!=null&&t.readyState){let r;const i=this.getAppendedFrag(t.currentTime);i&&i.start>1&&this.flushMainBuffer(0,i.start-1);const s=this.getLevelDetails();if(s!=null&&s.live){const a=this.getMainFwdBufferInfo();if(!a||a.len<s.targetduration*2)return}if(!t.paused&&e){const a=this.hls.nextLoadLevel,l=e[a],c=this.fragLastKbps;c&&this.fragCurrent?r=this.fragCurrent.duration*l.maxBitrate/(1e3*c)+1:r=0}else r=0;const o=this.getBufferedFrag(t.currentTime+r);if(o){const a=this.followingBufferedFrag(o);if(a){this.abortCurrentFrag();const l=a.maxStartPTS?a.maxStartPTS:a.start,c=a.duration,u=Math.max(o.end,l+Math.min(Math.max(c-this.config.maxFragLookUpTolerance,c*(this.couldBacktrack?.5:.125)),c*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(u,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case State.KEY_LOADING:case State.FRAG_LOADING:case State.FRAG_LOADING_WAITING_RETRY:case State.PARSING:case State.PARSED:this.state=State.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,this.altAudio?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);const r=t.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),r.addEventListener("playing",this.onvplaying),r.addEventListener("seeked",this.onvseeked),this.gapController=new GapController(this.config,r,this.fragmentTracker,this.hls)}onMediaDetaching(){const{media:e}=this;e&&this.onvplaying&&this.onvseeked&&(e.removeEventListener("playing",this.onvplaying),e.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),super.onMediaDetaching()}onMediaPlaying(){this.tick()}onMediaSeeked(){const e=this.media,t=e?e.currentTime:null;isFiniteNumber(t)&&this.log(`Media seeked to ${t.toFixed(3)}`);const r=this.getMainFwdBufferInfo();if(r===null||r.len===0){this.warn(`Main forward buffer length on "seeked" event ${r?r.len:"empty"})`);return}this.tick()}onManifestLoading(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(Events.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=this.fragLastKbps=0,this.levels=this.fragPlaying=this.backtrackFragment=this.levelLastLoaded=null,this.altAudio=this.audioOnly=this.startFragRequested=!1}onManifestParsed(e,t){let r=!1,i=!1;t.levels.forEach(s=>{const o=s.audioCodec;o&&(r=r||o.indexOf("mp4a.40.2")!==-1,i=i||o.indexOf("mp4a.40.5")!==-1)}),this.audioCodecSwitch=r&&i&&!changeTypeSupported(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){const{levels:r}=this;if(!r||this.state!==State.IDLE)return;const i=r[t.level];(!i.details||i.details.live&&this.levelLastLoaded!==i||this.waitForCdnTuneIn(i.details))&&(this.state=State.WAITING_LEVEL)}onLevelLoaded(e,t){var r;const{levels:i}=this,s=t.level,o=t.details,a=o.totalduration;if(!i){this.warn(`Levels were reset while loading level ${s}`);return}this.log(`Level ${s} loaded [${o.startSN},${o.endSN}]${o.lastPartSn?`[part-${o.lastPartSn}-${o.lastPartIndex}]`:""}, cc [${o.startCC}, ${o.endCC}] duration:${a}`);const l=i[s],c=this.fragCurrent;c&&(this.state===State.FRAG_LOADING||this.state===State.FRAG_LOADING_WAITING_RETRY)&&c.level!==t.level&&c.loader&&this.abortCurrentFrag();let u=0;if(o.live||(r=l.details)!=null&&r.live){var d;if(this.checkLiveUpdate(o),o.deltaUpdateFailed)return;u=this.alignPlaylists(o,l.details,(d=this.levelLastLoaded)==null?void 0:d.details)}if(l.details=o,this.levelLastLoaded=l,this.hls.trigger(Events.LEVEL_UPDATED,{details:o,level:s}),this.state===State.WAITING_LEVEL){if(this.waitForCdnTuneIn(o))return;this.state=State.IDLE}this.startFragRequested?o.live&&this.synchronizeToLiveEdge(o):this.setStartPosition(o,u),this.tick()}_handleFragmentLoadProgress(e){var t;const{frag:r,part:i,payload:s}=e,{levels:o}=this;if(!o){this.warn(`Levels were reset while fragment load was in progress. Fragment ${r.sn} of level ${r.level} will not be buffered`);return}const a=o[r.level],l=a.details;if(!l){this.warn(`Dropping fragment ${r.sn} of level ${r.level} after level details were reset`),this.fragmentTracker.removeFragment(r);return}const c=a.videoCodec,u=l.PTSKnown||!l.live,d=(t=r.initSegment)==null?void 0:t.data,f=this._getAudioCodec(a),m=this.transmuxer=this.transmuxer||new TransmuxerInterface(this.hls,PlaylistLevelType.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),g=i?i.index:-1,v=g!==-1,x=new ChunkMetadata(r.level,r.sn,r.stats.chunkCount,s.byteLength,g,v),S=this.initPTS[r.cc];m.push(s,d,f,c,r,i,l.totalduration,u,x,S)}onAudioTrackSwitching(e,t){const r=this.altAudio;if(!!!t.url){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const o=this.fragCurrent;o&&(this.log("Switching to main audio track, cancel main fragment load"),o.abortRequests(),this.fragmentTracker.removeFragment(o)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();const s=this.hls;r&&(s.trigger(Events.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null}),this.fragmentTracker.removeAllFragments()),s.trigger(Events.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){const r=t.id,i=!!this.hls.audioTracks[r].url;if(i){const s=this.videoBuffer;s&&this.mediaBuffer!==s&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=s)}this.altAudio=i,this.tick()}onBufferCreated(e,t){const r=t.tracks;let i,s,o=!1;for(const a in r){const l=r[a];if(l.id==="main"){if(s=a,i=l,a==="video"){const c=r[a];c&&(this.videoBuffer=c.buffer)}}else o=!0}o&&i?(this.log(`Alternate track found, use ${s}.buffered to schedule main fragment loading`),this.mediaBuffer=i.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){const{frag:r,part:i}=t;if(r&&r.type!==PlaylistLevelType.MAIN)return;if(this.fragContextChanged(r)){this.warn(`Fragment ${r.sn}${i?" p: "+i.index:""} of level ${r.level} finished buffering, but was aborted. state: ${this.state}`),this.state===State.PARSED&&(this.state=State.IDLE);return}const s=i?i.stats:r.stats;this.fragLastKbps=Math.round(8*s.total/(s.buffering.end-s.loading.first)),r.sn!=="initSegment"&&(this.fragPrevious=r),this.fragBufferedComplete(r,i)}onError(e,t){var r;if(t.fatal){this.state=State.ERROR;return}switch(t.details){case ErrorDetails.FRAG_GAP:case ErrorDetails.FRAG_PARSING_ERROR:case ErrorDetails.FRAG_DECRYPT_ERROR:case ErrorDetails.FRAG_LOAD_ERROR:case ErrorDetails.FRAG_LOAD_TIMEOUT:case ErrorDetails.KEY_LOAD_ERROR:case ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(PlaylistLevelType.MAIN,t);break;case ErrorDetails.LEVEL_LOAD_ERROR:case ErrorDetails.LEVEL_LOAD_TIMEOUT:case ErrorDetails.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===State.WAITING_LEVEL&&((r=t.context)==null?void 0:r.type)===PlaylistContextType.LEVEL&&(this.state=State.IDLE);break;case ErrorDetails.BUFFER_APPEND_ERROR:case ErrorDetails.BUFFER_FULL_ERROR:if(!t.parent||t.parent!=="main")return;if(t.details===ErrorDetails.BUFFER_APPEND_ERROR){this.resetLoadingState();return}this.reduceLengthAndFlushBuffer(t)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case ErrorDetails.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}checkBuffer(){const{media:e,gapController:t}=this;if(!(!e||!t||!e.readyState)){if(this.loadedmetadata||!BufferHelper.getBuffered(e).length){const r=this.state!==State.IDLE?this.fragCurrent:null;t.poll(this.lastCurrentTime,r)}this.lastCurrentTime=e.currentTime}}onFragLoadEmergencyAborted(){this.state=State.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()}onBufferFlushed(e,{type:t}){if(t!==ElementaryStreamTypes.AUDIO||this.audioOnly&&!this.altAudio){const r=(t===ElementaryStreamTypes.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(r,t,PlaylistLevelType.MAIN),this.tick()}}onLevelsUpdated(e,t){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level),this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const t=e.currentTime;let r=this.startPosition;if(r>=0&&t<r){if(e.seeking){this.log(`could not seek to ${r}, already seeking at ${t}`);return}const i=BufferHelper.getBuffered(e),o=(i.length?i.start(0):0)-r;o>0&&(o<this.config.maxBufferHole||o<this.config.maxFragLookUpTolerance)&&(this.log(`adjusting start position by ${o} to match buffer start`),r+=o,this.startPosition=r),this.log(`seek to target start position ${r} from current time ${t}`),e.currentTime=r}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t.indexOf("mp4a.40.5")!==-1?t="mp4a.40.2":t="mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then(r=>{const{hls:i}=this;if(!r||this.fragContextChanged(e))return;t.fragmentError=0,this.state=State.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const s=e.stats;s.parsing.start=s.parsing.end=s.buffering.start=s.buffering.end=self.performance.now(),i.trigger(Events.FRAG_LOADED,r),e.bitrateTest=!1})}_handleTransmuxComplete(e){var t;const r="main",{hls:i}=this,{remuxResult:s,chunkMeta:o}=e,a=this.getCurrentContext(o);if(!a){this.resetWhenMissingContext(o);return}const{frag:l,part:c,level:u}=a,{video:d,text:f,id3:m,initSegment:g}=s,{details:v}=u,x=this.altAudio?void 0:s.audio;if(this.fragContextChanged(l)){this.fragmentTracker.removeFragment(l);return}if(this.state=State.PARSING,g){if(g!=null&&g.tracks){const R=l.initSegment||l;this._bufferInitSegment(u,g.tracks,R,o),i.trigger(Events.FRAG_PARSING_INIT_SEGMENT,{frag:R,id:r,tracks:g.tracks})}const S=g.initPTS,C=g.timescale;isFiniteNumber(S)&&(this.initPTS[l.cc]={baseTime:S,timescale:C},i.trigger(Events.INIT_PTS_FOUND,{frag:l,id:r,initPTS:S,timescale:C}))}if(d&&v&&l.sn!=="initSegment"){const S=v.fragments[l.sn-1-v.startSN],C=l.sn===v.startSN,R=!S||l.cc>S.cc;if(s.independent!==!1){const{startPTS:k,endPTS:I,startDTS:F,endDTS:N}=d;if(c)c.elementaryStreams[d.type]={startPTS:k,endPTS:I,startDTS:F,endDTS:N};else if(d.firstKeyFrame&&d.independent&&o.id===1&&!R&&(this.couldBacktrack=!0),d.dropped&&d.independent){const U=this.getMainFwdBufferInfo(),M=(U?U.end:this.getLoadPosition())+this.config.maxBufferHole,B=d.firstKeyFramePTS?d.firstKeyFramePTS:k;if(!C&&M<B-this.config.maxBufferHole&&!R){this.backtrack(l);return}else R&&(l.gap=!0);l.setElementaryStreamInfo(d.type,l.start,I,l.start,N,!0)}else C&&k>MAX_START_GAP_JUMP&&(l.gap=!0);l.setElementaryStreamInfo(d.type,k,I,F,N),this.backtrackFragment&&(this.backtrackFragment=l),this.bufferFragmentData(d,l,c,o,C||R)}else if(C||R)l.gap=!0;else{this.backtrack(l);return}}if(x){const{startPTS:S,endPTS:C,startDTS:R,endDTS:k}=x;c&&(c.elementaryStreams[ElementaryStreamTypes.AUDIO]={startPTS:S,endPTS:C,startDTS:R,endDTS:k}),l.setElementaryStreamInfo(ElementaryStreamTypes.AUDIO,S,C,R,k),this.bufferFragmentData(x,l,c,o)}if(v&&m!=null&&(t=m.samples)!=null&&t.length){const S={id:r,frag:l,details:v,samples:m.samples};i.trigger(Events.FRAG_PARSING_METADATA,S)}if(v&&f){const S={id:r,frag:l,details:v,samples:f.samples};i.trigger(Events.FRAG_PARSING_USERDATA,S)}}_bufferInitSegment(e,t,r,i){if(this.state!==State.PARSING)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&delete t.audio;const{audio:s,video:o,audiovideo:a}=t;if(s){let l=e.audioCodec;const c=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){l&&(l.indexOf("mp4a.40.5")!==-1?l="mp4a.40.2":l="mp4a.40.5");const u=s.metadata;u&&"channelCount"in u&&(u.channelCount||1)!==1&&c.indexOf("firefox")===-1&&(l="mp4a.40.5")}l&&l.indexOf("mp4a.40.5")!==-1&&c.indexOf("android")!==-1&&s.container!=="audio/mpeg"&&(l="mp4a.40.2",this.log(`Android: force audio codec to ${l}`)),e.audioCodec&&e.audioCodec!==l&&this.log(`Swapping manifest audio codec "${e.audioCodec}" for "${l}"`),s.levelCodec=l,s.id="main",this.log(`Init audio buffer, container:${s.container}, codecs[selected/level/parsed]=[${l||""}/${e.audioCodec||""}/${s.codec}]`)}o&&(o.levelCodec=e.videoCodec,o.id="main",this.log(`Init video buffer, container:${o.container}, codecs[level/parsed]=[${e.videoCodec||""}/${o.codec}]`)),a&&this.log(`Init audiovideo buffer, container:${a.container}, codecs[level/parsed]=[${e.codecs}/${a.codec}]`),this.hls.trigger(Events.BUFFER_CODECS,t),Object.keys(t).forEach(l=>{const u=t[l].initSegment;u!=null&&u.byteLength&&this.hls.trigger(Events.BUFFER_APPENDING,{type:l,data:u,frag:r,part:null,chunkMeta:i,parent:r.type})}),this.tickImmediate()}getMainFwdBufferInfo(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,PlaylistLevelType.MAIN)}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=State.IDLE}checkFragmentChanged(){const e=this.media;let t=null;if(e&&e.readyState>1&&e.seeking===!1){const r=e.currentTime;if(BufferHelper.isBuffered(e,r)?t=this.getAppendedFrag(r):BufferHelper.isBuffered(e,r+.1)&&(t=this.getAppendedFrag(r+.1)),t){this.backtrackFragment=null;const i=this.fragPlaying,s=t.level;(!i||t.sn!==i.sn||i.level!==s)&&(this.fragPlaying=t,this.hls.trigger(Events.FRAG_CHANGED,{frag:t}),(!i||i.level!==s)&&this.hls.trigger(Events.LEVEL_SWITCHED,{level:s}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){const e=this.media;return e?this.fragPlaying||this.getAppendedFrag(e.currentTime):null}get currentProgramDateTime(){const e=this.media;if(e){const t=e.currentTime,r=this.currentFrag;if(r&&isFiniteNumber(t)&&isFiniteNumber(r.programDateTime)){const i=r.programDateTime+(t-r.start)*1e3;return new Date(i)}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class Hls{static get version(){return"1.5.17"}static isMSESupported(){return isMSESupported()}static isSupported(){return isSupported()}static getMediaSource(){return getMediaSource()}static get Events(){return Events}static get ErrorTypes(){return ErrorTypes}static get ErrorDetails(){return ErrorDetails}static get DefaultConfig(){return Hls.defaultConfig?Hls.defaultConfig:hlsDefaultConfig}static set DefaultConfig(e){Hls.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this.started=!1,this._emitter=new EventEmitter,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null,this.triggeringException=void 0,enableLogs(e.debug||!1,"Hls instance");const t=this.config=mergeConfig(Hls.DefaultConfig,e);this.userConfig=e,t.progressive&&enableStreamingMode(t);const{abrController:r,bufferController:i,capLevelController:s,errorController:o,fpsController:a}=t,l=new o(this),c=this.abrController=new r(this),u=this.bufferController=new i(this),d=this.capLevelController=new s(this),f=new a(this),m=new PlaylistLoader(this),g=new ID3TrackController(this),v=t.contentSteeringController,x=v?new v(this):null,S=this.levelController=new LevelController(this,x),C=new FragmentTracker(this),R=new KeyLoader(this.config),k=this.streamController=new StreamController(this,C,R);d.setStreamController(k),f.setStreamController(k);const I=[m,S,k];x&&I.splice(1,0,x),this.networkControllers=I;const F=[c,u,d,f,g,C];this.audioTrackController=this.createController(t.audioTrackController,I);const N=t.audioStreamController;N&&I.push(new N(this,C,R)),this.subtitleTrackController=this.createController(t.subtitleTrackController,I);const U=t.subtitleStreamController;U&&I.push(new U(this,C,R)),this.createController(t.timelineController,F),R.emeController=this.emeController=this.createController(t.emeController,F),this.cmcdController=this.createController(t.cmcdController,F),this.latencyController=this.createController(LatencyController,F),this.coreComponents=F,I.push(l);const M=l.onErrorOut;typeof M=="function"&&this.on(Events.ERROR,M,l)}createController(e,t){if(e){const r=new e(this);return t&&t.push(r),r}return null}on(e,t,r=this){this._emitter.on(e,t,r)}once(e,t,r=this){this._emitter.once(e,t,r)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t,r=this,i){this._emitter.off(e,t,r,i)}listeners(e){return this._emitter.listeners(e)}emit(e,t,r){return this._emitter.emit(e,t,r)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(r){if(logger.error("An internal error happened while handling event "+e+'. Error message: "'+r.message+'". Here is a stacktrace:',r),!this.triggeringException){this.triggeringException=!0;const i=e===Events.ERROR;this.trigger(Events.ERROR,{type:ErrorTypes.OTHER_ERROR,details:ErrorDetails.INTERNAL_EXCEPTION,fatal:i,event:e,error:r}),this.triggeringException=!1}}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){logger.log("destroy"),this.trigger(Events.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(t=>t.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(t=>t.destroy()),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){logger.log("attachMedia"),this._media=e,this.trigger(Events.MEDIA_ATTACHING,{media:e})}detachMedia(){logger.log("detachMedia"),this.trigger(Events.MEDIA_DETACHING,void 0),this._media=null}loadSource(e){this.stopLoad();const t=this.media,r=this.url,i=this.url=urlToolkitExports.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,logger.log(`loadSource:${i}`),t&&r&&(r!==i||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(Events.MANIFEST_LOADING,{url:e})}startLoad(e=-1){logger.log(`startLoad(${e})`),this.started=!0,this.networkControllers.forEach(t=>{t.startLoad(e)})}stopLoad(){logger.log("stopLoad"),this.started=!1,this.networkControllers.forEach(e=>{e.stopLoad()})}resumeBuffering(){this.started&&this.networkControllers.forEach(e=>{"fragmentLoader"in e&&e.startLoad(-1)})}pauseBuffering(){this.networkControllers.forEach(e=>{"fragmentLoader"in e&&e.stopLoad()})}swapAudioCodec(){logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){logger.log("recoverMediaError");const e=this._media;this.detachMedia(),e&&this.attachMedia(e)}removeLevel(e){this.levelController.removeLevel(e)}get levels(){const e=this.levelController.levels;return e||[]}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){logger.log(`set currentLevel:${e}`),this.levelController.manualLevel=e,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){logger.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){logger.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){logger.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){const e=this.levelController.startLevel;return e===-1&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e}set startLevel(e){logger.log(`set startLevel:${e}`),e!==-1&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}set bandwidthEstimate(e){this.abrController.resetEstimator(e)}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(logger.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){isHdcpLevel(e)&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;const r=e.length;for(let i=0;i<r;i++)if(e[i].maxBitrate>=t)return i;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:t,maxHdcpLevel:r}=this;let i;if(t===-1&&e!=null&&e.length?i=e.length-1:i=t,r)for(let s=i;s--;){const o=e[s].attrs["HDCP-LEVEL"];if(o&&o<=r)return s}return i}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(e){this.abrController.nextAutoLevel=e}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}setAudioOption(e){var t;return(t=this.audioTrackController)==null?void 0:t.setAudioOption(e)}setSubtitleOption(e){var t;return(t=this.subtitleTrackController)==null||t.setSubtitleOption(e),null}get allAudioTracks(){const e=this.audioTrackController;return e?e.allAudioTracks:[]}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const t=this.audioTrackController;t&&(t.audioTrack=e)}get allSubtitleTracks(){const e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return e?e.subtitleDisplay:!1}set subtitleDisplay(e){const t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}}Hls.defaultConfig=void 0;const _hoisted_1$1={id:"player-container",class:"bg-base-100 p-4"},_hoisted_2$1={class:"input-section"},_hoisted_3$1={class:"input-group"},_hoisted_4$1=["value"],_hoisted_5$1=["disabled"],_hoisted_6$1={key:0,class:"loading loading-spinner"},_hoisted_7$1={key:0,class:"main-content bg-base-300"},_hoisted_8$1={class:"video-container"},_hoisted_9$1={key:0,class:"default-cover bg-base-300"},_hoisted_10$1={key:0,class:"channel-overlay bg-base-300/90 backdrop-blur"},_hoisted_11$1={class:"channel-info-content"},_hoisted_12$1={class:"channel-header"},_hoisted_13$1=["src"],_hoisted_14$1={class:"channel-title"},_hoisted_15$1={class:"channel-name text-base-content"},_hoisted_16$1={class:"player-controls"},_hoisted_17$1={class:"floating-primary-sidebar bg-base-300/90 backdrop-blur"},_hoisted_18$1={class:"group-list"},_hoisted_19$1=["onClick"],_hoisted_20$1={class:"group-name text-base-content"},_hoisted_21$1={class:"group-count bg-base-content/10 text-base-content/60"},_hoisted_22$1={key:0,class:"secondary-sidebar bg-base-300/90 backdrop-blur"},_hoisted_23$1={class:"sidebar-header border-base-content/10"},_hoisted_24$1={class:"text-base-content"},_hoisted_25$1={class:"channel-list"},_hoisted_26=["onClick"],_hoisted_27={class:"channel-info"},_hoisted_28={class:"channel-main"},_hoisted_29={class:"channel-number text-base-content/50"},_hoisted_30={class:"channel-name text-base-content"},_hoisted_31={class:"channel-meta"},_hoisted_32={key:0,class:"meta-tag ipv6-tag"},_hoisted_33={key:1,class:"meta-tag quality-tag"},_hoisted_34={key:1,src:_imports_0,alt:"默认封面",class:"cover-image"},_sfc_main$1={__name:"index",setup(n){const e=ref(null),t=ref(null),r=ref(!1),i=ref([]),s=ref(0),o=ref(null),a=ref("");ref({});const l=computed(()=>{const $={};return i.value.forEach(W=>{const J=W.groupTitle||"未分组";$[J]||($[J]=[]),$[J].push(W)}),$}),c=computed(()=>{const $={...l.value};return Object.keys($).sort((W,J)=>W==="未分组"?1:J==="未分组"?-1:W.localeCompare(J)).reduce((W,J)=>(W[J]=$[J],W),{})}),u=ref(!1),d=ref(null),f=ref(!1),m=ref(null),g=computed(()=>m.value?l.value[m.value]||[]:[]),v=ref(!1),x=ref(""),S=async()=>{if(!a.value){N("请输入播放地址","warning");return}r.value=!0,o.value=null;try{if(a.value.toLowerCase().endsWith(".m3u")||a.value.toLowerCase().endsWith(".m3u8")){const $=await fetch(a.value);if(!$.ok)throw new Error(`HTTP error! status: ${$.status}`);const W=await $.text();i.value=I(W),i.value.length>0?(await U(i.value[0],0),N("播放列表加载成功","success")):N("没有找到有效的媒体链接","warning")}else await C(a.value)}catch($){console.error("加载失败:",$),o.value="加载失败，请检查地址是否正确",N("加载失败，请检查地址是否正确","error")}finally{r.value=!1}},C=async $=>{try{if(t.value&&t.value.destroy(),!e.value)throw new Error("播放器容器未找到");const W=R($);t.value=new DPlayer({container:e.value,video:{url:$,type:W,customType:{hls:function(J,ne){const ve=new Hls;ve.loadSource(J.src),ve.attachMedia(J)}}},autoplay:!0,live:W==="hls",preload:"auto"}),v.value=!0,H({name:k($)})}catch(W){console.error("播放器初始化失败:",W),N("播放失败，请检查视频地址","error"),v.value=!1}},R=$=>{switch($.toLowerCase().split("?")[0].split(".").pop()){case"m3u8":return"hls";case"mp4":return"auto";case"flv":return"flv";default:return"auto"}},k=$=>{try{const J=new URL($).pathname.split("/").pop();return decodeURIComponent(J)||"未知视频"}catch{return"未知视频"}},I=$=>{const W=$.split(`
`),J=[];let ne={};for(let ve=0;ve<W.length;ve++){const Re=W[ve].trim();if(Re.startsWith("#EXTINF:-1")){ne={};const Le=Re.match(/tvg-name="([^"]+)"/),Ce=Re.match(/tvg-id="([^"]+)"/),j=Re.match(/tvg-logo="([^"]+)"/),ae=Re.match(/group-title="([^"]+)"/),ie=Re.match(/,\s*(.+)$/);ne.tvgName=(Le==null?void 0:Le[1])||"",ne.tvgId=(Ce==null?void 0:Ce[1])||"",ne.tvgLogo=(j==null?void 0:j[1])||"",ne.groupTitle=(ae==null?void 0:ae[1])||"",ne.name=(ie==null?void 0:ie[1])||ne.tvgName}else Re.startsWith("http")&&(ne.url=Re,ne.name&&ne.url&&J.push(ne),ne={})}return J},F=$=>$.name||"未命名频道",N=($,W)=>{const J=document.querySelector(".toast");J&&J.remove();const ne=document.createElement("div");ne.className="toast toast-center z-50";const ve=document.createElement("div");switch(W){case"success":ve.className="alert alert-success min-h-0 message-alert";break;case"warning":ve.className="alert alert-warning min-h-0 message-alert";break;case"error":ve.className="alert alert-error min-h-0 message-alert";break;default:ve.className="alert alert-info min-h-0 message-alert"}ve.innerHTML=`
    <span class="message-text">${$}</span>
  `,ne.appendChild(ve),document.body.appendChild(ne),requestAnimationFrame(()=>{ve.classList.add("show")}),setTimeout(()=>{ve.classList.add("hide"),setTimeout(()=>{ne.remove()},300)},2700)},U=async($,W)=>{try{if(t.value&&t.value.destroy(),!e.value)throw new Error("播放器容器未找到");s.value=W,t.value=new DPlayer({container:e.value,video:{url:$.url,type:"hls",customType:{hls:function(J,ne){const ve=new Hls;ve.loadSource(J.src),ve.attachMedia(J)}}},autoplay:!0,live:!0,preload:"auto"}),v.value=!0,H($)}catch(J){console.error("播放器初始化失败:",J),o.value="播放器初始化失败，请新页面重试",N("播放器初始化失败","error"),v.value=!1}},M=($,W)=>{let J=0;for(const[ne,ve]of Object.entries(l.value)){if(ne===$)return J+W;J+=ve.length}return W},B=$=>$.includes("_1080")?"HD":$.includes("_720")?"720P":$.includes("_480")?"480P":"",H=$=>{window.channelInfoTimer&&clearTimeout(window.channelInfoTimer),d.value=$,u.value=!0,window.channelInfoTimer=setTimeout(()=>{u.value=!1},3e3)},K=$=>{$.target.style.display="none"},Y=()=>{f.value=!f.value,f.value&&(m.value=null)},oe=$=>{m.value=$},ue=()=>{m.value=null};onMounted(()=>{}),onUnmounted(()=>{window.channelInfoTimer&&clearTimeout(window.channelInfoTimer),t.value&&t.value.destroy()});const Z=$=>{try{return new URL($).hostname.includes(":")}catch{return!1}},Ae=[{name:"IPTV直播源",url:"https://live.kilvn.com/iptv.m3u"},{name:"IPTV4直播源",url:"https://live.zbds.top/tv/iptv4.m3u"},{name:"IPV6直播源",url:"https://live.zbds.top/tv/iptv6.m3u"}],ye=()=>{x.value&&(a.value=x.value,S())};return($,W)=>(openBlock(),createElementBlock("div",_hoisted_1$1,[createBaseVNode("div",_hoisted_2$1,[createBaseVNode("div",_hoisted_3$1,[withDirectives(createBaseVNode("input",{"onUpdate:modelValue":W[0]||(W[0]=J=>a.value=J),class:"input input-bordered w-full bg-base-100 text-base-content",placeholder:"输入视频直链(支持MP4/M3U8/HLS/DASH)或选择直播源",onKeyup:withKeys(S,["enter"])},null,544),[[vModelText,a.value]]),withDirectives(createBaseVNode("select",{class:"select select-bordered bg-base-100 text-base-content","onUpdate:modelValue":W[1]||(W[1]=J=>x.value=J),onChange:ye},[W[2]||(W[2]=createBaseVNode("option",{value:"",disabled:"",selected:""},"选择直播源",-1)),(openBlock(),createElementBlock(Fragment$1,null,renderList(Ae,J=>createBaseVNode("option",{key:J.url,value:J.url},toDisplayString(J.name),9,_hoisted_4$1)),64))],544),[[vModelSelect,x.value]])]),createBaseVNode("button",{class:"btn btn-primary",onClick:S,disabled:r.value||!a.value.trim()},[r.value?(openBlock(),createElementBlock("span",_hoisted_6$1)):createCommentVNode("",!0),createTextVNode(" "+toDisplayString(r.value?"加载中...":"播放"),1)],8,_hoisted_5$1)]),a.value.trim()||i.value.length?(openBlock(),createElementBlock("div",_hoisted_7$1,[createBaseVNode("div",_hoisted_8$1,[v.value?createCommentVNode("",!0):(openBlock(),createElementBlock("div",_hoisted_9$1,W[3]||(W[3]=[createBaseVNode("div",{class:"cover-text"},[createBaseVNode("h3",{class:"text-base-content"},"欢迎使用在线播放器"),createBaseVNode("p",{class:"text-base-content/70"},"请输入播放地址开始观看")],-1)]))),createBaseVNode("div",{ref_key:"dplayerRef",ref:e,class:normalizeClass(["dplayer",{hidden:!v.value}])},null,2),createVNode(Transition,{name:"fade"},{default:withCtx(()=>{var J,ne;return[u.value?(openBlock(),createElementBlock("div",_hoisted_10$1,[createBaseVNode("div",_hoisted_11$1,[createBaseVNode("div",_hoisted_12$1,[(J=d.value)!=null&&J.tvgLogo?(openBlock(),createElementBlock("img",{key:0,src:d.value.tvgLogo,class:"channel-logo",onError:K},null,40,_hoisted_13$1)):createCommentVNode("",!0),createBaseVNode("div",_hoisted_14$1,[W[4]||(W[4]=createBaseVNode("div",{class:"playing-badge"},[createBaseVNode("span",{class:"dot"}),createTextVNode(" 正在播放 ")],-1)),createBaseVNode("div",_hoisted_15$1,toDisplayString(((ne=d.value)==null?void 0:ne.name)||k(a.value)),1)])])])])):createCommentVNode("",!0)]}),_:1}),createBaseVNode("div",_hoisted_16$1,[createBaseVNode("button",{class:"control-btn bg-base-300/60 hover:bg-base-300/80",onClick:Y},[W[5]||(W[5]=createBaseVNode("svg",{viewBox:"0 0 24 24",width:"24",height:"24"},[createBaseVNode("path",{d:"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z",fill:"currentColor"})],-1)),createTextVNode(" "+toDisplayString(f.value?"显示频道":"隐藏频道"),1)])]),createVNode(Transition,{name:"fade"},{default:withCtx(()=>[withDirectives(createBaseVNode("div",_hoisted_17$1,[createBaseVNode("div",{class:"sidebar-header border-base-content/10"},[W[7]||(W[7]=createBaseVNode("h3",{class:"text-base-content"},"频道分类",-1)),createBaseVNode("button",{class:"close-btn hover:bg-base-content/10",onClick:Y},W[6]||(W[6]=[createBaseVNode("svg",{viewBox:"0 0 24 24",width:"16",height:"16"},[createBaseVNode("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z",fill:"currentColor"})],-1)]))]),createBaseVNode("div",_hoisted_18$1,[(openBlock(!0),createElementBlock(Fragment$1,null,renderList(c.value,(J,ne)=>(openBlock(),createElementBlock("div",{key:ne,class:normalizeClass(["group-item hover:bg-base-content/5",{"active bg-primary/10":m.value===ne}]),onClick:ve=>oe(ne)},[createBaseVNode("span",_hoisted_20$1,toDisplayString(ne||"未分组"),1),createBaseVNode("span",_hoisted_21$1,toDisplayString(J.length)+" 个频道",1)],10,_hoisted_19$1))),128))])],512),[[vShow,!f.value]])]),_:1})]),createVNode(Transition,{name:"slide-right"},{default:withCtx(()=>[m.value?(openBlock(),createElementBlock("div",_hoisted_22$1,[createBaseVNode("div",_hoisted_23$1,[createBaseVNode("h3",_hoisted_24$1,toDisplayString(m.value),1),createBaseVNode("button",{class:"close-btn hover:bg-base-content/10",onClick:ue},W[8]||(W[8]=[createBaseVNode("svg",{viewBox:"0 0 24 24",width:"16",height:"16"},[createBaseVNode("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z",fill:"currentColor"})],-1)]))]),createBaseVNode("ul",_hoisted_25$1,[(openBlock(!0),createElementBlock(Fragment$1,null,renderList(g.value,(J,ne)=>(openBlock(),createElementBlock("li",{key:J.url,class:normalizeClass({active:s.value===M(m.value,ne),"hover:bg-base-content/5":!0,"border-base-content/5":!0}),onClick:ve=>U(J,M(m.value,ne))},[createBaseVNode("div",_hoisted_27,[createBaseVNode("div",_hoisted_28,[createBaseVNode("span",_hoisted_29,toDisplayString(M(m.value,ne)+1)+". ",1),createBaseVNode("span",_hoisted_30,toDisplayString(F(J)),1)]),createBaseVNode("div",_hoisted_31,[Z(J.url)?(openBlock(),createElementBlock("span",_hoisted_32,"IPv6")):createCommentVNode("",!0),B(J.url)?(openBlock(),createElementBlock("span",_hoisted_33,toDisplayString(B(J.url)),1)):createCommentVNode("",!0)])])],10,_hoisted_26))),128))])])):createCommentVNode("",!0)]),_:1})])):(openBlock(),createElementBlock("img",_hoisted_34))]))}},Player=_export_sfc(_sfc_main$1,[["__scopeId","data-v-6a403f79"]]),_hoisted_1={class:"main p-4 bg-base-100"},_hoisted_2={class:"card bg-base-200 shadow-lg rounded-lg mt-4 p-4"},_hoisted_3={class:"network-status"},_hoisted_4={class:"stats shadow bg-base-100"},_hoisted_5={class:"stat"},_hoisted_6={class:"stat-value text-primary"},_hoisted_7={class:"stat"},_hoisted_8={class:"stat-value text-secondary"},_hoisted_9={class:"mt-4 space-y-2 text-base-content"},_hoisted_10={class:"card bg-base-200 shadow-lg rounded-lg mt-4 p-4"},_hoisted_11={class:"card-title flex justify-between items-center"},_hoisted_12={class:"space-y-4 mt-4"},_hoisted_13={class:"collapse-title flex items-center justify-between"},_hoisted_14={class:"font-medium text-base-content"},_hoisted_15={class:"flex items-center gap-2"},_hoisted_16={class:"text-sm text-base-content/60"},_hoisted_17={class:"collapse-content bg-base-200/50"},_hoisted_18={class:"text-sm text-base-content/70"},_hoisted_19={key:0,class:"text-sm text-primary mt-2"},_hoisted_20={class:"card bg-base-200 shadow-lg rounded-lg mt-4 p-4"},_hoisted_21={class:"card-title flex justify-between items-center"},_hoisted_22={class:"space-y-4 mt-4"},_hoisted_23={class:"collapse-title text-xl font-medium text-base-content"},_hoisted_24={class:"collapse-content bg-base-200/50"},_hoisted_25={class:"text-base-content/70"},_sfc_main={__name:"index",setup(n){const e=ref("检测中..."),t=ref(""),r=ref(""),i=ref("检测中..."),s=ref(!1),o=ref(!1),a=ref(0),l=ref(!1),c=ref(!1),u=ref(!1),d=ref(!1),f=ref([{name:"IPv4 域名连接测试",status:"等待测试",time:"-",description:"通过一个 DNS 只有 A 记录的域名加载对象。一般使用的是 IPv4，如果纯 IPv6 用户的运营商采用了 NAT64、DNS64 或代理服务器方案，他们也能成功加载。",detail:""},{name:"IPv6 域名连接测试",status:"等待测试",time:"-",description:"通过一个 DNS 只有 AAAA 记录的域名加载对象。一般使用的是 IPv6，尚未接入 IPv6 互联网的用户很可能失败，但只要是迅速失败，目前就没有大问题。",detail:""},{name:"双栈域名连接测试",status:"等待测试",time:"-",description:"验证你的浏览器能否连接兼备 IPv4 和 IPv6 记录的网站。纯 IPv4 主机应该能（通过 IPv4）顺利连接。",detail:""},{name:"双栈域名大数据包传输测试",status:"等待测试",time:"-",description:"验证你能否连接双栈服务器并收发大数据包。如果这项测试超时，无论是什么原因，你在世界 IPv6 日都会遇上麻烦。",detail:""},{name:"无域名 IPv4 连接测试",status:"等待测试",time:"-",description:"这项测试直接通过 IPv4 地址发起连接，大多数人都应当成功，除非用的是纯 IPv6。",detail:""},{name:"无域名 IPv6 连接测试",status:"等待测试",time:"-",description:"这项测试直接通过 IPv6 地址发起连接，意在排除 DNS 问题的干扰后测试 IPv6。",detail:""},{name:"IPv6 大数据包传输测试",status:"等待测试",time:"-",description:"验证 IPv6 能否传输大数据包。如果这项测试超时，但其他 IPv6 测试成功，那么可能存在 PMTUD 问题。",detail:""},{name:"测试运营商 DNS 是否接入 IPv6",status:"等待测试",time:"-",description:"测试你的 DNS 服务器（通常由运营商提供）能否访问纯 IPv6 的 DNS 权威服务器。",detail:""},{name:"查询 IPv4 运营商",status:"等待测试",time:"-",description:"尝试识别你的 IPv4 运营商。",detail:""},{name:"查询 IPv6 运营商",status:"等待测试",time:"-",description:"尝试识别你的 IPv6 运营商。如果 IPv4 和 IPv6 运营商名称不一致，那么你可能使用了隧道。",detail:""}]),m=ref([{question:"这个测试的原理是什么？",answer:"本测试完全由客户端的 JavaScript 脚本完成。为了测试可达性，服务器会向仅支持 IPv6 的、双栈的等各种域名发出一系列 Ajax 请求，对这些请求的成败及耗时进行考量。"},{question:"为什么此网站只能通过 IPv4 访问？",answer:"没错，我们没有 AAAA 记录，这是有意的。部分用户无法访问双栈网站，要是他们连接不上，就无法得知问题所在。这也是当下内容提供商所处的一大困境，而我就在这么一个提供商工作。因此，主要的测试页面需要使用 IPv4（原生的或转换后的均可）。有朝一日，当“故障”用户的比例显著下降后，我会考虑为 test-ipv6.com 部署双栈。"},{question:"所谓的“故障”是什么意思？",answer:"现在一部分用户虽然用上了 IPv6，但要么用的是性能不佳的公共隧道，要么连上了故障或不理想的线路。可是既然他们连上了，RFC 3484 的地址选择算法往往就会选择 IPv6，然后试着用这条烂线路。而浏览器可能要过 75 秒以上才会放弃连接！"},{question:"统计信息有多大的参考价值？",answer:"被统计的都是自愿访问这个网站的人，不能代表普通网民。这个网站的目标本来就不是提供统计信息，而是让大家知道他们是否已经准备好迎接 IPv6 世界了（无论他们是否加入！）。"},{question:"你的测试和内容提供商的有什么差别？",answer:"内容提供商统计的是用户故障情况的宏观数据，目前还不会反馈给用户。这些数据很大程度上会决定他们什么时候放弃纯 IPv4，部署 IPv6。"},{question:"你真的会看反馈信息吗？",answer:"我会的，谢谢！但要注意，你得留下联系方式我才能联系上你。如果你没有留下联系方式，我仍然表示感谢，但我将无法回答你的问题。"},{question:"还有什么方式能联系你？",answer:"我希望你能使用联系表，因为它能提供你的网络状况，也不会有邮件过滤的问题。 但也欢迎你直接发邮件到 jfesler@test-ipv6.com。"},{question:"此网站是开源的吗？",answer:"是的，此网站是开源的。你可以在 GitHub 上找到相关代码。"}]),g=computed(()=>r.value?r.value:l.value&&!s.value?"未检测到 IPv6 地址":"正在检测..."),v=computed(()=>i.value!=="检测中..."?i.value:l.value?"检测失败":"正在检测..."),x=()=>{u.value=!u.value},S=()=>{d.value=!d.value},C=async()=>{try{const M=await(await fetch("https://api.ipify.org?format=json")).json();t.value=M.ip;const B=fetch("https://api6.ipify.org?format=json",{signal:AbortSignal.timeout(5e3)});try{const K=await(await B).json();r.value=K.ip,s.value=!0}catch(H){console.log("IPv6 check failed:",H),r.value="",s.value=!1}try{const K=await(await fetch(`https://ipapi.co/${t.value}/json/`)).json();i.value=K.org||K.isp||"未知运营商"}catch{try{const Y=await(await fetch(`https://ip-api.com/json/${t.value}`)).json();i.value=Y.isp||"未知运营商"}catch{i.value="获取运营商信息失败"}}R()}catch(U){console.error("Network check failed:",U),s.value=!1,t.value="检测失败"}finally{l.value=!0,e.value=s.value?"IPv4 + IPv6 双栈":"IPv4 单栈"}},R=()=>{let U=0;s.value&&(U+=5),o.value&&(U+=2),r.value&&(U+=3),a.value=U},k=U=>({成功:"text-success",失败:"text-error",超时:"text-warning",等待测试:"text-gray-500",测试中:"text-info"})[U]||"text-gray-500",I=async(U,M)=>{const B=f.value[U];B.status="测试中";const H=performance.now();try{const K=await M();B.status=K.success?"成功":"失败",B.detail=K.detail||""}catch(K){B.status=K.name==="TimeoutError"?"超时":"失败",B.detail=K.message}finally{const K=performance.now();B.time=`${((K-H)/1e3).toFixed(3)}s`}},F=async()=>{c.value=!0;try{await Promise.all([I(0,async()=>({success:(await fetch("https://ipv4.ipv6ready.me/ip/?callback=?",{signal:AbortSignal.timeout(5e3)})).ok,detail:"IPv4 连接成功"})),I(1,async()=>({success:(await fetch("https://ipv6.ipv6ready.me/ip/?callback=?",{signal:AbortSignal.timeout(5e3)})).ok,detail:"IPv6 连接成功"})),I(2,async()=>({success:(await fetch("https://ds.ipv6ready.me/ip/?callback=?",{signal:AbortSignal.timeout(5e3)})).ok,detail:"双栈连接成功"})),I(3,async()=>({success:(await fetch("https://ds.ipv6ready.me/ip/?callback=?&size=1600&fill=xxx...xxx",{signal:AbortSignal.timeout(6e3)})).ok,detail:"大数据包传输成功"})),I(4,async()=>({success:(await fetch("https://163.44.117.45/ip/?callback=?",{signal:AbortSignal.timeout(5e3)})).ok,detail:"直连 IPv4 成功"})),I(5,async()=>({success:(await fetch("https://[2400:8500:2002:3319:163:44:117:45]:80/ip/?callback=?",{signal:AbortSignal.timeout(5e3)})).ok,detail:"直连 IPv6 成功"})),I(6,async()=>({success:(await fetch("https://mtu1280.ipv6ready.me/ip/?callback=?&size=1600&fill=xxx...xxx",{signal:AbortSignal.timeout(5e3)})).ok,detail:"IPv6 大数据包传输成功"})),I(7,async()=>({success:(await fetch("https://ds.v6ns.ipv6ready.me/ip/?callback=?",{signal:AbortSignal.timeout(16e3)})).ok,detail:"DNS 支持 IPv6"})),I(8,async()=>({success:!0,detail:`IPv4 ASN: ${(await(await fetch("https://ipv4.lookup.test-ipv6.com/ip/?callback=?&asn=1",{signal:AbortSignal.timeout(5e3)})).json()).asn||"未知"}`})),I(9,async()=>({success:!0,detail:`IPv6 ASN: ${(await(await fetch("https://ipv6.lookup.test-ipv6.com/ip/?callback=?&asn=1",{signal:AbortSignal.timeout(5e3)})).json()).asn||"未知"}`}))])}catch(U){console.error("Tests failed:",U)}finally{c.value=!1}},N=async()=>{try{const M=await(await fetch("https://dns.google/resolve?name=ipv6.google.com&type=AAAA")).json();o.value=M.Answer&&M.Answer.length>0}catch(U){console.error("DNS check failed:",U),o.value=!1}};return onMounted(async()=>{await C(),await N()}),(U,M)=>(openBlock(),createElementBlock("div",_hoisted_1,[M[10]||(M[10]=createBaseVNode("div",{role:"alert",class:"alert shadow-lg bg-base-200 p-4 rounded-lg"},[createBaseVNode("div",{class:"flex items-center gap-4"},[createBaseVNode("svg",{xmlns:"http://www.w3.org/2000/svg",class:"stroke-current shrink-0 h-8 w-8 text-primary",fill:"none",viewBox:"0 0 24 24"},[createBaseVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})]),createBaseVNode("div",null,[createBaseVNode("h1",{class:"font-bold text-primary text-xl"},"IPv6 网络测试工具"),createBaseVNode("p",{class:"text-base-content/70"},"检测您的网络 IPv6 连接状态和配置情况")])])],-1)),createBaseVNode("div",_hoisted_2,[createBaseVNode("div",_hoisted_3,[createBaseVNode("div",_hoisted_4,[createBaseVNode("div",_hoisted_5,[M[0]||(M[0]=createBaseVNode("div",{class:"stat-title text-base-content/70"},"网络类型",-1)),createBaseVNode("div",_hoisted_6,toDisplayString(e.value),1)]),createBaseVNode("div",_hoisted_7,[M[1]||(M[1]=createBaseVNode("div",{class:"stat-title text-base-content/70"},"IPv6 得分",-1)),createBaseVNode("div",_hoisted_8,toDisplayString(a.value)+"/10",1)])]),createBaseVNode("div",_hoisted_9,[createBaseVNode("p",null,[M[2]||(M[2]=createTextVNode("IPv4 地址: ")),createBaseVNode("strong",null,toDisplayString(t.value||"正在检测..."),1)]),createBaseVNode("p",null,[M[3]||(M[3]=createTextVNode("IPv6 地址: ")),createBaseVNode("strong",null,toDisplayString(g.value),1)]),createBaseVNode("p",null,[M[4]||(M[4]=createTextVNode("运营商（ISP）: ")),createBaseVNode("strong",null,toDisplayString(v.value),1)])]),l.value?(openBlock(),createElementBlock("div",{key:0,class:normalizeClass(["alert mt-4",s.value?"alert-success":"alert-warning"])},[createBaseVNode("div",null,[M[5]||(M[5]=createBaseVNode("svg",{xmlns:"http://www.w3.org/2000/svg",class:"stroke-current shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24"},[createBaseVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})],-1)),createBaseVNode("span",null,toDisplayString(s.value?"IPv6 连接正常":"未检测到 IPv6 连接"),1)])],2)):createCommentVNode("",!0),createBaseVNode("button",{onClick:F,class:"btn btn-primary w-full mt-4"},toDisplayString(c.value?"测试中...":"开始 IPv6 测试"),1)])]),createBaseVNode("div",_hoisted_10,[createBaseVNode("div",_hoisted_11,[M[6]||(M[6]=createBaseVNode("h2",{class:"text-xl font-bold text-base-content"},"测试项目",-1)),createBaseVNode("button",{class:"btn btn-ghost btn-sm",onClick:S},toDisplayString(d.value?"收起":"展开"),1)]),withDirectives(createBaseVNode("div",_hoisted_12,[(openBlock(!0),createElementBlock(Fragment$1,null,renderList(f.value,(B,H)=>(openBlock(),createElementBlock("div",{key:H,class:"collapse collapse-arrow bg-base-300 hover:bg-base-300/80"},[M[7]||(M[7]=createBaseVNode("input",{type:"checkbox"},null,-1)),createBaseVNode("div",_hoisted_13,[createBaseVNode("span",_hoisted_14,toDisplayString(B.name),1),createBaseVNode("div",_hoisted_15,[createBaseVNode("span",{class:normalizeClass(k(B.status))},toDisplayString(B.status),3),createBaseVNode("span",_hoisted_16,"("+toDisplayString(B.time)+")",1)])]),createBaseVNode("div",_hoisted_17,[createBaseVNode("p",_hoisted_18,toDisplayString(B.description),1),B.detail?(openBlock(),createElementBlock("p",_hoisted_19,toDisplayString(B.detail),1)):createCommentVNode("",!0)])]))),128))],512),[[vShow,d.value]])]),createBaseVNode("div",_hoisted_20,[createBaseVNode("div",_hoisted_21,[M[8]||(M[8]=createBaseVNode("h2",{class:"text-xl font-bold text-base-content"},"常见问题",-1)),createBaseVNode("button",{class:"btn btn-ghost btn-sm",onClick:x},toDisplayString(u.value?"收起":"展开"),1)]),withDirectives(createBaseVNode("div",_hoisted_22,[(openBlock(!0),createElementBlock(Fragment$1,null,renderList(m.value,(B,H)=>(openBlock(),createElementBlock("div",{key:H,class:"collapse collapse-arrow bg-base-300"},[M[9]||(M[9]=createBaseVNode("input",{type:"checkbox"},null,-1)),createBaseVNode("div",_hoisted_23,toDisplayString(B.question),1),createBaseVNode("div",_hoisted_24,[createBaseVNode("p",_hoisted_25,toDisplayString(B.answer),1)])]))),128))],512),[[vShow,u.value]])])]))}},Ipv6=_export_sfc(_sfc_main,[["__scopeId","data-v-cddeacde"]]),router=createRouter({history:createWebHashHistory(),routes:[{path:"/",redirect:"/qrcode"},{path:"/qrcode",name:"qrcode",component:Qrcode},{path:"/jsfuck",name:"jsfuck",component:Jsfuck},{path:"/table",name:"table",component:Change},{path:"/devtools",name:"devtools",component:Devtools},{path:"/player",name:"player",component:Player},{path:"/ipv6",name:"ipv6",component:Ipv6}]}),app=createApp(_sfc_main$6),pinia=createPinia();pinia.use(index);app.use(router);app.use(pinia);app.mount("#app");
